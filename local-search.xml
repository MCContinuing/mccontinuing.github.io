<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SpringBootæ‰“waråŒ…ã€jaråŒ…</title>
    <link href="/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/"/>
    <url>/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/</url>
    
    <content type="html"><![CDATA[<h1 id="SpringBootæ‰“waråŒ…"><a href="#SpringBootæ‰“waråŒ…" class="headerlink" title="SpringBootæ‰“waråŒ…"></a>SpringBootæ‰“waråŒ…</h1><p>1ã€æ·»åŠ spring-boot-starter-tomcatçš„providedä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>providedæŒ‡ç¼–è¯‘æ—¶ä¾èµ–</li></ul><p>2ã€æ·»åŠ maven-war-pluginæ’ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-war-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>finalNameè¡¨ç¤ºæ‰“åŒ…å‡ºçš„waråŒ…å¼•ç”¨project.artifactIdå‘½å</li></ul><p>3ã€åœ¨é¡¹ç›®pomå‰åŠ ä¸Špackaging-war</p><p><img src="/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/image-20210317151848454.png" alt="image-20210317151848454"></p><p>4ã€ä¿®æ”¹å¯åŠ¨ç±»</p><p>â€‹    æ·»åŠ extendã€é‡å†™ä¸€ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.builder.SpringApplicationBuilder;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.support.SpringBootServletInitializer;<br><br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mymiaosha01Application</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SpringBootServletInitializer</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(Mymiaosha01Application.class, args);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> SpringApplicationBuilder <span class="hljs-title">configure</span><span class="hljs-params">(SpringApplicationBuilder builder)</span></span>&#123;<br>        <span class="hljs-keyword">return</span> builder.sources(Mymiaosha01Application.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€å‘½ä»¤è¡Œå¯åŠ¨</p><p>æ¥åˆ°é¡¹ç›®æ‰€åœ¨æ–‡ä»¶ä½ç½®</p><p><img src="/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/image-20210317154308061.png" alt="image-20210317154308061"></p><p>cmd: <code>mvn clean package</code></p><p><img src="/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/image-20210317154436734.png" alt="image-20210317154436734"></p><p>6ã€æ”¾åˆ°tomcatç›®å½•çš„webapps/Rootä¸­</p><p>7ã€å¯åŠ¨tomcat</p><h1 id="SpringBootæ‰“jaråŒ…"><a href="#SpringBootæ‰“jaråŒ…" class="headerlink" title="SpringBootæ‰“jaråŒ…"></a>SpringBootæ‰“jaråŒ…</h1><p>springbooté»˜è®¤æ‰“jaråŒ…</p><p>æ­£å¸¸æƒ…å†µä¸éœ€è¦ä¿®æ”¹ä»£ç åœ¨å³è¾¹mavençª—å£ç‚¹å‡»packageå³å¯</p><p>è‹¥å¯¹æ¯”waråŒ…ï¼Œæ”¹æˆjarçš„è¯ï¼Œä¿®æ”¹æ—¶æ³¨æ„ä»¥ä¸‹å‡ ç‚¹</p><ul><li><p><packaging>war<packaging>ä¿®æ”¹æˆjar</packaging></packaging></p></li><li><p>åˆ é™¤ä¸Šè¿°ç¬¬ä¸€æ­¥çš„ä¾èµ–</p></li><li><p>å°†å¯åŠ¨ç±»è¿˜åŸ</p></li><li><p>å°†æ’ä»¶ä¿®æ”¹æˆä¸‹è¿°ä»£ç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-resources-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ­£å¸¸æƒ…å†µå·²ç»å¯ä»¥æ‰“åŒ…äº†</p><p>ä½†æ˜¯æµ‹è¯•æ—¶å‡ºç°äº†ä»¥ä¸‹é”™è¯¯</p><blockquote><p>Failed to execute goal org.apache.maven.plugins:maven-resources-plugin:3.0.2:resâ€¦</p></blockquote><p>å°†ä¸Šè¾¹æ’ä»¶è¿™ä¸ªä¿®æ”¹ä¸ºä¸‹é¢çš„å°±å¯ä»¥äº†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-resources-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.shared<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-filtering<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>æ‰“åŒ…æˆåŠŸ</p><p><img src="/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/image-20210317204550353.png" alt="image-20210317204550353"></p></li></ul><p>ä½†æ˜¯æ‰“åŒ…æˆåŠŸï¼Œåˆ°Linuxä»ç„¶è¿è¡Œå¤±è´¥</p><p>å†æ¬¡ä¿®æ”¹æ’ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-resources-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.shared<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-filtering<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h1 id="å°†æ‰“åŒ…åçš„jaråŒ…æ”¾å…¥Linuxä¸‹è¿è¡Œ"><a href="#å°†æ‰“åŒ…åçš„jaråŒ…æ”¾å…¥Linuxä¸‹è¿è¡Œ" class="headerlink" title="å°†æ‰“åŒ…åçš„jaråŒ…æ”¾å…¥Linuxä¸‹è¿è¡Œ"></a>å°†æ‰“åŒ…åçš„jaråŒ…æ”¾å…¥Linuxä¸‹è¿è¡Œ</h1><p>å¦‚å¤åˆ¶åˆ°æ–°å»ºæ–‡ä»¶å¤¹myprojectä¸­</p><p>è¿›å…¥æ–‡ä»¶å¤¹å†™å¦‚ä¸‹å‘½ä»¤è¿è¡ŒjaråŒ…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">nohup java -jar mymiaosha01.jar<br><span class="hljs-meta">#</span><span class="bash">æˆ–</span><br>java -jar mymiaosha01.jar<br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å¯ä»¥å°†è¾“å‡ºç»“æœåˆ°nohup.outæ–‡ä»¶ä¸­</p><p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹<code>tail -f nohup.out</code></p><p><img src="/2021/03/17/SpringBoot%E6%89%93war%E5%8C%85/image-20210317205639866.png" alt="image-20210317205639866"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Rediså‹åŠ›æµ‹è¯•</title>
    <link href="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/"/>
    <url>/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p>Rediså®˜æ–¹è‡ªå¸¦äº†ä¸€æ¬¾å‹æµ‹å·¥å…·redis-benchmark</p><h2 id="redis-benchmarkå‹åŠ›æµ‹è¯•å·¥å…·"><a href="#redis-benchmarkå‹åŠ›æµ‹è¯•å·¥å…·" class="headerlink" title="redis-benchmarkå‹åŠ›æµ‹è¯•å·¥å…·"></a>redis-benchmarkå‹åŠ›æµ‹è¯•å·¥å…·</h2><h2 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h2><p><img src="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/20210116175434236.png"></p><h2 id="æµ‹è¯•æ¼”ç¤º"><a href="#æµ‹è¯•æ¼”ç¤º" class="headerlink" title="æµ‹è¯•æ¼”ç¤º"></a>æµ‹è¯•æ¼”ç¤º</h2><h3 id="æµ‹è¯•1ï¼š100ä¸ªå¹¶å‘æµ‹è¯•ï¼Œ100000ä¸ªè¯·æ±‚"><a href="#æµ‹è¯•1ï¼š100ä¸ªå¹¶å‘æµ‹è¯•ï¼Œ100000ä¸ªè¯·æ±‚" class="headerlink" title="æµ‹è¯•1ï¼š100ä¸ªå¹¶å‘æµ‹è¯•ï¼Œ100000ä¸ªè¯·æ±‚"></a>æµ‹è¯•1ï¼š100ä¸ªå¹¶å‘æµ‹è¯•ï¼Œ100000ä¸ªè¯·æ±‚</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æµ‹è¯•ï¼š100ä¸ªå¹¶å‘è¿æ¥ 100000è¯·æ±‚</span><br>redis-benchmark -h localhost -p 6379 -c 100 -n 100000<br></code></pre></td></tr></table></figure><p><img src="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/image-20210219231612192.png" alt="image-20210219231612192"></p><p>æµ‹è¯•åˆ†æï¼š</p><p><img src="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/20210116175532636.png"></p><h3 id="æµ‹è¯•2ï¼šå­˜å–å¤§å°ä¸º100å­—èŠ‚çš„æ•°æ®åŒ…"><a href="#æµ‹è¯•2ï¼šå­˜å–å¤§å°ä¸º100å­—èŠ‚çš„æ•°æ®åŒ…" class="headerlink" title="æµ‹è¯•2ï¼šå­˜å–å¤§å°ä¸º100å­—èŠ‚çš„æ•°æ®åŒ…"></a>æµ‹è¯•2ï¼šå­˜å–å¤§å°ä¸º100å­—èŠ‚çš„æ•°æ®åŒ…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æµ‹è¯•ï¼šä»¥100å­—èŠ‚æµ‹è¯•ï¼Œ-qä¸è¾“å‡ºæµ‹è¯•è¯¦ç»†å†…å®¹</span><br>redis-benchmark -h 127.0.0.1 -p 6379 -q -d 100<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/image-20210317145052429.png" alt="image-20210317145052429"></p><h3 id="æµ‹è¯•3ï¼šåªæµ‹è¯•æŸäº›æ“ä½œçš„æ€§èƒ½"><a href="#æµ‹è¯•3ï¼šåªæµ‹è¯•æŸäº›æ“ä½œçš„æ€§èƒ½" class="headerlink" title="æµ‹è¯•3ï¼šåªæµ‹è¯•æŸäº›æ“ä½œçš„æ€§èƒ½"></a>æµ‹è¯•3ï¼šåªæµ‹è¯•æŸäº›æ“ä½œçš„æ€§èƒ½</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æµ‹è¯•ï¼šåªæµ‹è¯•<span class="hljs-built_in">set</span>ï¼Œlpushå‘½ä»¤</span><br>redis-benchmark -t set,lpush -n 100000 -q<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/image-20210317145331860.png" alt="image-20210317145331860"></p><h3 id="æµ‹è¯•4ï¼šåªæµ‹è¯•æŸäº›æ•°å€¼å­˜å–çš„æ€§èƒ½"><a href="#æµ‹è¯•4ï¼šåªæµ‹è¯•æŸäº›æ•°å€¼å­˜å–çš„æ€§èƒ½" class="headerlink" title="æµ‹è¯•4ï¼šåªæµ‹è¯•æŸäº›æ•°å€¼å­˜å–çš„æ€§èƒ½"></a>æµ‹è¯•4ï¼šåªæµ‹è¯•æŸäº›æ•°å€¼å­˜å–çš„æ€§èƒ½</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åªæµ‹è¯•æ‰§è¡Œ<span class="hljs-string">&quot;redis.call(&#x27;set&#x27;,&#x27;foo&#x27;,&#x27;bar&#x27;)&quot;</span>å‘½ä»¤çš„å‹æµ‹</span><br>redis-benchmark -n 100000 -q script load &quot;redis.call(&#x27;set&#x27;,&#x27;foo&#x27;,&#x27;bar&#x27;)&quot;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="/2021/03/16/Redis%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/image-20210317150137952.png" alt="image-20210317150137952"></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç§’æ€ç³»ç»Ÿå‹åŠ›æµ‹è¯•åŠé¡¹ç›®ä¼˜åŒ–ï¼ˆäºŒï¼‰</title>
    <link href="/2021/03/16/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E5%8F%8A%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2021/03/16/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E5%8F%8A%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="å‹åŠ›æµ‹è¯•ä¸€ï¼šåªä½¿ç”¨mysqlçš„å‹åŠ›æµ‹è¯•"><a href="#å‹åŠ›æµ‹è¯•ä¸€ï¼šåªä½¿ç”¨mysqlçš„å‹åŠ›æµ‹è¯•" class="headerlink" title="å‹åŠ›æµ‹è¯•ä¸€ï¼šåªä½¿ç”¨mysqlçš„å‹åŠ›æµ‹è¯•"></a>å‹åŠ›æµ‹è¯•ä¸€ï¼šåªä½¿ç”¨mysqlçš„å‹åŠ›æµ‹è¯•</h2><p>æµ‹è¯•å•†å“åˆ—è¡¨æ¥å£ç»“æœï¼šä¸€ç§’åªæ”¯æŒ147.7çº¿ç¨‹</p><p><img src="/2021/03/16/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E5%8F%8A%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96%EF%BC%88%E4%BA%8C%EF%BC%89/image-20210316203738249.png" alt="image-20210316203738249"></p><p><img src="/2021/03/16/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E5%8F%8A%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96%EF%BC%88%E4%BA%8C%EF%BC%89/image-20210316204042228.png" alt="image-20210316204042228"></p><p>æµ‹è¯•ç§’æ€æ¥å£æ—¶ï¼ŒQPSä¸ä¹‹å‰å·®ä¸å¤šï¼Œä½†æ˜¯å‡ºç°äº†è¶…å–ç°è±¡ã€‚è¯´æ˜å•ç”¨æˆ·çš„åˆ¤æ–­é€»è¾‘åœ¨å¤šç”¨æˆ·åœºæ™¯ä¸‹ä¸é€‚ç”¨ï¼Œæµ‹è¯•æ¨¡æ‹Ÿäº†5000ä¸ªç”¨æˆ·åŒæ—¶ç§’æ€ä¸€ä¸ª10åº“å­˜çš„å•†å“ï¼Œæœ€ç»ˆè¶…å–äº†13ä¸ªï¼Œè¿™åœ¨æ›´å¤§è§„æ¨¡ç”¨æˆ·ç§’æ€å•†å“æ—¶å‡ ä¹æ˜¯è‡´å‘½é”™è¯¯ã€‚</p><h1 id="ä¼˜åŒ–é¡¹ç›®"><a href="#ä¼˜åŒ–é¡¹ç›®" class="headerlink" title="ä¼˜åŒ–é¡¹ç›®"></a>ä¼˜åŒ–é¡¹ç›®</h1><h2 id="ä¼˜åŒ–ä¸€ï¼šé¡µé¢ç¼“å­˜-URLç¼“å­˜-å¯¹è±¡ç¼“å­˜"><a href="#ä¼˜åŒ–ä¸€ï¼šé¡µé¢ç¼“å­˜-URLç¼“å­˜-å¯¹è±¡ç¼“å­˜" class="headerlink" title="ä¼˜åŒ–ä¸€ï¼šé¡µé¢ç¼“å­˜+URLç¼“å­˜+å¯¹è±¡ç¼“å­˜"></a>ä¼˜åŒ–ä¸€ï¼šé¡µé¢ç¼“å­˜+URLç¼“å­˜+å¯¹è±¡ç¼“å­˜</h2><h3 id="é¡µé¢ç¼“å­˜"><a href="#é¡µé¢ç¼“å­˜" class="headerlink" title="é¡µé¢ç¼“å­˜"></a>é¡µé¢ç¼“å­˜</h3><ol><li>å–ç¼“å­˜</li><li>å¦‚æœç¼“å­˜ä¸å­˜åœ¨ï¼Œæ‰‹åŠ¨æ¸²æŸ“æ¨¡æ¿</li><li>ç»“æœè¾“å‡º</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value=&quot;/to_list&quot;,produces=&quot;text/html&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">list</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Model model, MiaoshaUser user)</span> </span>&#123;<br>        model.addAttribute(<span class="hljs-string">&quot;user&quot;</span>, user);<br><br>        <span class="hljs-comment">//å–ç¼“å­˜</span><br>        String html = redisService.get(GoodsKey.getGoodsList,<span class="hljs-string">&quot;&quot;</span>,String.class)<br>        <span class="hljs-keyword">if</span>(!StringUtils.isEmpty(html))&#123;<br>            <span class="hljs-keyword">return</span> html;<br>        &#125;<br><br>        <span class="hljs-comment">//å¦‚æœä¸ºç©ºåˆ™ï¼ŒæŸ¥è¯¢å•†å“åˆ—è¡¨</span><br>        List&lt;GoodsVo&gt; goodsList = goodsService.listGoodsVo();<br>        model.addAttribute(<span class="hljs-string">&quot;goodsList&quot;</span>, goodsList);<br><span class="hljs-comment">//        return &quot;goods_list&quot;;</span><br><br><br>        SpringWebContext ctx = <span class="hljs-keyword">new</span> SpringWebContext(request,<br>                response,request.getServletContext(),<br>                request.getLocale(),model.asMap(),applicationContext);<br><br>        <span class="hljs-comment">//æ‰‹åŠ¨æ¸²æŸ“</span><br>        html = thymeleafViewResolver.getTemplateEngine().process(<span class="hljs-string">&quot;goods_list&quot;</span>,ctx);<br>        <span class="hljs-comment">//å¦‚æœæ¨¡æ¿ä¸æ˜¯ç©ºï¼Œä¿å­˜åˆ°ç¼“å­˜ä¸­å»</span><br>        <span class="hljs-keyword">if</span>(!StringUtils.isEmpty(html))&#123;<br>            redisService.set(GoodsKey.getGoodsList,<span class="hljs-string">&quot;&quot;</span>,html);<br>        &#125;<br>        <span class="hljs-keyword">return</span> html;<br>    &#125;<br><br></code></pre></td></tr></table></figure><p>æ­¤å¤„é‡åˆ°é—®é¢˜ï¼šSping5ä¸­SpringWebContextæ–¹æ³•è¿‡æ—¶</p><p>å› ä¸ºåœ¨thymeleaf.spring5çš„APIä¸­æŠŠå¤§éƒ¨åˆ†çš„åŠŸèƒ½ç§»åˆ°äº†IWebContextä¸‹é¢,ç”¨æ¥åŒºåˆ†è¾¹ç•Œã€‚å‰”é™¤äº†ApplicationContext è¿‡å¤šçš„ä¾èµ–ï¼Œç°åœ¨thymeleafæ¸²æŸ“ä¸å†è¿‡å¤šä¾èµ–springå®¹å™¨</p><p>è°ƒç”¨è¿™ä¸ªå³å¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">IWebContext ctx =<span class="hljs-keyword">new</span> WebContext(request,response,<br>                request.getServletContext(),request.getLocale(),model.asMap());<br></code></pre></td></tr></table></figure><h2 id="ä¼˜åŒ–äºŒï¼šé¡µé¢é™æ€åŒ–ï¼Œå‰åç«¯åˆ†ç¦»"><a href="#ä¼˜åŒ–äºŒï¼šé¡µé¢é™æ€åŒ–ï¼Œå‰åç«¯åˆ†ç¦»" class="headerlink" title="ä¼˜åŒ–äºŒï¼šé¡µé¢é™æ€åŒ–ï¼Œå‰åç«¯åˆ†ç¦»"></a>ä¼˜åŒ–äºŒï¼šé¡µé¢é™æ€åŒ–ï¼Œå‰åç«¯åˆ†ç¦»</h2><p>å¼ƒç”¨thymeleaf,ä½¿ç”¨åŸç”ŸHtml</p><p>é‡‡ç”¨é™æ€åŒ–é¡µé¢</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#éœ€è¦åœ¨é…ç½®ä¸­åŠ ä¸Šå¦‚ä¸‹å†…å®¹ï¼Œå¦åˆ™ä¼š404</span><br><span class="hljs-comment">#static</span><br><span class="hljs-meta">spring.sources.add-mappings</span>=<span class="hljs-string">true</span><br><span class="hljs-meta">spring.sources.cache-period</span>= <span class="hljs-string">3600</span><br><span class="hljs-meta">spring.sources.chain.cache</span>=<span class="hljs-string">true </span><br><span class="hljs-meta">spring.sources.chain.enabled</span>=<span class="hljs-string">true</span><br><span class="hljs-meta">spring.sources.chain.gzipped</span>=<span class="hljs-string">true</span><br><span class="hljs-meta">spring.sources.chain.html-application-cache</span>=<span class="hljs-string">true</span><br><span class="hljs-meta">spring.sources.static-locations</span>=<span class="hljs-string">classpath:/static/</span><br></code></pre></td></tr></table></figure><p>è§£å†³è¶…å–ï¼š</p><p>1ã€æ•°æ®åº“ä»£ç ä¿®æ”¹</p><p>åŸä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Update(&quot;update miaosha_goods set stock_count = stock_count - 1 where goods_id = #&#123;goodsId&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reduceStock</span><span class="hljs-params">(MiaoshaGoods g)</span></span>;<br></code></pre></td></tr></table></figure><p>åŠ ä¸Šåˆ¤æ–­æ¡ä»¶ and stock_count &gt; 0ï¼Œä¿®æ”¹å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Update(&quot;update miaosha_goods set stock_count = stock_count - 1 where goods_id = #&#123;goodsId&#125; and stock_count &gt; 0&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">reduceStock</span><span class="hljs-params">(MiaoshaGoods g)</span></span>;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·ä¿®æ”¹åï¼Œä»ç„¶ä¸èƒ½é˜²æ­¢ä¸€ä¸ªç”¨æˆ·ç§’æ€åˆ°ä¸¤ä¸ªå•†å“çš„æƒ…å†µï¼šä¸€ä¸ªç”¨æˆ·åŒæ—¶å‘èµ·ä¸¤ä¸ªè¯·æ±‚å¹¶ä¸”åŒæ—¶ç§’æ€åˆ°å•†å“çš„æƒ…å†µã€‚å’Œä¸€ä¸ªç”¨æˆ·ä¸èƒ½ç§’æ€ä¸¤ä¸ªå•†å“çš„è§„åˆ™ç›¸è¿èƒŒ</p><p>2ã€æ‰€ä»¥éœ€è¦åˆ©ç”¨æ•°æ®åº“çš„ç´¢å¼•ï¼Œåˆ©ç”¨å”¯ä¸€ç´¢å¼•é˜²æ­¢ç”¨æˆ·æ’å…¥é‡å¤æ•°æ®ï¼Œæ•°æ®åº“æ·»åŠ ç´¢å¼•å¦‚ä¸‹ï¼š</p><p><img src="/2021/03/16/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E5%8F%8A%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96%EF%BC%88%E4%BA%8C%EF%BC%89/image-20210319164309659.png" alt="image-20210319164309659"></p><p>ä»¥ä¸Šä¸¤æ­¥å¯ä»¥å®Œå…¨æœç»å•†å“å–è¶…çš„æƒ…å†µ</p><p>æ€»ç»“ï¼š1ã€æ•°æ®åº“åŠ å”¯ä¸€ç´¢å¼•ï¼Œé˜²æ­¢ç”¨æˆ·é‡å¤è´­ä¹°ã€‚2ã€SQLåŠ åº“å­˜æ•°é‡åˆ¤æ–­ï¼šé˜²æ­¢åº“å­˜å˜æˆè´Ÿæ•°ã€‚</p><h2 id="ä¼˜åŒ–ä¸‰ï¼šé™æ€èµ„æºä¼˜åŒ–"><a href="#ä¼˜åŒ–ä¸‰ï¼šé™æ€èµ„æºä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–ä¸‰ï¼šé™æ€èµ„æºä¼˜åŒ–"></a>ä¼˜åŒ–ä¸‰ï¼šé™æ€èµ„æºä¼˜åŒ–</h2><p>1ã€JS/CSSå‹ç¼©ï¼Œå‡å°‘æµé‡</p><p>2ã€å¤šä¸ªJS/CSSç»„åˆï¼Œå‡å°‘è¿æ¥æ•°</p><p>tengine.taobao.org</p><h2 id="ä¼˜åŒ–å››ï¼šCDNä¼˜åŒ–"><a href="#ä¼˜åŒ–å››ï¼šCDNä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–å››ï¼šCDNä¼˜åŒ–"></a>ä¼˜åŒ–å››ï¼šCDNä¼˜åŒ–</h2><p>CDNå°±è¿‘è®¿é—®</p><h2 id="ä¼˜åŒ–äº”ï¼šæ¥å£ä¼˜åŒ–"><a href="#ä¼˜åŒ–äº”ï¼šæ¥å£ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–äº”ï¼šæ¥å£ä¼˜åŒ–"></a>ä¼˜åŒ–äº”ï¼šæ¥å£ä¼˜åŒ–</h2><p><strong>ä¸»è¦å·¥ä½œï¼š</strong></p><p>1ã€Redisé¢„å‡åº“å­˜å‡å°‘æ•°æ®åº“è®¿é—®</p><p>2ã€å†…å­˜æ ‡è®°å‡å°‘Redisè®¿é—®</p><p>3ã€è¯·æ±‚å…ˆå…¥é˜Ÿç¼“å†²ï¼Œå¼‚æ­¥ä¸‹å•ï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒ</p><p><strong>æ€è·¯ï¼š</strong>å‡å°‘æ•°æ®åº“è®¿é—®</p><p>1ã€ç³»ç»Ÿåˆå§‹åŒ–ï¼ŒæŠŠå•†å“åº“å­˜æ•°é‡åŠ è½½åˆ°Redis</p><p>2ã€æ”¶åˆ°è¯·æ±‚ï¼ŒRedisé¢„å‡åº“å­˜ï¼Œåº“å­˜ä¸è¶³ï¼Œç›´æ¥è¿”å›ï¼Œå¦åˆ™è¿›å…¥3</p><p>3ã€è¯·æ±‚å…¥é˜Ÿï¼Œç«‹å³è¿”å›æ’é˜Ÿä¸­</p><p>4ã€è¯·æ±‚å‡ºé˜Ÿï¼Œç”Ÿæˆè®¢å•ï¼Œå‡å°‘åº“å­˜</p><p>5ã€å®¢æˆ·ç«¯è½®è¯¢ï¼Œæ˜¯å¦ç§’æ€æˆåŠŸ</p><p><strong>ä½¿ç”¨rabbitmq</strong></p><p>å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#rabbitmq</span><br><span class="hljs-meta">spring.rabbitmq.host</span>=<span class="hljs-string">121.4.60.79</span><br><span class="hljs-meta">spring.rabbitmq.port</span>=<span class="hljs-string">5672</span><br><span class="hljs-meta">spring.rabbitmq.username</span>=<span class="hljs-string">guest</span><br><span class="hljs-meta">spring.rabbitmq.password</span>=<span class="hljs-string">guest</span><br><span class="hljs-meta">spring.rabbitmq.virtual-host</span>=<span class="hljs-string">/</span><br><span class="hljs-comment">#\u6D88\u8D39\u8005\u6570\u91CF</span><br><span class="hljs-comment">#æ¶ˆè´¹è€…æ•°é‡</span><br><span class="hljs-meta">spring.rabbitmq.listener.simple.concurrency</span>= <span class="hljs-string">10</span><br><span class="hljs-meta">spring.rabbitmq.listener.simple.max-concurrency</span>= <span class="hljs-string">10</span><br><span class="hljs-comment">#æ¯æ¬¡å–å‡ ä¸ª</span><br><span class="hljs-meta">spring.rabbitmq.listener.simple.prefetch</span>= <span class="hljs-string">1</span><br><span class="hljs-comment">#\u6D88\u8D39\u8005\u81EA\u52A8\u542F\u52A8</span><br><span class="hljs-comment">#æ¶ˆè´¹è€…æ˜¯å¦è‡ªåŠ¨å¯åŠ¨</span><br><span class="hljs-meta">spring.rabbitmq.listener.simple.auto-startup</span>=<span class="hljs-string">true</span><br><span class="hljs-comment">#æ¶ˆè´¹å¤±è´¥åæ˜¯å¦é‡æ–°å‹å…¥</span><br><span class="hljs-meta">spring.rabbitmq.listener.simple.default-requeue-rejected</span>= <span class="hljs-string">true</span><br><span class="hljs-comment">#ä»¥ä¸‹éƒ½æ˜¯é‡è¯•é…ç½®ï¼Œå¦‚æœæ»¡äº†åˆ™æ¯éš”1000</span><br><span class="hljs-meta">spring.rabbitmq.template.retry.enabled</span>=<span class="hljs-string">true </span><br><span class="hljs-meta">spring.rabbitmq.template.retry.initial-interval</span>=<span class="hljs-string">1000 </span><br><span class="hljs-meta">spring.rabbitmq.template.retry.max-attempts</span>=<span class="hljs-string">3</span><br><span class="hljs-meta">spring.rabbitmq.template.retry.max-interval</span>=<span class="hljs-string">10000</span><br><span class="hljs-comment">#å¦‚æœæ˜¯2åˆ™ç¬¬ä¸€æ¬¡ç­‰1ç§’ç¬¬äºŒæ¬¡X2ç­‰ä¸¤ç§’ï¼Œç¬¬ä¸‰æ¬¡ç­‰4ç§’</span><br><span class="hljs-meta">spring.rabbitmq.template.retry.multiplier</span>=<span class="hljs-string">1.0</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨thymeleafå‰åç«¯æœªæŠ¥é”™ï¼Œä½†å‰ç«¯æ— æ³•æ˜¾ç¤ºæ•°æ®åº“ä¼ æ¥çš„æ•°æ®</title>
    <link href="/2021/03/15/%E4%BD%BF%E7%94%A8thymeleaf%E5%89%8D%E5%90%8E%E7%AB%AF%E6%9C%AA%E6%8A%A5%E9%94%99%EF%BC%8C%E4%BD%86%E5%89%8D%E7%AB%AF%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%A0%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/"/>
    <url>/2021/03/15/%E4%BD%BF%E7%94%A8thymeleaf%E5%89%8D%E5%90%8E%E7%AB%AF%E6%9C%AA%E6%8A%A5%E9%94%99%EF%BC%8C%E4%BD%86%E5%89%8D%E7%AB%AF%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%A0%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºç²—å¿ƒçŠ¯é”™ï¼Œå¯¼è‡´ä¸¤å¤©éƒ½åœ¨é”™è·¯ä¸Šæ‰¾bugï¼Œå†™ä¸‹æ¥å½“æ•™è®­</p><p>åç«¯ä»£ç </p><p><img src="/2021/03/15/%E4%BD%BF%E7%94%A8thymeleaf%E5%89%8D%E5%90%8E%E7%AB%AF%E6%9C%AA%E6%8A%A5%E9%94%99%EF%BC%8C%E4%BD%86%E5%89%8D%E7%AB%AF%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%A0%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/image-20210315214254934.png" alt="image-20210315214254934"></p><p>å‰ç«¯ä»£ç </p><p><img src="/2021/03/15/%E4%BD%BF%E7%94%A8thymeleaf%E5%89%8D%E5%90%8E%E7%AB%AF%E6%9C%AA%E6%8A%A5%E9%94%99%EF%BC%8C%E4%BD%86%E5%89%8D%E7%AB%AF%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%A0%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/image-20210315213241744.png" alt="image-20210315213241744"></p><p>å‰ç«¯é¡µé¢æ— æ³•æ˜¾ç¤ºæ•°æ®ï¼Œæ§åˆ¶å°å¦‚ä¸‹å›¾</p><p><img src="/2021/03/15/%E4%BD%BF%E7%94%A8thymeleaf%E5%89%8D%E5%90%8E%E7%AB%AF%E6%9C%AA%E6%8A%A5%E9%94%99%EF%BC%8C%E4%BD%86%E5%89%8D%E7%AB%AF%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%A0%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/image-20210315213554173.png" alt="image-20210315213554173"></p><p>å°è¯•æ‰¾å„ç§é”™ï¼šthymeleafæ˜¯ä¸æ˜¯ä¸æ”¯æŒåˆ—è¡¨å¾ªç¯äº†ã€æ•°æ®åº“åç§°å’Œå®ä½“ç±»åç§°æ˜¯å¦å¯¹åº”ã€åç«¯è¯·æ±‚ä»£ç æ˜¯å¦é”™äº†ã€sqlè¯­è¨€æ˜¯å¦å‡ºé”™ï¼Œï¼Œï¼Œæ‰¾åˆ°æ— é”™å¯æ‰¾ï¼Œï¼Œï¼Œå¹¶ä¸”å‰ç«¯åç«¯éƒ½ä¸æŠ¥é”™ï¼Œæ­£å¸¸è¿è¡Œï¼Œéƒ½å¿«æ€€ç–‘æ˜¯ä¸æ˜¯ideaé‡Œé¢çš„çš„ç„å¹»bugï¼Œæœ€åï¼Œç»ˆäºçŸ¥é“é”™å“ªäº†ã€‚å¿˜åœ¨é…ç½®é‡Œå¼€å¯é©¼å³°äº†ğŸ˜­</p><p>æ·»åŠ é…ç½®</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-comment">#å¼€å¯é©¼å³°</span><br>mybatis.configuration.<span class="hljs-keyword">map</span>-underscore-<span class="hljs-keyword">to</span>-camel-<span class="hljs-keyword">case</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹å</p><p><img src="/2021/03/15/%E4%BD%BF%E7%94%A8thymeleaf%E5%89%8D%E5%90%8E%E7%AB%AF%E6%9C%AA%E6%8A%A5%E9%94%99%EF%BC%8C%E4%BD%86%E5%89%8D%E7%AB%AF%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%A0%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/image-20210315213404071.png" alt="image-20210315213404071"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Jmeteræ¥å£æµ‹è¯•</title>
    <link href="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/"/>
    <url>/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h1 id="Jmeterç®€ä»‹"><a href="#Jmeterç®€ä»‹" class="headerlink" title="Jmeterç®€ä»‹"></a>Jmeterç®€ä»‹</h1><blockquote><p>The <strong>Apache JMeterâ„¢</strong> application is open source software, a 100% pure Java application designed to load test functional behavior and measure performance. It was originally designed for testing Web Applications but has since expanded to other test functions.</p></blockquote><p>å®˜ç½‘ï¼š<a href="http://jmeter.apache.org/">http://jmeter.apache.org</a></p><p>ä¸‹è½½åœ°å€ï¼š<a href="http://jmeter.apache.org/download_jmeter.cgi">http://jmeter.apache.org/download_jmeter.cgi</a> </p><p>ç”¨æˆ·æ‰‹å†Œï¼š<a href="https://jmeter.apache.org/usermanual/get-started.html">https://jmeter.apache.org/usermanual/get-started.html</a></p><h1 id="Jmeterå®‰è£…æµ‹è¯•"><a href="#Jmeterå®‰è£…æµ‹è¯•" class="headerlink" title="Jmeterå®‰è£…æµ‹è¯•"></a>Jmeterå®‰è£…æµ‹è¯•</h1><h2 id="ä¸‹è½½è§£å‹"><a href="#ä¸‹è½½è§£å‹" class="headerlink" title="ä¸‹è½½è§£å‹"></a>ä¸‹è½½è§£å‹</h2><p>æ‰“å¼€å®˜ç½‘ä¸‹è½½åœ°å€ï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬ï¼ˆæ­¤å¤„ä¸‹è½½äºŒè¿›åˆ¶tgzç‰ˆæœ¬ï¼‰</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315194913965.png" alt="image-20210315194913965"></p><p>è§£å‹</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315195428545.png" alt="image-20210315195428545"></p><p>å¯åŠ¨ï¼šbinç›®å½•ä¸‹çš„ jmeter.bat</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315195816438.png" alt="image-20210315195816438"></p><p>å¯ä»¥çœ‹è§æ‰“å¼€äº†ä¸€ä¸ªcmdçª—å£ï¼ŒåŠä¸€ä¸ªå›¾å½¢ç•Œé¢åº”ç”¨ç¨‹åº</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315200610805.png" alt="image-20210315200610805"></p><h2 id="æµ‹è¯•1ï¼šç®€å•æ— å‚æ•°æ¥å£"><a href="#æµ‹è¯•1ï¼šç®€å•æ— å‚æ•°æ¥å£" class="headerlink" title="æµ‹è¯•1ï¼šç®€å•æ— å‚æ•°æ¥å£"></a>æµ‹è¯•1ï¼šç®€å•æ— å‚æ•°æ¥å£</h2><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315200543170.png" alt="image-20210315200543170"></p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315201012486.png" alt="image-20210315201012486"></p><p>Ramp-up periodï¼šè¡¨ç¤ºä¸Šé¢çš„è¿›ç¨‹æ•°éœ€è¦åœ¨å¤šå°‘ç§’å†…å¯åŠ¨èµ·æ¥ï¼ˆ0ï¼šä¸€èµ·å¯åŠ¨ï¼Œnï¼šnç§’å†…å…ˆåå¯åŠ¨ï¼Œï¼‰</p><p>Loop Countï¼šå¾ªç¯æ¬¡æ•°ï¼Œä¸Šé¢çš„çº¿ç¨‹åœ¨è®¿é—®æ¥å£æ—¶ä¸€å…±å¾ªç¯å¤šå°‘æ¬¡</p><h3 id="æ·»åŠ é…ç½®å…ƒä»¶ï¼šhttpè¯·æ±‚é»˜è®¤å€¼"><a href="#æ·»åŠ é…ç½®å…ƒä»¶ï¼šhttpè¯·æ±‚é»˜è®¤å€¼" class="headerlink" title="æ·»åŠ é…ç½®å…ƒä»¶ï¼šhttpè¯·æ±‚é»˜è®¤å€¼"></a>æ·»åŠ é…ç½®å…ƒä»¶ï¼šhttpè¯·æ±‚é»˜è®¤å€¼</h3><ul><li>è®¾ç½®é»˜è®¤å€¼çš„å¥½å¤„æ˜¯ä¹‹åçš„httpè¯·æ±‚ä¸éœ€è¦é‡å¤è®¾ç½®äº†</li></ul><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315202020328.png" alt="image-20210315202020328"></p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315202201068.png" alt="image-20210315202201068"></p><h3 id="æ·»åŠ Sampleï¼šHttpè¯·æ±‚"><a href="#æ·»åŠ Sampleï¼šHttpè¯·æ±‚" class="headerlink" title="æ·»åŠ Sampleï¼šHttpè¯·æ±‚"></a>æ·»åŠ Sampleï¼šHttpè¯·æ±‚</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315201521653.png" alt="image-20210315201521653"></p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315202742045.png" alt="image-20210315202742045"></p><h3 id="æ·»åŠ ç›‘å¬å™¨ï¼šèšåˆæŠ¥å‘Šï¼Œç”¨æ¥æŸ¥çœ‹æµ‹è¯•ç»“æœï¼ˆä¸€ä¸ªå¤§è‡´ç»“æœï¼‰"><a href="#æ·»åŠ ç›‘å¬å™¨ï¼šèšåˆæŠ¥å‘Šï¼Œç”¨æ¥æŸ¥çœ‹æµ‹è¯•ç»“æœï¼ˆä¸€ä¸ªå¤§è‡´ç»“æœï¼‰" class="headerlink" title="æ·»åŠ ç›‘å¬å™¨ï¼šèšåˆæŠ¥å‘Šï¼Œç”¨æ¥æŸ¥çœ‹æµ‹è¯•ç»“æœï¼ˆä¸€ä¸ªå¤§è‡´ç»“æœï¼‰"></a>æ·»åŠ ç›‘å¬å™¨ï¼šèšåˆæŠ¥å‘Šï¼Œç”¨æ¥æŸ¥çœ‹æµ‹è¯•ç»“æœï¼ˆä¸€ä¸ªå¤§è‡´ç»“æœï¼‰</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315202953651.png"></p><p>å¦‚æœæƒ³è¦è¯¦ç»†ç»“æœï¼Œéœ€è¦å†æ·»åŠ åˆ«çš„ç›‘å¬å™¨ï¼šå›¾å½¢ç»“æœï¼Œç»“æœæ ‘ï¼Œè¡¨æ ¼ç­‰ç­‰</p><p>æ­¤å¤„æ·»åŠ ä¸€ä¸ªå›¾å½¢ç»“æœã€å’Œå°†ç»“æœå­˜åœ¨è¡¨æ ¼</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315203231721.png" alt="image-20210315203231721"></p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315204701841.png" alt="image-20210315204701841"></p><h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315203940046.png" alt="image-20210315203940046"></p><p>é€‰æ‹©æ–‡ä»¶å¤¹ä¿å­˜æµ‹è¯•ç»“æœï¼ˆä¸ºäº†æ–¹ä¾¿ï¼Œæš‚æ—¶ä¿å­˜åœ¨æ¡Œé¢ï¼‰</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315204037445.png" alt="image-20210315204037445"></p><h3 id="æŸ¥çœ‹ç»“æœ"><a href="#æŸ¥çœ‹ç»“æœ" class="headerlink" title="æŸ¥çœ‹ç»“æœ"></a>æŸ¥çœ‹ç»“æœ</h3><p>åˆ°ç›‘å¬å™¨ä¸­æŸ¥çœ‹ç»“æœï¼š</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315204359096.png" alt="image-20210315204359096"></p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315204853189.png" alt="image-20210315204853189"></p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315204633851.png" alt="image-20210315204633851"></p><p>æ¸…é™¤æ•°æ®</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315204526301.png" alt="image-20210315204526301"></p><h2 id="æµ‹è¯•2ï¼šæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·è®¿é—®æœ‰å‚æ¥å£"><a href="#æµ‹è¯•2ï¼šæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·è®¿é—®æœ‰å‚æ¥å£" class="headerlink" title="æµ‹è¯•2ï¼šæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·è®¿é—®æœ‰å‚æ¥å£"></a>æµ‹è¯•2ï¼šæ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·è®¿é—®æœ‰å‚æ¥å£</h2><h3 id="æ·»åŠ Httpè¯·æ±‚"><a href="#æ·»åŠ Httpè¯·æ±‚" class="headerlink" title="æ·»åŠ Httpè¯·æ±‚"></a>æ·»åŠ Httpè¯·æ±‚</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316211645402.png" alt="image-20210316211645402"></p><p>æ­¤æ—¶å·²ç»å¯ä»¥å¯åŠ¨ï¼Œä½†æ˜¯åªèƒ½å½“åšå•ä¸ªç”¨æˆ·è®¿é—®ã€‚çœŸå®åœºæ™¯ä¸­è‚¯å®šä¸æ˜¯ä¸€ä¸ªç”¨æˆ·è®¿é—®å¤šæ¬¡ï¼Œè€Œæ˜¯å¤šä¸ªç”¨æˆ·è®¿é—®åŒä¸€ä¸ªæ¥å£ã€‚ä¸‹é¢çš„æ“ä½œå¯ä»¥æ¨¡æ‹Ÿå¤šä¸ªç”¨æˆ·è®¿é—®ã€‚</p><h3 id="æ·»åŠ æ§åˆ¶å…ƒä»¶-CSV-Date-Set-Config"><a href="#æ·»åŠ æ§åˆ¶å…ƒä»¶-CSV-Date-Set-Config" class="headerlink" title="æ·»åŠ æ§åˆ¶å…ƒä»¶:CSV Date Set Config"></a>æ·»åŠ æ§åˆ¶å…ƒä»¶:CSV Date Set Config</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316211907184.png" alt="image-20210316211907184"></p><p>åœ¨ç”µè„‘ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚config.txt</p><p>åœ¨txtæ–‡ä»¶ä¸­è¾“å…¥æ¨¡æ‹Ÿç”¨æˆ·ç™»é™†ä¿¡æ¯</p><p>æ ¼å¼å¦‚ä¸‹ï¼š</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316212252122.png" alt="image-20210316212252122"></p><p>æˆ‘ä»¬æŒ‰ç…§æ­¤æ ¼å¼å†™å…¥å¯¹åº”ä¿¡æ¯</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316213116595.png" alt="image-20210316213116595"></p><p>å°†æ–‡ä»¶å¯¼å…¥ï¼Œå¹¶è®¾ç½®ç›¸å…³ä¿¡æ¯å¦‚ä¸‹</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316212834952.png" alt="image-20210316212834952"></p><h3 id="ä¿®æ”¹Http-requestçš„tokenä¿¡æ¯-æ”¹æˆå¼•ç”¨çš„"><a href="#ä¿®æ”¹Http-requestçš„tokenä¿¡æ¯-æ”¹æˆå¼•ç”¨çš„" class="headerlink" title="ä¿®æ”¹Http requestçš„tokenä¿¡æ¯,æ”¹æˆå¼•ç”¨çš„"></a>ä¿®æ”¹Http requestçš„tokenä¿¡æ¯,æ”¹æˆå¼•ç”¨çš„</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316213315992.png" alt="image-20210316213315992"></p><h3 id="å¯åŠ¨æŸ¥çœ‹ç»“æœ"><a href="#å¯åŠ¨æŸ¥çœ‹ç»“æœ" class="headerlink" title="å¯åŠ¨æŸ¥çœ‹ç»“æœ"></a>å¯åŠ¨æŸ¥çœ‹ç»“æœ</h3><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210316213452790.png" alt="image-20210316213452790"></p><h1 id="Jmeteråœ¨Linuxdçš„å‘½ä»¤è¡Œä½¿ç”¨"><a href="#Jmeteråœ¨Linuxdçš„å‘½ä»¤è¡Œä½¿ç”¨" class="headerlink" title="Jmeteråœ¨Linuxdçš„å‘½ä»¤è¡Œä½¿ç”¨"></a>Jmeteråœ¨Linuxdçš„å‘½ä»¤è¡Œä½¿ç”¨</h1><p><strong>ä½¿ç”¨è¿‡ç¨‹ï¼š</strong></p><ol><li>åœ¨windowsä¸Šå½•å¥½jmsæ–‡ä»¶ï¼Œä¼ åˆ°linuxä¸­</li><li>å‘½ä»¤è¡Œ<code>sh jmeter.sh -n -t XXX.jmx -l result.jtl</code><ul><li>-n è¡¨ç¤ºä¸ä½¿ç”¨å›¾å½¢ç•Œé¢</li><li>-t è¡¨ç¤ºè„šæœ¬</li><li>-l è¡¨ç¤ºè¾“å‡ºç»“æœ</li></ul></li><li>æŠŠresult.jtlå¯¼å…¥Jmeter</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æå‰å°†apache-jmeter-5.4.1è§£å‹</span><br><span class="hljs-meta">#</span><span class="bash"> å°†jmsæ–‡ä»¶æ”¾åˆ°apache-jmeter-5.4.1åŒçº§ç›®å½•ä¸­</span><br>./apache-jmeter-5.4.1/bin/jmeter.sh -n -t goods_list.jmx  -l result.jtl<br></code></pre></td></tr></table></figure><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210317224740172.png" alt="image-20210317224740172"></p><p>å¯ä»¥ä¸‹è½½result.jtlç»“æœ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sz result.jtl<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ç»“æœï¼š</p><p>æ‰“å¼€Jmeterï¼Œæ‰¾åˆ°ä¹‹å‰åˆ›å»ºçš„èšåˆæŠ¥å‘Šï¼Œç‚¹å‡»æµè§ˆé€‰æ‹©result.jtlå³å¯æŸ¥çœ‹</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210318143958813.png" alt="image-20210318143958813"></p><p>å¦‚æœéœ€è¦å†æ¬¡æµ‹é‡ï¼Œéœ€è¦å°†Linuxä¸­çš„result.jtlç»“æœæ–‡ä»¶åˆ é™¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rm -rf result.jtl<br></code></pre></td></tr></table></figure><h1 id="è®¾ç½®Jmeterè¯­è¨€ä¸ºä¸­æ–‡ç¯å¢ƒ"><a href="#è®¾ç½®Jmeterè¯­è¨€ä¸ºä¸­æ–‡ç¯å¢ƒ" class="headerlink" title="è®¾ç½®Jmeterè¯­è¨€ä¸ºä¸­æ–‡ç¯å¢ƒ"></a>è®¾ç½®Jmeterè¯­è¨€ä¸ºä¸­æ–‡ç¯å¢ƒ</h1><h2 id="ä¸´æ—¶è®¾ç½®"><a href="#ä¸´æ—¶è®¾ç½®" class="headerlink" title="ä¸´æ—¶è®¾ç½®"></a>ä¸´æ—¶è®¾ç½®</h2><p>Jmeterèœå•æ é€‰æ‹©OptionsÃ Choose LanguageÃ Chinese (Simplified)</p><p>è¿™ç§æ–¹æ³•ï¼Œé‡å¯è½¯ä»¶ååˆå˜ä¸ºè‹±æ–‡ç¯å¢ƒäº†ã€‚</p><h2 id="æ°¸ä¹…è®¾ç½®"><a href="#æ°¸ä¹…è®¾ç½®" class="headerlink" title="æ°¸ä¹…è®¾ç½®"></a>æ°¸ä¹…è®¾ç½®</h2><p>è¿›å…¥binç›®å½•ï¼Œæ‰¾åˆ°â€œjmeter.propertiesâ€ï¼Œåœ¨æ–‡ä»¶çš„ç¬¬37è¡Œåæ·»åŠ â€œlanguage=zh_CNâ€ï¼Œä¿å­˜ä¹‹åå†æ‰“å¼€jmeterå°±æ°¸ä¹…å˜ä¸ºä¸­æ–‡ç¯å¢ƒäº†ã€‚</p><p><img src="/2021/03/15/Jmeter%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/image-20210315215137385.png" alt="image-20210315215137385"></p><h1 id="Jmeterä¸»è¦å…ƒä»¶"><a href="#Jmeterä¸»è¦å…ƒä»¶" class="headerlink" title="Jmeterä¸»è¦å…ƒä»¶"></a>Jmeterä¸»è¦å…ƒä»¶</h1><ul><li><p>æµ‹è¯•è®¡åˆ’ï¼šæ˜¯ä½¿ç”¨ JMeter è¿›è¡Œæµ‹è¯•çš„èµ·ç‚¹ï¼Œå®ƒæ˜¯å…¶å®ƒ JMeteræµ‹è¯•å…ƒä»¶çš„å®¹å™¨</p></li><li><p>çº¿ç¨‹ç»„ï¼šä»£è¡¨ä¸€å®šæ•°é‡çš„ç”¨æˆ·ï¼Œå®ƒå¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿç”¨æˆ·å¹¶å‘å‘é€è¯·æ±‚ã€‚å®é™…çš„è¯·æ±‚å†…å®¹åœ¨Samplerä¸­å®šä¹‰ï¼Œå®ƒè¢«çº¿ç¨‹ç»„åŒ…å«ã€‚</p></li><li><p>é…ç½®å…ƒä»¶ï¼šç»´æŠ¤Sampleréœ€è¦çš„é…ç½®ä¿¡æ¯ï¼Œå¹¶æ ¹æ®å®é™…çš„éœ€è¦ä¿®æ”¹è¯·æ±‚çš„å†…å®¹ã€‚</p></li><li><p>å‰ç½®å¤„ç†å™¨ï¼šè´Ÿè´£åœ¨è¯·æ±‚ä¹‹å‰å·¥ä½œï¼Œå¸¸ç”¨æ¥ä¿®æ”¹è¯·æ±‚çš„è®¾ç½®</p></li><li><p>å®šæ—¶å™¨ï¼šè´Ÿè´£å®šä¹‰è¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿé—´éš”ã€‚</p></li><li><p>å–æ ·å™¨(Sampler)ï¼šæ˜¯æ€§èƒ½æµ‹è¯•ä¸­å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè®°å½•å“åº”ä¿¡æ¯ã€å“åº”æ—¶é—´çš„æœ€å°å•å…ƒï¼Œå¦‚ï¼šHTTP Request Samplerã€FTP Request Sampleã€TCP Request Sampleã€JDBC Request Samplerç­‰ï¼Œæ¯ä¸€ç§ä¸åŒç±»å‹çš„sampler å¯ä»¥æ ¹æ®è®¾ç½®çš„å‚æ•°å‘æœåŠ¡å™¨å‘å‡ºä¸åŒç±»å‹çš„è¯·æ±‚ã€‚</p></li><li><p>åç½®å¤„ç†å™¨ï¼šè´Ÿè´£åœ¨è¯·æ±‚ä¹‹åå·¥ä½œï¼Œå¸¸ç”¨è·å–è¿”å›çš„å€¼ã€‚</p></li><li><p>æ–­è¨€ï¼šç”¨æ¥åˆ¤æ–­è¯·æ±‚å“åº”çš„ç»“æœæ˜¯å¦å¦‚ç”¨æˆ·æ‰€æœŸæœ›çš„ã€‚</p></li><li><p>ç›‘å¬å™¨ï¼šè´Ÿè´£æ”¶é›†æµ‹è¯•ç»“æœï¼ŒåŒæ—¶ç¡®å®šç»“æœæ˜¾ç¤ºçš„æ–¹å¼ã€‚</p></li><li><p>é€»è¾‘æ§åˆ¶å™¨ï¼šå¯ä»¥è‡ªå®šä¹‰JMeterå‘é€è¯·æ±‚çš„è¡Œä¸ºé€»è¾‘ï¼Œå®ƒä¸Samplerç»“åˆä½¿ç”¨å¯ä»¥æ¨¡æ‹Ÿå¤æ‚çš„è¯·æ±‚åºåˆ—ã€‚</p></li></ul><h2 id="å…ƒä»¶çš„ä½œç”¨åŸŸå’Œæ‰§è¡Œé¡ºåº"><a href="#å…ƒä»¶çš„ä½œç”¨åŸŸå’Œæ‰§è¡Œé¡ºåº" class="headerlink" title="å…ƒä»¶çš„ä½œç”¨åŸŸå’Œæ‰§è¡Œé¡ºåº"></a>å…ƒä»¶çš„ä½œç”¨åŸŸå’Œæ‰§è¡Œé¡ºåº</h2><h3 id="å…ƒä»¶ä½œç”¨åŸŸ"><a href="#å…ƒä»¶ä½œç”¨åŸŸ" class="headerlink" title="å…ƒä»¶ä½œç”¨åŸŸ"></a>å…ƒä»¶ä½œç”¨åŸŸ</h3><ul><li><p>é…ç½®å…ƒä»¶ï¼šå½±å“å…¶ä½œç”¨èŒƒå›´å†…çš„æ‰€æœ‰å…ƒä»¶ã€‚</p></li><li><p>å‰ç½®å¤„ç†å™¨ï¼šåœ¨å…¶ä½œç”¨èŒƒå›´å†…çš„æ¯ä¸€ä¸ªsamplerå…ƒä»¶ä¹‹å‰æ‰§è¡Œã€‚</p></li><li><p>å®šæ—¶å™¨ï¼šåœ¨å…¶ä½œç”¨èŒƒå›´å†…çš„æ¯ä¸€ä¸ªsampleræœ‰æ•ˆ</p></li><li><p>åç½®å¤„ç†å™¨ï¼šåœ¨å…¶ä½œç”¨èŒƒå›´å†…çš„æ¯ä¸€ä¸ªsamplerå…ƒä»¶ä¹‹åæ‰§è¡Œã€‚</p></li><li><p>æ–­è¨€ï¼šåœ¨å…¶ä½œç”¨èŒƒå›´å†…çš„å¯¹æ¯ä¸€ä¸ªsamplerå…ƒä»¶æ‰§è¡Œåçš„ç»“æœè¿›è¡Œæ ¡éªŒã€‚</p></li><li><p>ç›‘å¬å™¨ï¼šåœ¨å…¶ä½œç”¨èŒƒå›´å†…å¯¹æ¯ä¸€ä¸ªsamplerå…ƒä»¶çš„ä¿¡æ¯æ”¶é›†å¹¶å‘ˆç°ã€‚</p></li></ul><p>æ€»ç»“ï¼šä»å„ä¸ªå…ƒä»¶çš„å±‚æ¬¡ç»“æ„åˆ¤æ–­æ¯ä¸ªå…ƒä»¶çš„ä½œç”¨åŸŸã€‚</p><h3 id="å…ƒä»¶æ‰§è¡Œé¡ºåºï¼š"><a href="#å…ƒä»¶æ‰§è¡Œé¡ºåºï¼š" class="headerlink" title="å…ƒä»¶æ‰§è¡Œé¡ºåºï¼š"></a>å…ƒä»¶æ‰§è¡Œé¡ºåºï¼š</h3><p>é…ç½®å…ƒä»¶-&gt;å‰ç½®å¤„ç†å™¨-&gt;å®šæ—¶å™¨-&gt;å–æ ·å™¨-&gt;åç½®å¤„ç†ç¨‹åº-&gt;æ–­è¨€-&gt;ç›‘å¬å™¨</p><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>å‰ç½®å¤„ç†å™¨ã€åç½®å¤„ç†å™¨å’Œæ–­è¨€ç­‰ç»„ä»¶åªèƒ½å¯¹å–æ ·å™¨èµ·ä½œç”¨ï¼Œå› æ­¤ï¼Œå¦‚æœåœ¨å®ƒä»¬çš„ä½œç”¨åŸŸå†…æ²¡æœ‰ä»»ä½•å–æ ·å™¨ï¼Œåˆ™ä¸ä¼šè¢«æ‰§è¡Œã€‚</li><li>å¦‚æœåœ¨åŒä¸€ä½œç”¨åŸŸå†…æœ‰å¤šä¸ªåŒä¸€ç±»å‹çš„å…ƒä»¶ï¼Œåˆ™è¿™äº›å…ƒä»¶æŒ‰ç…§å®ƒä»¬åœ¨æµ‹è¯•è®¡åˆ’ä¸­çš„ä¸Šä¸‹é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚</li></ul><p>å‚è€ƒè¿æ¥ï¼š<a href="https://blog.csdn.net/pengjiangchun/article/details/105707405?utm_source=app&amp;app_version=4.5.4">https://blog.csdn.net/pengjiangchun/article/details/105707405?utm_source=app&amp;app_version=4.5.4</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootä¸­Jedisã€JedisPoolçš„ä½¿ç”¨</title>
    <link href="/2021/03/11/SpringBoot%E4%B8%ADJedis%E3%80%81JedisPool%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2021/03/11/SpringBoot%E4%B8%ADJedis%E3%80%81JedisPool%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="jedis-è¿æ¥redisï¼š"><a href="#jedis-è¿æ¥redisï¼š" class="headerlink" title="jedis è¿æ¥redisï¼š"></a>jedis è¿æ¥redisï¼š</h1><p>  ä½¿ç”¨jediså¦‚ä½•æ“ä½œredisï¼Œä½†æ˜¯å…¶å®æ–¹æ³•æ˜¯è·Ÿredisçš„æ“ä½œå¤§éƒ¨åˆ†æ˜¯ç›¸å¯¹åº”çš„ã€‚</p><p> æ‰€æœ‰çš„rediså‘½ä»¤éƒ½å¯¹åº”jedisçš„ä¸€ä¸ªæ–¹æ³• </p><p>  1ã€åœ¨macenå·¥ç¨‹ä¸­å¼•å…¥jedisçš„jaråŒ…   </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>   2ã€å»ºç«‹æµ‹è¯•å·¥ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JedisTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testJedis</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> Exception</span>&#123;<br>        Jedis jedis = <span class="hljs-keyword">new</span> Jedis(<span class="hljs-string">&quot;192.168.241.133&quot;</span>,<span class="hljs-number">6379</span>);<br>        jedis.set(<span class="hljs-string">&quot;test&quot;</span>, <span class="hljs-string">&quot;my forst jedis&quot;</span>);<br>        String str = jedis.get(<span class="hljs-string">&quot;test&quot;</span>);<br>        System.out.println(str);<br>        jedis.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€ç‚¹å‡»è¿è¡Œ</p><h1 id="ä½¿ç”¨jedisPoolè¿æ¥redis"><a href="#ä½¿ç”¨jedisPoolè¿æ¥redis" class="headerlink" title="ä½¿ç”¨jedisPoolè¿æ¥redis"></a>ä½¿ç”¨jedisPoolè¿æ¥redis</h1><p><strong>jediså¯ä»¥è¿æ¥redisï¼Œä¸ºä½•éœ€è¦Jedispoolï¼Ÿ</strong></p><p>æ¯æ¬¡è¿æ¥éœ€è¦åˆ›å»ºä¸€ä¸ªè¿æ¥ã€æ‰§è¡Œå®Œåå°±å…³é—­ï¼Œéå¸¸æµªè´¹èµ„æºï¼Œæ‰€ä»¥ä½¿ç”¨jedispoolï¼ˆè¿æ¥æ± ï¼‰è¿æ¥ã€‚åŸç†å’Œjdbcæ“ä½œæ•°æ®åº“ä¸€æ ·ã€‚</p><p>1ã€æ·»åŠ ä¾èµ–pom.xmlä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- æ“ä½œredis --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.75<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€redisé…ç½®æ–‡ä»¶</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#redis</span><br><span class="hljs-meta">redis.host</span>=<span class="hljs-string">121.4.60.79</span><br><span class="hljs-meta">redis.port</span>=<span class="hljs-string">6379</span><br><span class="hljs-meta">redis.timeout</span>=<span class="hljs-string">3</span><br><span class="hljs-meta">redis.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-meta">redis.poolMaxTotal</span>=<span class="hljs-string">10</span><br><span class="hljs-meta">redis.poolMaxIdle</span>=<span class="hljs-string">10</span><br><span class="hljs-meta">redis.poolMaxWait</span>=<span class="hljs-string">3</span><br></code></pre></td></tr></table></figure><p>æ³¨ï¼šideaä¼šæç¤ºCannot resolve configuration propertyã€‚ä¸å½±å“è¿è¡Œã€‚</p><p>3ã€ç»‘å®šé…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.redis;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ConfigurationProperties(prefix=&quot;redis&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisConfig</span> </span>&#123;<br><span class="hljs-keyword">private</span> String host;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> port;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> timeout;<span class="hljs-comment">//ç§’</span><br><span class="hljs-keyword">private</span> String password;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> poolMaxTotal;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> poolMaxIdle;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> poolMaxWait;<span class="hljs-comment">//ç§’</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getHost</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> host;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHost</span><span class="hljs-params">(String host)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.host = host;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPort</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> port;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> port)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.port = port;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getTimeout</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> timeout;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setTimeout</span><span class="hljs-params">(<span class="hljs-keyword">int</span> timeout)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.timeout = timeout;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPassword</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> password;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPassword</span><span class="hljs-params">(String password)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.password = password;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPoolMaxTotal</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> poolMaxTotal;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPoolMaxTotal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> poolMaxTotal)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.poolMaxTotal = poolMaxTotal;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPoolMaxIdle</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> poolMaxIdle;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPoolMaxIdle</span><span class="hljs-params">(<span class="hljs-keyword">int</span> poolMaxIdle)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.poolMaxIdle = poolMaxIdle;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPoolMaxWait</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> poolMaxWait;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPoolMaxWait</span><span class="hljs-params">(<span class="hljs-keyword">int</span> poolMaxWait)</span> </span>&#123;<br><span class="hljs-keyword">this</span>.poolMaxWait = poolMaxWait;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>4ã€JedisPoolçš„ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.redis;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> redis.clients.jedis.JedisPool;<br><span class="hljs-keyword">import</span> redis.clients.jedis.JedisPoolConfig;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisPoolFactory</span> </span>&#123;<br><br><span class="hljs-meta">@Autowired</span><br>RedisConfig redisConfig;<br><br><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> JedisPool <span class="hljs-title">JedisPoolFactory</span><span class="hljs-params">()</span> </span>&#123;<br>JedisPoolConfig poolConfig = <span class="hljs-keyword">new</span> JedisPoolConfig();<br>poolConfig.setMaxIdle(redisConfig.getPoolMaxIdle());<br>poolConfig.setMaxTotal(redisConfig.getPoolMaxTotal());<br>poolConfig.setMaxWaitMillis(redisConfig.getPoolMaxWait() * <span class="hljs-number">1000</span>);<br>JedisPool jp = <span class="hljs-keyword">new</span> JedisPool(poolConfig, redisConfig.getHost(), redisConfig.getPort(),<br>redisConfig.getTimeout()*<span class="hljs-number">1000</span>, redisConfig.getPassword(), <span class="hljs-number">0</span>);<br><span class="hljs-keyword">return</span> jp;<br>&#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ä½¿ç”¨</p><p>æ³¨äºº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>JedisPool jedisPool;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>JSR303å‚æ•°æ ¡éªŒ</title>
    <link href="/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/"/>
    <url>/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<p><strong>Spring Validator</strong>å’Œ<strong>Hibernate Validator</strong>æ˜¯ä¸¤å¥—Validatorï¼Œå¯ä»¥æ··ç€ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨<strong>Hibernate Validatorã€‚</strong></p><h3 id="Hibernate-Validator"><a href="#Hibernate-Validator" class="headerlink" title="Hibernate Validator"></a>Hibernate Validator</h3><p><a href="https://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#preface">https://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#preface</a></p><h3 id="Spring-Validator"><a href="#Spring-Validator" class="headerlink" title="Spring Validator"></a>Spring Validator</h3><p><a href="https://docs.spring.io/spring/docs/5.0.5.RELEASE/spring-framework-reference/core.html#validation">https://docs.spring.io/spring/docs/5.0.5.RELEASE/spring-framework-reference/core.html#validation</a></p><p>SpringBootå·²ç»é›†æˆäº†å‚æ•°æ ¡éªŒï¼Œä½†æ˜¯æ­¤æ¬¡ä½¿ç”¨æ—¶æœ‰äº›ç”¨æ³•ç”¨ä¸ä¸Šï¼Œæ¯”å¦‚lengthç­‰ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ã€‚å®˜ç½‘å¯¹Validatorçš„æè¿°ä¹Ÿåªæœ‰å‡ æ®µã€‚</p><p>å°è¯•å¯¼å…¥pom</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ideaä¸€ç›´å¯¼å…¥å¤±è´¥</p><p>æœ€åå°è¯•</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate.validator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-validator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.0.1.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸ</p><h3 id="ä½¿ç”¨ï¼š"><a href="#ä½¿ç”¨ï¼š" class="headerlink" title="ä½¿ç”¨ï¼š"></a>ä½¿ç”¨ï¼š</h3><h4 id="ç›´æ¥ä½¿ç”¨å†…ç½®çš„æ³¨è§£ï¼š"><a href="#ç›´æ¥ä½¿ç”¨å†…ç½®çš„æ³¨è§£ï¼š" class="headerlink" title="ç›´æ¥ä½¿ç”¨å†…ç½®çš„æ³¨è§£ï¼š"></a>ç›´æ¥ä½¿ç”¨å†…ç½®çš„æ³¨è§£ï¼š</h4><p>1ã€åœ¨éœ€è¦åº”ç”¨çš„å®ä½“ç±»å‰@Valid</p><p><img src="/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/image-20210309170306862.png" alt="image-20210309170306862"></p><p>2ã€å»å®ä½“ç±»ä¸­åœ¨éœ€è¦éªŒè¯çš„å‚æ•°åŠ å…·ä½“éªŒè¯å†…å®¹</p><p><img src="/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/image-20210309170812181.png" alt="image-20210309170812181"></p><h4 id="è‡ªå®šä¹‰æ ¡éªŒç±»ï¼š"><a href="#è‡ªå®šä¹‰æ ¡éªŒç±»ï¼š" class="headerlink" title="è‡ªå®šä¹‰æ ¡éªŒç±»ï¼š"></a>è‡ªå®šä¹‰æ ¡éªŒç±»ï¼š</h4><p>ç”¨äºæ£€æµ‹æ‰‹æœºå·</p><p>å‚è€ƒNotNullæˆ–Lengthçš„æºç </p><p><img src="/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/image-20210309190620872.png" alt="image-20210309190620872"></p><p>è‡ªå·±åˆ›å»ºä¸€ä¸ªæ£€æµ‹æ‰‹æœºå·ç æ˜¯å¦æ­£ç¡®çš„æ¥å£å’Œä¸€ä¸ªç±»</p><p><img src="/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/image-20210309190707603.png" alt="image-20210309190707603"></p><p><strong>IsMobile.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.validator;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.ElementType.ANNOTATION_TYPE;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.ElementType.CONSTRUCTOR;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.ElementType.FIELD;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.ElementType.METHOD;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.ElementType.PARAMETER;<br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.lang.annotation.RetentionPolicy.RUNTIME;<br><br><span class="hljs-keyword">import</span> java.lang.annotation.Documented;<br><span class="hljs-keyword">import</span> java.lang.annotation.Retention;<br><span class="hljs-keyword">import</span> java.lang.annotation.Target;<br><br><span class="hljs-keyword">import</span> javax.validation.Constraint;<br><span class="hljs-keyword">import</span> javax.validation.Payload;<br><br><span class="hljs-meta">@Target(&#123; METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER &#125;)</span><br><span class="hljs-meta">@Retention(RUNTIME)</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Constraint(validatedBy = &#123;IsMobileValidator.class &#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span>  IsMobile &#123;<br>    <span class="hljs-comment">//è®¾ç½®é»˜è®¤ä¸ä¸ºç©º</span><br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">required</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">true</span></span>;<br>    <span class="hljs-comment">//å¦‚æœæ ¡éªŒä¸é€šè¿‡ è¿”å›çš„ä¿¡æ¯</span><br>    <span class="hljs-function">String <span class="hljs-title">message</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> &quot;æ‰‹æœºå·ç æ ¼å¼é”™è¯¯&quot;</span>;<br><br>    Class&lt;?&gt;[] groups() <span class="hljs-keyword">default</span> &#123; &#125;;<br><br>    Class&lt;? extends Payload&gt;[] payload() <span class="hljs-keyword">default</span> &#123; &#125;;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p><strong>IsMobileValidator.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.validator;<br><br><span class="hljs-keyword">import</span> javax.validation.ConstraintValidator;<br><span class="hljs-keyword">import</span> javax.validation.ConstraintValidatorContext;<br><br><span class="hljs-keyword">import</span> com.mc.util.ValidatorUtil;<br><span class="hljs-keyword">import</span> org.apache.commons.lang3.StringUtils;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IsMobileValidator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ConstraintValidator</span>&lt;<span class="hljs-title">IsMobile</span>, <span class="hljs-title">String</span>&gt; </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> required = <span class="hljs-keyword">false</span>;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">(IsMobile constraintAnnotation)</span> </span>&#123;<br>        required = constraintAnnotation.required();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">(String s, ConstraintValidatorContext constraintValidatorContext)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(required)&#123;<br>            <span class="hljs-keyword">return</span> ValidatorUtil.isMobile(s);<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">if</span>(StringUtils.isEmpty(s))&#123;<br>                <span class="hljs-keyword">return</span>  <span class="hljs-keyword">true</span>;<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> ValidatorUtil.isMobile(s);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨</p><p><img src="/2021/03/09/JSR303%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/image-20210309190526973.png" alt="image-20210309190526973"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è‹±è¯­è‹±æ ‡è®°å½•</title>
    <link href="/2021/03/08/%E8%8B%B1%E8%AF%AD%E8%8B%B1%E6%A0%87%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/03/08/%E8%8B%B1%E8%AF%AD%E8%8B%B1%E6%A0%87%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>ç¬”è®°å‚è€ƒè§†é¢‘æ¥è‡ªupä¸»è‹±è¯­å…”ï¼š<a href="https://b23.tv/umX44N?share_medium=android&amp;share_source=qq&amp;bbid=1BE05DDD-5C38-4655-9B2A-7A985FF1F46244882infoc&amp;ts=1615207087470">https://b23.tv/umX44N?share_medium=android&amp;share_source=qq&amp;bbid=1BE05DDD-5C38-4655-9B2A-7A985FF1F46244882infoc&amp;ts=1615207087470</a></p><h1 id="éŸ³æ ‡ä½“ç³»"><a href="#éŸ³æ ‡ä½“ç³»" class="headerlink" title="éŸ³æ ‡ä½“ç³»"></a>éŸ³æ ‡ä½“ç³»</h1><p>éŸ³æ ‡ä½“ç³»æœ‰å¾ˆå¤šç§ï¼šDJéŸ³æ ‡ã€KKéŸ³æ ‡ã€éŸ¦æ°éŸ³æ ‡ã€AHDéŸ³æ ‡ç­‰ç­‰</p><p><img src="/2021/03/08/%E8%8B%B1%E8%AF%AD%E8%8B%B1%E6%A0%87%E8%AE%B0%E5%BD%95/QQ%E5%9B%BE%E7%89%8720210308213611.jpg"></p><h2 id="DJéŸ³æ ‡"><a href="#DJéŸ³æ ‡" class="headerlink" title="DJéŸ³æ ‡"></a>DJéŸ³æ ‡</h2><ul><li><p>æ¥è‡ªä¸¹å°¼å°”â€¢ç¼æ–¯æ•™æˆå‡ºç‰ˆçš„å·¥å…·ä¹¦ã€ŠEnglish Pronouncing Dictinaryã€‹1963ï¼Œæ­¤å¤„ä»å›½é™…éŸ³æ ‡ï¼ˆIPAï¼ŒInternational Phonetic Alphabetï¼‰ä¸­å€Ÿäº†å¾ˆå¤šæ³¨éŸ³ç¬¦å·ï¼Œç»™è‹±è¯­æ³¨éŸ³ã€‚</p></li><li><p>å¾ˆå¤šä¸­å›½äººä»å°å­¦çš„éŸ³æ ‡æ˜¯DJéŸ³æ ‡</p></li><li><p>ç°åœ¨æ–°ç‰ˆDJéŸ³æ ‡åœ¨1988è¢«æ­¤æ•™æˆçš„å­¦ç”Ÿä¿®è®¢</p></li></ul><h2 id="KKéŸ³æ ‡"><a href="#KKéŸ³æ ‡" class="headerlink" title="KKéŸ³æ ‡"></a>KKéŸ³æ ‡</h2><ul><li><p>æ¥è‡ªJohn Kenyonå’ŒThomas Knottç¼–æ’°çš„ç¾å›½å‘éŸ³è¯å…¸ã€ŠPronouncing Dictionary of American Englishã€‹ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éŸ³æ ‡ä¹Ÿæ¥è‡ªäºå›½é™…éŸ³æ ‡</p></li><li><p>åœ¨å°æ¹¾åœ°åŒºè¢«å¹¿æ³›ä½¿ç”¨ï¼Œèµ–ä¸–é›„è€å¸ˆä½¿ç”¨å°±æ˜¯KKéŸ³æ ‡</p></li><li><p>å‡ºç°åœ¨å¤§éƒ¨åˆ†ç¾è¯­æ•™æä¸­</p></li></ul><h2 id="éŸ¦æ°éŸ³æ ‡"><a href="#éŸ¦æ°éŸ³æ ‡" class="headerlink" title="éŸ¦æ°éŸ³æ ‡"></a>éŸ¦æ°éŸ³æ ‡</h2><p>æ¥è‡ªéŸ¦æ°è¯å…¸ã€ŠWebster`s Dictionaryã€‹</p><p>éŸ¦æ°è¯å…¸è¢«å¤§éƒ¨åˆ†ç¾å›½äººä»å°ä½¿ç”¨</p><h2 id="AHDéŸ³æ ‡"><a href="#AHDéŸ³æ ‡" class="headerlink" title="AHDéŸ³æ ‡"></a>AHDéŸ³æ ‡</h2><p>æ¥è‡ªç¾å›½ä¼ ç»Ÿè‹±è¯­è¯å…¸ã€ŠAmerican Heritage Dictionaryã€‹</p><h1 id="é€‰æ‹©DJå­¦ä¹ "><a href="#é€‰æ‹©DJå­¦ä¹ " class="headerlink" title="é€‰æ‹©DJå­¦ä¹ "></a>é€‰æ‹©DJå­¦ä¹ </h1><p>è¿™ä¹ˆå¤šéŸ³æ ‡ä½“ç³»é€‰å…¶ä¸­ä¸€ç§å­¦ä¹ å³å¯ï¼Œæˆ‘ä»¬é€‰æ‹©DJéŸ³æ ‡ï¼ŒåŸå› å¦‚ä¸‹</p><ul><li>è¢«å›½å†…å¤§éƒ¨åˆ†å­—å…¸ä½¿ç”¨å¦‚ç‰›æ´¥å­—å…¸ã€å‰‘æ¡¥å­—å…¸ã€æœ—æ–‡å­—å…¸</li><li>DJéŸ³æ ‡è™½ç„¶æœ€åˆè¢«ç”¨æ¥æ ‡æ³¨è‹±å¼è‹±è¯­ï¼Œä½†æ˜¯ç”¨æ¥æ ‡æ³¨ç¾å¼è‹±è¯­ä¹Ÿå¯ä»¥</li></ul><p><img src="/2021/03/08/%E8%8B%B1%E8%AF%AD%E8%8B%B1%E6%A0%87%E8%AE%B0%E5%BD%95/image-20210308213224570.png" alt="image-20210308213224570"></p>]]></content>
    
    
    <categories>
      
      <category>è‹±è¯­</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootæ•´åˆDruidæ•°æ®æº</title>
    <link href="/2021/03/04/SpringBoot%E6%95%B4%E5%90%88Druid%E6%95%B0%E6%8D%AE%E6%BA%90/"/>
    <url>/2021/03/04/SpringBoot%E6%95%B4%E5%90%88Druid%E6%95%B0%E6%8D%AE%E6%BA%90/</url>
    
    <content type="html"><![CDATA[<p>Druidæ˜¯ä¸€ä¸ªä¸“ä¸ºå¤§å‹æ•°æ®é›†ä¸Šçš„é«˜æ€§èƒ½åˆ‡ç‰‡å’ŒOLAPåˆ†æè€Œè®¾è®¡çš„æ•°æ®å­˜å‚¨ã€‚Druidæœ€å¸¸ç”¨ä½œä¸ºGUIåˆ†æåº”ç”¨ç¨‹åºæä¾›åŠ¨åŠ›çš„æ•°æ®å­˜å‚¨ï¼Œæˆ–è€…ç”¨ä½œéœ€è¦å¿«é€Ÿèšåˆçš„é«˜åº¦å¹¶å‘APIçš„åç«¯ã€‚</p><h1 id="Druidæ¶æ„"><a href="#Druidæ¶æ„" class="headerlink" title="Druidæ¶æ„"></a>Druidæ¶æ„</h1><p>Druidæ‹¥æœ‰ä¸€ä¸ªå¤šè¿›ç¨‹ï¼Œåˆ†å¸ƒå¼æ¶æ„ï¼Œæ—¨åœ¨å®ç°äº‘å‹å¥½ä¸”æ˜“äºæ“ä½œã€‚æ¯ä¸ªDruidæµç¨‹ç±»å‹éƒ½å¯ä»¥ç‹¬ç«‹é…ç½®å’Œæ‰©å±•ï¼Œä¸ºæ‚¨çš„ç¾¤é›†æä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚æ­¤è®¾è®¡è¿˜æä¾›å¢å¼ºçš„å®¹é”™èƒ½åŠ›ï¼šä¸€ä¸ªç»„ä»¶çš„ä¸­æ–­ä¸ä¼šç«‹å³å½±å“å…¶ä»–ç»„ä»¶ã€‚</p><p><img src="/2021/03/04/SpringBoot%E6%95%B4%E5%90%88Druid%E6%95%B0%E6%8D%AE%E6%BA%90/6178553-7607569293db644d.png" alt="Druidæ¶æ„"></p><h1 id="SpringBootæ•´åˆDruid"><a href="#SpringBootæ•´åˆDruid" class="headerlink" title="SpringBootæ•´åˆDruid"></a>SpringBootæ•´åˆDruid</h1><h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure><h2 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h2><p>è¿™é‡Œå°†æ‰€æœ‰çš„é…ç½®éƒ½å†™åœ¨æ­¤</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-comment"># ç«¯å£å·</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8002</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://IPåœ°å€:3306/æ•°æ®åº“åç§°?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">ç”¨æˆ·å</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">å¯†ç </span><br>    <span class="hljs-comment">#è¿æ¥æ± çš„è®¾ç½®</span><br>    <span class="hljs-attr">druid:</span><br>      <span class="hljs-comment">#åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°</span><br>      <span class="hljs-attr">initial-size:</span> <span class="hljs-number">5</span><br>      <span class="hljs-comment">#æœ€å°è¿æ¥æ± æ•°é‡</span><br>      <span class="hljs-attr">min-idle:</span> <span class="hljs-number">5</span><br>      <span class="hljs-comment">#æœ€å¤§è¿æ¥æ± æ•°é‡</span><br>      <span class="hljs-attr">max-active:</span> <span class="hljs-number">20</span><br>      <span class="hljs-comment">#è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’</span><br>      <span class="hljs-attr">max-wait:</span> <span class="hljs-number">60000</span><br>      <span class="hljs-comment">#ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</span><br>      <span class="hljs-attr">test-while-idle:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-comment">#æ—¢ä½œä¸ºæ£€æµ‹çš„é—´éš”æ—¶é—´åˆä½œä¸ºtestWhileIdelæ‰§è¡Œçš„ä¾æ®</span><br>      <span class="hljs-attr">time-between-eviction-runs-millis:</span> <span class="hljs-number">60000</span><br>      <span class="hljs-comment">#é”€æ¯çº¿ç¨‹æ—¶æ£€æµ‹å½“å‰è¿æ¥çš„æœ€åæ´»åŠ¨æ—¶é—´å’Œå½“å‰æ—¶é—´å·®å¤§äºè¯¥å€¼æ—¶ï¼Œå…³é—­å½“å‰è¿æ¥</span><br>      <span class="hljs-attr">min-evictable-idle-time-millis:</span> <span class="hljs-number">30000</span><br>      <span class="hljs-comment">#ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sql å¿…é¡»æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥</span><br>      <span class="hljs-comment">#mysqlä¸­ä¸º select &#x27;x&#x27;</span><br>      <span class="hljs-comment">#oracleä¸­ä¸º select 1 from dual</span><br>      <span class="hljs-attr">validation-query:</span> <span class="hljs-string">select</span> <span class="hljs-string">&#x27;x&#x27;</span><br>      <span class="hljs-comment">#ç”³è¯·è¿æ¥æ—¶ä¼šæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆ,å¼€å¯ä¼šé™ä½æ€§èƒ½,é»˜è®¤ä¸ºtrue</span><br>      <span class="hljs-attr">test-on-borrow:</span> <span class="hljs-literal">false</span><br>      <span class="hljs-comment">#å½’è¿˜è¿æ¥æ—¶ä¼šæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆ,å¼€å¯ä¼šé™ä½æ€§èƒ½,é»˜è®¤ä¸ºtrue</span><br>      <span class="hljs-attr">test-on-return:</span> <span class="hljs-literal">false</span><br>      <span class="hljs-comment">#æ˜¯å¦ç¼“å­˜preparedStatement,mysql5.5+å»ºè®®å¼€å¯</span><br>      <span class="hljs-attr">pool-prepared-statements:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-comment">#å½“å€¼å¤§äº0æ—¶poolPreparedStatementsä¼šè‡ªåŠ¨ä¿®æ”¹ä¸ºtrue</span><br>      <span class="hljs-attr">max-pool-prepared-statement-per-connection-size:</span> <span class="hljs-number">20</span><br>      <span class="hljs-comment">#é…ç½®æ‰©å±•æ’ä»¶</span><br>      <span class="hljs-attr">filters:</span> <span class="hljs-string">stat,wall,log4j</span><br>      <span class="hljs-comment">#é€šè¿‡connectPropertieså±æ€§æ¥æ‰“å¼€mergeSqlåŠŸèƒ½ï¼›æ…¢SQLè®°å½•</span><br>      <span class="hljs-attr">connection-properties:</span> <span class="hljs-string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</span><br>      <span class="hljs-comment">#åˆå¹¶å¤šä¸ªDruidDataSourceçš„ç›‘æ§æ•°æ®</span><br>      <span class="hljs-attr">use-global-data-source-stat:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-comment"># é…ç½® DruidStatFilter</span><br>      <span class="hljs-attr">web-stat-filter:</span><br>        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-attr">url-pattern:</span> <span class="hljs-string">/*</span><br>        <span class="hljs-attr">exclusions:</span> <span class="hljs-string">.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*</span><br>      <span class="hljs-comment"># é…ç½® DruidStatViewServlet</span><br>      <span class="hljs-attr">stat-view-servlet:</span><br>        <span class="hljs-attr">url-pattern:</span> <span class="hljs-string">/druid/*</span><br>        <span class="hljs-comment"># IP ç™½åå•ï¼Œæ²¡æœ‰é…ç½®æˆ–è€…ä¸ºç©ºï¼Œåˆ™å…è®¸æ‰€æœ‰è®¿é—®</span><br>        <span class="hljs-attr">allow:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br>        <span class="hljs-comment"># IP é»‘åå•ï¼Œè‹¥ç™½åå•ä¹Ÿå­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨</span><br>        <span class="hljs-attr">deny:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.31</span><span class="hljs-number">.253</span><br>        <span class="hljs-comment"># ç¦ç”¨ HTML ä¸­ Reset All æŒ‰é’®</span><br>        <span class="hljs-attr">reset-enable:</span> <span class="hljs-literal">false</span><br>        <span class="hljs-comment"># ç™»å½•ç”¨æˆ·å/å¯†ç </span><br>        <span class="hljs-attr">login-username:</span> <span class="hljs-string">root</span><br>        <span class="hljs-attr">login-password:</span> <span class="hljs-number">123</span><br>        <span class="hljs-comment"># å¯åŠ¨æ§åˆ¶å°ï¼Œé»˜è®¤åœ°å€å°±æ˜¯ip:ç«¯å£å·/druid/index.html</span><br>        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-attr">jpa:</span><br>    <span class="hljs-attr">properties:</span><br>      <span class="hljs-attr">hibernate:</span><br>        <span class="hljs-attr">hbm2ddl:</span><br>          <span class="hljs-attr">auto:</span> <span class="hljs-string">update</span><br>        <span class="hljs-attr">dialect:</span> <span class="hljs-string">org.hibernate.dialect.MySQL5Dialect</span><br>        <span class="hljs-attr">format_sql:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">show-sql:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æœªå½’æ¡£</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰è£…Jdkã€MySqlã€Tomcatè®°å½•ï¼ˆLinux:CentOS)</title>
    <link href="/2021/03/02/%E5%AE%89%E8%A3%85Jdk%E3%80%81MySql%E3%80%81Tomcat%E8%AE%B0%E5%BD%95%EF%BC%88Linux/"/>
    <url>/2021/03/02/%E5%AE%89%E8%A3%85Jdk%E3%80%81MySql%E3%80%81Tomcat%E8%AE%B0%E5%BD%95%EF%BC%88Linux/</url>
    
    <content type="html"><![CDATA[<ul><li><p>å…ˆåœ¨æœåŠ¡å™¨ç”¨æˆ·ç›®å½•ï¼ˆ/home/lwj/ï¼‰ä¸‹åˆ›å»ºä¸¤ä¸ªç›®å½•ï¼Œä½œä¸ºåæœŸç¯å¢ƒçš„ä½¿ç”¨ï¼šmkdir tools å’Œ mkdir environmentï¼Œä¸€ä¸ªæ˜¯ä½œä¸ºä¸Šä¼ å·¥å…·çš„ç›®å½•ï¼Œä¸€ä¸ªæ˜¯ä½œä¸ºå®‰è£…çš„ç›®å½•</p></li><li><p>è¦è¿›è¡Œåé¢çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹å‡ ä¸ªé…ç½®ï¼Œå…³é—­é˜²ç«å¢™ï¼Œå¹¶ç¦æ­¢å¼€æœºå¯åŠ¨ã€‚</p><p>â€‹    æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š <code>systemctl status firewalld</code></p><p>â€‹    æ‰§è¡Œå…³é—­å‘½ä»¤ï¼š <code>systemctl stop firewalld</code></p><p>â€‹    æ‰§è¡Œå¼€æœºç¦ç”¨é˜²ç«å¢™è‡ªå¯å‘½ä»¤ï¼š<code>systemctl disable firewalld</code></p></li></ul><p>è¿˜æœ‰è¿›è¡Œä¸»æœºåçš„ä¿®æ”¹ï¼š<code>vi /etc/hosts</code>æˆ–<code>vi /etc/hostname</code></p><h1 id="Jdkå®‰è£…åŠç¯å¢ƒé…ç½®"><a href="#Jdkå®‰è£…åŠç¯å¢ƒé…ç½®" class="headerlink" title="Jdkå®‰è£…åŠç¯å¢ƒé…ç½®"></a>Jdkå®‰è£…åŠç¯å¢ƒé…ç½®</h1><p>å°†JDKè¿›è¡Œä¸Šä¼ åˆ°toolsç›®å½•ä¸‹ï¼Œç„¶åè¿›è¡Œè§£å‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf tools/jdk-8u171-linux-x64.tar.gz -C environment/<br></code></pre></td></tr></table></figure><p>é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi ~/.bash_profile<br></code></pre></td></tr></table></figure><p> æ·»åŠ å¦‚ä¸‹ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">export JAVA_HOME=/home/lwj/environment/jdk1.8.0_171<br>export JRE_HOME=$JAVA_HOME/jre<br>export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/lib<br>export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin<br></code></pre></td></tr></table></figure><p>è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/.bash_profile<br></code></pre></td></tr></table></figure><p>éªŒè¯jdkæ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">java -version<br></code></pre></td></tr></table></figure><p><img src="/2021/03/02/%E5%AE%89%E8%A3%85Jdk%E3%80%81MySql%E3%80%81Tomcat%E8%AE%B0%E5%BD%95%EF%BC%88Linux/image-20210302224450705.png"></p><h1 id="MySQL-5-7ä½¿ç”¨yumæ–¹å¼å®‰è£…"><a href="#MySQL-5-7ä½¿ç”¨yumæ–¹å¼å®‰è£…" class="headerlink" title="MySQL-5.7ä½¿ç”¨yumæ–¹å¼å®‰è£…"></a>MySQL-5.7ä½¿ç”¨yumæ–¹å¼å®‰è£…</h1><p>1ã€å®‰è£…MySQL YUMæºåˆ°æœ¬åœ°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum localinstall https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm<br></code></pre></td></tr></table></figure><p>2ã€æ£€æŸ¥ mysql æºæ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum repolist enabled | grep &quot;mysql.*-community.*&quot;<br>Copy<br>å®‰è£…æˆåŠŸåä¼šçœ‹åˆ°å¦‚ä¸‹ï¼š<br>!mysql-connectors-community/x86_64       MySQL Connectors Community          153<br>!mysql-tools-community/x86_64            MySQL Tools Community               110<br>!mysql57-community/x86_64                MySQL 5.7 Community Server          424Copy<br></code></pre></td></tr></table></figure><p>3ã€ä½¿ç”¨ yum install å‘½ä»¤å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum -y install mysql-community-server<br></code></pre></td></tr></table></figure><p>4ã€å®‰è£…å®Œæ¯•åï¼Œå¯åŠ¨MySQLæ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start mysqld<br></code></pre></td></tr></table></figure><p>5ã€æŸ¥çœ‹MySQLçš„å¯åŠ¨çŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl status mysqld<br></code></pre></td></tr></table></figure><p>6ã€è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl enable mysqld<br></code></pre></td></tr></table></figure><p>7ã€é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl daemon-reload<br></code></pre></td></tr></table></figure><p>8ã€ä¿®æ”¹rootè´¦æˆ·é»˜è®¤å¯†ç <br>mysql å®‰è£…å®Œæˆä¹‹åï¼Œç”Ÿæˆçš„é»˜è®¤å¯†ç åœ¨ /var/log/mysqld.log æ–‡ä»¶ä¸­ã€‚ä½¿ç”¨ grep å‘½ä»¤æ‰¾åˆ°æ—¥å¿—ä¸­çš„å¯†ç ã€‚<br>æ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">grep &#x27;temporary password&#x27; /var/log/mysqld.log<br><br>å‡ºç°æ¯”å¦‚ï¼š<br>A temporary password is generated for root@localhost: WMYu.<span class="hljs-comment">#o8o#30Copy</span><br></code></pre></td></tr></table></figure><p>9ã€ä¿®æ”¹å¯†ç <br>ä½¿ç”¨mysql -uroot -p å›è½¦ï¼Œè¾“å…¥ä¸Šè¿°æŸ¥è¯¢å‡ºçš„å¯†ç ï¼Œ å°†å¯†ç æ”¹ä¸ºï¼šLwj#123123 è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> <span class="hljs-keyword">IDENTIFIED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;Lwj#123123&#x27;</span>; <br></code></pre></td></tr></table></figure><p>10ã€é…ç½®rootç”¨æˆ·è¿œç¨‹ç™»å½•åŠæ·»åŠ è¿œç¨‹ç™»å½•ç”¨æˆ·<br>é»˜è®¤åªå…è®¸rootå¸æˆ·åœ¨æœ¬åœ°ç™»å½•ï¼Œå¦‚æœè¦åœ¨å…¶å®ƒæœºå™¨ä¸Šè¿æ¥mysqlï¼Œä¸¤ç§æ–¹å¼ï¼š<br>    1ï¼‰è®¾ç½®rootç”¨æˆ·å…è®¸è¿œç¨‹ç™»å½•ï¼š<br>æ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">PRIVILEGES</span> <span class="hljs-keyword">ON</span> *.* <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">IDENTIFIED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;Lwj#123123&#x27;</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">OPTION</span>;   <br><span class="hljs-keyword">flush</span> <span class="hljs-keyword">privileges</span>;sql<br></code></pre></td></tr></table></figure><p>â€‹    2ï¼‰å¯ä»¥æ·»åŠ ä¸€ä¸ªå…è®¸è¿œç¨‹è¿æ¥çš„æ™®é€šå¸æˆ· </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">PRIVILEGES</span> <span class="hljs-keyword">ON</span> *.* <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;suben&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> <span class="hljs-keyword">IDENTIFIED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;Lwj#123123&#x27;</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">OPTION</span>;   <br><span class="hljs-keyword">flush</span> <span class="hljs-keyword">privileges</span>;<br></code></pre></td></tr></table></figure><p>12ã€è®¾ç½®é»˜è®¤ç¼–ç ä¸º utf8</p><p>mysql å®‰è£…åé»˜è®¤ä¸æ”¯æŒä¸­æ–‡ï¼Œéœ€è¦ä¿®æ”¹ç¼–ç ã€‚<br>ä¿®æ”¹ /etc/my.cnf é…ç½®æ–‡ä»¶ï¼Œåœ¨ç›¸å…³èŠ‚ç‚¹ï¼ˆæ²¡æœ‰åˆ™è‡ªè¡Œæ·»åŠ ï¼‰ä¸‹æ·»åŠ ç¼–ç é…ç½®ï¼Œå¦‚ä¸‹ï¼š<br>æ‰§è¡Œï¼š</p><p><code>vi /etc/my.cnf</code><br>åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[mysqld]</span><br><span class="hljs-attr">character-set-server</span>=utf8<br><span class="hljs-section">[client]</span><br><span class="hljs-attr">default-character-set</span>=utf8<br><span class="hljs-section">[mysql]</span><br><span class="hljs-attr">default-character-set</span>=utf8<br></code></pre></td></tr></table></figure><p><strong>CentOS7ä¸‹MySQL-5.7ä½¿ç”¨yumæ–¹å¼å¸è½½ï¼š</strong></p><p>1ã€åœæ­¢MySQL<br>å‘½ä»¤ï¼šsystemctl stop mysqld<br>2ã€æŸ¥çœ‹å·²å®‰è£…çš„mysql<br>å‘½ä»¤ï¼šrpm -qa | grep -i mysql<br>3ã€å¸è½½mysqlï¼Œä¾æ¬¡å¸è½½ç¬¬2æ­¥éª¤æ‰€åˆ—å‡ºçš„æœ‰å…³MySQLçš„å®‰è£…åŒ…,å¦‚<br>å‘½ä»¤ï¼šyum remove -y mysql-community-server-5.6.36-2.el7.x86_64<br>4ã€åˆ é™¤mysqlç›¸å…³ç›®å½•<br>1ï¼‰ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹mysqlç›¸å…³çš„æ–‡ä»¶ç›®å½•ï¼šfind / -name mysql<br>2ï¼‰ä¾æ¬¡åˆ é™¤æ‰€æŸ¥åˆ°çš„ç›®å½•ï¼Œå‘½ä»¤ï¼šrm -rf /xxx/xxx/mysql</p><h1 id="Tomcatå®‰è£…åŠç¯å¢ƒé…ç½®"><a href="#Tomcatå®‰è£…åŠç¯å¢ƒé…ç½®" class="headerlink" title="Tomcatå®‰è£…åŠç¯å¢ƒé…ç½®"></a>Tomcatå®‰è£…åŠç¯å¢ƒé…ç½®</h1><p>1ã€ä¸‹è½½tomcat-8.5.40ï¼Œåˆ°å®˜ç½‘ä¸Šä¸‹<br>2ã€å®‰è£…tomcat</p><p>1ï¼‰ä¸Šä¼ tomcatåˆ°toolsç›®å½•ä¸‹</p><p>2ï¼‰è§£å‹å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf tools/apache-tomcat-8.5.61.tar.gz -C environment/<br></code></pre></td></tr></table></figure><p>3ã€é…ç½®ç¯å¢ƒå˜é‡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi ~/.bash_profile<br></code></pre></td></tr></table></figure><p>æ·»åŠ å¦‚ä¸‹å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">tomcat</span><br>export PATH=$PATH:/home/lwj/envirenmont/apache-tomcat-8.5.61/bin<br></code></pre></td></tr></table></figure><p><img src="/2021/03/02/%E5%AE%89%E8%A3%85Jdk%E3%80%81MySql%E3%80%81Tomcat%E8%AE%B0%E5%BD%95%EF%BC%88Linux/image-20210303161746612.png" alt="image-20210303161746612"></p><p>ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/.bash_profile<br></code></pre></td></tr></table></figure><p>4ã€è¿›å…¥å®‰è£…ç›®å½•ä¸‹çš„binç›®å½•ï¼Œå¯åŠ¨Tomcat</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">sh</span> startup.<span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p><img src="/2021/03/02/%E5%AE%89%E8%A3%85Jdk%E3%80%81MySql%E3%80%81Tomcat%E8%AE%B0%E5%BD%95%EF%BC%88Linux/image-20210303140221836.png" alt="image-20210303140221836"></p><p>5ã€éªŒè¯ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥<a href="http://121.4.60.79:8080/">http://121.4.60.79:8080</a></p><p><img src="/2021/03/02/%E5%AE%89%E8%A3%85Jdk%E3%80%81MySql%E3%80%81Tomcat%E8%AE%B0%E5%BD%95%EF%BC%88Linux/image-20210303143007735.png" alt="image-20210303143007735"></p><p>tomcatå…³é—­ ï¼š</p><p><code>sh shutdown.sh</code></p>]]></content>
    
    
    <categories>
      
      <category>ç¯å¢ƒé…ç½®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ“ä½œè®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç§’æ€ç³»ç»Ÿé¡¹ç›®ä»‹ç»åŠæ­å»ºç¯å¢ƒï¼ˆä¸€ï¼‰</title>
    <link href="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®ä½¿ç”¨æ–¹æ¡ˆï¼š</p><p>å‰ç«¯ï¼š</p><p>åç«¯ï¼šSpringBootã€Mybatis</p><p>ä¸­é—´ä»¶ï¼šRabbitMQã€Redisã€Druid</p><p>ç¯å¢ƒï¼šLinux CentOS</p><p>å·¥å…·ï¼šIDEAå¼€å‘ã€Navicateæ•°æ®åº“ç®¡ç†</p><p>è¿œç¨‹è¿æ¥å·¥å…·ï¼šMobaXterm</p><p>æ•°æ®åº“ï¼šMySql</p><p>å‹åŠ›æµ‹è¯•å·¥å…·ï¼šJmeter</p><h2 id="è¿œç¨‹ç™»å½•å·¥å…·MobaXterm"><a href="#è¿œç¨‹ç™»å½•å·¥å…·MobaXterm" class="headerlink" title="è¿œç¨‹ç™»å½•å·¥å…·MobaXterm"></a>è¿œç¨‹ç™»å½•å·¥å…·MobaXterm</h2><p>å¯ç›´æ¥åˆ©ç”¨å·¥å…·ç¼–å†™å‘½ä»¤ï¼Œä¼ è¾“æ–‡ä»¶</p><p>æ‰“å¼€è½¯ä»¶ï¼Œåœ¨Remote hostè¾“å…¥IPåœ°å€</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210302192933216.png" alt="image-20210302192933216"></p><h2 id="åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²Redis"><a href="#åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²Redis" class="headerlink" title="åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²Redis"></a>åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²Redis</h2><p>æ³¨æ„æ”¹redis.confé…ç½®ï¼š</p><p>ï¼ˆ1ï¼‰å…è®¸æ‰€æœ‰IPè®¿é—®</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210305152548215.png" alt="image-20210305152548215"></p><p>ï¼ˆ2ï¼‰å…è®¸åå°è®¿é—®</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210305152707976.png" alt="image-20210305152707976"></p><p>ï¼ˆ3ï¼‰è®¾ç½®stop-writeä¸ºno</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210312143321946.png" alt="image-20210312143321946"></p><p>å¦åˆ™ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š</p><blockquote><p>ResponseError: MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.</p><p>ç©¶å…¶åŸå› æ˜¯å› ä¸ºå¼ºåˆ¶æŠŠrediså¿«ç…§å…³é—­äº†å¯¼è‡´ä¸èƒ½æŒä¹…åŒ–çš„é—®é¢˜ï¼Œåœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€äº›ç›¸å…³è§£å†³æ–¹æ¡ˆã€‚</p><p>é€šè¿‡stop-writes-on-bgsave-errorå€¼è®¾ç½®ä¸ºnoå³å¯é¿å…è¿™ç§é—®é¢˜ã€‚</p></blockquote><p>ä¸è¿‡éœ€è¦å…ˆå°†ä¹‹å‰å¯åŠ¨çš„redisè¿›ç¨‹killæ‰ï¼Œç„¶åå†é‡æ–°å¯åŠ¨æ–°çš„redisï¼Œæ‰èƒ½é¿å…æŠ¥ç›¸åŒçš„é”™</p><p>æŸ¥çœ‹è¿›ç¨‹ï¼š<code>ps -ef|grep redis</code></p><p>ç„¶åkillæ‰å¯¹åº”çš„è¿›ç¨‹ï¼š<code>kill -9 pid</code></p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210312144517831.png" alt="image-20210312144517831"></p><p>å¯¹åº”æ­¤å¤„ï¼š<code>kill -9 23789</code></p><p>å‚è€ƒå®‰è£…æ•™ç¨‹ï¼š<a href="https://mccontinuing.github.io/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/">Rediså®‰è£…åŠéƒ¨ç½²ï¼ˆwindosã€Linuxï¼‰</a>ä½¿ç”¨Linuxæ•™ç¨‹å®‰è£…</p><h2 id="SpringBooté›†æˆRedis"><a href="#SpringBooté›†æˆRedis" class="headerlink" title="SpringBooté›†æˆRedis"></a>SpringBooté›†æˆRedis</h2><p>å‚è€ƒ<a href="https://mccontinuing.github.io/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#SpringBoot%E6%95%B4%E5%90%88">SpringBootæ•´åˆRedisä¾èµ–å¯¼å…¥åŠé…ç½®</a></p><h2 id="åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²RabbitMQ"><a href="#åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²RabbitMQ" class="headerlink" title="åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²RabbitMQ"></a>åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²RabbitMQ</h2><p>å‚è€ƒå®‰è£…æ•™ç¨‹ï¼š<a href="https://mccontinuing.github.io/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/">RabbitMQå®‰è£…åŠé›†ç¾¤æ­å»º</a></p><p>RabbitMQæ›´æ–°åˆ°3.8ä»¥åå®‰è£…è¿‡ç¨‹éƒ½ä¸ç½‘ä¸Šä»‹ç»æœ‰æ‰€ä¸åŒï¼Œæ­¤å¤„ä»‹ç»3.8.11çš„æ–°ç‰ˆå®‰è£…è¿‡ç¨‹</p><h2 id="ç™»é™†ä½¿ç”¨ä¸¤æ¬¡MD5æ ¡éªŒ"><a href="#ç™»é™†ä½¿ç”¨ä¸¤æ¬¡MD5æ ¡éªŒ" class="headerlink" title="ç™»é™†ä½¿ç”¨ä¸¤æ¬¡MD5æ ¡éªŒ"></a>ç™»é™†ä½¿ç”¨ä¸¤æ¬¡MD5æ ¡éªŒ</h2><ul><li>ç”¨æˆ·ç«¯ï¼šPass = MD5ï¼ˆæ˜æ–‡ + å›ºå®šçš„saltï¼‰</li><li>æœåŠ¡ç«¯ï¼šPass = MD5ï¼ˆæ˜æ–‡ + éšæœºçš„saltï¼‰</li></ul><p>å¯¼å…¥MD5ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-codec<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-codec<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‰ç«¯(å°†ç”¨æˆ·çš„å¯†ç è¿›è¡ŒMD5è½¬æ¢)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doLogin</span>(<span class="hljs-params"></span>)</span>&#123;<br>g_showLoading();<br><br><span class="hljs-keyword">var</span> inputPass = $(<span class="hljs-string">&quot;#password&quot;</span>).val();<br><span class="hljs-keyword">var</span> salt = g_passsword_salt;<br><span class="hljs-keyword">var</span> str = <span class="hljs-string">&quot;&quot;</span>+salt.charAt(<span class="hljs-number">0</span>)+salt.charAt(<span class="hljs-number">2</span>) + inputPass +salt.charAt(<span class="hljs-number">5</span>) + salt.charAt(<span class="hljs-number">4</span>);<br><span class="hljs-keyword">var</span> password = md5(str);<br><br>$.ajax(&#123;<br>url: <span class="hljs-string">&quot;/login/do_login&quot;</span>,<br>    type: <span class="hljs-string">&quot;POST&quot;</span>,<br>    data:&#123;<br>    mobile:$(<span class="hljs-string">&quot;#mobile&quot;</span>).val(),<br>    password: password<br>    &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><p>åç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.commons.codec.digest.DigestUtils;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MD5Util</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">md5</span><span class="hljs-params">(String src)</span></span>&#123;<br>        <span class="hljs-keyword">return</span> DigestUtils.md5Hex(src);<br>    &#125;<br><br>    <span class="hljs-comment">//è®¾ç½®å›ºå®šçš„salt</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String salt = <span class="hljs-string">&quot;1a2b3c4d&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å°†ç”¨æˆ·è¾“å…¥çš„å¯†ç è¿›è¡Œmd5åå†ä¼ è¾“åˆ°ç½‘ç»œ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> inputPass</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">inputPassToFormPass</span><span class="hljs-params">(String inputPass)</span></span>&#123;<br>        String str = <span class="hljs-string">&quot;&quot;</span>+salt.charAt(<span class="hljs-number">0</span>)+salt.charAt(<span class="hljs-number">2</span>)+inputPass+salt.charAt(<span class="hljs-number">5</span>)+salt.charAt(<span class="hljs-number">4</span>);<br>        <span class="hljs-keyword">return</span> md5(str);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å°†formä¸­çš„è¡¨å•å¯†ç è¿›è¡Œmd5ååœ¨ä¼ è¾“åˆ°æ•°æ®åº“ä¸­</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">formPassToDbPass</span><span class="hljs-params">(String formPass, String salt)</span></span>&#123;<br>        String str = <span class="hljs-string">&quot;&quot;</span>+salt.charAt(<span class="hljs-number">0</span>)+salt.charAt(<span class="hljs-number">2</span>)+formPass+salt.charAt(<span class="hljs-number">5</span>)+salt.charAt(<span class="hljs-number">4</span>);<br>        <span class="hljs-keyword">return</span> md5(str);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å°†ç”¨æˆ·çš„å¯†ç ä¼ åˆ°æ•°æ®åº“ä¸­</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> input</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> saltDB</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">inputPassToDbPass</span><span class="hljs-params">(String input, String saltDB)</span></span>&#123;<br>        String formPass = inputPassToFormPass(input);<br>        String dbPass = formPassToDbPass(formPass, saltDB);<br>        <span class="hljs-keyword">return</span> dbPass;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        System.out.println(inputPassToFormPass(<span class="hljs-string">&quot;123456&quot;</span>));<span class="hljs-comment">//d3b1294a61a07da9b49b6e22b2cbd7f9</span><br>System.out.println(formPassToDbPass(inputPassToFormPass(<span class="hljs-string">&quot;123456&quot;</span>), <span class="hljs-string">&quot;1a2b3c4d&quot;</span>));<br>System.out.println(inputPassToDbPass(<span class="hljs-string">&quot;123456&quot;</span>, <span class="hljs-string">&quot;1a2b3c4d&quot;</span>));<span class="hljs-comment">//b7797cce01b4b131b433b6acf4add449</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="å…·ä½“ç™»é™†æµç¨‹"><a href="#å…·ä½“ç™»é™†æµç¨‹" class="headerlink" title="å…·ä½“ç™»é™†æµç¨‹"></a>å…·ä½“ç™»é™†æµç¨‹</h3><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210309151745454.png" alt="image-20210309151745454"></p><h2 id="JSR303å‚æ•°æ ¡éªŒ"><a href="#JSR303å‚æ•°æ ¡éªŒ" class="headerlink" title="JSR303å‚æ•°æ ¡éªŒ"></a>JSR303å‚æ•°æ ¡éªŒ</h2><p>ä¸ºç®€åŒ–å‚æ•°æ ¡éªŒå¼•å…¥JSR303å‚æ•°æ ¡éªŒçš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å‚æ•°æ ¡éªŒ--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>SpingBootå·²ç»é›†æˆJSR303æ•°æ®æ ¡éªŒ ï¼Œå¯ç›´æ¥ä½¿ç”¨</p><p>æˆ–è€…å¼•å…¥<strong>Hibernate Validator</strong>ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.glassfish<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jakarta.el<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>1ã€åœ¨éœ€è¦éªŒè¯çš„ç±»ä¸ŠåŠ @Validated</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210309170306862.png" alt="image-20210309170306862"></p><p>2ã€å»å®ä½“ç±»ä¸­åœ¨éœ€è¦éªŒè¯çš„å‚æ•°åŠ å…·ä½“éªŒè¯å†…å®¹</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210309170812181.png" alt="image-20210309170812181"></p><h2 id="WebMvcConfigurerAdapter-å¼ƒç”¨å¤„ç†"><a href="#WebMvcConfigurerAdapter-å¼ƒç”¨å¤„ç†" class="headerlink" title="WebMvcConfigurerAdapter å¼ƒç”¨å¤„ç†"></a>WebMvcConfigurerAdapter å¼ƒç”¨å¤„ç†</h2><p>SpringBoot2.0 æ˜¯åŸºäº spring 5.0 å®ç°çš„ã€‚</p><p>åœ¨Spring 5.0 ä¸­ï¼Œå·²ç»å°† WebMvcConfigurerAdapter æŠ½è±¡ç±»åŠ ä¸Š @Deprecated æ³¨è§£ å·²ç»è¢«å¼ƒç”¨ã€‚</p><p>è¿‡æ—¶æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebConfig</span>  <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurerAdapter</span></span>&#123;<br><br><span class="hljs-meta">@Autowired</span><br>UserArgumentResolver userArgumentResolver;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addArgumentResolvers</span><span class="hljs-params">(List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers)</span> </span>&#123;<br>argumentResolvers.add(userArgumentResolver);<br>&#125;<br></code></pre></td></tr></table></figure><p>WebMvcConfigurerAdapter  æŠ½è±¡ç±»å®ç°äº† WebMvcConfigurer æ¥å£ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦å°† extends WebMvcConfigurerAdapter  æ›¿æ¢ä¸º implements WebMvcConfigurer å³å¯ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    UserArgumentResolver userArgumentResolver;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addArgumentResolvers</span><span class="hljs-params">(List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers)</span> </span>&#123;<br>        argumentResolvers.add(userArgumentResolver);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ•°æ®åº“è®¾è®¡"><a href="#æ•°æ®åº“è®¾è®¡" class="headerlink" title="æ•°æ®åº“è®¾è®¡"></a>æ•°æ®åº“è®¾è®¡</h2><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210316155354513.png" alt="image-20210316155354513"></p><p>goods</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210316155506779.png" alt="image-20210316155506779"></p><p>miaosha_goods</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210316155557269.png" alt="image-20210316155557269"></p><p>miaosha_order</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210316155657625.png" alt="image-20210316155657625"></p><p>miaosha_user</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210316155744536.png" alt="image-20210316155744536"></p><p>order_info</p><p><img src="/2021/03/02/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%90%AD%E5%BB%BA%E7%8E%AF%E5%A2%83%EF%BC%88%E4%B8%80%EF%BC%89/image-20210316155843975.png" alt="image-20210316155843975"></p><p>å¤åˆ¶æ•°æ®åº“å¯¼å…¥Linux</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å¯åŠ¨æ•°æ®åº“</span><br>mysql -u root -p<br><span class="hljs-meta">#</span><span class="bash">æ–°å»ºä¸€ä¸ªåŒåçš„ç©ºæ•°æ®åº“</span><br>create database miaosha;<br><span class="hljs-meta">#</span><span class="bash">ä½¿ç”¨æ­¤æ•°æ®åº“</span><br>use miaosha;<br><span class="hljs-meta">#</span><span class="bash">å¯¼å…¥æ•°æ®åº“</span><br>source /home/lwj/myproject/miaosha.sql;<br><span class="hljs-meta">#</span><span class="bash">æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨</span><br>show tables;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®å®æˆ˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç§’æ€ç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQå®‰è£…åŠé›†ç¾¤æ­å»º</title>
    <link href="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/"/>
    <url>/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…åŠé…ç½®RabbitMQ"><a href="#å®‰è£…åŠé…ç½®RabbitMQ" class="headerlink" title="å®‰è£…åŠé…ç½®RabbitMQ"></a>å®‰è£…åŠé…ç½®RabbitMQ</h1><p>ä¸‹è½½åœ°å€ï¼š<a href="https://www.rabbitmq.com/#getstarted">https://www.rabbitmq.com/#getstarted</a></p><p>ç‚¹å‡»Download+Installation</p><p>1ã€æ­¤å¤„ä¸‹è½½centosç‰ˆæœ¬</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210222213424372.png" alt="image-20210222213424372"></p><p>åœ¨æ­¤é¡µé¢éœ€è¦ä¸‹è½½ä¸¤ä¸ªï¼šæœåŠ¡å’Œä¾èµ–åŒ…</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223110003677.png" alt="image-20210223110003677"></p><h2 id="ä¸‹è½½rabbit-serve-ç‚¹å‡»Download"><a href="#ä¸‹è½½rabbit-serve-ç‚¹å‡»Download" class="headerlink" title="ä¸‹è½½rabbit-serve ç‚¹å‡»Download"></a>ä¸‹è½½rabbit-serve ç‚¹å‡»Download</h2><p>ç‚¹å‡»è¦ä¸‹è½½çš„ç‰ˆæœ¬ï¼ˆæ­¤æœºä½¿ç”¨Centos7ï¼Œæ‰€ä»¥ä¸‹è½½ç¬¬äºŒä¸ªï¼‰</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223105632538.png" alt="image-20210223105632538"></p><h2 id="ä¸‹è½½åŒ…ä¾èµ–ï¼ŒåŠerlang"><a href="#ä¸‹è½½åŒ…ä¾èµ–ï¼ŒåŠerlang" class="headerlink" title="ä¸‹è½½åŒ…ä¾èµ–ï¼ŒåŠerlang"></a>ä¸‹è½½åŒ…ä¾èµ–ï¼ŒåŠerlang</h2><p>æ³¨æ„Erlangçš„ç‰ˆæœ¬éœ€è¦å’ŒRabbitMQç‰ˆæœ¬å¯¹åº”èµ·æ¥</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210222213338646.png" alt="image-20210222213338646"></p><p>å¯ä»¥æŸ¥çœ‹æœ€å°æœ€å¤§å¯¹åº”ç‰ˆæœ¬</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210222213602648.png" alt="image-20210222213602648"></p><p>æœ€ç»ˆä¸‹è½½ï¼š</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223112948384.png" alt="image-20210223112948384"></p><p>åœ¨è™šæ‹Ÿæœºä¸Šæ–°å»ºæ–‡ä»¶å¤¹/training/RabbitMQ,å°†ä¸‰ä¸ªåŒ…ä¸Šä¼ åˆ°æ–‡ä»¶å¤¹ä¸­</p><p>Linuxä¸­è¿›è¡Œå®‰è£…</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223113812156.png" alt="image-20210223113812156"></p><p>é»˜è®¤å®‰è£…è·¯å¾„åœ¨æ­¤ï¼š/usr/share/doc/rabbitmq-server-3.8.11/</p><h2 id="å¯åŠ¨rabbitmq"><a href="#å¯åŠ¨rabbitmq" class="headerlink" title="å¯åŠ¨rabbitmq"></a><strong>å¯åŠ¨rabbitmq</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl enable rabbitmq-server<br><br>systemctl start rabbitmq-server<br><br>systemctl status rabbitmq-server<br></code></pre></td></tr></table></figure><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223160424490.png" alt="image-20210223160424490"></p><h2 id="æ·»åŠ Webæ’ä»¶"><a href="#æ·»åŠ Webæ’ä»¶" class="headerlink" title="æ·»åŠ Webæ’ä»¶"></a>æ·»åŠ Webæ’ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rabbitmq-plugins enable rabbitmq_management<br></code></pre></td></tr></table></figure><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223160648007.png" alt="image-20210223160648007"></p><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æµè§ˆå™¨ä¸­è¾“å…¥</p><p><a href="http://192.168.91.130:15672/">http://192.168.91.130:15672</a></p><p>è´¦å·å¯†ç éƒ½æ˜¯é»˜è®¤ï¼šguest</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223161236620.png" alt="image-20210223161236620"></p><p>æç¤ºå½“å‰åªèƒ½æœ¬åœ°è®¿é—®ï¼Œéœ€è¦é…ç½®è¿œç¨‹ç”¨æˆ·æ‰èƒ½è¿œç¨‹è®¿é—®</p><h2 id="é…ç½®è¿œç¨‹ç”¨æˆ·"><a href="#é…ç½®è¿œç¨‹ç”¨æˆ·" class="headerlink" title="é…ç½®è¿œç¨‹ç”¨æˆ·"></a><strong>é…ç½®è¿œç¨‹ç”¨æˆ·</strong></h2><p>å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.rabbitmq.com/configure.html">https://www.rabbitmq.com/configure.html</a></p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/clip_image002.jpg" alt="img"></p><p>åœ¨è¿™ä¸ªéƒ¨åˆ†å¯ä»¥çœ‹åˆ°æˆ‘ä»¬RPMå®‰è£…çš„rabbitmqçš„é…ç½®æ–‡ä»¶æ”¾åœ¨è¿™ä¸ªä½ç½®</p><p>äºæ˜¯åœ¨etc/rabbitmq(å®‰è£…æ—¶çš„é»˜è®¤è·¯å¾„)ä¸­æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶rabbitmq.conf</p><p>åœ¨é‡Œé¢å†™ä¸Š</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223164059703.png" alt="image-20210223164059703"></p><p>åŸå› ï¼šåœ¨å®˜ç½‘ä¸­æ˜¯è¿™æ ·è¯´çš„ï¼šä½¿ç”¨key = valueæ–¹å¼æ¥æè¿°ä½ æƒ³è¦è®¾ç½®çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨rabbitMQä¸­é…ç½®äº†loopback_users = none</p><p>è¿™ä¸ªé…ç½®çš„ä½œç”¨ï¼šè§£å†³ä¸èƒ½é€šè¿‡ipæ¥ç›´æ¥è®¿é—®åç®¡é¡µé¢ï¼Œåªèƒ½é€šè¿‡localhostæ¥è®¿é—®</p><p><strong>é‡å¯Rabbitmq</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span>~]<span class="hljs-meta"># systemctl restart rabbitmq-server</span><br></code></pre></td></tr></table></figure><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20210223164344143.png" alt="image-20210223164344143"></p><h1 id="RabbitMQé›†ç¾¤æ­å»º"><a href="#RabbitMQé›†ç¾¤æ­å»º" class="headerlink" title="RabbitMQé›†ç¾¤æ­å»º"></a>RabbitMQé›†ç¾¤æ­å»º</h1><p>æ‘˜è¦ï¼šå®é™…ç”Ÿäº§åº”ç”¨ä¸­éƒ½ä¼šé‡‡ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„é›†ç¾¤æ–¹æ¡ˆï¼Œå¦‚æœé€‰æ‹©RabbitMQé‚£ä¹ˆæœ‰å¿…è¦äº†è§£ä¸‹å®ƒçš„é›†ç¾¤æ–¹æ¡ˆåŸç†</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœåªæ˜¯ä¸ºäº†å­¦ä¹ RabbitMQæˆ–è€…éªŒè¯ä¸šåŠ¡å·¥ç¨‹çš„æ­£ç¡®æ€§é‚£ä¹ˆåœ¨æœ¬åœ°ç¯å¢ƒæˆ–è€…æµ‹è¯•ç¯å¢ƒä¸Šä½¿ç”¨å…¶å•å®ä¾‹éƒ¨ç½²å°±å¯ä»¥äº†ï¼Œä½†æ˜¯å‡ºäºMQä¸­é—´ä»¶æœ¬èº«çš„å¯é æ€§ã€å¹¶å‘æ€§ã€ååé‡å’Œæ¶ˆæ¯å †ç§¯èƒ½åŠ›ç­‰é—®é¢˜çš„è€ƒè™‘ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä¸€èˆ¬éƒ½ä¼šè€ƒè™‘ä½¿ç”¨RabbitMQçš„é›†ç¾¤æ–¹æ¡ˆã€‚</p><h3 id="é›†ç¾¤æ–¹æ¡ˆçš„åŸç†"><a href="#é›†ç¾¤æ–¹æ¡ˆçš„åŸç†" class="headerlink" title="é›†ç¾¤æ–¹æ¡ˆçš„åŸç†"></a>é›†ç¾¤æ–¹æ¡ˆçš„åŸç†</h3><p>RabbitMQè¿™æ¬¾æ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶äº§å“æœ¬èº«æ˜¯åŸºäºErlangç¼–å†™ï¼ŒErlangè¯­è¨€å¤©ç”Ÿå…·å¤‡åˆ†å¸ƒå¼ç‰¹æ€§ï¼ˆé€šè¿‡åŒæ­¥Erlangé›†ç¾¤å„èŠ‚ç‚¹çš„magic cookieæ¥å®ç°ï¼‰ã€‚å› æ­¤ï¼ŒRabbitMQå¤©ç„¶æ”¯æŒClusteringã€‚è¿™ä½¿å¾—RabbitMQæœ¬èº«ä¸éœ€è¦åƒActiveMQã€Kafkaé‚£æ ·é€šè¿‡ZooKeeperåˆ†åˆ«æ¥å®ç°HAæ–¹æ¡ˆå’Œä¿å­˜é›†ç¾¤çš„å…ƒæ•°æ®ã€‚é›†ç¾¤æ˜¯ä¿è¯å¯é æ€§çš„ä¸€ç§æ–¹å¼ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡æ°´å¹³æ‰©å±•ä»¥è¾¾åˆ°å¢åŠ æ¶ˆæ¯ååé‡èƒ½åŠ›çš„ç›®çš„ã€‚</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/1566073768274.png" alt="1565245219265"></p><h3 id="3-2-å•æœºå¤šå®ä¾‹éƒ¨ç½²"><a href="#3-2-å•æœºå¤šå®ä¾‹éƒ¨ç½²" class="headerlink" title="3.2 å•æœºå¤šå®ä¾‹éƒ¨ç½²"></a>3.2 å•æœºå¤šå®ä¾‹éƒ¨ç½²</h3><p>ç”±äºæŸäº›å› ç´ çš„é™åˆ¶ï¼Œæœ‰æ—¶å€™ä½ ä¸å¾—ä¸åœ¨ä¸€å°æœºå™¨ä¸Šå»æ­å»ºä¸€ä¸ªrabbitmqé›†ç¾¤ï¼Œè¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼zookeeperçš„å•æœºç‰ˆã€‚çœŸå®ç”Ÿæˆç¯å¢ƒè¿˜æ˜¯è¦é…æˆå¤šæœºé›†ç¾¤çš„ã€‚æœ‰å…³æ€ä¹ˆé…ç½®å¤šæœºé›†ç¾¤çš„å¯ä»¥å‚è€ƒå…¶ä»–çš„èµ„æ–™ï¼Œè¿™é‡Œä¸»è¦è®ºè¿°å¦‚ä½•åœ¨å•æœºä¸­é…ç½®å¤šä¸ªrabbitmqå®ä¾‹ã€‚</p><p>ä¸»è¦å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.rabbitmq.com/clustering.html">https://www.rabbitmq.com/clustering.html</a></p><p>é¦–å…ˆç¡®ä¿RabbitMQè¿è¡Œæ²¡æœ‰é—®é¢˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@super ~]# rabbitmqctl status<br>Status of node rabbit@super ...<br>[&#123;pid,10232&#125;,<br> &#123;running_applications,<br>     [&#123;rabbitmq_management,&quot;RabbitMQ Management Console&quot;,&quot;3.6.5&quot;&#125;,<br>      &#123;rabbitmq_web_dispatch,&quot;RabbitMQ Web Dispatcher&quot;,&quot;3.6.5&quot;&#125;,<br>      &#123;webmachine,&quot;webmachine&quot;,&quot;1.10.3&quot;&#125;,<br>      &#123;mochiweb,&quot;MochiMedia Web Server&quot;,&quot;2.13.1&quot;&#125;,<br>      &#123;rabbitmq_management_agent,&quot;RabbitMQ Management Agent&quot;,&quot;3.6.5&quot;&#125;,<br>      &#123;rabbit,&quot;RabbitMQ&quot;,&quot;3.6.5&quot;&#125;,<br>      &#123;os_mon,&quot;CPO  CXC 138 46&quot;,&quot;2.4&quot;&#125;,<br>      &#123;syntax_tools,&quot;Syntax tools&quot;,&quot;1.7&quot;&#125;,<br>      &#123;inets,&quot;INETS  CXC 138 49&quot;,&quot;6.2&quot;&#125;,<br>      &#123;amqp_client,&quot;RabbitMQ AMQP Client&quot;,&quot;3.6.5&quot;&#125;,<br>      &#123;rabbit_common,[],&quot;3.6.5&quot;&#125;,<br>      &#123;ssl,&quot;Erlang/OTP SSL application&quot;,&quot;7.3&quot;&#125;,<br>      &#123;public_key,&quot;Public key infrastructure&quot;,&quot;1.1.1&quot;&#125;,<br>      &#123;asn1,&quot;The Erlang ASN1 compiler version 4.0.2&quot;,&quot;4.0.2&quot;&#125;,<br>      &#123;ranch,&quot;Socket acceptor pool for TCP protocols.&quot;,&quot;1.2.1&quot;&#125;,<br>      &#123;mnesia,&quot;MNESIA  CXC 138 12&quot;,&quot;4.13.3&quot;&#125;,<br>      &#123;compiler,&quot;ERTS  CXC 138 10&quot;,&quot;6.0.3&quot;&#125;,<br>      &#123;crypto,&quot;CRYPTO&quot;,&quot;3.6.3&quot;&#125;,<br>      &#123;xmerl,&quot;XML parser&quot;,&quot;1.3.10&quot;&#125;,<br>      &#123;sasl,&quot;SASL  CXC 138 11&quot;,&quot;2.7&quot;&#125;,<br>      &#123;stdlib,&quot;ERTS  CXC 138 10&quot;,&quot;2.8&quot;&#125;,<br>      &#123;kernel,&quot;ERTS  CXC 138 10&quot;,&quot;4.2&quot;&#125;]&#125;,<br> &#123;os,&#123;unix,linux&#125;&#125;,<br> &#123;erlang_version,<br>     &quot;Erlang/OTP 18 [erts-7.3] [source] [64-bit] [async-threads:64] [hipe] [kernel-poll:true]\n&quot;&#125;,<br> &#123;memory,<br>     [&#123;total,56066752&#125;,<br>      &#123;connection_readers,0&#125;,<br>      &#123;connection_writers,0&#125;,<br>      &#123;connection_channels,0&#125;,<br>      &#123;connection_other,2680&#125;,<br>      &#123;queue_procs,268248&#125;,<br>      &#123;queue_slave_procs,0&#125;,<br>      &#123;plugins,1131936&#125;,<br>      &#123;other_proc,18144280&#125;,<br>      &#123;mnesia,125304&#125;,<br>      &#123;mgmt_db,921312&#125;,<br>      &#123;msg_index,69440&#125;,<br>      &#123;other_ets,1413664&#125;,<br>      &#123;binary,755736&#125;,<br>      &#123;code,27824046&#125;,<br>      &#123;atom,1000601&#125;,<br>      &#123;other_system,4409505&#125;]&#125;,<br> &#123;alarms,[]&#125;,<br> &#123;listeners,[&#123;clustering,25672,&quot;::&quot;&#125;,&#123;amqp,5672,&quot;::&quot;&#125;]&#125;,<br> &#123;vm_memory_high_watermark,0.4&#125;,<br> &#123;vm_memory_limit,411294105&#125;,<br> &#123;disk_free_limit,50000000&#125;,<br> &#123;disk_free,13270233088&#125;,<br> &#123;file_descriptors,<br>     [&#123;total_limit,924&#125;,&#123;total_used,6&#125;,&#123;sockets_limit,829&#125;,&#123;sockets_used,0&#125;]&#125;,<br> &#123;processes,[&#123;limit,1048576&#125;,&#123;used,262&#125;]&#125;,<br> &#123;run_queue,0&#125;,<br> &#123;uptime,43651&#125;,<br> &#123;kernel,&#123;net_ticktime,60&#125;&#125;]<br></code></pre></td></tr></table></figure><p>åœæ­¢rabbitmqæœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@super sbin]# service rabbitmq-server stop<br>Stopping rabbitmq-server: rabbitmq-server.<br><br></code></pre></td></tr></table></figure><p>å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@super sbin]# RABBITMQ_NODE_PORT=5673 RABBITMQ_NODENAME=rabbit1 rabbitmq-server start<br><br>              RabbitMQ 3.6.5. Copyright (C) 2007-2016 Pivotal Software, Inc.<br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#  ##      Licensed under the MPL.  See http://www.rabbitmq.com/</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#  ##</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#########  Logs: /var/log/rabbitmq/rabbit1.log</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#####  ##        /var/log/rabbitmq/rabbit1-sasl.log</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#########</span></span><br>              Starting broker...<br> completed with 6 plugins.<br></code></pre></td></tr></table></figure><p>å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼š</p><blockquote><p>webç®¡ç†æ’ä»¶ç«¯å£å ç”¨,æ‰€ä»¥è¿˜è¦æŒ‡å®šå…¶webæ’ä»¶å ç”¨çš„ç«¯å£å·ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@super ~]# RABBITMQ_NODE_PORT=5674 RABBITMQ_SERVER_START_ARGS=&quot;-rabbitmq_management listener [&#123;port,15674&#125;]&quot; RABBITMQ_NODENAME=rabbit2 rabbitmq-server start<br><br>              RabbitMQ 3.6.5. Copyright (C) 2007-2016 Pivotal Software, Inc.<br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#  ##      Licensed under the MPL.  See http://www.rabbitmq.com/</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#  ##</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#########  Logs: /var/log/rabbitmq/rabbit2.log</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#####  ##        /var/log/rabbitmq/rabbit2-sasl.log</span></span><br><span class="hljs-meta">  #</span><span class="bash"><span class="hljs-comment">#########</span></span><br>              Starting broker...<br> completed with 6 plugins.<br><br></code></pre></td></tr></table></figure><p>ç»“æŸå‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">rabbitmqctl -n rabbit1 stop<br>rabbitmqctl -n rabbit2 stop<br></code></pre></td></tr></table></figure><p>rabbit1æ“ä½œä½œä¸ºä¸»èŠ‚ç‚¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@super ~]# rabbitmqctl -n rabbit1 stop_app  <br>Stopping node rabbit1@super ...<br>[root@super ~]# rabbitmqctl -n rabbit1 reset <br>Resetting node rabbit1@super ...<br>[root@super ~]# rabbitmqctl -n rabbit1 start_app<br>Starting node rabbit1@super ...<br>[root@super ~]# <br></code></pre></td></tr></table></figure><p>rabbit2æ“ä½œä¸ºä»èŠ‚ç‚¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@super ~]# rabbitmqctl -n rabbit2 stop_app<br>Stopping node rabbit2@super ...<br>[root@super ~]# rabbitmqctl -n rabbit2 reset<br>Resetting node rabbit2@super ...<br>[root@super ~]# rabbitmqctl -n rabbit2 join_cluster rabbit1@&#x27;super&#x27; ###&#x27;&#x27;å†…æ˜¯ä¸»æœºåæ¢æˆè‡ªå·±çš„<br>Clustering node rabbit2@super with rabbit1@super ...<br>[root@super ~]# rabbitmqctl -n rabbit2 start_app<br>Starting node rabbit2@super ...<br><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">[<span class="hljs-symbol">root@</span><span class="hljs-keyword">super</span> ~]# rabbitmqctl cluster_status -n rabbit1<br>Cluster status of node <span class="hljs-symbol">rabbit1@</span><span class="hljs-keyword">super</span> ...<br>[&#123;nodes,[&#123;disc,[<span class="hljs-symbol">rabbit1@</span><span class="hljs-keyword">super</span>,<span class="hljs-symbol">rabbit2@</span><span class="hljs-keyword">super</span>]&#125;]&#125;,<br> &#123;running_nodes,[<span class="hljs-symbol">rabbit2@</span><span class="hljs-keyword">super</span>,<span class="hljs-symbol">rabbit1@</span><span class="hljs-keyword">super</span>]&#125;,<br> &#123;cluster_name,&lt;&lt;<span class="hljs-string">&quot;rabbit1@super&quot;</span>&gt;&gt;&#125;,<br> &#123;partitions,[]&#125;,<br> &#123;alarms,[&#123;<span class="hljs-symbol">rabbit2@</span><span class="hljs-keyword">super</span>,[]&#125;,&#123;<span class="hljs-symbol">rabbit1@</span><span class="hljs-keyword">super</span>,[]&#125;]&#125;]<br></code></pre></td></tr></table></figure><p>webç›‘æ§ï¼š</p><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/1566065096459.png" alt="1566065096459"></p><h3 id="3-3-é›†ç¾¤ç®¡ç†"><a href="#3-3-é›†ç¾¤ç®¡ç†" class="headerlink" title="3.3 é›†ç¾¤ç®¡ç†"></a>3.3 é›†ç¾¤ç®¡ç†</h3><p><strong>rabbitmqctl join_cluster {cluster_node} [â€“ram]</strong><br>å°†èŠ‚ç‚¹åŠ å…¥æŒ‡å®šé›†ç¾¤ä¸­ã€‚åœ¨è¿™ä¸ªå‘½ä»¤æ‰§è¡Œå‰éœ€è¦åœæ­¢RabbitMQåº”ç”¨å¹¶é‡ç½®èŠ‚ç‚¹ã€‚</p><p><strong>rabbitmqctl cluster_status</strong><br>æ˜¾ç¤ºé›†ç¾¤çš„çŠ¶æ€ã€‚</p><p><strong>rabbitmqctl change_cluster_node_type {disc|ram}</strong><br>ä¿®æ”¹é›†ç¾¤èŠ‚ç‚¹çš„ç±»å‹ã€‚åœ¨è¿™ä¸ªå‘½ä»¤æ‰§è¡Œå‰éœ€è¦åœæ­¢RabbitMQåº”ç”¨ã€‚</p><p><strong>rabbitmqctl forget_cluster_node [â€“offline]</strong><br>å°†èŠ‚ç‚¹ä»é›†ç¾¤ä¸­åˆ é™¤ï¼Œå…è®¸ç¦»çº¿æ‰§è¡Œã€‚</p><p><strong>rabbitmqctl update_cluster_nodes {clusternode}</strong></p><p>åœ¨é›†ç¾¤ä¸­çš„èŠ‚ç‚¹åº”ç”¨å¯åŠ¨å‰å’¨è¯¢clusternodeèŠ‚ç‚¹çš„æœ€æ–°ä¿¡æ¯ï¼Œå¹¶æ›´æ–°ç›¸åº”çš„é›†ç¾¤ä¿¡æ¯ã€‚è¿™ä¸ªå’Œjoin_clusterä¸åŒï¼Œå®ƒä¸åŠ å…¥é›†ç¾¤ã€‚è€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼ŒèŠ‚ç‚¹Aå’ŒèŠ‚ç‚¹Béƒ½åœ¨é›†ç¾¤ä¸­ï¼Œå½“èŠ‚ç‚¹Aç¦»çº¿äº†ï¼ŒèŠ‚ç‚¹Cåˆå’ŒèŠ‚ç‚¹Bç»„æˆäº†ä¸€ä¸ªé›†ç¾¤ï¼Œç„¶åèŠ‚ç‚¹Båˆç¦»å¼€äº†é›†ç¾¤ï¼Œå½“Aé†’æ¥çš„æ—¶å€™ï¼Œå®ƒä¼šå°è¯•è”ç³»èŠ‚ç‚¹Bï¼Œä½†æ˜¯è¿™æ ·ä¼šå¤±è´¥ï¼Œå› ä¸ºèŠ‚ç‚¹Bå·²ç»ä¸åœ¨é›†ç¾¤ä¸­äº†ã€‚</p><p><strong>rabbitmqctl cancel_sync_queue [-p vhost] {queue}</strong><br>å–æ¶ˆé˜Ÿåˆ—queueåŒæ­¥é•œåƒçš„æ“ä½œã€‚</p><p><strong>rabbitmqctl set_cluster_name {name}</strong><br>è®¾ç½®é›†ç¾¤åç§°ã€‚é›†ç¾¤åç§°åœ¨å®¢æˆ·ç«¯è¿æ¥æ—¶ä¼šé€šæŠ¥ç»™å®¢æˆ·ç«¯ã€‚Federationå’ŒShovelæ’ä»¶ä¹Ÿä¼šæœ‰ç”¨åˆ°é›†ç¾¤åç§°çš„åœ°æ–¹ã€‚é›†ç¾¤åç§°é»˜è®¤æ˜¯é›†ç¾¤ä¸­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„åç§°ï¼Œé€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥é‡æ–°è®¾ç½®ã€‚</p><h3 id="3-4-RabbitMQé•œåƒé›†ç¾¤é…ç½®"><a href="#3-4-RabbitMQé•œåƒé›†ç¾¤é…ç½®" class="headerlink" title="3.4 RabbitMQé•œåƒé›†ç¾¤é…ç½®"></a>3.4 RabbitMQé•œåƒé›†ç¾¤é…ç½®</h3><blockquote><p>ä¸Šé¢å·²ç»å®ŒæˆRabbitMQé»˜è®¤é›†ç¾¤æ¨¡å¼ï¼Œä½†å¹¶ä¸ä¿è¯é˜Ÿåˆ—çš„é«˜å¯ç”¨æ€§ï¼Œå°½ç®¡äº¤æ¢æœºã€ç»‘å®šè¿™äº›å¯ä»¥å¤åˆ¶åˆ°é›†ç¾¤é‡Œçš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½†æ˜¯é˜Ÿåˆ—å†…å®¹ä¸ä¼šå¤åˆ¶ã€‚è™½ç„¶è¯¥æ¨¡å¼è§£å†³ä¸€é¡¹ç›®ç»„èŠ‚ç‚¹å‹åŠ›ï¼Œä½†é˜Ÿåˆ—èŠ‚ç‚¹å®•æœºç›´æ¥å¯¼è‡´è¯¥é˜Ÿåˆ—æ— æ³•åº”ç”¨ï¼Œåªèƒ½ç­‰å¾…é‡å¯ï¼Œæ‰€ä»¥è¦æƒ³åœ¨é˜Ÿåˆ—èŠ‚ç‚¹å®•æœºæˆ–æ•…éšœä¹Ÿèƒ½æ­£å¸¸åº”ç”¨ï¼Œå°±è¦å¤åˆ¶é˜Ÿåˆ—å†…å®¹åˆ°é›†ç¾¤é‡Œçš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå¿…é¡»è¦åˆ›å»ºé•œåƒé˜Ÿåˆ—ã€‚</p><p>é•œåƒé˜Ÿåˆ—æ˜¯åŸºäºæ™®é€šçš„é›†ç¾¤æ¨¡å¼çš„ï¼Œç„¶åå†æ·»åŠ ä¸€äº›ç­–ç•¥ï¼Œæ‰€ä»¥ä½ è¿˜æ˜¯å¾—å…ˆé…ç½®æ™®é€šé›†ç¾¤ï¼Œç„¶åæ‰èƒ½è®¾ç½®é•œåƒé˜Ÿåˆ—ï¼Œæˆ‘ä»¬å°±ä»¥ä¸Šé¢çš„é›†ç¾¤æ¥ç€åšã€‚</p></blockquote><p><strong>è®¾ç½®çš„é•œåƒé˜Ÿåˆ—å¯ä»¥é€šè¿‡å¼€å¯çš„ç½‘é¡µçš„ç®¡ç†ç«¯Admin-&gt;Policiesï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤ã€‚</strong></p><blockquote><p>rabbitmqctl set_policy my_ha â€œ^â€ â€˜{â€œha-modeâ€:â€allâ€}â€™</p></blockquote><p><img src="/2021/02/25/RabbitMQ%E5%AE%89%E8%A3%85%E5%8F%8A%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/1566072300852.png" alt="1566072300852"></p><blockquote><ul><li>Name:ç­–ç•¥åç§°</li><li>Patternï¼šåŒ¹é…çš„è§„åˆ™ï¼Œå¦‚æœæ˜¯åŒ¹é…æ‰€æœ‰çš„é˜Ÿåˆ—ï¼Œæ˜¯^.</li><li>Definition:ä½¿ç”¨ha-modeæ¨¡å¼ä¸­çš„allï¼Œä¹Ÿå°±æ˜¯åŒæ­¥æ‰€æœ‰åŒ¹é…çš„é˜Ÿåˆ—ã€‚é—®å·é“¾æ¥å¸®åŠ©æ–‡æ¡£ã€‚</li></ul></blockquote><h3 id="3-5-è´Ÿè½½å‡è¡¡-HAProxy"><a href="#3-5-è´Ÿè½½å‡è¡¡-HAProxy" class="headerlink" title="3.5 è´Ÿè½½å‡è¡¡-HAProxy"></a>3.5 è´Ÿè½½å‡è¡¡-HAProxy</h3><p>HAProxyæä¾›é«˜å¯ç”¨æ€§ã€è´Ÿè½½å‡è¡¡ä»¥åŠåŸºäºTCPå’ŒHTTPåº”ç”¨çš„ä»£ç†ï¼Œæ”¯æŒè™šæ‹Ÿä¸»æœºï¼Œå®ƒæ˜¯å…è´¹ã€å¿«é€Ÿå¹¶ä¸”å¯é çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ,åŒ…æ‹¬Twitterï¼ŒRedditï¼ŒStackOverflowï¼ŒGitHubåœ¨å†…çš„å¤šå®¶çŸ¥åäº’è”ç½‘å…¬å¸åœ¨ä½¿ç”¨ã€‚HAProxyå®ç°äº†ä¸€ç§äº‹ä»¶é©±åŠ¨ã€å•ä¸€è¿›ç¨‹æ¨¡å‹ï¼Œæ­¤æ¨¡å‹æ”¯æŒéå¸¸å¤§çš„å¹¶å‘è¿æ¥æ•°ã€‚</p><h5 id="3-5-1-å®‰è£…HAProxy"><a href="#3-5-1-å®‰è£…HAProxy" class="headerlink" title="3.5.1  å®‰è£…HAProxy"></a>3.5.1  å®‰è£…HAProxy</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">//ä¸‹è½½ä¾èµ–åŒ…<br>yum install gcc vim wget<br>//ä¸Šä¼ haproxyæºç åŒ…<br>//è§£å‹<br>tar -zxvf haproxy-1.6.5.tar.gz -C /usr/local<br>//è¿›å…¥ç›®å½•ã€è¿›è¡Œç¼–è¯‘ã€å®‰è£…<br>cd /usr/local/haproxy-1.6.5<br>make TARGET=linux31 PREFIX=/usr/local/haproxy<br>make install PREFIX=/usr/local/haproxy<br>mkdir /etc/haproxy<br>//èµ‹æƒ<br>groupadd -r -g 149 haproxy<br>useradd -g haproxy -r -s /sbin/nologin -u 149 haproxy<br>//åˆ›å»ºhaproxyé…ç½®æ–‡ä»¶<br>mkdir /etc/haproxy<br>vim /etc/haproxy/haproxy.cfg<br></code></pre></td></tr></table></figure><h5 id="3-5-2-é…ç½®HAProxy"><a href="#3-5-2-é…ç½®HAProxy" class="headerlink" title="3.5.2 é…ç½®HAProxy"></a>3.5.2 é…ç½®HAProxy</h5><p>é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/haproxy/haproxy.cfg</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">logging options</span><br>global<br>log 127.0.0.1 local0 info<br>maxconn 5120<br>chroot /usr/local/haproxy<br>uid 99<br>gid 99<br>daemon<br>quiet<br>nbproc 20<br>pidfile /var/run/haproxy.pid<br><br>defaults<br>log global<br><br>mode tcp<br><br>option tcplog<br>option dontlognull<br>retries 3<br>option redispatch<br>maxconn 2000<br>contimeout 5s<br>   <br>     clitimeout 60s<br><br>     srvtimeout 15s<br><span class="hljs-meta">#</span><span class="bash">front-end IP <span class="hljs-keyword">for</span> consumers and producters</span><br><br>listen rabbitmq_cluster<br>bind 0.0.0.0:5672<br><br>mode tcp<br><span class="hljs-meta">#</span><span class="bash">balance url_param userid</span><br><span class="hljs-meta">#</span><span class="bash">balance url_param session_id check_post 64</span><br><span class="hljs-meta">#</span><span class="bash">balance hdr(User-Agent)</span><br><span class="hljs-meta">#</span><span class="bash">balance hdr(host)</span><br><span class="hljs-meta">#</span><span class="bash">balance hdr(Host) use_domain_only</span><br><span class="hljs-meta">#</span><span class="bash">balance rdp-cookie</span><br><span class="hljs-meta">#</span><span class="bash">balance leastconn</span><br><span class="hljs-meta">#</span><span class="bash">balance <span class="hljs-built_in">source</span> //ip</span><br><br>balance roundrobin<br><br>        server node1 127.0.0.1:5673 check inter 5000 rise 2 fall 2<br>        server node2 127.0.0.1:5674 check inter 5000 rise 2 fall 2<br><br>listen stats<br>bind 172.16.98.133:8100<br>mode http<br>option httplog<br>stats enable<br>stats uri /rabbitmq-stats<br>stats refresh 5s<br></code></pre></td></tr></table></figure><p>å¯åŠ¨HAproxyè´Ÿè½½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">/usr/local/haproxy/sbin/haproxy -f /etc/haproxy/haproxy.cfg<br>//æŸ¥çœ‹haproxyè¿›ç¨‹çŠ¶æ€<br>ps -ef | grep haproxy<br><br>è®¿é—®å¦‚ä¸‹åœ°å€å¯¹mqèŠ‚ç‚¹è¿›è¡Œç›‘æ§<br>http://172.16.98.133:8100/rabbitmq-stats<br></code></pre></td></tr></table></figure><p>ä»£ç ä¸­è®¿é—®mqé›†ç¾¤åœ°å€ï¼Œåˆ™å˜ä¸ºè®¿é—®haproxyåœ°å€:5672</p>]]></content>
    
    
    <categories>
      
      <category>æœªå½’æ¡£</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MQæ¶ˆæ¯é˜Ÿåˆ—ä¸­é—´ä»¶çš„ä»‹ç»</title>
    <link href="/2021/02/22/MQ%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D/"/>
    <url>/2021/02/22/MQ%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<h1 id="MQæ¦‚è¿°"><a href="#MQæ¦‚è¿°" class="headerlink" title="MQæ¦‚è¿°"></a>MQæ¦‚è¿°</h1><p>MQå…¨ç§°ä¸ºMessage Queueï¼Œæ¶ˆæ¯é˜Ÿåˆ—æ˜¯åº”ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡æ–¹æ³•ã€‚</p><ul><li><p>ä¸ºä»€ä¹ˆä½¿ç”¨MQ</p><p>åœ¨é¡¹ç›®ä¸­ï¼Œå¯å°†ä¸€äº›æ— éœ€å³æ—¶è¿”å›ä¸”è€—æ—¶çš„æ“ä½œæå–å‡ºæ¥ï¼Œè¿›è¡Œ<strong>å¼‚æ­¥å¤„ç†</strong>ï¼Œè€Œè¿™ç§å¼‚æ­¥å¤„ç†çš„æ–¹å¼å¤§å¤§çš„èŠ‚çœäº†æœåŠ¡å™¨çš„è¯·æ±‚å“åº”æ—¶é—´ï¼Œä»è€Œ<strong>æé«˜</strong>äº†<strong>ç³»ç»Ÿ</strong>çš„<strong>ååé‡</strong>ã€‚</p></li></ul><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><ul><li><p>åº”ç”¨è§£è€¦ï¼šæé«˜ç³»ç»Ÿå®¹é”™æ€§å’Œå¯ç»´æŠ¤æ€§</p></li><li><p>å¼‚æ­¥æé€Ÿï¼šæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿååé‡</p></li><li><p>å‰Šå³°å¡«è°·ï¼šæé«˜ç³»ç»Ÿç¨³å®šæ€§</p><p>å¼€å‘ä¸­æ¶ˆæ¯é˜Ÿåˆ—é€šå¸¸æœ‰å¦‚ä¸‹åº”ç”¨åœºæ™¯ï¼š</p></li></ul><h3 id="1ã€ä»»åŠ¡å¼‚æ­¥å¤„ç†"><a href="#1ã€ä»»åŠ¡å¼‚æ­¥å¤„ç†" class="headerlink" title="1ã€ä»»åŠ¡å¼‚æ­¥å¤„ç†"></a>1ã€ä»»åŠ¡<strong>å¼‚æ­¥</strong>å¤„ç†</h3><p>å°†ä¸éœ€è¦åŒæ­¥å¤„ç†çš„å¹¶ä¸”è€—æ—¶é•¿çš„æ“ä½œç”±æ¶ˆæ¯é˜Ÿåˆ—é€šçŸ¥æ¶ˆæ¯æ¥æ”¶æ–¹è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚æé«˜äº†åº”ç”¨ç¨‹åºçš„å“åº”æ—¶é—´ã€‚</p><h3 id="2ã€åº”ç”¨ç¨‹åºè§£è€¦åˆ"><a href="#2ã€åº”ç”¨ç¨‹åºè§£è€¦åˆ" class="headerlink" title="2ã€åº”ç”¨ç¨‹åºè§£è€¦åˆ"></a>2ã€åº”ç”¨ç¨‹åºè§£è€¦åˆ</h3><p>MQç›¸å½“äºä¸€ä¸ªä¸­ä»‹ï¼Œç”Ÿäº§æ–¹é€šè¿‡MQä¸æ¶ˆè´¹æ–¹äº¤äº’ï¼Œå®ƒå°†åº”ç”¨ç¨‹åºè¿›è¡Œè§£è€¦åˆã€‚</p><h3 id="3ã€å‰Šå³°å¡«è°·"><a href="#3ã€å‰Šå³°å¡«è°·" class="headerlink" title="3ã€å‰Šå³°å¡«è°·"></a>3ã€å‰Šå³°å¡«è°·</h3><p>å¦‚è®¢å•ç³»ç»Ÿï¼Œåœ¨ä¸‹å•çš„æ—¶å€™å°±ä¼šå¾€æ•°æ®åº“å†™æ•°æ®ã€‚ä½†æ˜¯æ•°æ®åº“åªèƒ½æ”¯æ’‘æ¯ç§’1000å·¦å³çš„å¹¶å‘å†™å…¥ï¼Œå¹¶å‘é‡å†é«˜å°±å®¹æ˜“å®•æœºã€‚ä½å³°æœŸçš„æ—¶å€™å¹¶å‘ä¹Ÿå°±100å¤šä¸ªï¼Œä½†æ˜¯åœ¨é«˜å³°æœŸæ—¶å€™ï¼Œå¹¶å‘é‡ä¼šçªç„¶æ¿€å¢åˆ°5000ä»¥ä¸Šï¼Œè¿™ä¸ªæ—¶å€™æ•°æ®åº“è‚¯å®šå¡æ­»äº†ã€‚</p><p><img src="/2021/02/22/MQ%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D/01.jpg"></p><p>æ¶ˆæ¯è¢«MQä¿å­˜èµ·æ¥äº†ï¼Œç„¶åç³»ç»Ÿå°±å¯ä»¥æŒ‰ç…§è‡ªå·±çš„æ¶ˆè´¹èƒ½åŠ›æ¥æ¶ˆè´¹ï¼Œæ¯”å¦‚æ¯ç§’1000ä¸ªæ•°æ®ï¼Œè¿™æ ·æ…¢æ…¢å†™å…¥æ•°æ®åº“ï¼Œè¿™æ ·å°±ä¸ä¼šå¡æ­»æ•°æ®åº“äº†ã€‚</p><p><img src="/2021/02/22/MQ%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D/02.jpg"></p><p>ä½†æ˜¯ä½¿ç”¨äº†MQä¹‹åï¼Œé™åˆ¶æ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿåº¦ä¸º1000ï¼Œä½†æ˜¯è¿™æ ·ä¸€æ¥ï¼Œé«˜å³°æœŸäº§ç”Ÿçš„æ•°æ®åŠ¿å¿…ä¼šè¢«ç§¯å‹åœ¨MQä¸­ï¼Œé«˜å³°å°±è¢«â€œå‰Šâ€æ‰äº†ã€‚ä½†æ˜¯å› ä¸ºæ¶ˆæ¯ç§¯å‹ï¼Œåœ¨é«˜å³°æœŸè¿‡åçš„ä¸€æ®µæ—¶é—´å†…ï¼Œæ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿåº¦è¿˜æ˜¯ä¼šç»´æŒåœ¨1000QPSï¼Œç›´åˆ°æ¶ˆè´¹å®Œç§¯å‹çš„æ¶ˆæ¯,è¿™å°±å«åšâ€œå¡«è°·â€</p><p><img src="/2021/02/22/MQ%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BB%8B%E7%BB%8D/03.jpg"></p><p>ä½¿ç”¨MQåï¼Œå¯ä»¥æé«˜ç³»ç»Ÿç¨³å®šæ€§</p><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p><strong>ç³»ç»Ÿå¯ç”¨æ€§é™ä½</strong></p><p>ç³»ç»Ÿå¼•å…¥çš„å¤–éƒ¨ä¾èµ–è¶Šå¤šï¼Œç³»ç»Ÿç¨³å®šæ€§è¶Šå·®ã€‚ä¸€æ—¦ MQ å®•æœºï¼Œå°±ä¼šå¯¹ä¸šåŠ¡é€ æˆå½±å“ã€‚å¦‚ä½•ä¿è¯MQçš„é«˜å¯ç”¨ï¼Ÿ</p><p><strong>ç³»ç»Ÿå¤æ‚åº¦æé«˜</strong></p><p>MQ çš„åŠ å…¥å¤§å¤§å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œä»¥å‰ç³»ç»Ÿé—´æ˜¯åŒæ­¥çš„è¿œç¨‹è°ƒç”¨ï¼Œç°åœ¨æ˜¯é€šè¿‡ MQ è¿›è¡Œå¼‚æ­¥è°ƒç”¨ã€‚å¦‚ä½•ä¿è¯æ¶ˆæ¯æ²¡æœ‰è¢«é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆå¤„ç†æ¶ˆæ¯ä¸¢å¤±æƒ…å†µï¼Ÿé‚£ä¹ˆä¿è¯æ¶ˆæ¯ä¼ é€’çš„é¡ºåºæ€§ï¼Ÿ</p><p><strong>ä¸€è‡´æ€§é—®é¢˜</strong></p><p>A ç³»ç»Ÿå¤„ç†å®Œä¸šåŠ¡ï¼Œé€šè¿‡ MQ ç»™Bã€Cã€Dä¸‰ä¸ªç³»ç»Ÿå‘æ¶ˆæ¯æ•°æ®ï¼Œå¦‚æœ B ç³»ç»Ÿã€C ç³»ç»Ÿå¤„ç†æˆåŠŸï¼ŒD ç³»ç»Ÿå¤„ç†å¤±è´¥ã€‚å¦‚ä½•ä¿è¯æ¶ˆæ¯æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§ï¼Ÿ</p><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>æ—¢ç„¶ MQ æœ‰ä¼˜åŠ¿ä¹Ÿæœ‰åŠ£åŠ¿ï¼Œé‚£ä¹ˆä½¿ç”¨ MQ éœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶</p><ol><li><p>ç”Ÿäº§è€…ä¸éœ€è¦ä»æ¶ˆè´¹è€…å¤„è·å¾—åé¦ˆã€‚å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¹‹å‰çš„ç›´æ¥è°ƒç”¨ï¼Œå…¶æ¥å£çš„è¿”å›å€¼åº”è¯¥ä¸ºç©ºï¼Œè¿™æ‰è®©æ˜æ˜ä¸‹å±‚çš„åŠ¨ä½œè¿˜æ²¡åšï¼Œä¸Šå±‚å´å½“æˆåŠ¨ä½œåšå®Œäº†ç»§ç»­å¾€åèµ°ï¼Œå³æ‰€è°“å¼‚æ­¥æˆä¸ºäº†å¯èƒ½ã€‚</p></li><li><p>å®¹è®¸çŸ­æš‚çš„ä¸ä¸€è‡´æ€§ã€‚</p></li><li><p>ç¡®å®æ˜¯ç”¨äº†æœ‰æ•ˆæœã€‚å³è§£è€¦ã€æé€Ÿã€å‰Šå³°è¿™äº›æ–¹é¢çš„æ”¶ç›Šï¼Œè¶…è¿‡åŠ å…¥MQï¼Œç®¡ç†MQè¿™äº›æˆæœ¬ã€‚</p></li></ol><h1 id="AMQP-å’Œ-JMS"><a href="#AMQP-å’Œ-JMS" class="headerlink" title="AMQP å’Œ JMS"></a>AMQP å’Œ JMS</h1><p>MQæ˜¯æ¶ˆæ¯é€šä¿¡çš„æ¨¡å‹ï¼›å®ç°MQçš„å¤§è‡´æœ‰ä¸¤ç§ä¸»æµæ–¹å¼ï¼šAMQPã€JMSã€‚</p><h2 id="AMQP"><a href="#AMQP" class="headerlink" title="AMQP"></a>AMQP</h2><p>AMQPæ˜¯ä¸€ç§åè®®ï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯ä¸€ç§binary wire-level protocolï¼ˆé“¾æ¥åè®®ï¼‰ã€‚è¿™æ˜¯å…¶å’ŒJMSçš„æœ¬è´¨å·®åˆ«ï¼ŒAMQPä¸ä»APIå±‚è¿›è¡Œé™å®šï¼Œè€Œæ˜¯ç›´æ¥å®šä¹‰ç½‘ç»œäº¤æ¢çš„æ•°æ®æ ¼å¼ã€‚</p><h2 id="JMS"><a href="#JMS" class="headerlink" title="JMS"></a>JMS</h2><p>JMSå³Javaæ¶ˆæ¯æœåŠ¡ï¼ˆJavaMessage Serviceï¼‰åº”ç”¨ç¨‹åºæ¥å£ï¼Œæ˜¯ä¸€ä¸ªJavaå¹³å°ä¸­å…³äºé¢å‘æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMOMï¼‰çš„APIï¼Œç”¨äºåœ¨ä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´ï¼Œæˆ–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥é€šä¿¡ã€‚</p><h2 id="AMQP-ä¸-JMS-åŒºåˆ«"><a href="#AMQP-ä¸-JMS-åŒºåˆ«" class="headerlink" title="AMQP ä¸ JMS åŒºåˆ«"></a>AMQP ä¸ JMS åŒºåˆ«</h2><ul><li>JMSæ˜¯å®šä¹‰äº†ç»Ÿä¸€çš„æ¥å£ï¼Œæ¥å¯¹æ¶ˆæ¯æ“ä½œè¿›è¡Œç»Ÿä¸€ï¼›AMQPæ˜¯é€šè¿‡è§„å®šåè®®æ¥ç»Ÿä¸€æ•°æ®äº¤äº’çš„æ ¼å¼</li><li>JMSé™å®šäº†å¿…é¡»ä½¿ç”¨Javaè¯­è¨€ï¼›AMQPåªæ˜¯åè®®ï¼Œä¸è§„å®šå®ç°æ–¹å¼ï¼Œå› æ­¤æ˜¯è·¨è¯­è¨€çš„ã€‚</li><li>JMSè§„å®šäº†ä¸¤ç§æ¶ˆæ¯æ¨¡å¼ï¼›è€ŒAMQPçš„æ¶ˆæ¯æ¨¡å¼æ›´åŠ ä¸°å¯Œ</li></ul><h1 id="å¸¸è§çš„-MQ-äº§å“å¯¹æ¯”"><a href="#å¸¸è§çš„-MQ-äº§å“å¯¹æ¯”" class="headerlink" title="å¸¸è§çš„ MQ äº§å“å¯¹æ¯”"></a>å¸¸è§çš„ MQ äº§å“å¯¹æ¯”</h1><ul><li>ActiveMQï¼šåŸºäºJMS</li><li>ZeroMQï¼šåŸºäºCè¯­è¨€å¼€å‘</li><li>RabbitMQï¼šåŸºäºAMQPåè®®ï¼Œerlangè¯­è¨€å¼€å‘ï¼Œç¨³å®šæ€§å¥½</li><li>RocketMQï¼šåŸºäºJMSï¼Œé˜¿é‡Œå·´å·´äº§å“</li><li>Kafkaï¼šç±»ä¼¼MQçš„äº§å“ï¼›åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œé«˜ååé‡</li></ul><table><thead><tr><th></th><th><strong>RabbitMQ</strong></th><th><strong>ActiveMQ</strong></th><th><strong>RocketMQ</strong></th><th align="left"><strong>Kafka</strong></th></tr></thead><tbody><tr><td>å…¬å¸/ç¤¾åŒº</td><td>Rabbit</td><td>Apache</td><td>é˜¿é‡Œ</td><td align="left">Apache</td></tr><tr><td>å¼€å‘è¯­è¨€</td><td>Erlang</td><td>Java</td><td>Java</td><td align="left">Scala&amp;Java</td></tr><tr><td>åè®®æ”¯æŒ</td><td>AMQPï¼ŒXMPPï¼ŒSMTPï¼ŒSTOMP</td><td>OpenWire,STOMPï¼ŒREST,XMPP,AMQP</td><td>è‡ªå®šä¹‰</td><td align="left">è‡ªå®šä¹‰åè®®ï¼Œç¤¾åŒºå°è£…äº†httpåè®®æ”¯æŒ</td></tr><tr><td>å®¢æˆ·ç«¯æ”¯æŒè¯­è¨€</td><td>å®˜æ–¹æ”¯æŒErlangï¼ŒJavaï¼ŒRubyç­‰,ç¤¾åŒºäº§å‡ºå¤šç§APIï¼Œå‡ ä¹æ”¯æŒæ‰€æœ‰è¯­è¨€</td><td>Javaï¼ŒCï¼ŒC++ï¼ŒPythonï¼ŒPHPï¼ŒPerlï¼Œ.netç­‰</td><td>Javaï¼ŒC++ï¼ˆä¸æˆç†Ÿï¼‰</td><td align="left">å®˜æ–¹æ”¯æŒJava,ç¤¾åŒºäº§å‡ºå¤šç§APIï¼Œå¦‚PHPï¼ŒPythonç­‰</td></tr><tr><td>å•æœºååé‡</td><td>ä¸‡çº§ï¼ˆå…¶æ¬¡ï¼‰</td><td>ä¸‡çº§ï¼ˆæœ€å·®ï¼‰</td><td>åä¸‡çº§ï¼ˆæœ€å¥½ï¼‰</td><td align="left">åä¸‡çº§ï¼ˆæ¬¡ä¹‹ï¼‰</td></tr><tr><td>æ¶ˆæ¯å»¶è¿Ÿ</td><td>å¾®å¦™çº§</td><td>æ¯«ç§’çº§</td><td>æ¯«ç§’çº§</td><td align="left">æ¯«ç§’ä»¥å†…</td></tr><tr><td>åŠŸèƒ½ç‰¹æ€§</td><td>å¹¶å‘èƒ½åŠ›å¼ºï¼Œæ€§èƒ½æå…¶å¥½ï¼Œå»¶æ—¶ä½ï¼Œç¤¾åŒºæ´»è·ƒï¼Œç®¡ç†ç•Œé¢ä¸°å¯Œ</td><td>è€ç‰Œäº§å“ï¼Œæˆç†Ÿåº¦é«˜ï¼Œæ–‡æ¡£è¾ƒå¤š</td><td>MQåŠŸèƒ½æ¯”è¾ƒå®Œå¤‡ï¼Œæ‰©å±•æ€§ä½³</td><td align="left">åªæ”¯æŒä¸»è¦çš„MQåŠŸèƒ½ï¼Œæ¯•ç«Ÿæ˜¯ä¸ºå¤§æ•°æ®é¢†åŸŸå‡†å¤‡çš„ã€‚</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>æœªå½’æ¡£</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQå­¦ä¹ ç¬”è®°</title>
    <link href="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="RabbitMQç®€ä»‹"><a href="#RabbitMQç®€ä»‹" class="headerlink" title="RabbitMQç®€ä»‹"></a>RabbitMQç®€ä»‹</h1><p>RabbitMQæ˜¯ç”±erlangè¯­è¨€å¼€å‘ï¼ŒåŸºäºAMQPï¼ˆAdvanced Message Queue é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼‰åè®®å®ç°çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒæ˜¯ä¸€ç§åº”ç”¨ç¨‹åºä¹‹é—´çš„é€šä¿¡æ–¹æ³•ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘ä¸­åº”ç”¨éå¸¸å¹¿æ³›ã€‚</p><p>RabbitMQå®˜æ–¹åœ°å€ï¼š<a href="http://www.rabbitmq.com/">http://www.rabbitmq.com/</a></p><p>RabbitMQæä¾›äº†6ç§æ¨¡å¼ï¼š</p><ul><li>ç®€å•æ¨¡å¼</li><li>workæ¨¡å¼</li><li>Publish/Subscribeå‘å¸ƒä¸è®¢é˜…æ¨¡å¼</li><li>Routingè·¯ç”±æ¨¡å¼</li><li>Topicsä¸»é¢˜æ¨¡å¼</li><li>RPCè¿œç¨‹è°ƒç”¨æ¨¡å¼ï¼ˆè¿œç¨‹è°ƒç”¨ï¼Œä¸å¤ªç®—MQï¼›æš‚ä¸ä½œä»‹ç»ï¼‰ï¼›</li></ul><p>å®˜ç½‘å¯¹åº”æ¨¡å¼ä»‹ç»ï¼š<a href="https://www.rabbitmq.com/getstarted.html">https://www.rabbitmq.com/getstarted.html</a></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1555988678324.png" alt="1555988678324"></p><h1 id="å¯åŠ¨rabbitmq"><a href="#å¯åŠ¨rabbitmq" class="headerlink" title="å¯åŠ¨rabbitmq"></a><strong>å¯åŠ¨rabbitmq</strong></h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl enable rabbitmq-server<br><br>systemctl start rabbitmq-server<br><br>systemctl status rabbitmq-server<br></code></pre></td></tr></table></figure><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223160424490-1616241671832.png" alt="image-20210223160424490"></p><p>æµ‹è¯•ï¼šIP:15672</p><h1 id="ç®¡æ§å°æ·»åŠ ç”¨æˆ·åŠè™šæ‹Ÿæœº"><a href="#ç®¡æ§å°æ·»åŠ ç”¨æˆ·åŠè™šæ‹Ÿæœº" class="headerlink" title="ç®¡æ§å°æ·»åŠ ç”¨æˆ·åŠè™šæ‹Ÿæœº"></a>ç®¡æ§å°æ·»åŠ ç”¨æˆ·åŠè™šæ‹Ÿæœº</h1><p>æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®adminæƒé™</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223213219690.png" alt="image-20210223213219690"></p><p>æ·»åŠ è™šæ‹Ÿæœº</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223213350944.png" alt="image-20210223213350944"></p><p>ç‚¹å‡»æ­¤è™šæ‹Ÿæœºï¼Œè®¾ç½®ç”¨æˆ·è®¿é—®æ­¤è™šæ‹Ÿæœº</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223213749299.png" alt="image-20210223213749299"></p><p>é€€å‡ºé‡æ–°ç™»é™†æ–°è®¾ç½®ç”¨æˆ·</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223213912977.png" alt="image-20210223213912977"></p><h1 id="å…­ç§å·¥ä½œæ¨¡å¼çš„å®ç°"><a href="#å…­ç§å·¥ä½œæ¨¡å¼çš„å®ç°" class="headerlink" title="å…­ç§å·¥ä½œæ¨¡å¼çš„å®ç°"></a>å…­ç§å·¥ä½œæ¨¡å¼çš„å®ç°</h1><p>RabbitMQåŸºç¡€æ¶æ„å›¾</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223215519211.png" alt="image-20210223215519211"></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223215113592.png" alt="image-20210223215113592"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--rabbitmq java å®¢æˆ·ç«¯--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.rabbitmq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>amqp-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.6.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.8.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">source</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">target</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨æ‰€æœ‰pomä¸­éƒ½è¦åŠ å…¥ä¸Šè¿°ä¾èµ–</p><h2 id="ç®€å•æ¨¡å¼"><a href="#ç®€å•æ¨¡å¼" class="headerlink" title="ç®€å•æ¨¡å¼"></a>ç®€å•æ¨¡å¼</h2><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223215250866.png" alt="image-20210223215250866"></p><p><strong>producer_Helloworld.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.producer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‘é€æ¶ˆæ¯</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer_HelloWorld</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br>        <span class="hljs-comment">//5. åˆ›å»ºé˜Ÿåˆ—Queue</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. durable:æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯ä¹‹åï¼Œè¿˜åœ¨</span><br><span class="hljs-comment">            3. exclusiveï¼š</span><br><span class="hljs-comment">                * æ˜¯å¦ç‹¬å ã€‚åªèƒ½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ç›‘å¬è¿™é˜Ÿåˆ—</span><br><span class="hljs-comment">                * å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span><br><span class="hljs-comment">                *</span><br><span class="hljs-comment">            4. autoDelete:æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span><br><span class="hljs-comment">            5. argumentsï¼šå‚æ•°ã€‚</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªåå­—å«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰åˆ™ä¸ä¼šåˆ›å»º</span><br>        channel.queueDeclare(<span class="hljs-string">&quot;hello_world&quot;</span>,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicPublish(String exchange, String routingKey, BasicProperties props, byte[] body)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. exchangeï¼šäº¤æ¢æœºåç§°ã€‚ç®€å•æ¨¡å¼ä¸‹äº¤æ¢æœºä¼šä½¿ç”¨é»˜è®¤çš„ &quot;&quot;</span><br><span class="hljs-comment">            2. routingKeyï¼šè·¯ç”±åç§°</span><br><span class="hljs-comment">            3. propsï¼šé…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">            4. bodyï¼šå‘é€æ¶ˆæ¯æ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br><br>        String body = <span class="hljs-string">&quot;hello rabbitmq~~~&quot;</span>;<br><br>        <span class="hljs-comment">//6. å‘é€æ¶ˆæ¯</span><br>        channel.basicPublish(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;hello_world&quot;</span>,<span class="hljs-keyword">null</span>,body.getBytes());<br><br><br>        <span class="hljs-comment">//7.é‡Šæ”¾èµ„æº</span><br>      channel.close();<br>      connection.close();<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œç”Ÿäº§è€…</p><p><strong>Consumer_Helloworld.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_HelloWorld</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br>        <span class="hljs-comment">//5. åˆ›å»ºé˜Ÿåˆ—Queue</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. durable:æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯ä¹‹åï¼Œè¿˜åœ¨</span><br><span class="hljs-comment">            3. exclusiveï¼š</span><br><span class="hljs-comment">                * æ˜¯å¦ç‹¬å ã€‚åªèƒ½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ç›‘å¬è¿™é˜Ÿåˆ—</span><br><span class="hljs-comment">                * å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span><br><span class="hljs-comment">                *</span><br><span class="hljs-comment">            4. autoDelete:æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span><br><span class="hljs-comment">            5. argumentsï¼šå‚æ•°ã€‚</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªåå­—å«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰åˆ™ä¸ä¼šåˆ›å»º</span><br>        channel.queueDeclare(<span class="hljs-string">&quot;hello_world&quot;</span>,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>                System.out.println(<span class="hljs-string">&quot;consumerTagï¼š&quot;</span>+consumerTag);<br>                System.out.println(<span class="hljs-string">&quot;Exchangeï¼š&quot;</span>+envelope.getExchange());<br>                System.out.println(<span class="hljs-string">&quot;RoutingKeyï¼š&quot;</span>+envelope.getRoutingKey());<br>                System.out.println(<span class="hljs-string">&quot;propertiesï¼š&quot;</span>+properties);<br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(<span class="hljs-string">&quot;hello_world&quot;</span>,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œæ¶ˆè´¹è€…</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223214624036.png" alt="image-20210223214624036"></p><p>åŒæ—¶å¯ä»¥çœ‹è§æ§åˆ¶å°çš„å˜åŒ–</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223214658662.png" alt="image-20210223214658662"></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223214722175.png" alt="image-20210223214722175"></p><h2 id="WorkQueueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼"><a href="#WorkQueueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼" class="headerlink" title="WorkQueueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼"></a><strong>WorkQueueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼</strong></h2><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223220853733.png" alt="image-20210223220853733"></p><p>åŒç®€å•æ¨¡å¼ä»£ç è®¾ç½®ä¸¤ä¸ªä¸€æ ·çš„æ¶ˆè´¹è€…å³å¯</p><p><strong>Producer_WorkQueues.java</strong></p><p>ç”Ÿäº§è€…ä¸€æ¬¡æ€§ç”Ÿäº§å¤šä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.producer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‘é€æ¶ˆæ¯</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer_WorkQueues</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;172.16.98.133&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;heima&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;heima&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br>        <span class="hljs-comment">//5. åˆ›å»ºé˜Ÿåˆ—Queue</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. durable:æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯ä¹‹åï¼Œè¿˜åœ¨</span><br><span class="hljs-comment">            3. exclusiveï¼š</span><br><span class="hljs-comment">                * æ˜¯å¦ç‹¬å ã€‚åªèƒ½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ç›‘å¬è¿™é˜Ÿåˆ—</span><br><span class="hljs-comment">                * å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span><br><span class="hljs-comment">                *</span><br><span class="hljs-comment">            4. autoDelete:æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span><br><span class="hljs-comment">            5. argumentsï¼šå‚æ•°ã€‚</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªåå­—å«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰åˆ™ä¸ä¼šåˆ›å»º</span><br>        channel.queueDeclare(<span class="hljs-string">&quot;work_queues&quot;</span>,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicPublish(String exchange, String routingKey, BasicProperties props, byte[] body)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. exchangeï¼šäº¤æ¢æœºåç§°ã€‚ç®€å•æ¨¡å¼ä¸‹äº¤æ¢æœºä¼šä½¿ç”¨é»˜è®¤çš„ &quot;&quot;</span><br><span class="hljs-comment">            2. routingKeyï¼šè·¯ç”±åç§°</span><br><span class="hljs-comment">            3. propsï¼šé…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">            4. bodyï¼šå‘é€æ¶ˆæ¯æ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++) &#123;<br>            String body = i+<span class="hljs-string">&quot;hello rabbitmq~~~&quot;</span>;<br><br>            <span class="hljs-comment">//6. å‘é€æ¶ˆæ¯</span><br>            channel.basicPublish(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;work_queues&quot;</span>,<span class="hljs-keyword">null</span>,body.getBytes());<br>        &#125;<br><br>        <span class="hljs-comment">//7.é‡Šæ”¾èµ„æº</span><br>      channel.close();<br>      connection.close();<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç”Ÿäº§è€…</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223221340543.png" alt="image-20210223221340543"></p><p><strong>Consumer_WorkQueues1.java</strong></p><p><strong>Consumer_WorkQueues2.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_WorkQueues1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br>        <span class="hljs-comment">//5. åˆ›å»ºé˜Ÿåˆ—Queue</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. durable:æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯ä¹‹åï¼Œè¿˜åœ¨</span><br><span class="hljs-comment">            3. exclusiveï¼š</span><br><span class="hljs-comment">                * æ˜¯å¦ç‹¬å ã€‚åªèƒ½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ç›‘å¬è¿™é˜Ÿåˆ—</span><br><span class="hljs-comment">                * å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span><br><span class="hljs-comment">                *</span><br><span class="hljs-comment">            4. autoDelete:æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span><br><span class="hljs-comment">            5. argumentsï¼šå‚æ•°ã€‚</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªåå­—å«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰åˆ™ä¸ä¼šåˆ›å»º</span><br>        channel.queueDeclare(<span class="hljs-string">&quot;work_queues&quot;</span>,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(<span class="hljs-string">&quot;work_queues&quot;</span>,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åŒæ—¶å¼€å¯ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…å±äºç«äº‰å…³ç³»</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210223221747421.png" alt="image-20210223221747421"></p><h2 id="Pub-Subè®¢é˜…æ¨¡å¼"><a href="#Pub-Subè®¢é˜…æ¨¡å¼" class="headerlink" title="Pub/Subè®¢é˜…æ¨¡å¼"></a>Pub/Subè®¢é˜…æ¨¡å¼</h2><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224150909741.png" alt="image-20210224150909741"></p><p><strong>Producer_PubSub.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.producer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‘é€æ¶ˆæ¯</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer_PubSub</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br>       <span class="hljs-comment">/*</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">       exchangeDeclare(String exchange, BuiltinExchangeType type, boolean durable, boolean autoDelete, boolean internal, Map&lt;String, Object&gt; arguments)</span><br><span class="hljs-comment">       å‚æ•°ï¼š</span><br><span class="hljs-comment">        1. exchange:äº¤æ¢æœºåç§°</span><br><span class="hljs-comment">        2. type:äº¤æ¢æœºç±»å‹</span><br><span class="hljs-comment">            DIRECT(&quot;direct&quot;),ï¼šå®šå‘</span><br><span class="hljs-comment">            FANOUT(&quot;fanout&quot;),ï¼šæ‰‡å½¢ï¼ˆå¹¿æ’­ï¼‰ï¼Œå‘é€æ¶ˆæ¯åˆ°æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šé˜Ÿåˆ—ã€‚</span><br><span class="hljs-comment">            TOPIC(&quot;topic&quot;),é€šé…ç¬¦çš„æ–¹å¼</span><br><span class="hljs-comment">            HEADERS(&quot;headers&quot;);å‚æ•°åŒ¹é…</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        3. durable:æ˜¯å¦æŒä¹…åŒ–</span><br><span class="hljs-comment">        4. autoDelete:è‡ªåŠ¨åˆ é™¤</span><br><span class="hljs-comment">        5. internalï¼šå†…éƒ¨ä½¿ç”¨ã€‚ ä¸€èˆ¬false</span><br><span class="hljs-comment">        6. argumentsï¼šå‚æ•°</span><br><span class="hljs-comment">        */</span><br><br>       String exchangeName = <span class="hljs-string">&quot;test_fanout&quot;</span>;<br>        <span class="hljs-comment">//5. åˆ›å»ºäº¤æ¢æœº</span><br>        channel.exchangeDeclare(exchangeName, BuiltinExchangeType.FANOUT,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        <span class="hljs-comment">//6. åˆ›å»ºé˜Ÿåˆ—</span><br>        String queue1Name = <span class="hljs-string">&quot;test_fanout_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_fanout_queue2&quot;</span>;<br>        channel.queueDeclare(queue1Name,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        channel.queueDeclare(queue2Name,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        <span class="hljs-comment">//7. ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        queueBind(String queue, String exchange, String routingKey)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. exchangeï¼šäº¤æ¢æœºåç§°</span><br><span class="hljs-comment">            3. routingKeyï¼šè·¯ç”±é”®ï¼Œç»‘å®šè§„åˆ™</span><br><span class="hljs-comment">                å¦‚æœäº¤æ¢æœºçš„ç±»å‹ä¸ºfanout ï¼ŒroutingKeyè®¾ç½®ä¸º&quot;&quot;</span><br><span class="hljs-comment">         */</span><br>        channel.queueBind(queue1Name,exchangeName,<span class="hljs-string">&quot;&quot;</span>);<br>        channel.queueBind(queue2Name,exchangeName,<span class="hljs-string">&quot;&quot;</span>);<br><br>        String body = <span class="hljs-string">&quot;æ—¥å¿—ä¿¡æ¯ï¼šå¼ ä¸‰è°ƒç”¨äº†findAllæ–¹æ³•...æ—¥å¿—çº§åˆ«ï¼šinfo...&quot;</span>;<br>        <span class="hljs-comment">//8. å‘é€æ¶ˆæ¯</span><br>        channel.basicPublish(exchangeName,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-keyword">null</span>,body.getBytes());<br><br>        <span class="hljs-comment">//9. é‡Šæ”¾èµ„æº</span><br>        channel.close();<br>        connection.close();<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Consumer_PubSub1</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_PubSub1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_fanout_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_fanout_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment">a</span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°.....&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue1Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Consumer_PubSub2</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_PubSub2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_fanout_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_fanout_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯ä¿å­˜æ•°æ®åº“.....&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue2Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="Routingè·¯ç”±æ¨¡å¼"><a href="#Routingè·¯ç”±æ¨¡å¼" class="headerlink" title="Routingè·¯ç”±æ¨¡å¼"></a>Routingè·¯ç”±æ¨¡å¼</h2><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224151059609.png" alt="image-20210224151059609"></p><p><strong>Producer_Routing.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_PubSub2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_fanout_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_fanout_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯ä¿å­˜æ•°æ®åº“.....&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue2Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Consumer_Routing1.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_Routing1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_direct_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_direct_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°.....&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue2Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Consumer_Routing2.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_Routing2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_direct_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_direct_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯å­˜å‚¨åˆ°æ•°æ®åº“.....&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue1Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="Topicé€šé…ç¬¦æ¨¡å¼"><a href="#Topicé€šé…ç¬¦æ¨¡å¼" class="headerlink" title="Topicé€šé…ç¬¦æ¨¡å¼"></a>Topicé€šé…ç¬¦æ¨¡å¼</h2><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224151136431.png" alt="image-20210224151136431"></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224151212740.png" alt="image-20210224151212740"></p><p><strong>Producer_Topic.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.producer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.BuiltinExchangeType;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;<br><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‘é€æ¶ˆæ¯</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Producer_Topics</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br>       <span class="hljs-comment">/*</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">       exchangeDeclare(String exchange, BuiltinExchangeType type, boolean durable, boolean autoDelete, boolean internal, Map&lt;String, Object&gt; arguments)</span><br><span class="hljs-comment">       å‚æ•°ï¼š</span><br><span class="hljs-comment">        1. exchange:äº¤æ¢æœºåç§°</span><br><span class="hljs-comment">        2. type:äº¤æ¢æœºç±»å‹</span><br><span class="hljs-comment">            DIRECT(&quot;direct&quot;),ï¼šå®šå‘</span><br><span class="hljs-comment">            FANOUT(&quot;fanout&quot;),ï¼šæ‰‡å½¢ï¼ˆå¹¿æ’­ï¼‰ï¼Œå‘é€æ¶ˆæ¯åˆ°æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šé˜Ÿåˆ—ã€‚</span><br><span class="hljs-comment">            TOPIC(&quot;topic&quot;),é€šé…ç¬¦çš„æ–¹å¼</span><br><span class="hljs-comment">            HEADERS(&quot;headers&quot;);å‚æ•°åŒ¹é…</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">        3. durable:æ˜¯å¦æŒä¹…åŒ–</span><br><span class="hljs-comment">        4. autoDelete:è‡ªåŠ¨åˆ é™¤</span><br><span class="hljs-comment">        5. internalï¼šå†…éƒ¨ä½¿ç”¨ã€‚ ä¸€èˆ¬false</span><br><span class="hljs-comment">        6. argumentsï¼šå‚æ•°</span><br><span class="hljs-comment">        */</span><br><br>       String exchangeName = <span class="hljs-string">&quot;test_topic&quot;</span>;<br>        <span class="hljs-comment">//5. åˆ›å»ºäº¤æ¢æœº</span><br>        channel.exchangeDeclare(exchangeName, BuiltinExchangeType.TOPIC,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        <span class="hljs-comment">//6. åˆ›å»ºé˜Ÿåˆ—</span><br>        String queue1Name = <span class="hljs-string">&quot;test_topic_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_topic_queue2&quot;</span>;<br>        channel.queueDeclare(queue1Name,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        channel.queueDeclare(queue2Name,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">false</span>,<span class="hljs-keyword">null</span>);<br>        <span class="hljs-comment">//7. ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        queueBind(String queue, String exchange, String routingKey)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. exchangeï¼šäº¤æ¢æœºåç§°</span><br><span class="hljs-comment">            3. routingKeyï¼šè·¯ç”±é”®ï¼Œç»‘å®šè§„åˆ™</span><br><span class="hljs-comment">                å¦‚æœäº¤æ¢æœºçš„ç±»å‹ä¸ºfanout ï¼ŒroutingKeyè®¾ç½®ä¸º&quot;&quot;</span><br><span class="hljs-comment">         */</span><br><br>        <span class="hljs-comment">// routing key  ç³»ç»Ÿçš„åç§°.æ—¥å¿—çš„çº§åˆ«ã€‚</span><br>        <span class="hljs-comment">//=éœ€æ±‚ï¼š æ‰€æœ‰errorçº§åˆ«çš„æ—¥å¿—å­˜å…¥æ•°æ®åº“ï¼Œæ‰€æœ‰orderç³»ç»Ÿçš„æ—¥å¿—å­˜å…¥æ•°æ®åº“</span><br>        channel.queueBind(queue1Name,exchangeName,<span class="hljs-string">&quot;#.error&quot;</span>);<br>        channel.queueBind(queue1Name,exchangeName,<span class="hljs-string">&quot;order.*&quot;</span>);<br>        channel.queueBind(queue2Name,exchangeName,<span class="hljs-string">&quot;*.*&quot;</span>);<br><br>        String body = <span class="hljs-string">&quot;æ—¥å¿—ä¿¡æ¯ï¼šå¼ ä¸‰è°ƒç”¨äº†findAllæ–¹æ³•...æ—¥å¿—çº§åˆ«ï¼šinfo...&quot;</span>;<br>        <span class="hljs-comment">//8. å‘é€æ¶ˆæ¯</span><br>        channel.basicPublish(exchangeName,<span class="hljs-string">&quot;goods.error&quot;</span>,<span class="hljs-keyword">null</span>,body.getBytes());<br><br>        <span class="hljs-comment">//9. é‡Šæ”¾èµ„æº</span><br>        channel.close();<br>        connection.close();<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Consumer_Topic1.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_Topic1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_topic_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_topic_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯å­˜å…¥æ•°æ®åº“.......&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue1Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>Consumer_Topic.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.consumer;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.*;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.concurrent.TimeoutException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Consumer_Topic2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, TimeoutException </span>&#123;<br><br>        <span class="hljs-comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span><br>        ConnectionFactory factory = <span class="hljs-keyword">new</span> ConnectionFactory();<br>        <span class="hljs-comment">//2. è®¾ç½®å‚æ•°</span><br>        factory.setHost(<span class="hljs-string">&quot;192.168.91.130&quot;</span>);<span class="hljs-comment">//ip  é»˜è®¤å€¼ localhost</span><br>        factory.setPort(<span class="hljs-number">5672</span>); <span class="hljs-comment">//ç«¯å£  é»˜è®¤å€¼ 5672</span><br>        factory.setVirtualHost(<span class="hljs-string">&quot;/itcast&quot;</span>);<span class="hljs-comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span><br>        factory.setUsername(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//ç”¨æˆ·å é»˜è®¤ guest</span><br>        factory.setPassword(<span class="hljs-string">&quot;mochen&quot;</span>);<span class="hljs-comment">//å¯†ç  é»˜è®¤å€¼ guest</span><br>        <span class="hljs-comment">//3. åˆ›å»ºè¿æ¥ Connection</span><br>        Connection connection = factory.newConnection();<br>        <span class="hljs-comment">//4. åˆ›å»ºChannel</span><br>        Channel channel = connection.createChannel();<br><br><br>        String queue1Name = <span class="hljs-string">&quot;test_topic_queue1&quot;</span>;<br>        String queue2Name = <span class="hljs-string">&quot;test_topic_queue2&quot;</span>;<br><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        basicConsume(String queue, boolean autoAck, Consumer callback)</span><br><span class="hljs-comment">        å‚æ•°ï¼š</span><br><span class="hljs-comment">            1. queueï¼šé˜Ÿåˆ—åç§°</span><br><span class="hljs-comment">            2. autoAckï¼šæ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span><br><span class="hljs-comment">            3. callbackï¼šå›è°ƒå¯¹è±¡</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span><br>        Consumer consumer = <span class="hljs-keyword">new</span> DefaultConsumer(channel)&#123;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">                å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">                1. consumerTagï¼šæ ‡è¯†</span><br><span class="hljs-comment">                2. envelopeï¼šè·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span><br><span class="hljs-comment">                3. properties:é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">                4. bodyï¼šæ•°æ®</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleDelivery</span><span class="hljs-params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="hljs-keyword">byte</span>[] body)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>              <span class="hljs-comment">/*  System.out.println(&quot;consumerTagï¼š&quot;+consumerTag);</span><br><span class="hljs-comment">                System.out.println(&quot;Exchangeï¼š&quot;+envelope.getExchange());</span><br><span class="hljs-comment">                System.out.println(&quot;RoutingKeyï¼š&quot;+envelope.getRoutingKey());</span><br><span class="hljs-comment">                System.out.println(&quot;propertiesï¼š&quot;+properties);*/</span><br>                System.out.println(<span class="hljs-string">&quot;bodyï¼š&quot;</span>+<span class="hljs-keyword">new</span> String(body));<br>                System.out.println(<span class="hljs-string">&quot;å°†æ—¥å¿—ä¿¡æ¯æ‰“å°æ§åˆ¶å°.......&quot;</span>);<br>            &#125;<br>        &#125;;<br>        channel.basicConsume(queue2Name,<span class="hljs-keyword">true</span>,consumer);<br><br><br>        <span class="hljs-comment">//å…³é—­èµ„æºï¼Ÿä¸è¦</span><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="SSpringæ•´åˆRabbbitMQ"><a href="#SSpringæ•´åˆRabbbitMQ" class="headerlink" title="SSpringæ•´åˆRabbbitMQ"></a>SSpringæ•´åˆRabbbitMQ</h1><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224160452851.png" alt="image-20210224160452851"></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224160949065.png" alt="image-20210224160949065"></p><p>æ‰€æœ‰pomæ·»åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.itheima<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-rabbitmq-producers<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.7.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.amqp<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-rabbit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.8.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.7.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.8.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">source</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">target</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="æ­å»ºProducerså·¥ç¨‹"><a href="#æ­å»ºProducerså·¥ç¨‹" class="headerlink" title="æ­å»ºProducerså·¥ç¨‹"></a><strong>æ­å»ºProducerså·¥ç¨‹</strong></h2><h3 id="é…ç½®æ•´åˆ"><a href="#é…ç½®æ•´åˆ" class="headerlink" title="é…ç½®æ•´åˆ"></a>é…ç½®æ•´åˆ</h3><p><strong>rabbitmq.properties</strong>:</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">rabbitmq.host</span>=<span class="hljs-string">192.168.91.130</span><br><span class="hljs-meta">rabbitmq.port</span>=<span class="hljs-string">5672</span><br><span class="hljs-meta">rabbitmq.username</span>=<span class="hljs-string">heima</span><br><span class="hljs-meta">rabbitmq.password</span>=<span class="hljs-string">heima</span><br><span class="hljs-meta">rabbitmq.virtual-host</span>=<span class="hljs-string">/itcast</span><br></code></pre></td></tr></table></figure><p><strong>spring-rabbitmq-producer.xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:rabbit</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/rabbit&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/rabbit</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/rabbit/spring-rabbit.xsd&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--åŠ è½½é…ç½®æ–‡ä»¶--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;classpath:rabbitmq.properties&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å®šä¹‰rabbitmq connectionFactory --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:connection-factory</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.port&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">username</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.username&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.password&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">virtual-host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.virtual-host&#125;&quot;</span>/&gt;</span><br>    <span class="hljs-comment">&lt;!--å®šä¹‰ç®¡ç†äº¤æ¢æœºã€é˜Ÿåˆ—--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:admin</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºï¼›ä¸ç»‘å®šåˆ°äº¤æ¢æœºåˆ™ç»‘å®šåˆ°é»˜è®¤äº¤æ¢æœº</span><br><span class="hljs-comment">    é»˜è®¤äº¤æ¢æœºç±»å‹ä¸ºdirectï¼Œåå­—ä¸ºï¼š&quot;&quot;ï¼Œè·¯ç”±é”®ä¸ºé˜Ÿåˆ—çš„åç§°</span><br><span class="hljs-comment">    --&gt;</span><br>    <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">        idï¼šbeançš„åç§°</span><br><span class="hljs-comment">        nameï¼šqueueçš„åç§°</span><br><span class="hljs-comment">        auto-declare:è‡ªåŠ¨åˆ›å»º</span><br><span class="hljs-comment">        auto-delete:è‡ªåŠ¨åˆ é™¤ã€‚ æœ€åä¸€ä¸ªæ¶ˆè´¹è€…å’Œè¯¥é˜Ÿåˆ—æ–­å¼€è¿æ¥åï¼Œè‡ªåŠ¨åˆ é™¤é˜Ÿåˆ—</span><br><span class="hljs-comment">        exclusive:æ˜¯å¦ç‹¬å </span><br><span class="hljs-comment">        durableï¼šæ˜¯å¦æŒä¹…åŒ–</span><br><span class="hljs-comment">    --&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_queue&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_queue&quot;</span>    <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~å¹¿æ’­ï¼›æ‰€æœ‰é˜Ÿåˆ—éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --&gt;</span><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å¹¿æ’­äº¤æ¢æœºä¸­çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_fanout_queue_1&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_fanout_queue_1&quot;</span> <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å¹¿æ’­äº¤æ¢æœºä¸­çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_fanout_queue_2&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_fanout_queue_2&quot;</span> <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å¹¿æ’­ç±»å‹äº¤æ¢æœºï¼›å¹¶ç»‘å®šä¸Šè¿°ä¸¤ä¸ªé˜Ÿåˆ—--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:fanout-exchange</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_fanout_exchange&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_fanout_exchange&quot;</span>  <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span>  <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;spring_fanout_queue_1&quot;</span>  /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;spring_fanout_queue_2&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:fanout-exchange</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--&lt;rabbit:direct-exchange name=&quot;aa&quot; &gt;</span><br><span class="hljs-comment">        &lt;rabbit:bindings&gt;</span><br><span class="hljs-comment">            &amp;lt;!&amp;ndash;direct ç±»å‹çš„äº¤æ¢æœºç»‘å®šé˜Ÿåˆ—  key ï¼šè·¯ç”±key  queueï¼šé˜Ÿåˆ—åç§°&amp;ndash;&amp;gt;</span><br><span class="hljs-comment">            &lt;rabbit:binding queue=&quot;spring_queue&quot; key=&quot;xxx&quot;&gt;&lt;/rabbit:binding&gt;</span><br><span class="hljs-comment">        &lt;/rabbit:bindings&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;/rabbit:direct-exchange&gt;--&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~é€šé…ç¬¦ï¼›*åŒ¹é…ä¸€ä¸ªå•è¯ï¼Œ#åŒ¹é…å¤šä¸ªå•è¯ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --&gt;</span><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å¹¿æ’­äº¤æ¢æœºä¸­çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_topic_queue_star&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_topic_queue_star&quot;</span>  <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å¹¿æ’­äº¤æ¢æœºä¸­çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_topic_queue_well&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_topic_queue_well&quot;</span> <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å¹¿æ’­äº¤æ¢æœºä¸­çš„æŒä¹…åŒ–é˜Ÿåˆ—ï¼Œä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_topic_queue_well2&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_topic_queue_well2&quot;</span> <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:topic-exchange</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;spring_topic_exchange&quot;</span>  <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;spring_topic_exchange&quot;</span> <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;heima.*&quot;</span>  <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;spring_topic_queue_star&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;heima.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;spring_topic_queue_well&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;itcast.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;spring_topic_queue_well2&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:topic-exchange</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰rabbitTemplateå¯¹è±¡æ“ä½œå¯ä»¥åœ¨ä»£ç ä¸­æ–¹ä¾¿å‘é€æ¶ˆæ¯--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rabbitTemplate&quot;</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="headerlink" title="å‘é€æ¶ˆæ¯"></a>å‘é€æ¶ˆæ¯</h3><p><strong>ProducerTest.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.test.context.ContextConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;<br><br><span class="hljs-meta">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="hljs-meta">@ContextConfiguration(locations = &quot;classpath:spring/spring-rabbitmq.xml&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProducerTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åªå‘é˜Ÿåˆ—æ¶ˆæ¯</span><br><span class="hljs-comment">     * é»˜è®¤äº¤æ¢æœºç±»å‹ä¸º direct</span><br><span class="hljs-comment">     * äº¤æ¢æœºçš„åç§°ä¸ºç©ºï¼Œè·¯ç”±é”®ä¸ºé˜Ÿåˆ—çš„åç§°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">queueTest</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//è·¯ç”±é”®ä¸é˜Ÿåˆ—åŒå</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;spring_queue&quot;</span>, <span class="hljs-string">&quot;åªå‘é˜Ÿåˆ—spring_queueçš„æ¶ˆæ¯ã€‚&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å‘é€å¹¿æ’­</span><br><span class="hljs-comment">     * äº¤æ¢æœºç±»å‹ä¸º fanout</span><br><span class="hljs-comment">     * ç»‘å®šåˆ°è¯¥äº¤æ¢æœºçš„æ‰€æœ‰é˜Ÿåˆ—éƒ½èƒ½å¤Ÿæ”¶åˆ°æ¶ˆæ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fanoutTest</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * å‚æ•°1ï¼šäº¤æ¢æœºåç§°</span><br><span class="hljs-comment">         * å‚æ•°2ï¼šè·¯ç”±é”®åï¼ˆå¹¿æ’­è®¾ç½®ä¸ºç©ºï¼‰</span><br><span class="hljs-comment">         * å‚æ•°3ï¼šå‘é€çš„æ¶ˆæ¯å†…å®¹</span><br><span class="hljs-comment">         */</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;spring_fanout_exchange&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;å‘é€åˆ°spring_fanout_exchangeäº¤æ¢æœºçš„å¹¿æ’­æ¶ˆæ¯&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šé…ç¬¦</span><br><span class="hljs-comment">     * äº¤æ¢æœºç±»å‹ä¸º topic</span><br><span class="hljs-comment">     * åŒ¹é…è·¯ç”±é”®çš„é€šé…ç¬¦ï¼Œ*è¡¨ç¤ºä¸€ä¸ªå•è¯ï¼Œ#è¡¨ç¤ºå¤šä¸ªå•è¯</span><br><span class="hljs-comment">     * ç»‘å®šåˆ°è¯¥äº¤æ¢æœºçš„åŒ¹é…é˜Ÿåˆ—èƒ½å¤Ÿæ”¶åˆ°å¯¹åº”æ¶ˆæ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">topicTest</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * å‚æ•°1ï¼šäº¤æ¢æœºåç§°</span><br><span class="hljs-comment">         * å‚æ•°2ï¼šè·¯ç”±é”®å</span><br><span class="hljs-comment">         * å‚æ•°3ï¼šå‘é€çš„æ¶ˆæ¯å†…å®¹</span><br><span class="hljs-comment">         */</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;spring_topic_exchange&quot;</span>, <span class="hljs-string">&quot;heima.bj&quot;</span>, <span class="hljs-string">&quot;å‘é€åˆ°spring_topic_exchangeäº¤æ¢æœºheima.bjçš„æ¶ˆæ¯&quot;</span>);<br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;spring_topic_exchange&quot;</span>, <span class="hljs-string">&quot;heima.bj.1&quot;</span>, <span class="hljs-string">&quot;å‘é€åˆ°spring_topic_exchangeäº¤æ¢æœºheima.bj.1çš„æ¶ˆæ¯&quot;</span>);<br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;spring_topic_exchange&quot;</span>, <span class="hljs-string">&quot;heima.bj.2&quot;</span>, <span class="hljs-string">&quot;å‘é€åˆ°spring_topic_exchangeäº¤æ¢æœºheima.bj.2çš„æ¶ˆæ¯&quot;</span>);<br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;spring_topic_exchange&quot;</span>, <span class="hljs-string">&quot;itcast.cn&quot;</span>, <span class="hljs-string">&quot;å‘é€åˆ°spring_topic_exchangeäº¤æ¢æœºitcast.cnçš„æ¶ˆæ¯&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ­å»ºconsumerså·¥ç¨‹"><a href="#æ­å»ºconsumerså·¥ç¨‹" class="headerlink" title="æ­å»ºconsumerså·¥ç¨‹:"></a><strong>æ­å»ºconsumerså·¥ç¨‹:</strong></h2><h3 id="é…ç½®æ•´åˆ-1"><a href="#é…ç½®æ•´åˆ-1" class="headerlink" title="é…ç½®æ•´åˆ"></a>é…ç½®æ•´åˆ</h3><ol><li>åˆ›å»º<code>spring-rabbitmq-consumer\src\main\resources\properties\rabbitmq.properties</code>è¿æ¥å‚æ•°ç­‰é…ç½®æ–‡ä»¶ï¼›</li></ol><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">rabbitmq.host</span>=<span class="hljs-string">192.168.91.130</span><br><span class="hljs-meta">rabbitmq.port</span>=<span class="hljs-string">5672</span><br><span class="hljs-meta">rabbitmq.username</span>=<span class="hljs-string">heima</span><br><span class="hljs-meta">rabbitmq.password</span>=<span class="hljs-string">heima</span><br><span class="hljs-meta">rabbitmq.virtual-host</span>=<span class="hljs-string">/itcast</span><br></code></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\resources\spring\spring-rabbitmq.xml</code> æ•´åˆé…ç½®æ–‡ä»¶ï¼›</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:rabbit</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/rabbit&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/rabbit</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/rabbit/spring-rabbit.xsd&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--åŠ è½½é…ç½®æ–‡ä»¶--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;classpath:properties/rabbitmq.properties&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å®šä¹‰rabbitmq connectionFactory --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:connection-factory</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.port&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">username</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.username&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.password&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">virtual-host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.virtual-host&#125;&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;springQueueListener&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.itheima.rabbitmq.listener.SpringQueueListener&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fanoutListener1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.itheima.rabbitmq.listener.FanoutListener1&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;fanoutListener2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.itheima.rabbitmq.listener.FanoutListener2&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;topicListenerStar&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.itheima.rabbitmq.listener.TopicListenerStar&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;topicListenerWell&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.itheima.rabbitmq.listener.TopicListenerWell&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;topicListenerWell2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.itheima.rabbitmq.listener.TopicListenerWell2&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener-container</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">auto-declare</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;springQueueListener&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;spring_queue&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;fanoutListener1&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;spring_fanout_queue_1&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;fanoutListener2&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;spring_fanout_queue_2&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;topicListenerStar&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;spring_topic_queue_star&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;topicListenerWell&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;spring_topic_queue_well&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;topicListenerWell2&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;spring_topic_queue_well2&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener-container</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="æ¶ˆæ¯ç›‘å¬å™¨"><a href="#æ¶ˆæ¯ç›‘å¬å™¨" class="headerlink" title="æ¶ˆæ¯ç›‘å¬å™¨"></a>æ¶ˆæ¯ç›‘å¬å™¨</h3><h4 id="1ï¼‰é˜Ÿåˆ—ç›‘å¬å™¨"><a href="#1ï¼‰é˜Ÿåˆ—ç›‘å¬å™¨" class="headerlink" title="1ï¼‰é˜Ÿåˆ—ç›‘å¬å™¨"></a>1ï¼‰é˜Ÿåˆ—ç›‘å¬å™¨</h4><p>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\java\com\itheima\rabbitmq\listener\SpringQueueListener.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringQueueListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageListener</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            String msg = <span class="hljs-keyword">new</span> String(message.getBody(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br><br>            System.out.printf(<span class="hljs-string">&quot;æ¥æ”¶è·¯ç”±åç§°ä¸ºï¼š%sï¼Œè·¯ç”±é”®ä¸ºï¼š%sï¼Œé˜Ÿåˆ—åä¸ºï¼š%sçš„æ¶ˆæ¯ï¼š%s \n&quot;</span>,<br>                    message.getMessageProperties().getReceivedExchange(),<br>                    message.getMessageProperties().getReceivedRoutingKey(),<br>                    message.getMessageProperties().getConsumerQueue(),<br>                    msg);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ï¼‰å¹¿æ’­ç›‘å¬å™¨1"><a href="#2ï¼‰å¹¿æ’­ç›‘å¬å™¨1" class="headerlink" title="2ï¼‰å¹¿æ’­ç›‘å¬å™¨1"></a>2ï¼‰å¹¿æ’­ç›‘å¬å™¨1</h4><p>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\java\com\itheima\rabbitmq\listener\FanoutListener1.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FanoutListener1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageListener</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            String msg = <span class="hljs-keyword">new</span> String(message.getBody(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br><br>            System.out.printf(<span class="hljs-string">&quot;å¹¿æ’­ç›‘å¬å™¨1ï¼šæ¥æ”¶è·¯ç”±åç§°ä¸ºï¼š%sï¼Œè·¯ç”±é”®ä¸ºï¼š%sï¼Œé˜Ÿåˆ—åä¸ºï¼š%sçš„æ¶ˆæ¯ï¼š%s \n&quot;</span>,<br>                    message.getMessageProperties().getReceivedExchange(),<br>                    message.getMessageProperties().getReceivedRoutingKey(),<br>                    message.getMessageProperties().getConsumerQueue(),<br>                    msg);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="3ï¼‰å¹¿æ’­ç›‘å¬å™¨2"><a href="#3ï¼‰å¹¿æ’­ç›‘å¬å™¨2" class="headerlink" title="3ï¼‰å¹¿æ’­ç›‘å¬å™¨2"></a>3ï¼‰å¹¿æ’­ç›‘å¬å™¨2</h4><p>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\java\com\itheima\rabbitmq\listener\FanoutListener2.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FanoutListener2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageListener</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            String msg = <span class="hljs-keyword">new</span> String(message.getBody(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br><br>            System.out.printf(<span class="hljs-string">&quot;å¹¿æ’­ç›‘å¬å™¨2ï¼šæ¥æ”¶è·¯ç”±åç§°ä¸ºï¼š%sï¼Œè·¯ç”±é”®ä¸ºï¼š%sï¼Œé˜Ÿåˆ—åä¸ºï¼š%sçš„æ¶ˆæ¯ï¼š%s \n&quot;</span>,<br>                    message.getMessageProperties().getReceivedExchange(),<br>                    message.getMessageProperties().getReceivedRoutingKey(),<br>                    message.getMessageProperties().getConsumerQueue(),<br>                    msg);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ï¼‰æ˜Ÿå·é€šé…ç¬¦ç›‘å¬å™¨"><a href="#4ï¼‰æ˜Ÿå·é€šé…ç¬¦ç›‘å¬å™¨" class="headerlink" title="4ï¼‰æ˜Ÿå·é€šé…ç¬¦ç›‘å¬å™¨"></a>4ï¼‰æ˜Ÿå·é€šé…ç¬¦ç›‘å¬å™¨</h4><p>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\java\com\itheima\rabbitmq\listener\TopicListenerStar.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TopicListenerStar</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageListener</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            String msg = <span class="hljs-keyword">new</span> String(message.getBody(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br><br>            System.out.printf(<span class="hljs-string">&quot;é€šé…ç¬¦*ç›‘å¬å™¨ï¼šæ¥æ”¶è·¯ç”±åç§°ä¸ºï¼š%sï¼Œè·¯ç”±é”®ä¸ºï¼š%sï¼Œé˜Ÿåˆ—åä¸ºï¼š%sçš„æ¶ˆæ¯ï¼š%s \n&quot;</span>,<br>                    message.getMessageProperties().getReceivedExchange(),<br>                    message.getMessageProperties().getReceivedRoutingKey(),<br>                    message.getMessageProperties().getConsumerQueue(),<br>                    msg);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="5ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨"><a href="#5ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨" class="headerlink" title="5ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨"></a>5ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨</h4><p>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\java\com\itheima\rabbitmq\listener\TopicListenerWell.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TopicListenerWell</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageListener</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            String msg = <span class="hljs-keyword">new</span> String(message.getBody(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br><br>            System.out.printf(<span class="hljs-string">&quot;é€šé…ç¬¦#ç›‘å¬å™¨ï¼šæ¥æ”¶è·¯ç”±åç§°ä¸ºï¼š%sï¼Œè·¯ç”±é”®ä¸ºï¼š%sï¼Œé˜Ÿåˆ—åä¸ºï¼š%sçš„æ¶ˆæ¯ï¼š%s \n&quot;</span>,<br>                    message.getMessageProperties().getReceivedExchange(),<br>                    message.getMessageProperties().getReceivedRoutingKey(),<br>                    message.getMessageProperties().getConsumerQueue(),<br>                    msg);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="6ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨2"><a href="#6ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨2" class="headerlink" title="6ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨2"></a>6ï¼‰äº•å·é€šé…ç¬¦ç›‘å¬å™¨2</h4><p>åˆ›å»º <code>spring-rabbitmq-consumer\src\main\java\com\itheima\rabbitmq\listener\TopicListenerWell2.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TopicListenerWell2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MessageListener</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            String msg = <span class="hljs-keyword">new</span> String(message.getBody(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br><br>            System.out.printf(<span class="hljs-string">&quot;é€šé…ç¬¦#ç›‘å¬å™¨2ï¼šæ¥æ”¶è·¯ç”±åç§°ä¸ºï¼š%sï¼Œè·¯ç”±é”®ä¸ºï¼š%sï¼Œé˜Ÿåˆ—åä¸ºï¼š%sçš„æ¶ˆæ¯ï¼š%s \n&quot;</span>,<br>                    message.getMessageProperties().getReceivedExchange(),<br>                    message.getMessageProperties().getReceivedRoutingKey(),<br>                    message.getMessageProperties().getConsumerQueue(),<br>                    msg);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="SpringBootæ•´åˆRabbitMQ"><a href="#SpringBootæ•´åˆRabbitMQ" class="headerlink" title="SpringBootæ•´åˆRabbitMQ"></a>SpringBootæ•´åˆRabbitMQ</h1><p>åœ¨Springé¡¹ç›®ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Spring-Rabbitå»æ“ä½œRabbitMQ<br><a href="https://github.com/spring-projects/spring-amqp">https://github.com/spring-projects/spring-amqp</a></p><p>å°¤å…¶æ˜¯åœ¨spring booté¡¹ç›®ä¸­åªéœ€è¦å¼•å…¥å¯¹åº”çš„amqpå¯åŠ¨å™¨ä¾èµ–å³å¯ï¼Œæ–¹ä¾¿çš„ä½¿ç”¨RabbitTemplateå‘é€æ¶ˆæ¯ï¼Œä½¿ç”¨æ³¨è§£æ¥æ”¶æ¶ˆæ¯ã€‚</p><p><em>ä¸€èˆ¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­</em>ï¼š</p><p><strong>ç”Ÿäº§è€…å·¥ç¨‹ï¼š</strong></p><ol><li><p>application.ymlæ–‡ä»¶é…ç½®RabbitMQç›¸å…³ä¿¡æ¯ï¼›</p></li><li><p>åœ¨ç”Ÿäº§è€…å·¥ç¨‹ä¸­ç¼–å†™é…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºäº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼Œå¹¶è¿›è¡Œç»‘å®š</p></li><li><p>æ³¨å…¥RabbitTemplateå¯¹è±¡ï¼Œé€šè¿‡RabbitTemplateå¯¹è±¡å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœº</p></li></ol><p><strong>æ¶ˆè´¹è€…å·¥ç¨‹ï¼š</strong></p><ol><li><p>application.ymlæ–‡ä»¶é…ç½®RabbitMQç›¸å…³ä¿¡æ¯</p></li><li><p>åˆ›å»ºæ¶ˆæ¯å¤„ç†ç±»ï¼Œç”¨äºæ¥æ”¶é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†</p></li></ol><h2 id="æ­å»ºç”Ÿäº§è€…å·¥ç¨‹"><a href="#æ­å»ºç”Ÿäº§è€…å·¥ç¨‹" class="headerlink" title="æ­å»ºç”Ÿäº§è€…å·¥ç¨‹"></a>æ­å»ºç”Ÿäº§è€…å·¥ç¨‹</h2><h3 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h3><p>åˆ›å»ºç”Ÿäº§è€…å·¥ç¨‹springboot-rabbitmq-producer</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1558321303612.png" alt="1556072078816"></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1558321417385.png" alt="1556072084653"></p><h3 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h3><p>ä¿®æ”¹pom.xmlæ–‡ä»¶å†…å®¹ä¸ºå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.4.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.itheima<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springboot-rabbitmq-producer<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="å¯åŠ¨ç±»"><a href="#å¯åŠ¨ç±»" class="headerlink" title="å¯åŠ¨ç±»"></a>å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.rabbitmq;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProducerApplication</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(ProducerApplication.class);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="é…ç½®RabbitMQ"><a href="#é…ç½®RabbitMQ" class="headerlink" title="é…ç½®RabbitMQ"></a>é…ç½®RabbitMQ</h3><h4 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åˆ›å»ºapplication.ymlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span><br>    <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">/itcast</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">heima</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">heima</span><br></code></pre></td></tr></table></figure><h4 id="ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—"><a href="#ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—" class="headerlink" title="ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—"></a>ç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—</h4><p>åˆ›å»ºRabbitMQé˜Ÿåˆ—ä¸äº¤æ¢æœºç»‘å®šçš„é…ç½®ç±»com.itheima.rabbitmq.config.RabbitMQConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.rabbitmq.config;<br><br><span class="hljs-keyword">import</span> org.springframework.amqp.core.*;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RabbitMQConfig</span> </span>&#123;<br>    <span class="hljs-comment">//äº¤æ¢æœºåç§°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ITEM_TOPIC_EXCHANGE = <span class="hljs-string">&quot;item_topic_exchange&quot;</span>;<br>    <span class="hljs-comment">//é˜Ÿåˆ—åç§°</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ITEM_QUEUE = <span class="hljs-string">&quot;item_queue&quot;</span>;<br><br>    <span class="hljs-comment">//å£°æ˜äº¤æ¢æœº</span><br>    <span class="hljs-meta">@Bean(&quot;itemTopicExchange&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Exchange <span class="hljs-title">topicExchange</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> ExchangeBuilder.topicExchange(ITEM_TOPIC_EXCHANGE).durable(<span class="hljs-keyword">true</span>).build();<br>    &#125;<br><br>    <span class="hljs-comment">//å£°æ˜é˜Ÿåˆ—</span><br>    <span class="hljs-meta">@Bean(&quot;itemQueue&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Queue <span class="hljs-title">itemQueue</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> QueueBuilder.durable(ITEM_QUEUE).build();<br>    &#125;<br><br>    <span class="hljs-comment">//ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Binding <span class="hljs-title">itemQueueExchange</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier(&quot;itemQueue&quot;)</span> Queue queue,</span></span><br><span class="hljs-function"><span class="hljs-params">                                     <span class="hljs-meta">@Qualifier(&quot;itemTopicExchange&quot;)</span> Exchange exchange)</span></span>&#123;<br>        <span class="hljs-keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="hljs-string">&quot;item.#&quot;</span>).noargs();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ­å»ºæ¶ˆè´¹è€…å·¥ç¨‹"><a href="#æ­å»ºæ¶ˆè´¹è€…å·¥ç¨‹" class="headerlink" title="æ­å»ºæ¶ˆè´¹è€…å·¥ç¨‹"></a>æ­å»ºæ¶ˆè´¹è€…å·¥ç¨‹</h2><h3 id="åˆ›å»ºå·¥ç¨‹-1"><a href="#åˆ›å»ºå·¥ç¨‹-1" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h3><p>åˆ›å»ºæ¶ˆè´¹è€…å·¥ç¨‹springboot-rabbitmq-consumer</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1558322109359.png" alt="1556073553841"></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1558322192435.png" alt="1556073567786"></p><h3 id="æ·»åŠ ä¾èµ–-1"><a href="#æ·»åŠ ä¾èµ–-1" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h3><p>ä¿®æ”¹pom.xmlæ–‡ä»¶å†…å®¹ä¸ºå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.4.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.itheima<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springboot-rabbitmq-consumer<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="å¯åŠ¨ç±»-1"><a href="#å¯åŠ¨ç±»-1" class="headerlink" title="å¯åŠ¨ç±»"></a>å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.rabbitmq;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConsumerApplication</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(ConsumerApplication.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é…ç½®RabbitMQ-1"><a href="#é…ç½®RabbitMQ-1" class="headerlink" title="é…ç½®RabbitMQ"></a>é…ç½®RabbitMQ</h3><p>åˆ›å»ºapplication.ymlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.91</span><span class="hljs-number">.130</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span><br>    <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">/itcast</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">heima</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">heima</span><br></code></pre></td></tr></table></figure><h3 id="æ¶ˆæ¯ç›‘å¬å¤„ç†ç±»"><a href="#æ¶ˆæ¯ç›‘å¬å¤„ç†ç±»" class="headerlink" title="æ¶ˆæ¯ç›‘å¬å¤„ç†ç±»"></a>æ¶ˆæ¯ç›‘å¬å¤„ç†ç±»</h3><p>ç¼–å†™æ¶ˆæ¯ç›‘å¬å™¨com.itheima.rabbitmq.listener.MyListener</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.rabbitmq.listener;<br><br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyListener</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç›‘å¬æŸä¸ªé˜Ÿåˆ—çš„æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RabbitListener(queues = &quot;item_queue&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">myListener1</span><span class="hljs-params">(String message)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ¶ˆè´¹è€…æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸ºï¼š&quot;</span> + message);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>åœ¨ç”Ÿäº§è€…å·¥ç¨‹springboot-rabbitmq-producerä¸­åˆ›å»ºæµ‹è¯•ç±»ï¼Œå‘é€æ¶ˆæ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.itheima.rabbitmq;<br><br><span class="hljs-keyword">import</span> com.itheima.rabbitmq.config.RabbitMQConfig;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.junit.runner.RunWith;<br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringRunner;<br><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RabbitMQTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>        rabbitTemplate.convertAndSend(RabbitMQConfig.ITEM_TOPIC_EXCHANGE, <span class="hljs-string">&quot;item.insert&quot;</span>, <span class="hljs-string">&quot;å•†å“æ–°å¢ï¼Œrouting key ä¸ºitem.insert&quot;</span>);<br>        rabbitTemplate.convertAndSend(RabbitMQConfig.ITEM_TOPIC_EXCHANGE, <span class="hljs-string">&quot;item.update&quot;</span>, <span class="hljs-string">&quot;å•†å“ä¿®æ”¹ï¼Œrouting key ä¸ºitem.update&quot;</span>);<br>        rabbitTemplate.convertAndSend(RabbitMQConfig.ITEM_TOPIC_EXCHANGE, <span class="hljs-string">&quot;item.delete&quot;</span>, <span class="hljs-string">&quot;å•†å“åˆ é™¤ï¼Œrouting key ä¸ºitem.delete&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆè¿è¡Œä¸Šè¿°æµ‹è¯•ç¨‹åºï¼ˆäº¤æ¢æœºå’Œé˜Ÿåˆ—æ‰èƒ½å…ˆè¢«å£°æ˜å’Œç»‘å®šï¼‰ï¼Œç„¶åå¯åŠ¨æ¶ˆè´¹è€…ï¼›åœ¨æ¶ˆè´¹è€…å·¥ç¨‹springboot-rabbitmq-consumerä¸­æ§åˆ¶å°æŸ¥çœ‹æ˜¯å¦æ¥æ”¶åˆ°å¯¹åº”æ¶ˆæ¯ã€‚</p><p>å¦å¤–ï¼›ä¹Ÿå¯ä»¥åœ¨RabbitMQçš„ç®¡ç†æ§åˆ¶å°ä¸­æŸ¥çœ‹åˆ°äº¤æ¢æœºä¸é˜Ÿåˆ—çš„ç»‘å®šï¼š</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1556074827222.png" alt="1556074827222"></p><h1 id="RabbitMQé«˜çº§ç‰¹æ€§"><a href="#RabbitMQé«˜çº§ç‰¹æ€§" class="headerlink" title="RabbitMQé«˜çº§ç‰¹æ€§"></a>RabbitMQé«˜çº§ç‰¹æ€§</h1><p>é«˜çº§ç‰¹æ€§ä»‹ç»ä¸­ä½¿ç”¨çš„ä»£ç ç›®å½•ï¼Œè¯¦ç»†æŸ¥çœ‹ä»£ç é™„å½•</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224214156170.png" alt="image-20210224214156170"></p><h2 id="æ¶ˆæ¯å¯é æ€§æŠ•é€’"><a href="#æ¶ˆæ¯å¯é æ€§æŠ•é€’" class="headerlink" title="æ¶ˆæ¯å¯é æ€§æŠ•é€’"></a>æ¶ˆæ¯å¯é æ€§æŠ•é€’</h2><p>åœ¨ä½¿ç”¨ RabbitMQ çš„æ—¶å€™ï¼Œä½œä¸ºæ¶ˆæ¯å‘é€æ–¹å¸Œæœ›æœç»ä»»ä½•æ¶ˆæ¯ä¸¢å¤±æˆ–è€…æŠ•é€’å¤±è´¥åœºæ™¯ã€‚RabbitMQ ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§æ–¹å¼ç”¨æ¥æ§åˆ¶æ¶ˆæ¯çš„æŠ•é€’å¯é æ€§æ¨¡å¼ã€‚</p><ul><li><p>confirm ç¡®è®¤æ¨¡å¼</p></li><li><p>return é€€å›æ¨¡å¼</p></li></ul><p>rabbitmq æ•´ä¸ªæ¶ˆæ¯æŠ•é€’çš„è·¯å¾„ä¸ºï¼š</p><p>producerâ€”&gt;rabbitmq brokerâ€”&gt;exchangeâ€”&gt;queueâ€”&gt;consumer</p><ul><li><p>æ¶ˆæ¯ä» producer åˆ° exchange åˆ™ä¼šè¿”å›ä¸€ä¸ª confirmCallback ã€‚</p></li><li><p>æ¶ˆæ¯ä» exchangeâ€“&gt;queue æŠ•é€’å¤±è´¥åˆ™ä¼šè¿”å›ä¸€ä¸ª returnCallback ã€‚</p></li></ul><p>æˆ‘ä»¬å°†åˆ©ç”¨è¿™ä¸¤ä¸ª callback æ§åˆ¶æ¶ˆæ¯çš„å¯é æ€§æŠ•é€’</p><h2 id="confirm-ç¡®è®¤æ¨¡å¼"><a href="#confirm-ç¡®è®¤æ¨¡å¼" class="headerlink" title="confirm ç¡®è®¤æ¨¡å¼"></a>confirm ç¡®è®¤æ¨¡å¼</h2><p>1ã€è®¾ç½®ConnectionFactoryçš„publisher-confirms=â€trueâ€ å¼€å¯ç¡®è®¤æ¨¡å¼ã€‚</p><p><code>src/main/resources/spring-rabbitmq-producer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å®šä¹‰rabbitmq connectionFactory --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:connection-factory</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.port&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">username</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.username&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.password&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">virtual-host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.virtual-host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">publisher-confirms</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">                        </span><br><span class="hljs-tag">    /&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ä½¿ç”¨rabbitTemplate.setConfirmCallbackè®¾ç½®å›è°ƒå‡½æ•°ã€‚å½“æ¶ˆæ¯å‘é€åˆ°exchangeåå›è°ƒconfirmæ–¹æ³•ã€‚åœ¨æ–¹æ³•ä¸­åˆ¤æ–­ackï¼Œå¦‚æœä¸ºtrueï¼Œåˆ™å‘é€æˆåŠŸï¼Œå¦‚æœä¸ºfalseï¼Œåˆ™å‘é€å¤±è´¥ï¼Œéœ€è¦å¤„ç†ã€‚</p><p><code>com/itheima/test/ProducerTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¡®è®¤æ¨¡å¼ï¼š</span><br><span class="hljs-comment">     * æ­¥éª¤ï¼š</span><br><span class="hljs-comment">     * 1. ç¡®è®¤æ¨¡å¼å¼€å¯ï¼šConnectionFactoryä¸­å¼€å¯publisher-confirms=&quot;true&quot;</span><br><span class="hljs-comment">     * 2. åœ¨rabbitTemplateå®šä¹‰ConfirmCallBackå›è°ƒå‡½æ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testConfirm</span><span class="hljs-params">()</span> </span>&#123;<br><br>        <span class="hljs-comment">//2. å®šä¹‰å›è°ƒ</span><br>        rabbitTemplate.setConfirmCallback(<span class="hljs-keyword">new</span> RabbitTemplate.ConfirmCallback() &#123;<br>            <span class="hljs-comment">/**</span><br><span class="hljs-comment">             *</span><br><span class="hljs-comment">             * <span class="hljs-doctag">@param</span> correlationData ç›¸å…³é…ç½®ä¿¡æ¯</span><br><span class="hljs-comment">             * <span class="hljs-doctag">@param</span> ack   exchangeäº¤æ¢æœº æ˜¯å¦æˆåŠŸæ”¶åˆ°äº†æ¶ˆæ¯ã€‚true æˆåŠŸï¼Œfalseä»£è¡¨å¤±è´¥</span><br><span class="hljs-comment">             * <span class="hljs-doctag">@param</span> cause å¤±è´¥åŸå› </span><br><span class="hljs-comment">             */</span><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">confirm</span><span class="hljs-params">(CorrelationData correlationData, <span class="hljs-keyword">boolean</span> ack, String cause)</span> </span>&#123;<br>                System.out.println(<span class="hljs-string">&quot;confirmæ–¹æ³•è¢«æ‰§è¡Œäº†....&quot;</span>);<br><br>                <span class="hljs-keyword">if</span> (ack) &#123;<br>                    <span class="hljs-comment">//æ¥æ”¶æˆåŠŸ</span><br>                    System.out.println(<span class="hljs-string">&quot;æ¥æ”¶æˆåŠŸæ¶ˆæ¯&quot;</span> + cause);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">//æ¥æ”¶å¤±è´¥</span><br>                    System.out.println(<span class="hljs-string">&quot;æ¥æ”¶å¤±è´¥æ¶ˆæ¯&quot;</span> + cause);<br>                    <span class="hljs-comment">//åšä¸€äº›å¤„ç†ï¼Œè®©æ¶ˆæ¯å†æ¬¡å‘é€ã€‚</span><br>                &#125;<br>            &#125;<br>        &#125;);<br><br>        <span class="hljs-comment">//3. å‘é€æ¶ˆæ¯</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;test_exchange_confirm111&quot;</span>, <span class="hljs-string">&quot;confirm&quot;</span>, <span class="hljs-string">&quot;message confirm....&quot;</span>);<br>    &#125;<br><br></code></pre></td></tr></table></figure><h2 id="return-é€€å›æ¨¡å¼"><a href="#return-é€€å›æ¨¡å¼" class="headerlink" title="return é€€å›æ¨¡å¼"></a>return é€€å›æ¨¡å¼</h2><p>1ã€è®¾ç½®ConnectionFactoryçš„publisher-returns=â€trueâ€ å¼€å¯ é€€å›æ¨¡å¼ã€‚</p><p><code>src/main/resources/spring-rabbitmq-producer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å®šä¹‰rabbitmq connectionFactory --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:connection-factory</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.port&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">username</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.username&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.password&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">virtual-host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.virtual-host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">publisher-confirms</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">publisher-returns</span>=<span class="hljs-string">&quot;true&quot;</span></span><br><span class="hljs-tag">    /&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ä½¿ç”¨rabbitTemplate.setReturnCallbackè®¾ç½®é€€å›å‡½æ•°ï¼Œå½“æ¶ˆæ¯ä»exchangeè·¯ç”±åˆ°queueå¤±è´¥åï¼Œå¦‚æœè®¾ç½®äº†rabbitTemplate.setMandatory(true)å‚æ•°ï¼Œåˆ™ä¼šå°†æ¶ˆæ¯é€€å›ç»™producerã€‚å¹¶æ‰§è¡Œå›è°ƒå‡½æ•°returnedMessageã€‚</p><p><code>com/itheima/test/ProducerTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * å›é€€æ¨¡å¼ï¼š å½“æ¶ˆæ¯å‘é€ç»™Exchangeåï¼ŒExchangeè·¯ç”±åˆ°Queueå¤±è´¥æ˜¯ æ‰ä¼šæ‰§è¡Œ ReturnCallBack</span><br><span class="hljs-comment">    * æ­¥éª¤ï¼š</span><br><span class="hljs-comment">    * 1. å¼€å¯å›é€€æ¨¡å¼:publisher-returns=&quot;true&quot;</span><br><span class="hljs-comment">    * 2. è®¾ç½®ReturnCallBack</span><br><span class="hljs-comment">    * 3. è®¾ç½®Exchangeå¤„ç†æ¶ˆæ¯çš„æ¨¡å¼ï¼š</span><br><span class="hljs-comment">    * 1. å¦‚æœæ¶ˆæ¯æ²¡æœ‰è·¯ç”±åˆ°Queueï¼Œåˆ™ä¸¢å¼ƒæ¶ˆæ¯ï¼ˆé»˜è®¤ï¼‰</span><br><span class="hljs-comment">    * 2. å¦‚æœæ¶ˆæ¯æ²¡æœ‰è·¯ç”±åˆ°Queueï¼Œè¿”å›ç»™æ¶ˆæ¯å‘é€æ–¹ReturnCallBack</span><br><span class="hljs-comment">    */</span><br><br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testReturn</span><span class="hljs-params">()</span> </span>&#123;<br><br>       <span class="hljs-comment">//è®¾ç½®äº¤æ¢æœºå¤„ç†å¤±è´¥æ¶ˆæ¯çš„æ¨¡å¼</span><br>       rabbitTemplate.setMandatory(<span class="hljs-keyword">true</span>);<br><br>       <span class="hljs-comment">//2.è®¾ç½®ReturnCallBack</span><br>       rabbitTemplate.setReturnCallback(<span class="hljs-keyword">new</span> RabbitTemplate.ReturnCallback() &#123;<br>           <span class="hljs-comment">/**</span><br><span class="hljs-comment">            *</span><br><span class="hljs-comment">            * <span class="hljs-doctag">@param</span> message   æ¶ˆæ¯å¯¹è±¡</span><br><span class="hljs-comment">            * <span class="hljs-doctag">@param</span> replyCode é”™è¯¯ç </span><br><span class="hljs-comment">            * <span class="hljs-doctag">@param</span> replyText é”™è¯¯ä¿¡æ¯</span><br><span class="hljs-comment">            * <span class="hljs-doctag">@param</span> exchange  äº¤æ¢æœº</span><br><span class="hljs-comment">            * <span class="hljs-doctag">@param</span> routingKey è·¯ç”±é”®</span><br><span class="hljs-comment">            */</span><br>           <span class="hljs-meta">@Override</span><br>           <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">returnedMessage</span><span class="hljs-params">(Message message, <span class="hljs-keyword">int</span> replyCode, String replyText, String exchange, String routingKey)</span> </span>&#123;<br>               System.out.println(<span class="hljs-string">&quot;return æ‰§è¡Œäº†....&quot;</span>);<br><br>               System.out.println(message);<br>               System.out.println(replyCode);<br>               System.out.println(replyText);<br>               System.out.println(exchange);<br>               System.out.println(routingKey);<br><br>               <span class="hljs-comment">//å¤„ç†</span><br>           &#125;a]<br>       &#125;);<br><br><br>       <span class="hljs-comment">//3. å‘é€æ¶ˆæ¯</span><br>       rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;test_exchange_confirm&quot;</span>, <span class="hljs-string">&quot;confirm&quot;</span>, <span class="hljs-string">&quot;message confirm....&quot;</span>);<br>   &#125;<br><br></code></pre></td></tr></table></figure><p>Ã˜åœ¨RabbitMQä¸­ä¹Ÿæä¾›äº†äº‹åŠ¡æœºåˆ¶ï¼Œä½†æ˜¯æ€§èƒ½è¾ƒå·®ï¼Œæ­¤å¤„ä¸åšè®²è§£ã€‚</p><p>ä½¿ç”¨channelä¸‹åˆ—æ–¹æ³•ï¼Œå®Œæˆäº‹åŠ¡æ§åˆ¶ï¼š</p><p>txSelect(), ç”¨äºå°†å½“å‰channelè®¾ç½®æˆtransactionæ¨¡å¼</p><p>txCommit()ï¼Œç”¨äºæäº¤äº‹åŠ¡</p><p>txRollback(),ç”¨äºå›æ»šäº‹åŠ¡</p><h2 id="Consumer-ACK"><a href="#Consumer-ACK" class="headerlink" title="Consumer ACK"></a>Consumer ACK</h2><p>ackæŒ‡Acknowledgeï¼Œç¡®è®¤ã€‚ è¡¨ç¤ºæ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼ã€‚</p><p>æœ‰ä¸‰ç§ç¡®è®¤æ–¹å¼ï¼š</p><ul><li><p>è‡ªåŠ¨ç¡®è®¤ï¼šacknowledge=â€noneâ€</p></li><li><p>æ‰‹åŠ¨ç¡®è®¤ï¼šacknowledge=â€manualâ€</p></li><li><p>æ ¹æ®å¼‚å¸¸æƒ…å†µç¡®è®¤ï¼šacknowledge=â€autoâ€ï¼Œï¼ˆè¿™ç§æ–¹å¼ä½¿ç”¨éº»çƒ¦ï¼Œä¸ä½œè®²è§£ï¼‰</p></li></ul><p>å…¶ä¸­è‡ªåŠ¨ç¡®è®¤æ˜¯æŒ‡ï¼Œå½“æ¶ˆæ¯ä¸€æ—¦è¢«Consumeræ¥æ”¶åˆ°ï¼Œåˆ™è‡ªåŠ¨ç¡®è®¤æ”¶åˆ°ï¼Œå¹¶å°†ç›¸åº” message ä» RabbitMQ çš„æ¶ˆæ¯ç¼“å­˜ä¸­ç§»é™¤ã€‚ä½†æ˜¯åœ¨å®é™…ä¸šåŠ¡å¤„ç†ä¸­ï¼Œå¾ˆå¯èƒ½æ¶ˆæ¯æ¥æ”¶åˆ°ï¼Œä¸šåŠ¡å¤„ç†å‡ºç°å¼‚å¸¸ï¼Œé‚£ä¹ˆè¯¥æ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚å¦‚æœè®¾ç½®äº†æ‰‹åŠ¨ç¡®è®¤æ–¹å¼ï¼Œåˆ™éœ€è¦åœ¨ä¸šåŠ¡å¤„ç†æˆåŠŸåï¼Œè°ƒç”¨channel.basicAck()ï¼Œæ‰‹åŠ¨ç­¾æ”¶ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™è°ƒç”¨channel.basicNack()æ–¹æ³•ï¼Œè®©å…¶è‡ªåŠ¨é‡æ–°å‘é€æ¶ˆæ¯ã€‚</p><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>1ã€åœ¨rabbit:listener-containeræ ‡ç­¾ä¸­è®¾ç½®acknowledgeå±æ€§ï¼Œè®¾ç½®ackæ–¹å¼ noneï¼šè‡ªåŠ¨ç¡®è®¤ï¼Œmanualï¼šæ‰‹åŠ¨ç¡®è®¤</p><p><code>src/main/resources/spring-rabbitmq-consumer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:rabbit</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/rabbit&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/rabbit</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/rabbit/spring-rabbit.xsd&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--åŠ è½½é…ç½®æ–‡ä»¶--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;classpath:rabbitmq.properties&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- å®šä¹‰rabbitmq connectionFactory --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:connection-factory</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.host&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.port&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">username</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.username&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">password</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.password&#125;&quot;</span></span><br><span class="hljs-tag">                               <span class="hljs-attr">virtual-host</span>=<span class="hljs-string">&quot;$&#123;rabbitmq.virtual-host&#125;&quot;</span>/&gt;</span><br><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.itheima.listener&quot;</span> /&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰ç›‘å¬å™¨å®¹å™¨--&gt;</span><br>    <span class="hljs-comment">&lt;!--acknowledge=&quot;manual&quot;æ‰‹åŠ¨--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener-container</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">acknowledge</span>=<span class="hljs-string">&quot;manual&quot;</span> <span class="hljs-attr">prefetch</span>=<span class="hljs-string">&quot;1&quot;</span> &gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;ackListener&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;test_queue_confirm&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener</span>&gt;</span><br>       <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener-container</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€å¦‚æœåœ¨æ¶ˆè´¹ç«¯æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œåˆ™è°ƒç”¨channel.basicAck(deliveryTag,false);æ–¹æ³•ç¡®è®¤ç­¾æ”¶æ¶ˆæ¯</p><p>å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™åœ¨catchä¸­è°ƒç”¨ basicNackæˆ– basicRejectï¼Œæ‹’ç»æ¶ˆæ¯ï¼Œè®©MQé‡æ–°å‘é€æ¶ˆæ¯ã€‚</p><p><code>src/main/java/com/itheima/listener/AckListener.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Consumer ACKæœºåˆ¶ï¼š</span><br><span class="hljs-comment"> *  1. è®¾ç½®æ‰‹åŠ¨ç­¾æ”¶ã€‚acknowledge=&quot;manual&quot;</span><br><span class="hljs-comment"> *  2. è®©ç›‘å¬å™¨ç±»å®ç°ChannelAwareMessageListeneræ¥å£</span><br><span class="hljs-comment"> *  3. å¦‚æœæ¶ˆæ¯æˆåŠŸå¤„ç†ï¼Œåˆ™è°ƒç”¨channelçš„ basicAck()ç­¾æ”¶</span><br><span class="hljs-comment"> *  4. å¦‚æœæ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œåˆ™è°ƒç”¨channelçš„basicNack()æ‹’ç»ç­¾æ”¶ï¼Œbrokeré‡æ–°å‘é€ç»™consumer</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AckListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ChannelAwareMessageListener</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-keyword">long</span> deliveryTag = message.getMessageProperties().getDeliveryTag();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.æ¥æ”¶è½¬æ¢æ¶ˆæ¯</span><br>            System.out.println(<span class="hljs-keyword">new</span> String(message.getBody()));<br><br>            <span class="hljs-comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span><br>            System.out.println(<span class="hljs-string">&quot;å¤„ç†ä¸šåŠ¡é€»è¾‘...&quot;</span>);<br>            <span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>/<span class="hljs-number">0</span>;<span class="hljs-comment">//å‡ºç°é”™è¯¯</span><br>            <span class="hljs-comment">//3. æ‰‹åŠ¨ç­¾æ”¶</span><br>            channel.basicAck(deliveryTag,<span class="hljs-keyword">true</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-comment">//e.printStackTrace();</span><br><br>            <span class="hljs-comment">//4.æ‹’ç»ç­¾æ”¶</span><br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">            ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šrequeueï¼šé‡å›é˜Ÿåˆ—ã€‚å¦‚æœè®¾ç½®ä¸ºtrueï¼Œåˆ™æ¶ˆæ¯é‡æ–°å›åˆ°queueï¼Œbrokerä¼šé‡æ–°å‘é€è¯¥æ¶ˆæ¯ç»™æ¶ˆè´¹ç«¯</span><br><span class="hljs-comment">             */</span><br>            channel.basicNack(deliveryTag,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">true</span>);<br>            <span class="hljs-comment">//channel.basicReject(deliveryTag,true);</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ¶ˆè´¹ç«¯é™æµ"><a href="#æ¶ˆè´¹ç«¯é™æµ" class="headerlink" title="æ¶ˆè´¹ç«¯é™æµ"></a>æ¶ˆè´¹ç«¯é™æµ</h2><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224215000420.png" alt="image-20210224215000420"></p><h3 id="ä»£ç å®ç°-1"><a href="#ä»£ç å®ç°-1" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>1ã€åœ¨<a href="rabbit:listener-container">rabbit:listener-container</a> ä¸­é…ç½® prefetchå±æ€§è®¾ç½®æ¶ˆè´¹ç«¯ä¸€æ¬¡æ‹‰å–å¤šå°‘æ¶ˆæ¯ã€</p><p>2ã€æ¶ˆè´¹ç«¯çš„ç¡®è®¤æ¨¡å¼ä¸€å®šä¸ºæ‰‹åŠ¨ç¡®è®¤ã€‚acknowledge=â€manualâ€</p><p><code>src/main/resources/spring-rabbitmq-consumer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å®šä¹‰ç›‘å¬å™¨å®¹å™¨--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener-container</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">acknowledge</span>=<span class="hljs-string">&quot;manual&quot;</span> <span class="hljs-attr">prefetch</span>=<span class="hljs-string">&quot;1&quot;</span> &gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;qosListener&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;test_queue_confirm&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener</span>&gt;</span>--&gt;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener-container</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€å®ç°</p><p><code>src/main/java/com/itheima/listener/QosListener.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Consumer é™æµæœºåˆ¶</span><br><span class="hljs-comment"> *  1. ç¡®ä¿ackæœºåˆ¶ä¸ºæ‰‹åŠ¨ç¡®è®¤ã€‚</span><br><span class="hljs-comment"> *  2. listener-containeré…ç½®å±æ€§</span><br><span class="hljs-comment"> *      perfetch = 1,è¡¨ç¤ºæ¶ˆè´¹ç«¯æ¯æ¬¡ä»mqæ‹‰å»ä¸€æ¡æ¶ˆæ¯æ¥æ¶ˆè´¹ï¼Œç›´åˆ°æ‰‹åŠ¨ç¡®è®¤æ¶ˆè´¹å®Œæ¯•åï¼Œæ‰ä¼šç»§ç»­æ‹‰å»ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QosListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ChannelAwareMessageListener</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>        <span class="hljs-comment">//1.è·å–æ¶ˆæ¯</span><br>        System.out.println(<span class="hljs-keyword">new</span> String(message.getBody()));<br><br>        <span class="hljs-comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span><br><br>        <span class="hljs-comment">//3. ç­¾æ”¶</span><br>        channel.basicAck(message.getMessageProperties().getDeliveryTag(),<span class="hljs-keyword">true</span>);<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="TTL"><a href="#TTL" class="headerlink" title="TTL"></a>TTL</h2><p>TTL å…¨ç§° Time To Liveï¼ˆå­˜æ´»æ—¶é—´/è¿‡æœŸæ—¶é—´ï¼‰ã€‚</p><p>å½“æ¶ˆæ¯åˆ°è¾¾å­˜æ´»æ—¶é—´åï¼Œè¿˜æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚</p><p>RabbitMQå¯ä»¥å¯¹æ¶ˆæ¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥å¯¹æ•´ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224220328216.png" alt="image-20210224220328216"></p><h3 id="æ§åˆ¶å°å®ç°"><a href="#æ§åˆ¶å°å®ç°" class="headerlink" title="æ§åˆ¶å°å®ç°"></a>æ§åˆ¶å°å®ç°</h3><p>æ·»åŠ é˜Ÿåˆ—</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224221215187.png" alt="image-20210224221215187"></p><p>æ·»åŠ äº¤æ¢æœº</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224221408696.png" alt="image-20210224221408696"></p><p>ä¸ºäº¤æ¢æœºæ·»åŠ é˜Ÿåˆ—</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224221620373.png" alt="image-20210224221620373"></p><p>ç»‘å®šæˆåŠŸ</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224221825200.png" alt="image-20210224221825200"></p><p>äº¤æ¢æœºä¸­å‘å¸ƒæ¶ˆæ¯</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224221941354.png" alt="image-20210224221941354"></p><p>å›åˆ°é˜Ÿåˆ—ä¸­å¯ä»¥çœ‹è§æ¶ˆæ¯è¿‡äº†åç§’è¢«æ¸…é™¤äº†</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224222044094.png" alt="image-20210224222044094"></p><h3 id="ä»£ç å®ç°-2"><a href="#ä»£ç å®ç°-2" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>1ã€è®¾ç½®é˜Ÿåˆ—è¿‡æœŸæ—¶é—´ä½¿ç”¨å‚æ•°ï¼šx-message-ttlï¼Œå•ä½ï¼šms(æ¯«ç§’)ï¼Œä¼šå¯¹æ•´ä¸ªé˜Ÿåˆ—æ¶ˆæ¯ç»Ÿä¸€è¿‡æœŸã€‚</p><p>2ã€è®¾ç½®æ¶ˆæ¯è¿‡æœŸæ—¶é—´ä½¿ç”¨å‚æ•°ï¼šexpirationã€‚å•ä½ï¼šms(æ¯«ç§’)ï¼Œå½“è¯¥æ¶ˆæ¯åœ¨é˜Ÿåˆ—å¤´éƒ¨æ—¶ï¼ˆæ¶ˆè´¹æ—¶ï¼‰ï¼Œä¼šå•ç‹¬åˆ¤æ–­è¿™ä¸€æ¶ˆæ¯æ˜¯å¦è¿‡æœŸã€‚</p><p>3ã€å¦‚æœä¸¤è€…éƒ½è¿›è¡Œäº†è®¾ç½®ï¼Œä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚</p><p><code>src/main/resources/spring-rabbitmq-producer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ttl--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;test_queue_ttl&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;test_queue_ttl&quot;</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--è®¾ç½®queueçš„å‚æ•°--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue-arguments</span>&gt;</span><br>           <span class="hljs-comment">&lt;!--x-message-ttlæŒ‡é˜Ÿåˆ—çš„è¿‡æœŸæ—¶é—´--&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-message-ttl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;100000&quot;</span> <span class="hljs-attr">value-type</span>=<span class="hljs-string">&quot;java.lang.Integer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">entry</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue-arguments</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">rabbit:topic-exchange</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;test_exchange_ttl&quot;</span> &gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;ttl.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;test_queue_ttl&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:binding</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:topic-exchange</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•</p><p><code>src/test/java/com/itheima/test/ProducerTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">    * TTL:è¿‡æœŸæ—¶é—´</span><br><span class="hljs-comment">    *  1. é˜Ÿåˆ—ç»Ÿä¸€è¿‡æœŸ</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    *  2. æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * å¦‚æœè®¾ç½®äº†æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿè®¾ç½®äº†é˜Ÿåˆ—çš„è¿‡æœŸæ—¶é—´ï¼Œå®ƒä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚</span><br><span class="hljs-comment">    * é˜Ÿåˆ—è¿‡æœŸåï¼Œä¼šå°†é˜Ÿåˆ—æ‰€æœ‰æ¶ˆæ¯å…¨éƒ¨ç§»é™¤ã€‚</span><br><span class="hljs-comment">    * æ¶ˆæ¯è¿‡æœŸåï¼Œåªæœ‰æ¶ˆæ¯åœ¨é˜Ÿåˆ—é¡¶ç«¯ï¼Œæ‰ä¼šåˆ¤æ–­å…¶æ˜¯å¦è¿‡æœŸ(ç§»é™¤æ‰)</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testTtl</span><span class="hljs-params">()</span> </span>&#123;<br><br><br>     <span class="hljs-comment">/*  for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class="hljs-comment">           // å‘é€æ¶ˆæ¯</span><br><span class="hljs-comment">           rabbitTemplate.convertAndSend(&quot;test_exchange_ttl&quot;, &quot;ttl.hehe&quot;, &quot;message ttl....&quot;);</span><br><span class="hljs-comment">       &#125;*/</span><br><br>     <span class="hljs-comment">// æ¶ˆæ¯åå¤„ç†å¯¹è±¡ï¼Œè®¾ç½®ä¸€äº›æ¶ˆæ¯çš„å‚æ•°ä¿¡æ¯</span><br>       MessagePostProcessor messagePostProcessor = <span class="hljs-keyword">new</span> MessagePostProcessor() &#123;<br><br>           <span class="hljs-meta">@Override</span><br>           <span class="hljs-function"><span class="hljs-keyword">public</span> Message <span class="hljs-title">postProcessMessage</span><span class="hljs-params">(Message message)</span> <span class="hljs-keyword">throws</span> AmqpException </span>&#123;<br>               <span class="hljs-comment">//1.è®¾ç½®messageçš„ä¿¡æ¯</span><br>               message.getMessageProperties().setExpiration(<span class="hljs-string">&quot;5000&quot;</span>);<span class="hljs-comment">//æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´</span><br>               <span class="hljs-comment">//2.è¿”å›è¯¥æ¶ˆæ¯</span><br>               <span class="hljs-keyword">return</span> message;<br>           &#125;<br>       &#125;;<br><br><br>       <span class="hljs-comment">//æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</span><br>       <span class="hljs-comment">//rabbitTemplate.convertAndSend(&quot;test_exchange_ttl&quot;, &quot;ttl.hehe&quot;, &quot;message ttl....&quot;,messagePostProcessor);</span><br><br><br>       <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>           <span class="hljs-keyword">if</span>(i == <span class="hljs-number">5</span>)&#123;<br>               <span class="hljs-comment">//æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</span><br>               rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;test_exchange_ttl&quot;</span>, <span class="hljs-string">&quot;ttl.hehe&quot;</span>, <span class="hljs-string">&quot;message ttl....&quot;</span>,messagePostProcessor);<br>           &#125;<span class="hljs-keyword">else</span>&#123;<br>               <span class="hljs-comment">//ä¸è¿‡æœŸçš„æ¶ˆæ¯</span><br>               rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;test_exchange_ttl&quot;</span>, <span class="hljs-string">&quot;ttl.hehe&quot;</span>, <span class="hljs-string">&quot;message ttl....&quot;</span>);<br><br>           &#125;<br><br>       &#125;<br><br><br>   &#125;<br><br></code></pre></td></tr></table></figure><h2 id="æ­»ä¿¡é˜Ÿåˆ—"><a href="#æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—"></a>æ­»ä¿¡é˜Ÿåˆ—</h2><p>æ­»ä¿¡é˜Ÿåˆ—ï¼Œè‹±æ–‡ç¼©å†™ï¼šDLX </p><p>Dead Letter Exchangeï¼ˆæ­»ä¿¡äº¤æ¢æœºï¼‰</p><p>å½“æ¶ˆæ¯æˆä¸ºDead messageåï¼Œå¯ä»¥è¢«é‡æ–°å‘é€åˆ°å¦ä¸€ä¸ªäº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºå°±æ˜¯DLX</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224231141724.png" alt="image-20210224231141724"></p><p><strong>æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µï¼š</strong></p><ul><li><p>é˜Ÿåˆ—æ¶ˆæ¯é•¿åº¦åˆ°è¾¾é™åˆ¶ï¼›</p></li><li><p>æ¶ˆè´¹è€…æ‹’æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼ŒbasicNack/basicReject,å¹¶ä¸”ä¸æŠŠæ¶ˆæ¯é‡æ–°æ”¾å…¥åŸç›®æ ‡é˜Ÿåˆ—,requeue=falseï¼›</p></li><li><p>åŸé˜Ÿåˆ—å­˜åœ¨æ¶ˆæ¯è¿‡æœŸè®¾ç½®ï¼Œæ¶ˆæ¯åˆ°è¾¾è¶…æ—¶æ—¶é—´æœªè¢«æ¶ˆè´¹</p></li></ul><h3 id="ä»£ç å®ç°-3"><a href="#ä»£ç å®ç°-3" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p><code>src/main/resources/spring-rabbitmq-producer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       æ­»ä¿¡é˜Ÿåˆ—ï¼š</span><br><span class="hljs-comment">           1. å£°æ˜æ­£å¸¸çš„é˜Ÿåˆ—(test_queue_dlx)å’Œäº¤æ¢æœº(test_exchange_dlx)</span><br><span class="hljs-comment">           2. å£°æ˜æ­»ä¿¡é˜Ÿåˆ—(queue_dlx)å’Œæ­»ä¿¡äº¤æ¢æœº(exchange_dlx)</span><br><span class="hljs-comment">           3. æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</span><br><span class="hljs-comment">               è®¾ç½®ä¸¤ä¸ªå‚æ•°ï¼š</span><br><span class="hljs-comment">                   * x-dead-letter-exchangeï¼šæ­»ä¿¡äº¤æ¢æœºåç§°</span><br><span class="hljs-comment">                   * x-dead-letter-routing-keyï¼šå‘é€ç»™æ­»ä¿¡äº¤æ¢æœºçš„routingkey</span><br><span class="hljs-comment">   --&gt;</span><br><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       1. å£°æ˜æ­£å¸¸çš„é˜Ÿåˆ—(test_queue_dlx)å’Œäº¤æ¢æœº(test_exchange_dlx)</span><br><span class="hljs-comment">   --&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;test_queue_dlx&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;test_queue_dlx&quot;</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--3. æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue-arguments</span>&gt;</span><br>           <span class="hljs-comment">&lt;!--3.1 x-dead-letter-exchangeï¼šæ­»ä¿¡äº¤æ¢æœºåç§°--&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-dead-letter-exchange&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;exchange_dlx&quot;</span> /&gt;</span><br><br>           <span class="hljs-comment">&lt;!--3.2 x-dead-letter-routing-keyï¼šå‘é€ç»™æ­»ä¿¡äº¤æ¢æœºçš„routingkey--&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-dead-letter-routing-key&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;dlx.hehe&quot;</span> /&gt;</span><br><br>           <span class="hljs-comment">&lt;!--4.1 è®¾ç½®é˜Ÿåˆ—çš„è¿‡æœŸæ—¶é—´ ttl--&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-message-ttl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10000&quot;</span> <span class="hljs-attr">value-type</span>=<span class="hljs-string">&quot;java.lang.Integer&quot;</span> /&gt;</span><br>           <span class="hljs-comment">&lt;!--4.2 è®¾ç½®é˜Ÿåˆ—çš„é•¿åº¦é™åˆ¶ max-length --&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-max-length&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attr">value-type</span>=<span class="hljs-string">&quot;java.lang.Integer&quot;</span> /&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue-arguments</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:topic-exchange</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;test_exchange_dlx&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;test.dlx.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;test_queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:binding</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:topic-exchange</span>&gt;</span><br><br><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      2. å£°æ˜æ­»ä¿¡é˜Ÿåˆ—(queue_dlx)å’Œæ­»ä¿¡äº¤æ¢æœº(exchange_dlx)</span><br><span class="hljs-comment">  --&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;queue_dlx&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:topic-exchange</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;exchange_dlx&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;dlx.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:binding</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:topic-exchange</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p><code>src/test/java/com/itheima/test/ProducerTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å‘é€æµ‹è¯•æ­»ä¿¡æ¶ˆæ¯ï¼š</span><br><span class="hljs-comment">     *  1. è¿‡æœŸæ—¶é—´</span><br><span class="hljs-comment">     *  2. é•¿åº¦é™åˆ¶</span><br><span class="hljs-comment">     *  3. æ¶ˆæ¯æ‹’æ”¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDlx</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//1. æµ‹è¯•è¿‡æœŸæ—¶é—´ï¼Œæ­»ä¿¡æ¶ˆæ¯</span><br>        <span class="hljs-comment">//rabbitTemplate.convertAndSend(&quot;test_exchange_dlx&quot;,&quot;test.dlx.haha&quot;,&quot;æˆ‘æ˜¯ä¸€æ¡æ¶ˆæ¯ï¼Œæˆ‘ä¼šæ­»å—ï¼Ÿ&quot;);</span><br><br>        <span class="hljs-comment">//2. æµ‹è¯•é•¿åº¦é™åˆ¶åï¼Œæ¶ˆæ¯æ­»ä¿¡</span><br>       <span class="hljs-comment">/* for (int i = 0; i &lt; 20; i++) &#123;</span><br><span class="hljs-comment">            rabbitTemplate.convertAndSend(&quot;test_exchange_dlx&quot;,&quot;test.dlx.haha&quot;,&quot;æˆ‘æ˜¯ä¸€æ¡æ¶ˆæ¯ï¼Œæˆ‘ä¼šæ­»å—ï¼Ÿ&quot;);</span><br><span class="hljs-comment">        &#125;*/</span><br><br>        <span class="hljs-comment">//3. æµ‹è¯•æ¶ˆæ¯æ‹’æ”¶</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;test_exchange_dlx&quot;</span>,<span class="hljs-string">&quot;test.dlx.haha&quot;</span>,<span class="hljs-string">&quot;æˆ‘æ˜¯ä¸€æ¡æ¶ˆæ¯ï¼Œæˆ‘ä¼šæ­»å—ï¼Ÿ&quot;</span>);<br><br>    &#125;<br><br><br></code></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…</p><p><code>src/main/resources/spring-rabbitmq-consumer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å®šä¹‰ç›‘å¬å™¨å®¹å™¨--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener-container</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">acknowledge</span>=<span class="hljs-string">&quot;manual&quot;</span> <span class="hljs-attr">prefetch</span>=<span class="hljs-string">&quot;1&quot;</span> &gt;</span><br>        <span class="hljs-comment">&lt;!--å®šä¹‰ç›‘å¬å™¨ï¼Œç›‘å¬æ­£å¸¸é˜Ÿåˆ—--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dlxListener&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;test_queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener-container</span>&gt;</span><br></code></pre></td></tr></table></figure><p><code>src/main/java/com/itheima/listener/DlxListener.java    </code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DlxListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ChannelAwareMessageListener</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-keyword">long</span> deliveryTag = message.getMessageProperties().getDeliveryTag();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.æ¥æ”¶è½¬æ¢æ¶ˆæ¯</span><br>            System.out.println(<span class="hljs-keyword">new</span> String(message.getBody()));<br><br>            <span class="hljs-comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span><br>            System.out.println(<span class="hljs-string">&quot;å¤„ç†ä¸šåŠ¡é€»è¾‘...&quot;</span>);<br>            <span class="hljs-keyword">int</span> i = <span class="hljs-number">3</span>/<span class="hljs-number">0</span>;<span class="hljs-comment">//å‡ºç°é”™è¯¯</span><br>            <span class="hljs-comment">//3. æ‰‹åŠ¨ç­¾æ”¶</span><br>            channel.basicAck(deliveryTag,<span class="hljs-keyword">true</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-comment">//e.printStackTrace();</span><br>            System.out.println(<span class="hljs-string">&quot;å‡ºç°å¼‚å¸¸ï¼Œæ‹’ç»æ¥å—&quot;</span>);<br>            <span class="hljs-comment">//4.æ‹’ç»ç­¾æ”¶ï¼Œä¸é‡å›é˜Ÿåˆ— requeue=false</span><br>            channel.basicNack(deliveryTag,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§ï¼š</p><ul><li>æ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—å’Œæ™®é€šçš„æ²¡æœ‰åŒºåˆ«</li><li>å½“æ¶ˆæ¯æˆä¸ºæ­»ä¿¡åï¼Œå¦‚æœè¯¥é˜Ÿåˆ—ç»‘å®šäº†æ­»ä¿¡äº¤æ¢æœºï¼Œåˆ™æ¶ˆæ¯ä¼šè¢«æ­»ä¿¡äº¤æ¢æœºé‡æ–°è·¯ç”±åˆ°æ­»ä¿¡é˜Ÿåˆ—</li></ul><h2 id="å»¶è¿Ÿé˜Ÿåˆ—"><a href="#å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—"></a>å»¶è¿Ÿé˜Ÿåˆ—</h2><p>å»¶è¿Ÿé˜Ÿåˆ—ï¼Œå³æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—åä¸ä¼šç«‹å³è¢«æ¶ˆè´¹ï¼Œåªæœ‰åˆ°è¾¾æŒ‡å®šæ—¶é—´åï¼Œæ‰ä¼šè¢«æ¶ˆè´¹ã€‚</p><p>å¦‚éœ€æ±‚ï¼š1ï¼‰ä¸‹å•åï¼Œ30åˆ†é’Ÿæœªæ”¯ä»˜ï¼Œå–æ¶ˆè®¢å•ï¼Œå›æ»šåº“å­˜ã€‚2ï¼‰ æ–°ç”¨æˆ·æ³¨å†ŒæˆåŠŸ7å¤©åï¼Œå‘é€çŸ­ä¿¡é—®å€™ã€‚</p><p>å®ç°æ–¹å¼ï¼š</p><ul><li><p>å®šæ—¶å™¨ï¼ˆæ•ˆæœå·®ï¼‰</p></li><li><p>å»¶è¿Ÿé˜Ÿåˆ—</p></li></ul><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224232518669.png" alt="image-20210224232518669"></p><p>å¾ˆå¯æƒœï¼Œåœ¨RabbitMQä¸­å¹¶æœªæä¾›å»¶è¿Ÿé˜Ÿåˆ—åŠŸèƒ½ã€‚</p><p>ä½†æ˜¯å¯ä»¥ä½¿ç”¨ï¼š==TTL+æ­»ä¿¡é˜Ÿåˆ—== ç»„åˆå®ç°å»¶è¿Ÿé˜Ÿåˆ—çš„æ•ˆæœã€‚ã€‚</p><h3 id="ä»£ç å®ç°-4"><a href="#ä»£ç å®ç°-4" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p><code>src/main/resources/spring-rabbitmq-producer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       å»¶è¿Ÿé˜Ÿåˆ—ï¼š</span><br><span class="hljs-comment">           1. å®šä¹‰æ­£å¸¸äº¤æ¢æœºï¼ˆorder_exchangeï¼‰å’Œé˜Ÿåˆ—(order_queue)</span><br><span class="hljs-comment">           2. å®šä¹‰æ­»ä¿¡äº¤æ¢æœºï¼ˆorder_exchange_dlxï¼‰å’Œé˜Ÿåˆ—(order_queue_dlx)</span><br><span class="hljs-comment">           3. ç»‘å®šï¼Œè®¾ç½®æ­£å¸¸é˜Ÿåˆ—è¿‡æœŸæ—¶é—´ä¸º30åˆ†é’Ÿ</span><br><span class="hljs-comment">   --&gt;</span><br>   <span class="hljs-comment">&lt;!-- 1. å®šä¹‰æ­£å¸¸äº¤æ¢æœºï¼ˆorder_exchangeï¼‰å’Œé˜Ÿåˆ—(order_queue)--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;order_queue&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;order_queue&quot;</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- 3. ç»‘å®šï¼Œè®¾ç½®æ­£å¸¸é˜Ÿåˆ—è¿‡æœŸæ—¶é—´ä¸º30åˆ†é’Ÿ--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue-arguments</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-dead-letter-exchange&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;order_exchange_dlx&quot;</span> /&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-dead-letter-routing-key&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;dlx.order.cancel&quot;</span> /&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;x-message-ttl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10000&quot;</span> <span class="hljs-attr">value-type</span>=<span class="hljs-string">&quot;java.lang.Integer&quot;</span> /&gt;</span><br><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue-arguments</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:topic-exchange</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;order_exchange&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;order.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;order_queue&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:binding</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:topic-exchange</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--  2. å®šä¹‰æ­»ä¿¡äº¤æ¢æœºï¼ˆorder_exchange_dlxï¼‰å’Œé˜Ÿåˆ—(order_queue_dlx)--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:queue</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;order_queue_dlx&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;order_queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:queue</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:topic-exchange</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;order_exchange_dlx&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:binding</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;dlx.order.#&quot;</span> <span class="hljs-attr">queue</span>=<span class="hljs-string">&quot;order_queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:binding</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:bindings</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:topic-exchange</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p><code>src/test/java/com/itheima/test/ProducerTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title">testDelay</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>        <span class="hljs-comment">//1.å‘é€è®¢å•æ¶ˆæ¯ã€‚ å°†æ¥æ˜¯åœ¨è®¢å•ç³»ç»Ÿä¸­ï¼Œä¸‹å•æˆåŠŸåï¼Œå‘é€æ¶ˆæ¯</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;order_exchange&quot;</span>,<span class="hljs-string">&quot;order.msg&quot;</span>,<span class="hljs-string">&quot;è®¢å•ä¿¡æ¯ï¼šid=1,time=2019å¹´8æœˆ17æ—¥16:41:47&quot;</span>);<br><br><br>        <span class="hljs-comment">/*//2.æ‰“å°å€’è®¡æ—¶10ç§’</span><br><span class="hljs-comment">        for (int i = 10; i &gt; 0 ; i--) &#123;</span><br><span class="hljs-comment">            System.out.println(i+&quot;...&quot;);</span><br><span class="hljs-comment">            Thread.sleep(1000);</span><br><span class="hljs-comment">        &#125;*/</span><br><br><br>    &#125;<br></code></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…</p><p><code>src/main/resources/spring-rabbitmq-consumer.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener-container</span> <span class="hljs-attr">connection-factory</span>=<span class="hljs-string">&quot;connectionFactory&quot;</span> <span class="hljs-attr">acknowledge</span>=<span class="hljs-string">&quot;manual&quot;</span> <span class="hljs-attr">prefetch</span>=<span class="hljs-string">&quot;1&quot;</span> &gt;</span><br>    <span class="hljs-comment">&lt;!--å»¶è¿Ÿé˜Ÿåˆ—æ•ˆæœå®ç°ï¼š  ä¸€å®šè¦ç›‘å¬çš„æ˜¯ æ­»ä¿¡é˜Ÿåˆ—ï¼ï¼ï¼--&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">rabbit:listener</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;orderListener&quot;</span> <span class="hljs-attr">queue-names</span>=<span class="hljs-string">&quot;order_queue_dlx&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rabbit:listener-container</span>&gt;</span><br></code></pre></td></tr></table></figure><p><code>src/main/java/com/itheima/listener/OrderListener.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ChannelAwareMessageListener</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-keyword">long</span> deliveryTag = message.getMessageProperties().getDeliveryTag();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.æ¥æ”¶è½¬æ¢æ¶ˆæ¯</span><br>            System.out.println(<span class="hljs-keyword">new</span> String(message.getBody()));<br><br>            <span class="hljs-comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span><br>            System.out.println(<span class="hljs-string">&quot;å¤„ç†ä¸šåŠ¡é€»è¾‘...&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;æ ¹æ®è®¢å•idæŸ¥è¯¢å…¶çŠ¶æ€...&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;åˆ¤æ–­çŠ¶æ€æ˜¯å¦ä¸ºæ”¯ä»˜æˆåŠŸ&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;å–æ¶ˆè®¢å•ï¼Œå›æ»šåº“å­˜....&quot;</span>);<br>            <span class="hljs-comment">//3. æ‰‹åŠ¨ç­¾æ”¶</span><br>            channel.basicAck(deliveryTag,<span class="hljs-keyword">true</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-comment">//e.printStackTrace();</span><br>            System.out.println(<span class="hljs-string">&quot;å‡ºç°å¼‚å¸¸ï¼Œæ‹’ç»æ¥å—&quot;</span>);<br>            <span class="hljs-comment">//4.æ‹’ç»ç­¾æ”¶ï¼Œä¸é‡å›é˜Ÿåˆ— requeue=false</span><br>            channel.basicNack(deliveryTag,<span class="hljs-keyword">true</span>,<span class="hljs-keyword">false</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ—¥å¿—ä¸ç›‘æ§"><a href="#æ—¥å¿—ä¸ç›‘æ§" class="headerlink" title="æ—¥å¿—ä¸ç›‘æ§"></a>æ—¥å¿—ä¸ç›‘æ§</h2><h3 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h3><ul><li><p>RabbitMQé»˜è®¤æ—¥å¿—å­˜æ”¾è·¯å¾„ï¼š /var/log/rabbitmq/rabbit@xxx.log</p></li><li><p>æ—¥å¿—åŒ…å«äº†RabbitMQçš„ç‰ˆæœ¬å·ã€Erlangçš„ç‰ˆæœ¬å·ã€RabbitMQæœåŠ¡èŠ‚ç‚¹åç§°ã€cookieçš„hashå€¼ã€RabbitMQé…ç½®æ–‡ä»¶åœ°å€ã€å†…å­˜é™åˆ¶ã€ç£ç›˜é™åˆ¶ã€é»˜è®¤è´¦æˆ·guestçš„åˆ›å»ºä»¥åŠæƒé™é…ç½®ç­‰ç­‰</p></li></ul><h3 id="rabbitmqctlç®¡ç†å’Œç›‘æ§"><a href="#rabbitmqctlç®¡ç†å’Œç›‘æ§" class="headerlink" title="rabbitmqctlç®¡ç†å’Œç›‘æ§"></a>rabbitmqctlç®¡ç†å’Œç›‘æ§</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs shell">æŸ¥çœ‹å¦‚ä½•ä½¿ç”¨<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl <span class="hljs-built_in">help</span></span><br><br>æŸ¥çœ‹é˜Ÿåˆ—<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_queues</span><br><br>æŸ¥çœ‹exchanges<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_exchanges</span><br><br>æŸ¥çœ‹ç”¨æˆ·<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_users</span><br><br>æŸ¥çœ‹è¿æ¥<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_connections</span><br><br>æŸ¥çœ‹æ¶ˆè´¹è€…ä¿¡æ¯<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_consumers</span><br><br>æŸ¥çœ‹ç¯å¢ƒå˜é‡<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl environment</span><br><br>æŸ¥çœ‹æœªè¢«ç¡®è®¤çš„é˜Ÿåˆ—<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_queues  name messages_unacknowledged</span><br><br>æŸ¥çœ‹å•ä¸ªé˜Ÿåˆ—çš„å†…å­˜ä½¿ç”¨<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_queues name memory</span><br><br>æŸ¥çœ‹å‡†å¤‡å°±ç»ªçš„é˜Ÿåˆ—<br><span class="hljs-meta">#</span><span class="bash"> rabbitmqctl list_queues name messages_ready</span><br><br></code></pre></td></tr></table></figure><h2 id="æ¶ˆæ¯å¯é æ€§åˆ†æä¸è¿½è¸ª"><a href="#æ¶ˆæ¯å¯é æ€§åˆ†æä¸è¿½è¸ª" class="headerlink" title="æ¶ˆæ¯å¯é æ€§åˆ†æä¸è¿½è¸ª"></a>æ¶ˆæ¯å¯é æ€§åˆ†æä¸è¿½è¸ª</h2><ul><li><p>åœ¨ä½¿ç”¨ä»»ä½•æ¶ˆæ¯ä¸­é—´ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œéš¾å…ä¼šå‡ºç°æŸæ¡æ¶ˆæ¯å¼‚å¸¸ä¸¢å¤±çš„æƒ…å†µã€‚å¯¹äºRabbitMQè€Œè¨€ï¼Œå¯èƒ½æ˜¯å› ä¸ºç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…ä¸RabbitMQæ–­å¼€äº†è¿æ¥ï¼Œè€Œå®ƒä»¬ä¸RabbitMQåˆé‡‡ç”¨äº†ä¸åŒçš„ç¡®è®¤æœºåˆ¶ï¼›ä¹Ÿæœ‰å¯èƒ½æ˜¯å› ä¸ºäº¤æ¢å™¨ä¸é˜Ÿåˆ—ä¹‹é—´ä¸åŒçš„è½¬å‘ç­–ç•¥ï¼›ç”šè‡³æ˜¯äº¤æ¢å™¨å¹¶æ²¡æœ‰ä¸ä»»ä½•é˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œç”Ÿäº§è€…åˆä¸æ„ŸçŸ¥æˆ–è€…æ²¡æœ‰é‡‡å–ç›¸åº”çš„æªæ–½ï¼›å¦å¤–RabbitMQæœ¬èº«çš„é›†ç¾¤ç­–ç•¥ä¹Ÿå¯èƒ½å¯¼è‡´æ¶ˆæ¯çš„ä¸¢å¤±ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æœ‰ä¸€ä¸ªè¾ƒå¥½çš„æœºåˆ¶è·Ÿè¸ªè®°å½•æ¶ˆæ¯çš„æŠ•é€’è¿‡ç¨‹ï¼Œä»¥æ­¤ååŠ©å¼€å‘å’Œè¿ç»´äººå‘˜è¿›è¡Œé—®é¢˜çš„å®šä½ã€‚</p></li><li><p>åœ¨RabbitMQä¸­å¯ä»¥ä½¿ç”¨Firehoseå’Œrabbitmq_tracingæ’ä»¶åŠŸèƒ½æ¥å®ç°æ¶ˆæ¯è¿½è¸ªã€‚</p></li></ul><h3 id="æ¶ˆæ¯è¿½è¸ª-Firehose"><a href="#æ¶ˆæ¯è¿½è¸ª-Firehose" class="headerlink" title="æ¶ˆæ¯è¿½è¸ª-Firehose"></a>æ¶ˆæ¯è¿½è¸ª-Firehose</h3><ul><li>firehoseçš„æœºåˆ¶æ˜¯å°†ç”Ÿäº§è€…æŠ•é€’ç»™rabbitmqçš„æ¶ˆæ¯ï¼ŒrabbitmqæŠ•é€’ç»™æ¶ˆè´¹è€…çš„æ¶ˆæ¯æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼å‘é€åˆ°é»˜è®¤çš„exchangeä¸Šã€‚è¿™ä¸ªé»˜è®¤çš„exchangeçš„åç§°ä¸ºamq.rabbitmq.traceï¼Œå®ƒæ˜¯ä¸€ä¸ªtopicç±»å‹çš„exchangeã€‚å‘é€åˆ°è¿™ä¸ªexchangeä¸Šçš„æ¶ˆæ¯çš„routing keyä¸º publish.exchangename å’Œ deliver.queuenameã€‚å…¶ä¸­exchangenameå’Œqueuenameä¸ºå®é™…exchangeå’Œqueueçš„åç§°ï¼Œåˆ†åˆ«å¯¹åº”ç”Ÿäº§è€…æŠ•é€’åˆ°exchangeçš„æ¶ˆæ¯ï¼Œå’Œæ¶ˆè´¹è€…ä»queueä¸Šè·å–çš„æ¶ˆæ¯ã€‚</li></ul><p>æ³¨æ„ï¼šæ‰“å¼€ trace ä¼šå½±å“æ¶ˆæ¯å†™å…¥åŠŸèƒ½ï¼Œé€‚å½“æ‰“å¼€åè¯·å…³é—­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">rabbitmqctl trace_onï¼š<br><span class="hljs-meta">#</span><span class="bash"> å¼€å¯Firehoseå‘½ä»¤</span><br><br>rabbitmqctl trace_offï¼š<br><span class="hljs-meta">#</span><span class="bash">å…³é—­Firehoseå‘½ä»¤</span><br></code></pre></td></tr></table></figure><h3 id="æ¶ˆæ¯è¿½è¸ª-rabbitmq-tracingæ’ä»¶"><a href="#æ¶ˆæ¯è¿½è¸ª-rabbitmq-tracingæ’ä»¶" class="headerlink" title="æ¶ˆæ¯è¿½è¸ª-rabbitmq_tracingæ’ä»¶"></a>æ¶ˆæ¯è¿½è¸ª-rabbitmq_tracingæ’ä»¶</h3><p>ä½¿ç”¨rabbitmq_tracingæ’ä»¶åŠŸèƒ½æ¥å®ç°æ¶ˆæ¯è¿½è¸ª</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">rabbitmq-plugins enable rabbitmq_tracing<br><span class="hljs-meta">#</span><span class="bash"> å¼€å¯æ’ä»¶</span><br></code></pre></td></tr></table></figure><h1 id="RabbitMQ-åº”ç”¨é—®é¢˜"><a href="#RabbitMQ-åº”ç”¨é—®é¢˜" class="headerlink" title="RabbitMQ åº”ç”¨é—®é¢˜"></a>RabbitMQ åº”ç”¨é—®é¢˜</h1><h2 id="æ¶ˆæ¯å¯é æ€§ä¿éšœ"><a href="#æ¶ˆæ¯å¯é æ€§ä¿éšœ" class="headerlink" title="æ¶ˆæ¯å¯é æ€§ä¿éšœ"></a>æ¶ˆæ¯å¯é æ€§ä¿éšœ</h2><p><strong>æ¶ˆæ¯è¡¥å¿æœºåˆ¶</strong></p><p>éœ€æ±‚ï¼š100%ç¡®ä¿æ¶ˆæ¯å‘é€æˆåŠŸ</p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224235411180.png" alt="image-20210224235411180"></p><h2 id="æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ"><a href="#æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ" class="headerlink" title="æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ"></a>æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ</h2><ul><li><p>å¹‚ç­‰æ€§æŒ‡ä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€ä¸ªèµ„æºï¼Œå¯¹äºèµ„æºæœ¬èº«åº”è¯¥å…·æœ‰åŒæ ·çš„ç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œå¯¹èµ„æºæœ¬èº«æ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚</p></li><li><p>åœ¨MQä¸­æŒ‡ï¼Œæ¶ˆè´¹å¤šæ¡ç›¸åŒçš„æ¶ˆæ¯ï¼Œå¾—åˆ°ä¸æ¶ˆè´¹è¯¥æ¶ˆæ¯ä¸€æ¬¡ç›¸åŒçš„ç»“æœã€‚</p></li></ul><p><strong>ä¹è§‚é”è§£å†³æ–¹æ¡ˆ</strong></p><p><img src="/2021/02/22/RabbitMQ%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210224235547502.png" alt="image-20210224235547502"></p>]]></content>
    
    
    <categories>
      
      <category>æœªå½’æ¡£</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså®‰è£…æ­¥éª¤ï¼ˆWindowsã€Linuxï¼‰ã€Rediså‹æµ‹å·¥å…·</title>
    <link href="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/"/>
    <url>/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="Windowså®‰è£…"><a href="#Windowså®‰è£…" class="headerlink" title="Windowså®‰è£…"></a>Windowså®‰è£…</h2><p>1ã€ä¸‹è½½å®‰è£…åŒ…ï¼š<a href="https://github.com/dmajkic/redis/releases">https://github.com/dmajkic/redis/releases</a></p><p>2ã€ä¸‹è½½å®Œæ¯•å¾—åˆ°å‹ç¼©åŒ…ï¼š</p><p>3ã€è§£å‹åˆ°è‡ªå·±ç”µè„‘ä¸Šçš„ç¯å¢ƒç›®å½•ä¸‹çš„å°±å¯ä»¥çš„ï¼Redis ååˆ†çš„å°ï¼Œåªæœ‰5M</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219162648326.png" alt="image-20210219162648326"></p><p>4ã€å¼€å¯Redisï¼ŒåŒå‡»è¿è¡ŒæœåŠ¡å³å¯ï¼</p><p>5ã€ä½¿ç”¨rediså®¢æˆ·å•æ¥æ¥è¿æ¥redis</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219162728663.png" alt="image-20210219162728663"></p><p>Windowä¸‹ä½¿ç”¨ç®€å•ï¼Œä½†æ˜¯Redis æ¨èæˆ‘ä»¬ä½¿ç”¨Linuxå»å¼€å‘ä½¿ç”¨ï¼</p><h2 id="Linuxå®‰è£…"><a href="#Linuxå®‰è£…" class="headerlink" title="Linuxå®‰è£…"></a>Linuxå®‰è£…</h2><p>1ã€ä¸‹è½½å®‰è£…åŒ…ï¼ <code>redis-5.0.8.tar.gz</code> ä¸Šä¼ åˆ°è™šæ‹Ÿæœºtoolsç›®å½•ä¸‹</p><p>å®˜ç½‘ï¼š<a href="https://redis.io/">https://redis.io/</a></p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219163055743.png" alt="image-20210219163055743"></p><p>2ã€è§£å‹Redisçš„å®‰è£…åŒ…ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf /tools/redis-6.0.10.tar.gz  -C /training/<br></code></pre></td></tr></table></figure><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219164007275.png" alt="image-20210219164007275"></p><p>3ã€è¿›å…¥è§£å‹åçš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬redisçš„é…ç½®æ–‡ä»¶</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219164329163.png" alt="image-20210219164329163"></p><p>4ã€åŸºæœ¬çš„ç¯å¢ƒå®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 1ã€å®‰è£…c++ç¯å¢ƒ</span><br>yum install gcc-c++ <br><br><span class="hljs-meta">#</span><span class="bash"> æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ</span><br>gcc -v<br><br></code></pre></td></tr></table></figure><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219164949305.png" alt="image-20210219164949305"></p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219165019560.png" alt="image-20210219165019560"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 2ã€å°†æ‰€æœ‰éœ€è¦çš„æ–‡ä»¶é…ç½®ä¸Š</span><br>make<br><br><span class="hljs-meta">#</span><span class="bash"> !!!æ³¨æ„redis6.0ä»¥ä¸Šä¼šå‡ºé”™</span><br><span class="hljs-meta">#</span><span class="bash"> å®‰è£…6.0ä»¥ä¸Šç‰ˆæœ¬éœ€è¦å‡çº§gccåˆ°5.3åŠä»¥ä¸Š,å¦‚ä¸‹ï¼šå‡çº§åˆ°gcc 9.3ï¼š</span><br>yum -y install centos-release-scl<br><br>yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils<br><br>scl enable devtoolset-9 bash<br><br><span class="hljs-meta">#</span><span class="bash"> éœ€è¦æ³¨æ„çš„æ˜¯sclå‘½ä»¤å¯ç”¨åªæ˜¯ä¸´æ—¶çš„ï¼Œé€€å‡ºshellæˆ–é‡å¯å°±ä¼šæ¢å¤åŸç³»ç»Ÿgccç‰ˆæœ¬ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> å¦‚æœè¦é•¿æœŸä½¿ç”¨gcc 9.3çš„è¯ï¼š</span><br>echo &quot;source /opt/rh/devtoolset-9/enable&quot; &gt;&gt;/etc/profile<br><span class="hljs-meta">#</span><span class="bash"> è¿™æ ·é€€å‡ºshellé‡æ–°æ‰“å¼€å°±æ˜¯æ–°ç‰ˆçš„gccäº†</span><br><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 3ã€</span><br>make install<br></code></pre></td></tr></table></figure><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219170438172.png" alt="image-20210219170438172"></p><p>5ã€redisçš„é»˜è®¤å®‰è£…è·¯å¾„ <code>/usr/local/bin</code></p><p>è¿›å…¥æ­¤å®‰è£…è·¯å¾„</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219170808808.png" alt="image-20210219170808808"></p><p>6ã€å°†redisé…ç½®æ–‡ä»¶ã€‚å¤åˆ¶åˆ°æˆ‘ä»¬å½“å‰ç›®å½•ä¸‹ï¼ˆåœ¨æ­¤ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å­˜æ”¾ï¼‰</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219171039670.png" alt="image-20210219171039670"></p><p>æˆ‘ä»¬ä»¥åå°±ä½¿ç”¨è¿™ä¸ªæ–°å»ºçš„ç›®å½•ä¸­çš„redis.confè¿›è¡Œä¿®æ”¹é…ç½®</p><p>7ã€redisé»˜è®¤ä¸æ˜¯åå°å¯åŠ¨çš„ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219171514163.png" alt="image-20210219171514163"></p><h3 id="å¯åŠ¨RedisæœåŠ¡ï¼"><a href="#å¯åŠ¨RedisæœåŠ¡ï¼" class="headerlink" title="å¯åŠ¨RedisæœåŠ¡ï¼"></a>å¯åŠ¨RedisæœåŠ¡ï¼</h3><p>é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219230530598.png" alt="image-20210219230530598"></p><h3 id="ä½¿ç”¨redis-cli-è¿›è¡Œè¿æ¥æµ‹è¯•ï¼"><a href="#ä½¿ç”¨redis-cli-è¿›è¡Œè¿æ¥æµ‹è¯•ï¼" class="headerlink" title="ä½¿ç”¨redis-cli è¿›è¡Œè¿æ¥æµ‹è¯•ï¼"></a>ä½¿ç”¨redis-cli è¿›è¡Œè¿æ¥æµ‹è¯•ï¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Ttttttttttt">redis-cli -p 6379<br></code></pre></td></tr></table></figure><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219230433989.png" alt="image-20210219230433989"></p><p>æŸ¥çœ‹redisçš„è¿›ç¨‹æ˜¯å¦å¼€å¯ï¼</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219230704401.png" alt="image-20210219230704401"></p><h3 id="å…³é—­RedisæœåŠ¡å‘¢ï¼Ÿ-shutdown"><a href="#å…³é—­RedisæœåŠ¡å‘¢ï¼Ÿ-shutdown" class="headerlink" title="å…³é—­RedisæœåŠ¡å‘¢ï¼Ÿ shutdown"></a>å…³é—­RedisæœåŠ¡å‘¢ï¼Ÿ <code>shutdown</code></h3><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219230827108.png" alt="image-20210219230827108"></p><p>å†æ¬¡æŸ¥çœ‹è¿›ç¨‹æ˜¯å¦å­˜åœ¨</p><p><img src="/2021/02/20/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%88Windows%E3%80%81Linux%EF%BC%89/image-20210219230907067.png" alt="image-20210219230907067"></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤§æ•°æ®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NoSqlä»‹ç»</title>
    <link href="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/NoSql%E4%BB%8B%E7%BB%8D/"/>
    <url>/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/NoSql%E4%BB%8B%E7%BB%8D/</url>
    
    <content type="html"><![CDATA[<p>ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œç¤¾äº¤ç½‘ç»œï¼Œåœ°ç†ä½ç½®ã€‚ç”¨æˆ·è‡ªå·±äº§ç”Ÿçš„æ•°æ®ï¼Œç”¨æˆ·æ—¥å¿—ç­‰ç­‰çˆ†å‘å¼å¢é•¿ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨NoSQLæ•°æ®åº“çš„ï¼ŒNosql å¯ä»¥å¾ˆå¥½çš„å¤„ç†ä»¥ä¸Šçš„æƒ…å†µï¼</p><ul><li><p>NoSQL = Not Only SQL ï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰</p><ul><li>å…³ç³»å‹æ•°æ®åº“ï¼šè¡¨æ ¼ ï¼Œè¡Œ ï¼Œåˆ—</li><li>æ³›æŒ‡éå…³ç³»å‹æ•°æ®åº“çš„ï¼Œéšç€web2.0äº’è”ç½‘çš„è¯ç”Ÿï¼ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å¾ˆéš¾å¯¹ä»˜web2.0æ—¶ä»£ï¼å°¤å…¶æ˜¯è¶…å¤§è§„æ¨¡çš„é«˜å¹¶å‘çš„ç¤¾åŒºï¼ æš´éœ²å‡ºæ¥å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼ŒNoSQLåœ¨å½“ä»Šå¤§æ•°æ®ç¯å¢ƒä¸‹å‘å±•çš„ååˆ†è¿…é€Ÿï¼ŒRedisæ˜¯å‘å±•æœ€å¿«çš„ï¼Œè€Œä¸”æ˜¯æˆ‘ä»¬å½“ä¸‹å¿…é¡»è¦æŒæ¡çš„ä¸€ä¸ªæŠ€æœ¯ï¼<br>å¾ˆå¤šçš„æ•°æ®ç±»å‹ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œç¤¾äº¤ç½‘ç»œï¼Œåœ°ç†ä½ç½®ã€‚è¿™äº›æ•°æ®ç±»å‹çš„å­˜å‚¨ä¸éœ€è¦ä¸€ä¸ªå›ºå®šçš„æ ¼å¼ï¼</li></ul></li><li><p>ä¸éœ€è¦å¤šä½™çš„æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•çš„ ï¼ Map&lt;String,Object&gt; ä½¿ç”¨é”®å€¼å¯¹æ¥æ§åˆ¶ï¼</p></li></ul><h1 id="NoSQL-ç‰¹ç‚¹"><a href="#NoSQL-ç‰¹ç‚¹" class="headerlink" title="NoSQL ç‰¹ç‚¹"></a>NoSQL ç‰¹ç‚¹</h1><p><strong>è§£è€¦</strong></p><ol><li>æ–¹ä¾¿æ‰©å±•ï¼ˆæ•°æ®ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼Œå¾ˆå¥½æ‰©å±•ï¼ï¼‰</li><li>å¤§æ•°æ®é‡é«˜æ€§èƒ½ï¼ˆRedis ä¸€ç§’å†™8ä¸‡æ¬¡ï¼Œè¯»å–11ä¸‡ï¼ŒNoSQLçš„ç¼“å­˜è®°å½•çº§ï¼Œæ˜¯ä¸€ç§ç»†ç²’åº¦çš„ç¼“å­˜ï¼Œæ€§èƒ½ä¼šæ¯”è¾ƒé«˜ï¼ï¼‰</li><li>æ•°æ®ç±»å‹æ˜¯å¤šæ ·å‹çš„ï¼ï¼ˆä¸éœ€è¦äº‹å…ˆè®¾è®¡æ•°æ®åº“ï¼éšå–éšç”¨ï¼å¦‚æœæ˜¯æ•°æ®é‡ååˆ†å¤§çš„è¡¨ï¼Œå¾ˆå¤šäººå°±æ— æ³•è®¾è®¡äº†ï¼ï¼‰</li><li>ä¼ ç»Ÿ RDBMS å’Œ NoSQL</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">ä¼ ç»Ÿçš„ RDBMS<br>- ç»“æ„åŒ–ç»„ç»‡<br>- SQL<br>- æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­ row col<br>- æ“ä½œæ“ä½œï¼Œæ•°æ®å®šä¹‰è¯­è¨€<br>- ä¸¥æ ¼çš„ä¸€è‡´æ€§<br>- åŸºç¡€çš„äº‹åŠ¡<br>- .....<br><br>Nosql<br>- ä¸ä»…ä»…æ˜¯æ•°æ®<br>- æ²¡æœ‰å›ºå®šçš„æŸ¥è¯¢è¯­è¨€<br>- é”®å€¼å¯¹å­˜å‚¨ï¼Œåˆ—å­˜å‚¨ï¼Œæ–‡æ¡£å­˜å‚¨ï¼Œå›¾å½¢æ•°æ®åº“ï¼ˆç¤¾äº¤å…³ç³»ï¼‰<br>- æœ€ç»ˆä¸€è‡´æ€§ï¼Œ<br>- CAPå®šç†å’ŒBASE ï¼ˆå¼‚åœ°å¤šæ´»ï¼‰ åˆçº§æ¶æ„å¸ˆï¼ï¼ˆç‹‚ç¥ç†å¿µï¼šåªè¦å­¦ä¸æ­»ï¼Œå°±å¾€æ­»é‡Œå­¦ï¼ï¼‰<br>- é«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œé«˜å¯æ‰©<br>- ....<br></code></pre></td></tr></table></figure><h1 id="äº†è§£ï¼š3V-3é«˜"><a href="#äº†è§£ï¼š3V-3é«˜" class="headerlink" title="äº†è§£ï¼š3V+3é«˜"></a>äº†è§£ï¼š3V+3é«˜</h1><p>å¤§æ•°æ®æ—¶ä»£çš„3Vï¼šä¸»è¦æ˜¯æè¿°é—®é¢˜çš„</p><ol><li>æµ·é‡Volume</li><li>å¤šæ ·Variety</li><li>å®æ—¶Velocity</li></ol><p>å¤§æ•°æ®æ—¶ä»£çš„3é«˜ï¼šä¸»è¦æ˜¯å¯¹ç¨‹åºçš„è¦æ±‚</p><ol><li>é«˜å¹¶å‘</li><li>é«˜å¯æ‰©</li><li>é«˜æ€§èƒ½</li></ol><p>çœŸæ­£åœ¨å…¬å¸ä¸­çš„å®è·µï¼šNoSQL + RDBMS ä¸€èµ·ä½¿ç”¨æ‰æ˜¯æœ€å¼ºçš„ï¼Œæ¯”å¦‚é˜¿é‡Œå·´å·´çš„æ¶æ„æ¼”è¿›</p><p>ä¸€ä¸ªç®€å•åœ°ç½‘é¡µèƒŒåçš„æŠ€æœ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 1ã€å•†å“çš„åŸºæœ¬ä¿¡æ¯    </span><br>åç§°ã€ä»·æ ¼ã€å•†å®¶ä¿¡æ¯ï¼›    <br>å…³ç³»å‹æ•°æ®åº“å°±å¯ä»¥è§£å†³äº†ï¼ MySQL / Oracle ï¼ˆæ·˜å®æ—©å¹´å°±å»IOEäº†ï¼- ç‹åšï¼šæ¨èæ–‡ç« ï¼šé˜¿é‡Œäº‘çš„è¿™ç¾¤ç–¯å­ï¼š40åˆ†é’Ÿé‡è¦ï¼ï¼‰    <br>æ·˜å®å†…éƒ¨çš„ MySQL ä¸æ˜¯å¤§å®¶ç”¨çš„ MySQL<br><span class="hljs-meta">#</span><span class="bash"> 2ã€å•†å“çš„æè¿°ã€è¯„è®ºï¼ˆæ–‡å­—æ¯”è¾ƒå¤šï¼‰    </span><br>æ–‡æ¡£å‹æ•°æ®åº“ä¸­ï¼ŒMongoDB<br><span class="hljs-meta">#</span><span class="bash"> 3ã€å›¾ç‰‡    </span><br>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ FastDFS    <br>- æ·˜å®è‡ªå·±çš„ TFS    <br>- Gooaleçš„ GFS    <br>- Hadoop HDFS    <br>- é˜¿é‡Œäº‘çš„ oss<br><span class="hljs-meta">#</span><span class="bash"> 4ã€å•†å“çš„å…³é”®å­— ï¼ˆæœç´¢ï¼‰    </span><br>- æœç´¢å¼•æ“ solr elasticsearch    <br>- ISerachï¼šå¤šéš†ï¼ˆå¤šå»äº†è§£ä¸€ä¸‹è¿™äº›æŠ€æœ¯å¤§ä½¬ï¼ï¼‰    <br>æ‰€æœ‰ç‰›é€¼çš„äººéƒ½æœ‰ä¸€æ®µè‹¦é€¼çš„å²æœˆï¼ä½†æ˜¯ä½ åªè¦åƒSBä¸€æ ·çš„å»åšæŒï¼Œç»ˆå°†ç‰›é€¼ï¼<br><span class="hljs-meta">#</span><span class="bash"> 5ã€å•†å“çƒ­é—¨çš„æ³¢æ®µä¿¡æ¯    </span><br>- å†…å­˜æ•°æ®åº“    <br>- Redis Tairã€Memache...<br><span class="hljs-meta">#</span><span class="bash"> 6ã€å•†å“çš„äº¤æ˜“ï¼Œå¤–éƒ¨çš„æ”¯ä»˜æ¥å£    </span><br>- ä¸‰æ–¹åº”ç”¨<br></code></pre></td></tr></table></figure><h1 id="NoSQLçš„å››å¤§åˆ†ç±»"><a href="#NoSQLçš„å››å¤§åˆ†ç±»" class="headerlink" title="NoSQLçš„å››å¤§åˆ†ç±»"></a>NoSQLçš„å››å¤§åˆ†ç±»</h1><h2 id="KVé”®å€¼å¯¹ï¼š"><a href="#KVé”®å€¼å¯¹ï¼š" class="headerlink" title="KVé”®å€¼å¯¹ï¼š"></a>KVé”®å€¼å¯¹ï¼š</h2><ul><li>æ–°æµªï¼šRedis</li><li>ç¾å›¢ï¼šRedis + Tair</li><li>é˜¿é‡Œã€ç™¾åº¦ï¼šRedis + memecache</li></ul><h2 id="æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆbsonæ ¼å¼-å’Œjsonä¸€æ ·ï¼‰ï¼š"><a href="#æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆbsonæ ¼å¼-å’Œjsonä¸€æ ·ï¼‰ï¼š" class="headerlink" title="æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆbsonæ ¼å¼ å’Œjsonä¸€æ ·ï¼‰ï¼š"></a>æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆbsonæ ¼å¼ å’Œjsonä¸€æ ·ï¼‰ï¼š</h2><ul><li>MongoDB ï¼ˆä¸€èˆ¬å¿…é¡»è¦æŒæ¡ï¼‰<ul><li>MongoDB æ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„æ•°æ®åº“ï¼ŒC++ ç¼–å†™ï¼Œä¸»è¦ç”¨æ¥å¤„ç†å¤§é‡çš„æ–‡æ¡£ï¼</li><li>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“ä¸­é—´çš„äº§å“ï¼MongoDB æ˜¯éå…³ç³»å‹æ•°æ®åº“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»å‹æ•°æ®åº“çš„ï¼</li></ul></li><li>ConthDB</li></ul><h2 id="åˆ—å­˜å‚¨æ•°æ®åº“ï¼š"><a href="#åˆ—å­˜å‚¨æ•°æ®åº“ï¼š" class="headerlink" title="åˆ—å­˜å‚¨æ•°æ®åº“ï¼š"></a>åˆ—å­˜å‚¨æ•°æ®åº“ï¼š</h2><ul><li>HBase</li><li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</li></ul><h2 id="å›¾å…³ç³»æ•°æ®åº“"><a href="#å›¾å…³ç³»æ•°æ®åº“" class="headerlink" title="å›¾å…³ç³»æ•°æ®åº“:"></a>å›¾å…³ç³»æ•°æ®åº“:</h2><ul><li>ä»–ä¸æ˜¯å­˜å›¾å½¢ï¼Œæ”¾çš„æ˜¯å…³ç³»ï¼Œæ¯”å¦‚ï¼šæœ‹å‹åœˆç¤¾äº¤ç½‘ç»œï¼Œå¹¿å‘Šæ¨èï¼</li><li>Neo4jï¼ŒInfoGridï¼›</li></ul><h2 id="å››è€…å¯¹æ¯”"><a href="#å››è€…å¯¹æ¯”" class="headerlink" title="å››è€…å¯¹æ¯”"></a>å››è€…å¯¹æ¯”</h2><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/NoSql%E4%BB%8B%E7%BB%8D/20201220115449142.png"></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤§æ•°æ®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså­¦ä¹ ç¬”è®°</title>
    <link href="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="Redisæ¦‚è¿°"><a href="#Redisæ¦‚è¿°" class="headerlink" title="Redisæ¦‚è¿°"></a>Redisæ¦‚è¿°</h1><p>Redisï¼ˆ==R==emote ==Di==ctionary ==S==erver )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ !</p><ul><li><p>æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSIï¼ŒCè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„API</p></li><li><p>redisä¼šå‘¨æœŸæ€§çš„æŠŠæ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº†master-slaveï¼ˆä¸»ä»ï¼‰åŒæ­¥ã€‚</p></li><li><p>æ˜¯å½“ä¸‹æœ€çƒ­é—¨çš„ NoSQL æŠ€æœ¯ä¹‹ä¸€ï¼Œä¹Ÿè¢«äººä»¬ç§°ä¹‹ä¸ºç»“æ„åŒ–æ•°æ®åº“ã€‚</p></li></ul><h2 id="Redisä½œç”¨"><a href="#Redisä½œç”¨" class="headerlink" title="Redisä½œç”¨"></a>Redisä½œç”¨</h2><ol><li>å†…å­˜å­˜å‚¨ã€æŒä¹…åŒ–ï¼Œå†…å­˜ä¸­æ˜¯æ–­ç”µå³å¤±ã€æ‰€ä»¥è¯´æŒä¹…åŒ–å¾ˆé‡è¦ï¼ˆrdbã€aofï¼‰</li><li>æ•ˆç‡é«˜ï¼Œå¯ä»¥ç”¨äºé«˜é€Ÿç¼“å­˜</li><li>å‘å¸ƒè®¢é˜…ç³»ç»Ÿ</li><li>åœ°å›¾ä¿¡æ¯åˆ†æ</li><li>è®¡æ—¶å™¨ã€è®¡æ•°å™¨ï¼ˆæµè§ˆé‡ï¼ï¼‰</li><li>â€¦â€¦..</li></ol><h2 id="Redisç‰¹æ€§"><a href="#Redisç‰¹æ€§" class="headerlink" title="Redisç‰¹æ€§"></a>Redisç‰¹æ€§</h2><p>1ã€å¤šæ ·çš„æ•°æ®ç±»å‹</p><p>2ã€æŒä¹…åŒ–</p><p>3ã€é›†ç¾¤</p><p>4ã€äº‹åŠ¡</p><h1 id="RedisæœåŠ¡ä½¿ç”¨"><a href="#RedisæœåŠ¡ä½¿ç”¨" class="headerlink" title="RedisæœåŠ¡ä½¿ç”¨"></a>RedisæœåŠ¡ä½¿ç”¨</h1><h3 id="å¯åŠ¨RedisæœåŠ¡"><a href="#å¯åŠ¨RedisæœåŠ¡" class="headerlink" title="å¯åŠ¨RedisæœåŠ¡"></a>å¯åŠ¨RedisæœåŠ¡</h3><p>é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210219230530598-1613785778498.png" alt="image-20210219230530598"></p><h3 id="ä½¿ç”¨redis-cli-è¿›è¡Œè¿æ¥æµ‹è¯•ï¼"><a href="#ä½¿ç”¨redis-cli-è¿›è¡Œè¿æ¥æµ‹è¯•ï¼" class="headerlink" title="ä½¿ç”¨redis-cli è¿›è¡Œè¿æ¥æµ‹è¯•ï¼"></a>ä½¿ç”¨redis-cli è¿›è¡Œè¿æ¥æµ‹è¯•ï¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">redis-cli -p 6379<br></code></pre></td></tr></table></figure><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210219230433989-1613785778504.png" alt="image-20210219230433989"></p><h3 id="æŸ¥çœ‹redisçš„è¿›ç¨‹æ˜¯å¦å¼€å¯"><a href="#æŸ¥çœ‹redisçš„è¿›ç¨‹æ˜¯å¦å¼€å¯" class="headerlink" title="æŸ¥çœ‹redisçš„è¿›ç¨‹æ˜¯å¦å¼€å¯"></a>æŸ¥çœ‹redisçš„è¿›ç¨‹æ˜¯å¦å¼€å¯</h3><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210219230704401-1613785778506.png" alt="image-20210219230704401"></p><h3 id="å…³é—­RedisæœåŠ¡-shutdown"><a href="#å…³é—­RedisæœåŠ¡-shutdown" class="headerlink" title="å…³é—­RedisæœåŠ¡ shutdown"></a>å…³é—­RedisæœåŠ¡ <code>shutdown</code></h3><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210219230827108-1613785778506.png" alt="image-20210219230827108"></p><h1 id="RedisåŸºç¡€"><a href="#RedisåŸºç¡€" class="headerlink" title="RedisåŸºç¡€"></a>RedisåŸºç¡€</h1><p>redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“</p><p>é»˜è®¤ä½¿ç”¨çš„æ˜¯ç¬¬0ä¸ª</p><h2 id="åŸºæœ¬å‘½ä»¤åŠå¯†ç è®¾ç½®"><a href="#åŸºæœ¬å‘½ä»¤åŠå¯†ç è®¾ç½®" class="headerlink" title="åŸºæœ¬å‘½ä»¤åŠå¯†ç è®¾ç½®"></a>åŸºæœ¬å‘½ä»¤åŠå¯†ç è®¾ç½®</h2><ul><li>é€‰æ‹©æ•°æ®åº“ <code>select</code></li><li>æŸ¥çœ‹æ•°æ®åº“å¤§å° <code>DBSIZE</code></li><li>æŸ¥çœ‹æ•°æ®åº“æ‰€æœ‰çš„key<code>key *</code></li><li>æ¸…é™¤å½“å‰æ•°æ®åº“ <code>flushdb</code></li><li>æ¸…é™¤å…¨éƒ¨æ•°æ®åº“çš„å†…å®¹ <code>FLUSHALL</code></li><li>è®¾ç½®å¯†ç ï¼š<code>config set requirepass 123456</code><ul><li>è®¾ç½®å¯†ç åæ¯æ¬¡ä½¿ç”¨éœ€è¦è¾“å…¥auth 123456</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost bin]# redis-server myconfig/redis.conf<br>[root@localhost bin]# redis-cli -p 6379<br>127.0.0.1:6379&gt; select 3 # é€‰æ‹©æ•°æ®åº“<br>OK<br>127.0.0.1:6379[3]&gt; DBSIZE # æŸ¥çœ‹æ•°æ®åº“å¤§å°<br>(integer) 0<br>127.0.0.1:6379[3]&gt; set name mochen<br>OK<br>127.0.0.1:6379[3]&gt; DBSIZE<br>(integer) 1<br>127.0.0.1:6379[3]&gt; get name<br>&quot;mochen&quot;<br>127.0.0.1:6379[3]&gt; flushdb   #æ¸…æ¥šå½“å‰æ•°æ®åº“<br>OK<br>127.0.0.1:6379[3]&gt; keys *<br>(empty list or set)<br></code></pre></td></tr></table></figure><h2 id="Redis-æ˜¯å•çº¿ç¨‹çš„"><a href="#Redis-æ˜¯å•çº¿ç¨‹çš„" class="headerlink" title="Redis æ˜¯å•çº¿ç¨‹çš„"></a>Redis æ˜¯å•çº¿ç¨‹çš„</h2><p>æ˜ç™½Redisæ˜¯å¾ˆå¿«çš„ï¼Œå®˜æ–¹è¡¨ç¤ºï¼ŒRedisæ˜¯åŸºäºå†…å­˜æ“ä½œï¼ŒCPUä¸æ˜¯Redisæ€§èƒ½ç“¶é¢ˆï¼ŒRedisçš„ç“¶é¢ˆæ˜¯æ ¹æ®æœºå™¨çš„å†…å­˜å’Œç½‘ç»œå¸¦å®½ï¼Œæ—¢ç„¶å¯ä»¥ä½¿ç”¨å•çº¿ç¨‹æ¥å®ç°ï¼Œå°±ä½¿ç”¨å•çº¿ç¨‹äº†ï¼</p><p>Redis æ˜¯C è¯­è¨€å†™çš„ï¼Œå®˜æ–¹æä¾›çš„æ•°æ®ä¸º 100000+ çš„QPSï¼Œå®Œå…¨ä¸æ¯”åŒæ ·æ˜¯ä½¿ç”¨ key-valeçš„Memecacheå·®ï¼</p><p>Redis ä¸ºä»€ä¹ˆå•çº¿ç¨‹è¿˜è¿™ä¹ˆå¿«ï¼Ÿ</p><p>1ã€è¯¯åŒº1ï¼šé«˜æ€§èƒ½çš„æœåŠ¡å™¨ä¸€å®šæ˜¯å¤šçº¿ç¨‹çš„ï¼Ÿ<br>2ã€è¯¯åŒº2ï¼šå¤šçº¿ç¨‹ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼ï¼‰ä¸€å®šæ¯”å•çº¿ç¨‹æ•ˆç‡é«˜ï¼</p><p><strong>æ ¸å¿ƒï¼š</strong>redis æ˜¯å°†æ‰€æœ‰çš„æ•°æ®å…¨éƒ¨æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥è¯´ä½¿ç”¨å•çº¿ç¨‹å»æ“ä½œæ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼Œå¤šçº¿ç¨‹ï¼ˆCPUä¸Šä¸‹æ–‡ä¼šåˆ‡æ¢ï¼šè€—æ—¶çš„æ“ä½œï¼‰ï¼Œå¯¹äºå†…å­˜ç³»ç»Ÿæ¥è¯´ï¼Œå¦‚æœæ²¡æœ‰ä¸Šä¸‹æ–‡åˆ‡æ¢æ•ˆç‡å°±æ˜¯æœ€é«˜çš„ï¼å¤šæ¬¡è¯»å†™éƒ½æ˜¯åœ¨ä¸€ä¸ªCPUä¸Šçš„ï¼Œåœ¨å†…å­˜æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå°±æ˜¯æœ€ä½³çš„æ–¹æ¡ˆï¼</p><h1 id="äº”å¤§æ•°æ®ç±»å‹"><a href="#äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="äº”å¤§æ•°æ®ç±»å‹"></a>äº”å¤§æ•°æ®ç±»å‹</h1><h2 id="Redis-Key"><a href="#Redis-Key" class="headerlink" title="Redis-Key"></a>Redis-Key</h2><ul><li>keys * æŸ¥çœ‹æ‰€æœ‰çš„key</li><li>set name kuangshen set key value</li><li>EXISTS name åˆ¤æ–­å½“å‰çš„keyæ˜¯å¦å­˜åœ¨</li><li>move name 1 ç§»é™¤å½“å‰çš„key</li><li>EXPIRE name 10 è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ˜¯ç§’</li><li>ttl name æŸ¥çœ‹å½“å‰keyçš„å‰©ä½™æ—¶é—´</li><li>type name æŸ¥çœ‹å½“å‰keyçš„ä¸€ä¸ªç±»å‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; keys * # æŸ¥çœ‹æ‰€æœ‰çš„key<br>(empty list or set)<br>127.0.0.1:6379&gt; set name kuangshen   # set key<br>OK<br>127.0.0.1:6379&gt; keys *<br>1) &quot;name&quot;<br>127.0.0.1:6379&gt; set age 1<br>OK<br>127.0.0.1:6379&gt; keys *<br>1) &quot;age&quot;<br>2) &quot;name&quot;<br>127.0.0.1:6379&gt; EXISTS name # åˆ¤æ–­å½“å‰çš„keyæ˜¯å¦å­˜åœ¨<br>(integer) 1<br>127.0.0.1:6379&gt; EXISTS name1<br>(integer) 0<br>127.0.0.1:6379&gt; move name 1 # ç§»é™¤å½“å‰çš„key<br>(integer) 1<br>127.0.0.1:6379&gt; keys *<br>1) &quot;age&quot;<br>127.0.0.1:6379&gt; set name qinjiang<br>OK<br>127.0.0.1:6379&gt; keys *<br>1) &quot;age&quot;<br>2) &quot;name&quot;<br>127.0.0.1:6379&gt; clear<br>127.0.0.1:6379&gt; keys *<br>1) &quot;age&quot;<br>2) &quot;name&quot;<br>127.0.0.1:6379&gt; get name<br>&quot;qinjiang&quot;<br>127.0.0.1:6379&gt; EXPIRE name 10 # è®¾ç½®keyçš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ˜¯ç§’<br>(integer) 1<br>127.0.0.1:6379&gt; ttl name # æŸ¥çœ‹å½“å‰keyçš„å‰©ä½™æ—¶é—´<br>(integer) 4<br>127.0.0.1:6379&gt; ttl name<br>(integer) 3<br>127.0.0.1:6379&gt; ttl name<br>(integer) 2<br>127.0.0.1:6379&gt; ttl name<br>(integer) 1<br>127.0.0.1:6379&gt; ttl name<br>(integer) -2<br>127.0.0.1:6379&gt; get name<br>(nil)<br>127.0.0.1:6379&gt; type name # æŸ¥çœ‹å½“å‰keyçš„ä¸€ä¸ªç±»å‹ï¼<br>string<br>127.0.0.1:6379&gt; type age<br>string<br></code></pre></td></tr></table></figure><p>åé¢å¦‚æœé‡åˆ°ä¸ä¼šçš„å‘½ä»¤ï¼Œå¯ä»¥åœ¨å®˜ç½‘æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼</p><h2 id="Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"><a href="#Stringï¼ˆå­—ç¬¦ä¸²ï¼‰" class="headerlink" title="Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"></a>Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</h2><p>90% çš„ javaç¨‹åºå‘˜ä½¿ç”¨ redis åªä¼šä½¿ç”¨ä¸€ä¸ªStringç±»å‹ï¼</p><ul><li><p>set key1 v1 è®¾ç½®å€¼</p></li><li><p>get key1 è·å¾—å€¼</p></li><li><p>keys * è·å¾—æ‰€æœ‰çš„key</p></li><li><p>EXISTS key1 åˆ¤æ–­æŸä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨</p></li><li><p>APPEND key1 â€œhelloâ€ è¿½åŠ å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰keyä¸å­˜åœ¨ï¼Œå°±ç›¸å½“äºsetkey</p></li><li><p>STRLEN key1 è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼</p></li><li><p>incr views è‡ªå¢1</p></li><li><p>decr views è‡ªå‡1</p></li><li><p>INCRBY views 10 å¯ä»¥è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå¢é‡ï¼</p></li><li><p>DECRBY views 5 æŒ‡å®šå‡é‡</p></li><li><p>GETRANGE key1 0 3 æˆªå–å­—ç¬¦ä¸² [0,3]</p></li><li><p>GETRANGE key1 0 -1 è·å–å…¨éƒ¨çš„å­—ç¬¦ä¸² å’Œ get keyæ˜¯ä¸€æ ·çš„</p></li><li><p>SETRANGE key2 1 xx æ›¿æ¢æŒ‡å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²ï¼</p></li><li><p>setex key3 30 â€œhelloâ€ è®¾ç½®key3 çš„å€¼ä¸º hello,30ç§’åè¿‡æœŸ</p><ul><li>setex (set with expire) è®¾ç½®è¿‡æœŸæ—¶é—´</li></ul></li><li><p>setnx mykey â€œredisâ€ å¦‚æœmykey ä¸å­˜åœ¨ï¼Œåˆ›å»ºmykeyï¼Œå¦‚æœmykeyå­˜åœ¨ï¼Œåˆ›å»ºå¤±è´¥ï¼</p><ul><li>setnx (set if not exist) ä¸å­˜åœ¨åœ¨è®¾ç½® ï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼ï¼‰</li></ul></li><li><p>mset k1 v1 k2 v2 k3 v3 åŒæ—¶è®¾ç½®å¤šä¸ªå€¼</p></li><li><p>mget k1 k2 k3 åŒæ—¶è·å–å¤šä¸ªå€¼</p></li><li><p>msetnx k1 v1 k4 v4 msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·</p></li><li><p>mset user:1:name zhangsan user:1:age 2</p><ul><li><p>å¯¹è±¡ set user:1 {name:zhangsan,age:3} # è®¾ç½®ä¸€ä¸ªuser:1 å¯¹è±¡ å€¼ä¸º jsonå­—ç¬¦æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼</p><p>è¿™é‡Œçš„keyæ˜¯ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼š user:{id}:{filed} , å¦‚æ­¤è®¾è®¡åœ¨Redisä¸­æ˜¯å®Œå…¨OKäº†ï¼</p></li></ul></li><li><p>mget user:1:name user:1:age</p></li><li><p>getset db redis å¦‚æœä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å› nilï¼Œå¹¶åˆ›å»ºkey-valueå€¼ï¼Œå¦‚æœå­˜åœ¨å€¼ï¼Œè·å–åŸæ¥çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼</p><ul><li>getset å…ˆgetç„¶ååœ¨set</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; set key1 v1 # è®¾ç½®å€¼<br>OK<br>127.0.0.1:6379&gt; get key1 # è·å¾—å€¼<br>&quot;v1&quot;<br>127.0.0.1:6379&gt; keys * # è·å¾—æ‰€æœ‰çš„key<br>1) &quot;key1&quot;<br>127.0.0.1:6379&gt; EXISTS key1 # åˆ¤æ–­æŸä¸€ä¸ªkeyæ˜¯å¦å­˜åœ¨<br>(integer) 1<br>127.0.0.1:6379&gt; APPEND key1 &quot;hello&quot; # è¿½åŠ å­—ç¬¦ä¸²ï¼Œå¦‚æœå½“å‰keyä¸å­˜åœ¨ï¼Œå°±ç›¸å½“äºsetkey<br>(integer) 7<br>127.0.0.1:6379&gt; get key1<br>&quot;v1hello&quot;<br>127.0.0.1:6379&gt; STRLEN key1 # è·å–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼<br>(integer) 7<br>127.0.0.1:6379&gt; APPEND key1 &quot;,kaungshen&quot;<br>(integer) 17<br>127.0.0.1:6379&gt; STRLEN key1<br>(integer) 17<br>127.0.0.1:6379&gt; get key1<br>&quot;v1hello,kaungshen&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br><span class="hljs-meta">#</span><span class="bash"> i++</span><br><span class="hljs-meta">#</span><span class="bash"> æ­¥é•¿ i+=</span><br>127.0.0.1:6379&gt; set views 0 # åˆå§‹æµè§ˆé‡ä¸º0<br>OK<br>127.0.0.1:6379&gt; get views<br>&quot;0&quot;<br>127.0.0.1:6379&gt; incr views # è‡ªå¢1 æµè§ˆé‡å˜ä¸º1<br>(integer) 1<br>127.0.0.1:6379&gt; incr views<br>(integer) 2<br>127.0.0.1:6379&gt; get views<br>&quot;2&quot;<br>127.0.0.1:6379&gt; decr views # è‡ªå‡1 æµè§ˆé‡-1<br>(integer) 1<br>127.0.0.1:6379&gt; decr views<br>(integer) 0<br>127.0.0.1:6379&gt; decr views<br>(integer) -1<br>127.0.0.1:6379&gt; get views<br>&quot;-1&quot;<br>127.0.0.1:6379&gt; INCRBY views 10 # å¯ä»¥è®¾ç½®æ­¥é•¿ï¼ŒæŒ‡å®šå¢é‡ï¼<br>(integer) 9<br>127.0.0.1:6379&gt; INCRBY views 10<br>(integer) 19<br>127.0.0.1:6379&gt; DECRBY views 5<br>(integer) 14<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br><span class="hljs-meta">#</span><span class="bash"> å­—ç¬¦ä¸²èŒƒå›´ range</span><br>127.0.0.1:6379&gt; set key1 &quot;hello,kuangshen&quot; # è®¾ç½® key1 çš„å€¼<br>OK<br>127.0.0.1:6379&gt; get key1<br>&quot;hello,kuangshen&quot;<br>127.0.0.1:6379&gt; GETRANGE key1 0 3 # æˆªå–å­—ç¬¦ä¸² [0,3]<br>&quot;hell&quot;<br>127.0.0.1:6379&gt; GETRANGE key1 0 -1 # è·å–å…¨éƒ¨çš„å­—ç¬¦ä¸² å’Œ get keyæ˜¯ä¸€æ ·çš„<br>&quot;hello,kuangshen&quot;<br><span class="hljs-meta">#</span><span class="bash"> æ›¿æ¢ï¼</span><br>127.0.0.1:6379&gt; set key2 abcdefg<br>OK<br>127.0.0.1:6379&gt; get key2<br>&quot;abcdefg&quot;<br>127.0.0.1:6379&gt; SETRANGE key2 1 xx # æ›¿æ¢æŒ‡å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²ï¼<br>(integer) 7<br>127.0.0.1:6379&gt; get key2<br>&quot;axxdefg&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br><span class="hljs-meta">#</span><span class="bash"> setex (<span class="hljs-built_in">set</span> with expire) <span class="hljs-comment"># è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="hljs-meta">#</span><span class="bash"> setnx (<span class="hljs-built_in">set</span> <span class="hljs-keyword">if</span> not exist) <span class="hljs-comment"># ä¸å­˜åœ¨åœ¨è®¾ç½® ï¼ˆåœ¨åˆ†å¸ƒå¼é”ä¸­ä¼šå¸¸å¸¸ä½¿ç”¨ï¼ï¼‰</span></span><br>127.0.0.1:6379&gt; setex key3 30 &quot;hello&quot; # è®¾ç½®key3 çš„å€¼ä¸º hello,30ç§’åè¿‡æœŸ<br>OK<br>127.0.0.1:6379&gt; ttl key3<br>(integer) 26<br>127.0.0.1:6379&gt; get key3<br>&quot;hello&quot;<br>127.0.0.1:6379&gt; setnx mykey &quot;redis&quot; # å¦‚æœmykey ä¸å­˜åœ¨ï¼Œåˆ›å»ºmykey<br>(integer) 1<br>127.0.0.1:6379&gt; keys *<br>1) &quot;key2&quot;<br>2) &quot;mykey&quot;<br>3) &quot;key1&quot;<br>127.0.0.1:6379&gt; ttl key3<br>(integer) -2<br>127.0.0.1:6379&gt; setnx mykey &quot;MongoDB&quot; # å¦‚æœmykeyå­˜åœ¨ï¼Œåˆ›å»ºå¤±è´¥ï¼<br>(integer) 0<br>127.0.0.1:6379&gt; get mykey<br>&quot;redis&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>mset<br>mget<br>127.0.0.1:6379&gt; mset k1 v1 k2 v2 k3 v3 # åŒæ—¶è®¾ç½®å¤šä¸ªå€¼<br>OK<br>127.0.0.1:6379&gt; keys *<br>1) &quot;k1&quot;<br>2) &quot;k2&quot;<br>3) &quot;k3&quot;<br>127.0.0.1:6379&gt; mget k1 k2 k3 # åŒæ—¶è·å–å¤šä¸ªå€¼<br>1) &quot;v1&quot;<br>2) &quot;v2&quot;<br>3) &quot;v3&quot;<br>127.0.0.1:6379&gt; msetnx k1 v1 k4 v4 # msetnx æ˜¯ä¸€ä¸ªåŸå­æ€§çš„æ“ä½œï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·<br>å¤±è´¥ï¼<br>(integer) 0<br>127.0.0.1:6379&gt; get k4<br>(nil)<br><span class="hljs-meta">#</span><span class="bash"> å¯¹è±¡</span><br>set user:1 &#123;name:zhangsan,age:3&#125; # è®¾ç½®ä¸€ä¸ªuser:1 å¯¹è±¡ å€¼ä¸º jsonå­—ç¬¦æ¥ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼<br><span class="hljs-meta">#</span><span class="bash"> è¿™é‡Œçš„keyæ˜¯ä¸€ä¸ªå·§å¦™çš„è®¾è®¡ï¼š user:&#123;id&#125;:&#123;filed&#125; , å¦‚æ­¤è®¾è®¡åœ¨Redisä¸­æ˜¯å®Œå…¨OKäº†ï¼</span><br>127.0.0.1:6379&gt; mset user:1:name zhangsan user:1:age 2<br>OK<br>127.0.0.1:6379&gt; mget user:1:name user:1:age<br>1) &quot;zhangsan&quot;<br>2) &quot;2&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>getset # å…ˆgetç„¶ååœ¨set<br>127.0.0.1:6379&gt; getset db redis # å¦‚æœä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å› nilï¼Œå¹¶åˆ›å»ºkey-valueå€¼<br>(nil)<br>127.0.0.1:6379&gt; get db<br>&quot;redis<br>127.0.0.1:6379&gt; getset db mongodb # å¦‚æœå­˜åœ¨å€¼ï¼Œè·å–åŸæ¥çš„å€¼ï¼Œå¹¶è®¾ç½®æ–°çš„å€¼<br>&quot;redis&quot;<br>127.0.0.1:6379&gt; get db<br>&quot;mongodb&quot;<br></code></pre></td></tr></table></figure><p>æ•°æ®ç»“æ„æ˜¯ç›¸åŒçš„ï¼</p><p>Stringç±»ä¼¼çš„ä½¿ç”¨åœºæ™¯ï¼švalueé™¤äº†æ˜¯æˆ‘ä»¬çš„å­—ç¬¦ä¸²è¿˜å¯ä»¥æ˜¯æˆ‘ä»¬çš„æ•°å­—ï¼</p><ul><li>è®¡æ•°å™¨</li><li>ç»Ÿè®¡å¤šå•ä½çš„æ•°é‡</li><li>ç²‰ä¸æ•°</li><li>å¯¹è±¡ç¼“å­˜å­˜å‚¨ï¼</li></ul><h2 id="Listï¼ˆåˆ—è¡¨ï¼‰"><a href="#Listï¼ˆåˆ—è¡¨ï¼‰" class="headerlink" title="Listï¼ˆåˆ—è¡¨ï¼‰"></a>Listï¼ˆåˆ—è¡¨ï¼‰</h2><p>åœ¨redisé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠlistç©æˆ ï¼Œæ ˆã€é˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ—ï¼</p><p>æ‰€æœ‰çš„listå‘½ä»¤éƒ½æ˜¯ç”¨lå¼€å¤´çš„ï¼ŒRedisä¸åŒºåˆ†å¤§å°å‘½ä»¤</p><ul><li>LPUSH list one # å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ ï¼ˆå·¦ï¼‰</li><li>LRANGE list 0 -1 # è·å–listä¸­å€¼ï¼</li><li>LRANGE list 0 1 # é€šè¿‡åŒºé—´è·å–å…·ä½“çš„å€¼ï¼</li><li>Rpush list righr # å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨ä½éƒ¨ ï¼ˆå³ï¼‰</li><li>Lpop list # ç§»é™¤listçš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>Rpop list # ç§»é™¤listçš„æœ€åä¸€ä¸ªå…ƒç´ </li><li>lindex list 1 # é€šè¿‡ä¸‹æ ‡è·å¾— list ä¸­çš„æŸä¸€ä¸ªå€¼ï¼</li><li>Llen list # è¿”å›åˆ—è¡¨çš„é•¿åº¦</li><li>lrem list 1 one # ç§»é™¤listé›†åˆä¸­æŒ‡å®šä¸ªæ•°çš„valueï¼Œç²¾ç¡®åŒ¹é…</li><li>ltrim mylist 1 2 # é€šè¿‡ä¸‹æ ‡æˆªå–æŒ‡å®šçš„é•¿åº¦ï¼Œè¿™ä¸ªlistå·²ç»è¢«æ”¹å˜äº†ï¼Œåªå‰©ä¸‹æˆªå–çš„å…ƒç´ ï¼</li><li>rpoplpush mylist myotherlist # ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°çš„</li><li>EXISTS list # åˆ¤æ–­è¿™ä¸ªåˆ—è¡¨æ˜¯å¦å­˜åœ¨</li><li>lset list 0 item # å¦‚æœä¸å­˜åœ¨åˆ—è¡¨æˆ‘ä»¬å»æ›´æ–°å°±ä¼šæŠ¥é”™ï¼Œ å¦‚æœå­˜åœ¨ï¼Œæ›´æ–°å½“å‰ä¸‹æ ‡çš„å€¼</li><li>LINSERT mylist before â€œworldâ€ â€œotherâ€</li><li>LINSERT mylist after â€œworldâ€ â€œnewâ€ # å°†æŸä¸ªå…·ä½“çš„valueæ’å…¥åˆ°åˆ—æŠŠä½ ä¸­æŸä¸ªå…ƒç´ çš„å‰é¢æˆ–è€…åé¢ï¼</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; LPUSH list one # å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ ï¼ˆå·¦ï¼‰<br>(integer) 1<br>127.0.0.1:6379&gt; LPUSH list two<br>(integer) 2<br>127.0.0.1:6379&gt; LPUSH list three<br>(integer) 3<br>127.0.0.1:6379&gt; LRANGE list 0 -1 # è·å–listä¸­å€¼ï¼<br>1) &quot;three&quot;<br>2) &quot;two&quot;<br>3) &quot;one&quot;<br>127.0.0.1:6379&gt; LRANGE list 0 1 # é€šè¿‡åŒºé—´è·å–å…·ä½“çš„å€¼ï¼<br>1) &quot;three&quot;<br>2) &quot;two&quot;<br>127.0.0.1:6379&gt; Rpush list righr # å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ°åˆ—è¡¨ä½éƒ¨ ï¼ˆå³ï¼‰<br>(integer) 4<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;three&quot;<br>2) &quot;two&quot;<br>3) &quot;one&quot;<br>4) &quot;righr&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>LPOP<br>RPOP<br>127.0.0.1:6379&gt; Lpop list # ç§»é™¤listçš„ç¬¬ä¸€ä¸ªå…ƒç´ <br>&quot;three&quot;<br>127.0.0.1:6379&gt; Rpop list # ç§»é™¤listçš„æœ€åä¸€ä¸ªå…ƒç´ <br>&quot;righr&quot;<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;two&quot;<br>2) &quot;one&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>Lindex<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;two&quot;<br>2) &quot;one&quot;<br>127.0.0.1:6379&gt; lindex list 1 # é€šè¿‡ä¸‹æ ‡è·å¾— list ä¸­çš„æŸä¸€ä¸ªå€¼ï¼<br>&quot;one&quot;<br>127.0.0.1:6379&gt; lindex list 0<br>&quot;two&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>Llen<br>127.0.0.1:6379&gt; Lpush list one<br>(integer) 1<br>127.0.0.1:6379&gt; Lpush list two<br>(integer) 2<br>127.0.0.1:6379&gt; Lpush list three<br>(integer) 3<br>127.0.0.1:6379&gt; Llen list # è¿”å›åˆ—è¡¨çš„é•¿åº¦<br>(integer) 3<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>ç§»é™¤æŒ‡å®šçš„å€¼ï¼<br>å–å…³ uid<br>Lrem<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;three&quot;<br>2) &quot;three&quot;<br>3) &quot;two&quot;<br>4) &quot;one&quot;<br>127.0.0.1:6379&gt; lrem list 1 one # ç§»é™¤listé›†åˆä¸­æŒ‡å®šä¸ªæ•°çš„valueï¼Œç²¾ç¡®åŒ¹é…<br>(integer) 1<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;three&quot;<br>2) &quot;three&quot;<br>3) &quot;two&quot;<br>127.0.0.1:6379&gt; lrem list 1 three<br>(integer) 1<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;three&quot;<br>2) &quot;two&quot;<br>127.0.0.1:6379&gt; Lpush list three<br>(integer) 3<br>127.0.0.1:6379&gt; lrem list 2 three<br>(integer) 2<br>127.0.0.1:6379&gt; LRANGE list 0 -1<br>1) &quot;two&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>trim ä¿®å‰ªã€‚ï¼› list æˆªæ–­!<br>127.0.0.1:6379&gt; keys *<br>(empty list or set)<br>127.0.0.1:6379&gt; Rpush mylist &quot;hello&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; Rpush mylist &quot;hello1&quot;<br>(integer) 2<br>127.0.0.1:6379&gt; Rpush mylist &quot;hello2&quot;<br>(integer) 3<br>127.0.0.1:6379&gt; Rpush mylist &quot;hello3&quot;<br>(integer) 4<br>127.0.0.1:6379&gt; ltrim mylist 1 2 # é€šè¿‡ä¸‹æ ‡æˆªå–æŒ‡å®šçš„é•¿åº¦ï¼Œè¿™ä¸ªlistå·²ç»è¢«æ”¹å˜äº†ï¼Œæˆªæ–­äº†ï¼Œåªå‰©ä¸‹æˆªå–çš„å…ƒç´ ï¼<br>OK<br>127.0.0.1:6379&gt; LRANGE mylist 0 -1<br>1) &quot;hello1&quot;<br>2) &quot;hello2&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>rpoplpush # ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°çš„åˆ—è¡¨ä¸­ï¼<br>127.0.0.1:6379&gt; rpush mylist &quot;hello&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; rpush mylist &quot;hello1&quot;<br>(integer) 2<br>127.0.0.1:6379&gt; rpush mylist &quot;hello2&quot;<br>(integer) 3<br>127.0.0.1:6379&gt; rpoplpush mylist myotherlist # ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°†ä»–ç§»åŠ¨åˆ°æ–°çš„åˆ—è¡¨ä¸­ï¼<br>&quot;hello2&quot;<br>127.0.0.1:6379&gt; lrange mylist 0 -1 # æŸ¥çœ‹åŸæ¥çš„åˆ—è¡¨<br>1) &quot;hello&quot;<br>2) &quot;hello1&quot;<br>127.0.0.1:6379&gt; lrange myotherlist 0 -1 # æŸ¥çœ‹ç›®æ ‡åˆ—è¡¨ä¸­ï¼Œç¡®å®å­˜åœ¨æ”¹å€¼ï¼<br>1) &quot;hello2&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>lset å°†åˆ—è¡¨ä¸­æŒ‡å®šä¸‹æ ‡çš„å€¼æ›¿æ¢ä¸ºå¦å¤–ä¸€ä¸ªå€¼ï¼Œæ›´æ–°æ“ä½œ<br>127.0.0.1:6379&gt; EXISTS list # åˆ¤æ–­è¿™ä¸ªåˆ—è¡¨æ˜¯å¦å­˜åœ¨<br>(integer) 0<br>127.0.0.1:6379&gt; lset list 0 item # å¦‚æœä¸å­˜åœ¨åˆ—è¡¨æˆ‘ä»¬å»æ›´æ–°å°±ä¼šæŠ¥é”™<br>(error) ERR no such key<br>127.0.0.1:6379&gt; lpush list value1<br>(integer) 1<br>127.0.0.1:6379&gt; LRANGE list 0 0<br>1) &quot;value1&quot;<br>127.0.0.1:6379&gt; lset list 0 item # å¦‚æœå­˜åœ¨ï¼Œæ›´æ–°å½“å‰ä¸‹æ ‡çš„å€¼<br>OK<br>127.0.0.1:6379&gt; LRANGE list 0 0<br>1) &quot;item&quot;<br>127.0.0.1:6379&gt; lset list 1 other # å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ¥é”™ï¼<br>(error) ERR index out of range<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>linsert # å°†æŸä¸ªå…·ä½“çš„valueæ’å…¥åˆ°åˆ—æŠŠä½ ä¸­æŸä¸ªå…ƒç´ çš„å‰é¢æˆ–è€…åé¢ï¼<br>127.0.0.1:6379&gt; Rpush mylist &quot;hello&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; Rpush mylist &quot;world&quot;<br>(integer) 2<br>127.0.0.1:6379&gt; LINSERT mylist before &quot;world&quot; &quot;other&quot;<br>(integer) 3<br>127.0.0.1:6379&gt; LRANGE mylist 0 -1<br>1) &quot;hello&quot;<br>2) &quot;other&quot;<br>3) &quot;world&quot;<br>127.0.0.1:6379&gt; LINSERT mylist after world new<br>(integer) 4<br>127.0.0.1:6379&gt; LRANGE mylist 0 -1<br>1) &quot;hello&quot;<br>2) &quot;other&quot;<br>3) &quot;world&quot;<br>4) &quot;new&quot;<br></code></pre></td></tr></table></figure><p>å°ç»“</p><ul><li>ä»–å®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œbefore Node after ï¼Œ leftï¼Œright éƒ½å¯ä»¥æ’å…¥å€¼</li><li>å¦‚æœkey ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„é“¾è¡¨</li><li>å¦‚æœkeyå­˜åœ¨ï¼Œæ–°å¢å†…å®¹</li><li>å¦‚æœç§»é™¤äº†æ‰€æœ‰å€¼ï¼Œç©ºé“¾è¡¨ï¼Œä¹Ÿä»£è¡¨ä¸å­˜åœ¨ï¼</li><li>åœ¨ä¸¤è¾¹æ’å…¥æˆ–è€…æ”¹åŠ¨å€¼ï¼Œæ•ˆç‡æœ€é«˜ï¼ ä¸­é—´å…ƒç´ ï¼Œç›¸å¯¹æ¥è¯´æ•ˆç‡ä¼šä½ä¸€ç‚¹~</li></ul><p>æ¶ˆæ¯æ’é˜Ÿï¼šæ¶ˆæ¯é˜Ÿåˆ— ï¼ˆLpush Rpopï¼‰ï¼Œ æ ˆï¼ˆ Lpush Lpopï¼‰ï¼</p><h2 id="Setï¼ˆé›†åˆï¼‰"><a href="#Setï¼ˆé›†åˆï¼‰" class="headerlink" title="Setï¼ˆé›†åˆï¼‰"></a>Setï¼ˆé›†åˆï¼‰</h2><p>setä¸­çš„å€¼æ˜¯ä¸èƒ½é‡è¯»çš„ï¼</p><ul><li>list æ˜¯æœ‰åºåˆ—è¡¨ï¼Œå€¼å¯é‡å¤</li><li>set æ˜¯æ— åºåˆ—è¡¨ï¼Œå€¼ä¸å¯é‡å¤</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; sadd myset &quot;hello&quot; # seté›†åˆä¸­æ·»åŠ å…ƒç´ <br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset &quot;kuangshen&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset &quot;lovekuangshen&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; SMEMBERS myset # æŸ¥çœ‹æŒ‡å®šsetçš„æ‰€æœ‰å€¼<br>1) &quot;hello&quot;<br>2) &quot;lovekuangshen&quot;<br>3) &quot;kuangshen&quot;<br>127.0.0.1:6379&gt; SISMEMBER myset hello # åˆ¤æ–­æŸä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯åœ¨seté›†åˆä¸­ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; SISMEMBER myset world<br>(integer) 0<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; scard myset # è·å–seté›†åˆä¸­çš„å†…å®¹å…ƒç´ ä¸ªæ•°ï¼<br>(integer) 4<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>rem<br>127.0.0.1:6379&gt; srem myset hello # ç§»é™¤seté›†åˆä¸­çš„æŒ‡å®šå…ƒç´ <br>(integer) 1<br>127.0.0.1:6379&gt; scard myset<br>(integer) 3<br>127.0.0.1:6379&gt; SMEMBERS myset<br>1) &quot;lovekuangshen2&quot;<br>2) &quot;lovekuangshen&quot;<br>3) &quot;kuangshen&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>set æ— åºä¸é‡å¤é›†åˆã€‚æŠ½éšæœºï¼<br>127.0.0.1:6379&gt; SMEMBERS myset<br>1) &quot;lovekuangshen2&quot;<br>2) &quot;lovekuangshen&quot;<br>3) &quot;kuangshen&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset # éšæœºæŠ½é€‰å‡ºä¸€ä¸ªå…ƒç´ <br>&quot;kuangshen&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset<br>&quot;kuangshen&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset<br>&quot;kuangshen&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset<br>&quot;kuangshen&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset 2 # éšæœºæŠ½é€‰å‡ºæŒ‡å®šä¸ªæ•°çš„å…ƒç´ <br>bilibiliï¼šç‹‚ç¥è¯´Java<br>1) &quot;lovekuangshen&quot;<br>2) &quot;lovekuangshen2&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset 2<br>1) &quot;lovekuangshen&quot;<br>2) &quot;lovekuangshen2&quot;<br>127.0.0.1:6379&gt; SRANDMEMBER myset # éšæœºæŠ½é€‰å‡ºä¸€ä¸ªå…ƒç´ <br>&quot;lovekuangshen2&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>åˆ é™¤å®šçš„keyï¼Œéšæœºåˆ é™¤keyï¼<br>127.0.0.1:6379&gt; SMEMBERS myset<br>1) &quot;lovekuangshen2&quot;<br>2) &quot;lovekuangshen&quot;<br>3) &quot;kuangshen&quot;<br>127.0.0.1:6379&gt; spop myset # éšæœºåˆ é™¤ä¸€äº›seté›†åˆä¸­çš„å…ƒç´ ï¼<br>&quot;lovekuangshen2&quot;<br>127.0.0.1:6379&gt; spop myset<br>&quot;lovekuangshen&quot;<br>127.0.0.1:6379&gt; SMEMBERS myset<br>1) &quot;kuangshen&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>å°†ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªseté›†åˆï¼<br>127.0.0.1:6379&gt; sadd myset &quot;hello&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset &quot;world&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset &quot;kuangshen&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; sadd myset2 &quot;set2&quot;<br>(integer) 1<br>127.0.0.1:6379&gt; smove myset myset2 &quot;kuangshen&quot; # å°†ä¸€ä¸ªæŒ‡å®šçš„å€¼ï¼Œç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªseté›†åˆï¼<br>(integer) 1<br>127.0.0.1:6379&gt; SMEMBERS myset<br>1) &quot;world&quot;<br>2) &quot;hello&quot;<br>127.0.0.1:6379&gt; SMEMBERS myset2<br>1) &quot;kuangshen&quot;<br>2) &quot;set2&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>å¾®åšï¼ŒBç«™ï¼Œå…±åŒå…³æ³¨ï¼(å¹¶é›†)<br>æ•°å­—é›†åˆç±»ï¼š<br>- å·®é›† SDIFF<br>- äº¤é›†<br>- å¹¶é›†<br>127.0.0.1:6379&gt; SDIFF key1 key2 # å·®é›†<br>1) &quot;b&quot;<br>2) &quot;a&quot;<br>127.0.0.1:6379&gt; SINTER key1 key2 # äº¤é›† å…±åŒå¥½å‹å°±å¯ä»¥è¿™æ ·å®ç°<br>1) &quot;c&quot;<br>127.0.0.1:6379&gt; SUNION key1 key2 # å¹¶é›†<br>1) &quot;b&quot;<br>2) &quot;c&quot;<br>3) &quot;e&quot;<br>4) &quot;a&quot;<br>5) &quot;d&quot;<br></code></pre></td></tr></table></figure><h2 id="Hashï¼ˆå“ˆå¸Œï¼‰"><a href="#Hashï¼ˆå“ˆå¸Œï¼‰" class="headerlink" title="Hashï¼ˆå“ˆå¸Œï¼‰"></a>Hashï¼ˆå“ˆå¸Œï¼‰</h2><p>Mapé›†åˆï¼Œkey-map! æ—¶å€™è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ªmapé›†åˆï¼ æœ¬è´¨å’ŒStringç±»å‹æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œè¿˜æ˜¯ä¸€ä¸ªç®€å•çš„key-vlaueï¼</p><p>set myhash field kuangshen</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; hset myhash field1 kuangshen # setä¸€ä¸ªå…·ä½“ key-vlaue<br>(integer) 1<br>127.0.0.1:6379&gt; hget myhash field1 # è·å–ä¸€ä¸ªå­—æ®µå€¼<br>&quot;kuangshen&quot;<br>127.0.0.1:6379&gt; hmset myhash field1 hello field2 world # setå¤šä¸ª key-vlaue<br>OK<br>127.0.0.1:6379&gt; hmget myhash field1 field2 # è·å–å¤šä¸ªå­—æ®µå€¼<br>1) &quot;hello&quot;<br>2) &quot;world&quot;<br>127.0.0.1:6379&gt; hgetall myhash # è·å–å…¨éƒ¨çš„æ•°æ®ï¼Œ<br>1) &quot;field1&quot;<br>2) &quot;hello&quot;<br>3) &quot;field2&quot;<br>4) &quot;world&quot;<br>127.0.0.1:6379&gt; hdel myhash field1 # åˆ é™¤hashæŒ‡å®škeyå­—æ®µï¼å¯¹åº”çš„valueå€¼ä¹Ÿå°±æ¶ˆå¤±äº†ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; hgetall myhash<br>1) &quot;field2&quot;<br>2) &quot;world&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>hlen<br>127.0.0.1:6379&gt; hmset myhash field1 hello field2 world<br>OK<br>127.0.0.1:6379&gt; HGETALL myhash<br>1) &quot;field2&quot;<br>2) &quot;world&quot;<br>3) &quot;field1&quot;<br>4) &quot;hello&quot;<br>127.0.0.1:6379&gt; hlen myhash # è·å–hashè¡¨çš„å­—æ®µæ•°é‡ï¼<br>(integer) 2<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; HEXISTS myhash field1 # åˆ¤æ–­hashä¸­æŒ‡å®šå­—æ®µæ˜¯å¦å­˜åœ¨ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; HEXISTS myhash field3<br>(integer) 0<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br><span class="hljs-meta">#</span><span class="bash"> åªè·å¾—æ‰€æœ‰field</span><br><span class="hljs-meta">#</span><span class="bash"> åªè·å¾—æ‰€æœ‰value</span><br>127.0.0.1:6379&gt; hkeys myhash # åªè·å¾—æ‰€æœ‰field<br>1) &quot;field2&quot;<br>2) &quot;field1&quot;<br>127.0.0.1:6379&gt; hvals myhash # åªè·å¾—æ‰€æœ‰value<br>1) &quot;world&quot;<br>2) &quot;hello&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>incr decr<br>127.0.0.1:6379&gt; hset myhash field3 5 #æŒ‡å®šå¢é‡ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; HINCRBY myhash field3 1<br>(integer) 6<br>127.0.0.1:6379&gt; HINCRBY myhash field3 -1<br>(integer) 5<br>127.0.0.1:6379&gt; hsetnx myhash field4 hello # å¦‚æœä¸å­˜åœ¨åˆ™å¯ä»¥è®¾ç½®<br>(integer) 1<br>127.0.0.1:6379&gt; hsetnx myhash field4 world # å¦‚æœå­˜åœ¨åˆ™ä¸èƒ½è®¾ç½®<br>(integer) 0<br></code></pre></td></tr></table></figure><p>hashå˜æ›´çš„æ•°æ® user name age,å°¤å…¶æ˜¯æ˜¯ç”¨æˆ·ä¿¡æ¯ä¹‹ç±»çš„ï¼Œç»å¸¸å˜åŠ¨çš„ä¿¡æ¯ï¼ hash æ›´é€‚åˆäºå¯¹è±¡çš„å­˜å‚¨ï¼ŒStringæ›´åŠ é€‚åˆå­—ç¬¦ä¸²å­˜å‚¨ï¼</p><h2 id="Zsetï¼ˆæœ‰åºé›†åˆï¼‰"><a href="#Zsetï¼ˆæœ‰åºé›†åˆï¼‰" class="headerlink" title="Zsetï¼ˆæœ‰åºé›†åˆï¼‰"></a>Zsetï¼ˆæœ‰åºé›†åˆï¼‰</h2><p>åœ¨setçš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€ä¸ªå€¼ï¼Œset k1 v1 zset k1 score1 v1</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; zadd myset 1 one # æ·»åŠ ä¸€ä¸ªå€¼<br>(integer) 1<br>127.0.0.1:6379&gt; zadd myset 2 two 3 three # æ·»åŠ å¤šä¸ªå€¼<br>(integer) 2<br>127.0.0.1:6379&gt; ZRANGE myset 0 -1<br>1) &quot;one&quot;<br>2) &quot;two&quot;<br>3) &quot;three&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>æ’åºå¦‚ä½•å®ç°<br>127.0.0.1:6379&gt; zadd salary 2500 xiaohong # æ·»åŠ ä¸‰ä¸ªç”¨æˆ·<br>(integer) 1<br>127.0.0.1:6379&gt; zadd salary 5000 zhangsan<br>(integer) 1<br>127.0.0.1:6379&gt; zadd salary 500 kaungshen<br>(integer) 1<br><span class="hljs-meta">#</span><span class="bash"> ZRANGEBYSCORE key min max</span><br>127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf +inf # æ˜¾ç¤ºå…¨éƒ¨çš„ç”¨æˆ· ä»å°åˆ°å¤§ï¼<br>1) &quot;kaungshen&quot;<br>2) &quot;xiaohong&quot;<br>3) &quot;zhangsan&quot;<br>127.0.0.1:6379&gt; ZREVRANGE salary 0 -1 # ä»å¤§åˆ°è¿›è¡Œæ’åºï¼<br>1) &quot;zhangsan&quot;<br>2) &quot;kaungshen&quot;<br>127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf +inf withscores # æ˜¾ç¤ºå…¨éƒ¨çš„ç”¨æˆ·å¹¶ä¸”é™„å¸¦æˆ<br>ç»©<br>1) &quot;kaungshen&quot;<br>2) &quot;500&quot;<br>3) &quot;xiaohong&quot;<br>4) &quot;2500&quot;<br>5) &quot;zhangsan&quot;<br>6) &quot;5000&quot;<br>127.0.0.1:6379&gt; ZRANGEBYSCORE salary -inf 2500 withscores # æ˜¾ç¤ºå·¥èµ„å°äº2500å‘˜å·¥çš„å‡<br>åºæ’åºï¼<br>1) &quot;kaungshen&quot;<br>2) &quot;500&quot;<br>3) &quot;xiaohong&quot;<br>4) &quot;2500&quot;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br><span class="hljs-meta">#</span><span class="bash"> ç§»é™¤remä¸­çš„å…ƒç´ </span><br>127.0.0.1:6379&gt; zrange salary 0 -1<br>1) &quot;kaungshen&quot;<br>2) &quot;xiaohong&quot;<br>3) &quot;zhangsan&quot;<br>127.0.0.1:6379&gt; zrem salary xiaohong # ç§»é™¤æœ‰åºé›†åˆä¸­çš„æŒ‡å®šå…ƒç´ <br>(integer) 1<br>127.0.0.1:6379&gt; zrange salary 0 -1<br>1) &quot;kaungshen&quot;<br>2) &quot;zhangsan&quot;<br>127.0.0.1:6379&gt; zcard salary # è·å–æœ‰åºé›†åˆä¸­çš„ä¸ªæ•°<br>(integer) 2<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">#########################################################################</span></span><br>127.0.0.1:6379&gt; zadd myset 1 hello<br>(integer) 1<br>127.0.0.1:6379&gt; zadd myset 2 world 3 kuangshen<br>(integer) 2<br>127.0.0.1:6379&gt; zcount myset 1 3 # è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡ï¼<br>(integer) 3<br>127.0.0.1:6379&gt; zcount myset 1 2<br>(integer) 2<br></code></pre></td></tr></table></figure><h1 id="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"><a href="#ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹" class="headerlink" title="ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"></a>ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</h1><h2 id="Geospatial-åœ°ç†ä½ç½®"><a href="#Geospatial-åœ°ç†ä½ç½®" class="headerlink" title="Geospatial åœ°ç†ä½ç½®"></a>Geospatial åœ°ç†ä½ç½®</h2><p>è¿™ä¸ªåŠŸèƒ½å¯ä»¥æ¨ç®—åœ°ç†ä½ç½®çš„ä¿¡æ¯ï¼Œä¸¤åœ°ä¹‹é—´çš„è·ç¦»ï¼Œæ–¹åœ†å‡ é‡Œçš„äºº</p><p>å¯ä»¥æŸ¥è¯¢ä¸€äº›æµ‹è¯•æ•°æ®ï¼š<a href="http://www.jsons.cn/lngcodeinfo/0706D99C19A781A3/">http://www.jsons.cn/lngcodeinfo/0706D99C19A781A3/</a></p><p>åªæœ‰ å…­ä¸ªå‘½ä»¤ï¼š</p><ul><li>GEOADD</li><li>GEODIST</li><li>GEOHASH</li><li>GEOPOS</li><li>GEORADIUS</li><li>GEORADIUSBYMEMBER</li></ul><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.redis.net.cn/order/3685.html">https://www.redis.net.cn/order/3685.html</a></p><h3 id="getadd"><a href="#getadd" class="headerlink" title="getadd"></a>getadd</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> getadd æ·»åŠ åœ°ç†ä½ç½®</span><br><span class="hljs-meta">#</span><span class="bash"> è§„åˆ™ï¼šä¸¤çº§æ— æ³•ç›´æ¥æ·»åŠ ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä¸‹è½½åŸå¸‚æ•°æ®ï¼Œç›´æ¥é€šè¿‡javaç¨‹åºä¸€æ¬¡æ€§å¯¼å…¥ï¼</span><br><span class="hljs-meta">#</span><span class="bash"> æœ‰æ•ˆçš„ç»åº¦ä»-180åº¦åˆ°180åº¦ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> æœ‰æ•ˆçš„çº¬åº¦ä»-85.05112878åº¦åˆ°85.05112878åº¦ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> å½“åæ ‡ä½ç½®è¶…å‡ºä¸Šè¿°æŒ‡å®šèŒƒå›´æ—¶ï¼Œè¯¥å‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> 127.0.0.1:6379&gt; geoadd china:city 39.90 116.40 beijin</span><br>(error) ERR invalid longitude,latitude pair 39.900000,116.400000<br><span class="hljs-meta">#</span><span class="bash"> å‚æ•° key å€¼ï¼ˆï¼‰</span><br>127.0.0.1:6379&gt; geoadd china:city 116.40 39.90 beijing<br>(integer) 1<br>127.0.0.1:6379&gt; geoadd china:city 121.47 31.23 shanghai<br>(integer) 1<br>127.0.0.1:6379&gt; geoadd china:city 106.50 29.53 chongqi 114.05 22.52 shengzhen<br>(integer) 2<br>127.0.0.1:6379&gt; geoadd china:city 120.16 30.24 hangzhou 108.96 34.26 xian<br>(integer) 2<br></code></pre></td></tr></table></figure><h3 id="getpos"><a href="#getpos" class="headerlink" title="getpos"></a>getpos</h3><p>è·å¾—å½“å‰å®šä½ï¼šä¸€å®šæ˜¯ä¸€ä¸ªåæ ‡å€¼ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; GEOPOS china:city beijing # è·å–æŒ‡å®šçš„åŸå¸‚çš„ç»åº¦å’Œçº¬åº¦ï¼<br>1) 1) &quot;116.39999896287918091&quot;<br>2) &quot;39.90000009167092543&quot;<br>127.0.0.1:6379&gt; GEOPOS china:city beijing chongqi<br>1) 1) &quot;116.39999896287918091&quot;<br>2) &quot;39.90000009167092543&quot;<br>2) 1) &quot;106.49999767541885376&quot;<br>2) &quot;29.52999957900659211&quot;<br></code></pre></td></tr></table></figure><h3 id="GEODIST"><a href="#GEODIST" class="headerlink" title="GEODIST"></a>GEODIST</h3><p>ä¸¤äººä¹‹é—´çš„è·ç¦»ï¼</p><p>å•ä½ï¼š</p><ul><li>m è¡¨ç¤ºå•ä½ä¸ºç±³ã€‚</li><li>km è¡¨ç¤ºå•ä½ä¸ºåƒç±³ã€‚</li><li>mi è¡¨ç¤ºå•ä½ä¸ºè‹±é‡Œã€‚</li><li>ft è¡¨ç¤ºå•ä½ä¸ºè‹±å°ºã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; GEODIST china:city beijing shanghai km # æŸ¥çœ‹ä¸Šæµ·åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»<br>&quot;1067.3788&quot;<br>127.0.0.1:6379&gt; GEODIST china:city beijing chongqi km # æŸ¥çœ‹é‡åº†åˆ°åŒ—äº¬çš„ç›´çº¿è·ç¦»<br>&quot;1464.0708&quot;<br></code></pre></td></tr></table></figure><h3 id="georadius-ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ-æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ "><a href="#georadius-ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ-æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ " class="headerlink" title="georadius ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ "></a>georadius ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œ æ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´ </h3><p>æˆ‘é™„è¿‘çš„äººï¼Ÿ ï¼ˆè·å¾—æ‰€æœ‰é™„è¿‘çš„äººçš„åœ°å€ï¼Œå®šä½ï¼ï¼‰é€šè¿‡åŠå¾„æ¥æŸ¥è¯¢ï¼</p><p>è·å¾—æŒ‡å®šæ•°é‡çš„äººï¼Œ200</p><p>æ‰€æœ‰æ•°æ®åº”è¯¥éƒ½å½•å…¥ï¼šchina:city ï¼Œæ‰ä¼šè®©ç»“æœæ›´åŠ è¯·æ±‚ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; GEORADIUS china:city 110 30 1000 km # ä»¥110ï¼Œ30 è¿™ä¸ªç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œå¯»<br>æ‰¾æ–¹åœ†1000kmå†…çš„åŸå¸‚<br>1) &quot;chongqi&quot;<br>2) &quot;xian&quot;<br>3) &quot;shengzhen&quot;<br>4) &quot;hangzhou&quot;<br>127.0.0.1:6379&gt; GEORADIUS china:city 110 30 500 km<br>1) &quot;chongqi&quot;<br>2) &quot;xian&quot;<br>127.0.0.1:6379&gt; GEORADIUS china:city 110 30 500 km withdist # æ˜¾ç¤ºåˆ°ä¸­é—´è·ç¦»çš„ä½ç½®<br>1) 1) &quot;chongqi&quot;<br>2) &quot;341.9374&quot;<br>2) 1) &quot;xian&quot;<br>2) &quot;483.8340&quot;<br>127.0.0.1:6379&gt; GEORADIUS china:city 110 30 500 km withcoord # æ˜¾ç¤ºä»–äººçš„å®šä½ä¿¡æ¯<br>1) 1) &quot;chongqi&quot;<br>2) 1) &quot;106.49999767541885376&quot;<br>2) &quot;29.52999957900659211&quot;<br>2) 1) &quot;xian&quot;<br>2) 1) &quot;108.96000176668167114&quot;<br>2) &quot;34.25999964418929977&quot;<br>127.0.0.1:6379&gt; GEORADIUS china:city 110 30 500 km withdist withcoord count 1 #<br>ç­›é€‰å‡ºæŒ‡å®šçš„ç»“æœï¼<br>1) 1) &quot;chongqi&quot;<br>2) &quot;341.9374&quot;<br>3) 1) &quot;106.49999767541885376&quot;<br>2) &quot;29.52999957900659211&quot;<br>127.0.0.1:6379&gt; GEORADIUS china:city 110 30 500 km withdist withcoord count 2<br>1) 1) &quot;chongqi&quot;<br>2) &quot;341.9374&quot;<br>3) 1) &quot;106.49999767541885376&quot;<br>2) &quot;29.52999957900659211&quot;<br>2) 1) &quot;xian&quot;<br>2) &quot;483.8340&quot;<br>3) 1) &quot;108.96000176668167114&quot;<br>2) &quot;34.25999964418929977&quot;<br></code></pre></td></tr></table></figure><h3 id="GEORADIUSBYMEMBER"><a href="#GEORADIUSBYMEMBER" class="headerlink" title="GEORADIUSBYMEMBER"></a>GEORADIUSBYMEMBER</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ‰¾å‡ºä½äºæŒ‡å®šå…ƒç´ å‘¨å›´çš„å…¶ä»–å…ƒç´ ï¼</span><br>127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city beijing 1000 km<br>1) &quot;beijing&quot;<br>2) &quot;xian&quot;<br>127.0.0.1:6379&gt; GEORADIUSBYMEMBER china:city shanghai 400 km<br>1) &quot;hangzhou&quot;<br>2) &quot;shanghai&quot;<br></code></pre></td></tr></table></figure><h3 id="GEOHASH-å‘½ä»¤-è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å…ƒç´ çš„-Geohash-è¡¨ç¤º"><a href="#GEOHASH-å‘½ä»¤-è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å…ƒç´ çš„-Geohash-è¡¨ç¤º" class="headerlink" title="GEOHASH å‘½ä»¤ - è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å…ƒç´ çš„ Geohash è¡¨ç¤º"></a>GEOHASH å‘½ä»¤ - è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å…ƒç´ çš„ Geohash è¡¨ç¤º</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°†äºŒç»´çš„ç»çº¬åº¦è½¬æ¢ä¸ºä¸€ç»´çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²è¶Šæ¥è¿‘ï¼Œé‚£ä¹ˆåˆ™è·ç¦»è¶Šè¿‘ï¼</span><br>127.0.0.1:6379&gt; geohash china:city beijing chongqi<br>1) &quot;wx4fbxxfke0&quot;<br>2) &quot;wm5xzrybty0&quot;<br></code></pre></td></tr></table></figure><h3 id="GEO-åº•å±‚çš„å®ç°åŸç†å…¶å®å°±æ˜¯-Zsetï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Zsetå‘½ä»¤æ¥æ“ä½œgeoï¼"><a href="#GEO-åº•å±‚çš„å®ç°åŸç†å…¶å®å°±æ˜¯-Zsetï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Zsetå‘½ä»¤æ¥æ“ä½œgeoï¼" class="headerlink" title="GEO åº•å±‚çš„å®ç°åŸç†å…¶å®å°±æ˜¯ Zsetï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Zsetå‘½ä»¤æ¥æ“ä½œgeoï¼"></a>GEO åº•å±‚çš„å®ç°åŸç†å…¶å®å°±æ˜¯ Zsetï¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Zsetå‘½ä»¤æ¥æ“ä½œgeoï¼</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; ZRANGE china:city 0 -1 # æŸ¥çœ‹åœ°å›¾ä¸­å…¨éƒ¨çš„å…ƒç´ <br>1) &quot;chongqi&quot;<br>2) &quot;xian&quot;<br>3) &quot;shengzhen&quot;<br>4) &quot;hangzhou&quot;<br>5) &quot;shanghai&quot;<br>6) &quot;beijing&quot;<br>127.0.0.1:6379&gt; zrem china:city beijing # ç§»é™¤æŒ‡å®šå…ƒç´ ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; ZRANGE china:city 0 -1<br>1) &quot;chongqi&quot;<br>2) &quot;xian&quot;<br>3) &quot;shengzhen&quot;<br>4) &quot;hangzhou&quot;<br>5) &quot;shanghai&quot;<br></code></pre></td></tr></table></figure><h2 id="Hyperloglog"><a href="#Hyperloglog" class="headerlink" title="Hyperloglog"></a>Hyperloglog</h2><p>Redis 2.8.9 ç‰ˆæœ¬å°±æ›´æ–°äº† Hyperloglog æ•°æ®ç»“æ„ï¼</p><p>Redis Hyperloglog åŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼</p><p>ä¼˜ç‚¹ï¼šå ç”¨çš„å†…å­˜æ˜¯å›ºå®šï¼Œ2^64 ä¸åŒçš„å…ƒç´ çš„æŠ€æœ¯ï¼Œåªéœ€è¦åºŸ 12KBå†…å­˜ï¼å¦‚æœè¦ä»å†…å­˜è§’åº¦æ¥æ¯”è¾ƒçš„è¯ Hyperloglog é¦–é€‰ï¼</p><p><code>ç½‘é¡µçš„ UV ï¼ˆä¸€ä¸ªäººè®¿é—®ä¸€ä¸ªç½‘ç«™å¤šæ¬¡ï¼Œä½†æ˜¯è¿˜æ˜¯ç®—ä½œä¸€ä¸ªäººï¼ï¼‰</code></p><p>ä¼ ç»Ÿçš„æ–¹å¼ï¼Œ set ä¿å­˜ç”¨æˆ·çš„idï¼Œç„¶åå°±å¯ä»¥ç»Ÿè®¡ set ä¸­çš„å…ƒç´ æ•°é‡ä½œä¸ºæ ‡å‡†åˆ¤æ–­ !</p><p>è¿™ä¸ªæ–¹å¼å¦‚æœä¿å­˜å¤§é‡çš„ç”¨æˆ·idï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†è®¡æ•°ï¼Œè€Œä¸æ˜¯ä¿å­˜ç”¨æˆ·idï¼›</p><p>0.81% é”™è¯¯ç‡ï¼ ç»Ÿè®¡UVä»»åŠ¡ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡çš„ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; PFadd mykey a b c d e f g h i j # åˆ›å»ºç¬¬ä¸€ç»„å…ƒç´  mykey<br>(integer) 1<br>127.0.0.1:6379&gt; PFCOUNT mykey # ç»Ÿè®¡ mykey å…ƒç´ çš„åŸºæ•°æ•°é‡<br>(integer) 10<br>127.0.0.1:6379&gt; PFadd mykey2 i j z x c v b n m # åˆ›å»ºç¬¬äºŒç»„å…ƒç´  mykey2<br>(integer) 1<br>127.0.0.1:6379&gt; PFCOUNT mykey2<br>(integer) 9<br>127.0.0.1:6379&gt; PFMERGE mykey3 mykey mykey2 # åˆå¹¶ä¸¤ç»„ mykey mykey2 =&gt; mykey3 å¹¶é›†<br>OK<br>127.0.0.1:6379&gt; PFCOUNT mykey3 # çœ‹å¹¶é›†çš„æ•°é‡ï¼<br>(integer) 15<br><br></code></pre></td></tr></table></figure><p>å¦‚æœå…è®¸å®¹é”™ï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥ä½¿ç”¨ Hyperloglog </p><p>å¦‚æœä¸å…è®¸å®¹é”™ï¼Œå°±ä½¿ç”¨ set æˆ–è€…è‡ªå·±çš„æ•°æ®ç±»å‹å³å¯</p><h2 id="Bitmap"><a href="#Bitmap" class="headerlink" title="Bitmap"></a>Bitmap</h2><h4 id="ä½å­˜å‚¨"><a href="#ä½å­˜å‚¨" class="headerlink" title="ä½å­˜å‚¨"></a>ä½å­˜å‚¨</h4><p>ç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ï¼Œæ´»è·ƒï¼Œä¸æ´»è·ƒï¼ ç™»å½• ã€ æœªç™»å½•ï¼ æ‰“å¡ï¼Œ365æ‰“å¡ï¼ ä¸¤ä¸ªçŠ¶æ€çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Bitmapsï¼</p><p>Bitmap ä½å›¾ï¼Œæ•°æ®ç»“æ„ï¼ éƒ½æ˜¯æ“ä½œäºŒè¿›åˆ¶ä½æ¥è¿›è¡Œè®°å½•ï¼Œå°±åªæœ‰0 å’Œ 1 ä¸¤ä¸ªçŠ¶æ€ï¼</p><p>365 å¤© = 365 bit 1å­—èŠ‚ = 8bit 46 ä¸ªå­—èŠ‚å·¦å³ï¼</p><p>ä½¿ç”¨bitmap æ¥è®°å½• å‘¨ä¸€åˆ°å‘¨æ—¥çš„æ‰“å¡ï¼</p><p>å‘¨ä¸€ï¼š1 å‘¨äºŒï¼š0 å‘¨ä¸‰ï¼š0 å‘¨å››ï¼š1 â€¦â€¦</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210116180909199.png"></p><p>æŸ¥çœ‹æŸä¸€å¤©æ˜¯å¦æœ‰æ‰“å¡ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; getbit sign 3<br>(integer) 1<br>127.0.0.1:6379&gt; getbit sign 6<br>(integer) 0<br></code></pre></td></tr></table></figure><p>ç»Ÿè®¡æ“ä½œï¼Œç»Ÿè®¡ æ‰“å¡çš„å¤©æ•°ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; bitcount sign # ç»Ÿè®¡è¿™å‘¨çš„æ‰“å¡è®°å½•ï¼Œå°±å¯ä»¥çœ‹åˆ°æ˜¯å¦æœ‰å…¨å‹¤ï¼<br>(integer) 3<br></code></pre></td></tr></table></figure><h1 id="äº‹åŠ¡-åŸå­æ€§"><a href="#äº‹åŠ¡-åŸå­æ€§" class="headerlink" title="äº‹åŠ¡(åŸå­æ€§)"></a>äº‹åŠ¡(åŸå­æ€§)</h1><p><strong>Redisäº‹åŠ¡æ²¡æœ‰æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µï¼</strong></p><p>æ‰€æœ‰çš„å‘½ä»¤åœ¨äº‹åŠ¡ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥è¢«æ‰§è¡Œï¼åªæœ‰å‘èµ·æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œï¼ExecRediså•æ¡å‘½ä»¤å¼ä¿å­˜åŸå­æ€§çš„ï¼Œä½†æ˜¯äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§ï¼</p><p>redisçš„äº‹åŠ¡ï¼š</p><ul><li>å¼€å¯äº‹åŠ¡ï¼ˆmultiï¼‰</li><li>å‘½ä»¤å…¥é˜Ÿï¼ˆâ€¦â€¦ï¼‰</li><li>æ‰§è¡Œäº‹åŠ¡ï¼ˆexecï¼‰</li></ul><p>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; multi # å¼€å¯äº‹åŠ¡<br>OK<br><span class="hljs-meta">#</span><span class="bash"> å‘½ä»¤å…¥é˜Ÿ</span><br>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; get k2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; exec # æ‰§è¡Œäº‹åŠ¡<br>1) OK<br>2) OK<br>3) &quot;v2&quot;<br>4) OK<br></code></pre></td></tr></table></figure><p>æ”¾å¼ƒäº‹åŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; multi # å¼€å¯äº‹åŠ¡<br>OK<br>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k4 v4<br>QUEUED<br>127.0.0.1:6379&gt; DISCARD # å–æ¶ˆäº‹åŠ¡<br>OK<br>127.0.0.1:6379&gt; get k4 # äº‹åŠ¡é˜Ÿåˆ—ä¸­å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼<br>(nil)<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å‹å¼‚å¸¸ï¼ˆä»£ç æœ‰é—®é¢˜ï¼ å‘½ä»¤æœ‰é”™ï¼ï¼‰ ï¼Œäº‹åŠ¡ä¸­æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; set k1 v1<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; getset k3 # é”™è¯¯çš„å‘½ä»¤<br>(error) ERR wrong number of arguments for &#x27;getset&#x27; command<br>127.0.0.1:6379&gt; set k4 v4<br>QUEUED<br>127.0.0.1:6379&gt; set k5 v5<br>QUEUED<br>127.0.0.1:6379&gt; exec # æ‰§è¡Œäº‹åŠ¡æŠ¥é”™ï¼<br>(error) EXECABORT Transaction discarded because of previous errors.<br>127.0.0.1:6379&gt; get k5 # æ‰€æœ‰çš„å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œï¼<br>(nil)<br></code></pre></td></tr></table></figure><p>è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆ1/0ï¼‰ï¼Œ å¦‚æœäº‹åŠ¡é˜Ÿåˆ—ä¸­å­˜åœ¨è¯­æ³•æ€§ï¼Œé‚£ä¹ˆæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå…¶ä»–å‘½ä»¤æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œé”™è¯¯å‘½ä»¤æŠ›å‡ºå¼‚å¸¸ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; set k1 &quot;v1&quot;<br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; incr k1 # ä¼šæ‰§è¡Œçš„æ—¶å€™å¤±è´¥ï¼<br>QUEUED<br>127.0.0.1:6379&gt; set k2 v2<br>QUEUED<br>127.0.0.1:6379&gt; set k3 v3<br>QUEUED<br>127.0.0.1:6379&gt; get k3<br>QUEUED<br>127.0.0.1:6379&gt; exec<br>1) (error) ERR value is not an integer or out of range # è™½ç„¶ç¬¬ä¸€æ¡å‘½ä»¤æŠ¥é”™äº†ï¼Œä½†æ˜¯ä¾æ—§æ­£å¸¸æ‰§è¡ŒæˆåŠŸäº†ï¼<br>2) OK<br>3) OK<br>4) &quot;v3&quot;<br>127.0.0.1:6379&gt; get k2<br>&quot;v2&quot;<br>127.0.0.1:6379&gt; get k3<br>&quot;v3&quot;<br></code></pre></td></tr></table></figure><p>ç›‘æ§ï¼ Watch ï¼ˆé¢è¯•å¸¸é—®ï¼ï¼‰</p><p><strong>æ‚²è§‚é”ï¼š</strong></p><ul><li>å¾ˆæ‚²è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ— è®ºåšä»€ä¹ˆéƒ½ä¼šåŠ é”ï¼</li></ul><p><strong>ä¹è§‚é”</strong>ï¼š</p><ul><li>å¾ˆä¹è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼ æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­ä¸€ä¸‹ï¼Œåœ¨æ­¤æœŸé—´æ˜¯å¦æœ‰äººä¿®æ”¹è¿‡è¿™ä¸ªæ•°æ®ï¼Œ</li><li>è·å–version</li><li>æ›´æ–°çš„æ—¶å€™æ¯”è¾ƒ version</li></ul><p>Redisæµ‹ç›‘è§†æµ‹è¯•</p><p>æ­£å¸¸æ‰§è¡ŒæˆåŠŸï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; set money 100<br>OK<br>127.0.0.1:6379&gt; set out 0<br>OK<br>127.0.0.1:6379&gt; watch money # ç›‘è§† money å¯¹è±¡<br>OK<br>127.0.0.1:6379&gt; multi # äº‹åŠ¡æ­£å¸¸ç»“æŸï¼Œæ•°æ®æœŸé—´æ²¡æœ‰å‘ç”Ÿå˜åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±æ­£å¸¸æ‰§è¡ŒæˆåŠŸï¼<br>OK<br>127.0.0.1:6379&gt; DECRBY money 20<br>QUEUED<br>127.0.0.1:6379&gt; INCRBY out 20<br>QUEUED<br>127.0.0.1:6379&gt; exec<br>1) (integer) 80<br>2) (integer) 20<br></code></pre></td></tr></table></figure><p>æµ‹è¯•å¤šçº¿ç¨‹ä¿®æ”¹å€¼ , ä½¿ç”¨watch å¯ä»¥å½“åšredisçš„ä¹è§‚é”æ“ä½œï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; watch money # ç›‘è§† money<br>OK<br>127.0.0.1:6379&gt; multi<br>OK<br>127.0.0.1:6379&gt; DECRBY money 10<br>QUEUED<br>127.0.0.1:6379&gt; INCRBY out 10<br>QUEUED<br>127.0.0.1:6379&gt; exec # æ‰§è¡Œä¹‹å‰ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹ï¼Œä¿®æ”¹äº†æˆ‘ä»¬çš„å€¼ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼<br>(nil)<br><br></code></pre></td></tr></table></figure><p>å¦‚æœä¿®æ”¹å¤±è´¥ï¼Œè·å–æœ€æ–°çš„å€¼å°±å¥½</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210220170403756.png" alt="image-20210220170403756"></p><h1 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h1><p>æˆ‘ä»¬è¦ä½¿ç”¨ Java æ¥æ“ä½œ Redisï¼ŒçŸ¥å…¶ç„¶å¹¶çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæˆäººä»¥æ¸”ï¼ å­¦ä¹ ä¸èƒ½æ€¥èºï¼Œæ…¢æ…¢æ¥ä¼šå¾ˆå¿«ï¼</p><p>ä»€ä¹ˆæ˜¯Jedis ï¼Ÿ æ˜¯ Redis å®˜æ–¹æ¨èçš„ javaè¿æ¥å¼€å‘å·¥å…·ï¼ ä½¿ç”¨Java æ“ä½œRedis ä¸­é—´ä»¶ï¼å¦‚æœä½ è¦ä½¿ç”¨ javaæ“ä½œredisï¼Œé‚£ä¹ˆä¸€å®šè¦å¯¹Jedis ååˆ†çš„ç†Ÿæ‚‰ï¼</p><p>æµ‹è¯•</p><p>æ–°å»ºç©ºé¡¹ç›®ï¼ˆç©ºé¡¹ç›®å®¹æ˜“å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼‰</p><p>æ³¨æ„è¦æŠŠjdkå’Œlambdasé…ç½®å¥½</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210220212237065.png" alt="image-20210220212237065"></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210220212313834.png" alt="image-20210220212313834"></p><p>æ³¨æ„ä¿®æ”¹Javaç‰ˆæœ¬</p><p>![image-20210220212442237](Rediså­¦ä¹ ç¬”è®°/image-20210220212442237.png</p><p>1ã€å¯¼å…¥å¯¹åº”çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--fastjson--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.62<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ç¼–ç æµ‹è¯•ï¼š</p><ul><li>è¿æ¥æ•°æ®åº“</li><li>æ“ä½œå‘½ä»¤</li><li>æ–­å¼€è¿æ¥ï¼</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang;<br><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestPing</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// 1ã€ new Jedis å¯¹è±¡å³å¯</span><br>        Jedis jedis = <span class="hljs-keyword">new</span> Jedis(<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-number">6379</span>);<br>        <span class="hljs-comment">// jedis æ‰€æœ‰çš„å‘½ä»¤å°±æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„æ‰€æœ‰æŒ‡ä»¤ï¼æ‰€ä»¥ä¹‹å‰çš„æŒ‡ä»¤å­¦ä¹ å¾ˆé‡è¦ï¼</span><br>        System.out.println(jedis.ping());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210220214347906.png" alt="image-20210220214347906"></p><h3 id="å¸¸ç”¨çš„API"><a href="#å¸¸ç”¨çš„API" class="headerlink" title="å¸¸ç”¨çš„API"></a>å¸¸ç”¨çš„API</h3><p>String</p><p>List</p><p>Set</p><p>Hash</p><p>Zset</p><p>æ‰€æœ‰çš„apiå‘½ä»¤ï¼Œå°±æ˜¯æˆ‘ä»¬å¯¹åº”çš„ä¸Šé¢å­¦ä¹ çš„æŒ‡ä»¤ï¼Œä¸€ä¸ªéƒ½æ²¡æœ‰å˜åŒ–ï¼</p><p>äº‹åŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestTX</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Jedis jedis = <span class="hljs-keyword">new</span> Jedis(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">6379</span>);<br>        jedis.flushDB();<br>        JSONObject jsonObject = <span class="hljs-keyword">new</span> JSONObject();<br>        jsonObject.put(<span class="hljs-string">&quot;hello&quot;</span>,<span class="hljs-string">&quot;world&quot;</span>);<br>        jsonObject.put(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;kuangshen&quot;</span>);<br>        <span class="hljs-comment">// å¼€å¯äº‹åŠ¡</span><br>        Transaction multi = jedis.multi();<br>        String result = jsonObject.toJSONString();<br>        <span class="hljs-comment">// jedis.watch(result)</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            multi.set(<span class="hljs-string">&quot;user1&quot;</span>,result);<br>            multi.set(<span class="hljs-string">&quot;user2&quot;</span>,result);<br>            <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>/<span class="hljs-number">0</span> ; <span class="hljs-comment">// ä»£ç æŠ›å‡ºå¼‚å¸¸äº‹åŠ¡ï¼Œæ‰§è¡Œå¤±è´¥ï¼</span><br>            multi.exec(); <span class="hljs-comment">// æ‰§è¡Œäº‹åŠ¡ï¼</span><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            multi.discard(); <span class="hljs-comment">// æ”¾å¼ƒäº‹åŠ¡</span><br>            e.printStackTrace();<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            System.out.println(jedis.get(<span class="hljs-string">&quot;user1&quot;</span>));<br>            System.out.println(jedis.get(<span class="hljs-string">&quot;user2&quot;</span>));<br>            jedis.close(); <span class="hljs-comment">// å…³é—­è¿æ¥</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210220220954844.png" alt="image-20210220220954844"></p><h1 id="SpringBootæ•´åˆ"><a href="#SpringBootæ•´åˆ" class="headerlink" title="SpringBootæ•´åˆ"></a>SpringBootæ•´åˆ</h1><p>SpringBoot æ“ä½œæ•°æ®ï¼šspring-data jpa jdbc mongodb redisï¼</p><p>SpringData ä¹Ÿæ˜¯å’Œ SpringBoot é½åçš„é¡¹ç›®ï¼</p><p>è¯´æ˜ï¼š åœ¨ SpringBoot2.x ä¹‹åï¼ŒåŸæ¥ä½¿ç”¨çš„jedis è¢«æ›¿æ¢ä¸ºäº† lettuce?</p><p>jedis : é‡‡ç”¨çš„ç›´è¿ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œçš„è¯ï¼Œæ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœæƒ³è¦é¿å…ä¸å®‰å…¨çš„ï¼Œä½¿ç”¨ jedis pool è¿æ¥æ± ï¼ æ›´åƒ BIO æ¨¡å¼</p><p>lettuce : é‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥å†å¤šä¸ªçº¿ç¨‹ä¸­è¿›è¡Œå…±äº«ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼å¯ä»¥å‡å°‘çº¿ç¨‹æ•°æ®äº†ï¼Œæ›´åƒ NIO æ¨¡å¼</p><p>æ–°å»ºspringé¡¹ç›®ï¼Œå°†éœ€è¦çš„éƒ½å‹¾é€‰ä¸Šï¼ˆweb springredisç­‰ç­‰ï¼‰</p><h2 id="æºç åˆ†æï¼š"><a href="#æºç åˆ†æï¼š" class="headerlink" title="æºç åˆ†æï¼š"></a>æºç åˆ†æï¼š</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@ConditionalOnMissingBean(name = &quot;redisTemplate&quot;)</span> <span class="hljs-comment">// æˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ªredisTemplateæ¥æ›¿æ¢è¿™ä¸ªé»˜è®¤çš„ï¼</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> RedisTemplate&lt;Object, Object&gt; <span class="hljs-title">redisTemplate</span><span class="hljs-params">(RedisConnectionFactory</span></span><br><span class="hljs-function"><span class="hljs-params">                                                       redisConnectionFactory)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> UnknownHostException </span>&#123;<br>    <span class="hljs-comment">// é»˜è®¤çš„ RedisTemplate æ²¡æœ‰è¿‡å¤šçš„è®¾ç½®ï¼Œredis å¯¹è±¡éƒ½æ˜¯éœ€è¦åºåˆ—åŒ–ï¼</span><br>    <span class="hljs-comment">// ä¸¤ä¸ªæ³›å‹éƒ½æ˜¯ Object, Object çš„ç±»å‹ï¼Œæˆ‘ä»¬åä½¿ç”¨éœ€è¦å¼ºåˆ¶è½¬æ¢ &lt;String, Object&gt;</span><br>    RedisTemplate&lt;Object, Object&gt; template = <span class="hljs-keyword">new</span> RedisTemplate&lt;&gt;();<br>    template.setConnectionFactory(redisConnectionFactory);<br>    <span class="hljs-keyword">return</span> template;<br>&#125;<br><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@ConditionalOnMissingBean</span> <span class="hljs-comment">// ç”±äº String æ˜¯redisä¸­æœ€å¸¸ä½¿ç”¨çš„ç±»å‹ï¼Œæ‰€ä»¥è¯´å•ç‹¬æå‡ºæ¥äº†ä¸€ä¸ªbeanï¼</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> StringRedisTemplate <span class="hljs-title">stringRedisTemplate</span><span class="hljs-params">(RedisConnectionFactory</span></span><br><span class="hljs-function"><span class="hljs-params">                                                   redisConnectionFactory)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> UnknownHostException </span>&#123;<br>    StringRedisTemplate template = <span class="hljs-keyword">new</span> StringRedisTemplate();<br>    template.setConnectionFactory(redisConnectionFactory);<br>    <span class="hljs-keyword">return</span> template;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é…ç½®ä»‹ç»"><a href="#é…ç½®ä»‹ç»" class="headerlink" title="é…ç½®ä»‹ç»"></a>é…ç½®ä»‹ç»</h2><p><strong>redisæœåŠ¡å™¨é…ç½®</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># redisæœåŠ¡å™¨é…ç½®</span><br><span class="hljs-comment"># æœåŠ¡å™¨åœ°å€</span><br><span class="hljs-meta">spring.redis.host</span>=<span class="hljs-string">121.4.60.79</span><br><span class="hljs-comment"># æœåŠ¡å™¨ç«¯å£</span><br><span class="hljs-meta">spring.redis.port</span>=<span class="hljs-string">6379</span><br><span class="hljs-comment"># è¶…æ—¶</span><br><span class="hljs-meta">spring.redis.timeout</span>=<span class="hljs-string">3</span><br><span class="hljs-comment"># æ•°æ®åº“ç´¢å¼•</span><br> <span class="hljs-meta">spring.redis.database</span>=<span class="hljs-string">0</span><br><span class="hljs-comment"># å¯†ç </span><br><span class="hljs-meta">spring.redis.password</span>=<span class="hljs-string">123456</span><br></code></pre></td></tr></table></figure><p><strong>Rediså®¢æˆ·ç«¯Lettuceé…ç½®</strong></p><p>Spring Bootä»2.Xç‰ˆæœ¬å¼€å§‹å¼•å…¥æ–°çš„å®¢æˆ·ç«¯â€”â€”<strong>Lettuce</strong>ã€‚è¾ƒä¹‹å‰çš„Jedisç›¸æ¯”è€Œè¨€ï¼ŒLettuceæ˜¯ä¸€ä¸ªåŸºäºNettyçš„çº¿ç¨‹å®‰å…¨çš„Rediså®¢æˆ·ç«¯ã€‚æ•…ï¼Œæˆ‘ä»¬è¿™é‡Œæ¨èä½¿ç”¨Lettuceï¼Œå¹¶åœ¨application.propertiesé…ç½®æ–‡ä»¶ä¸­å¯¹Lettuceå®¢æˆ·ç«¯è¿›è¡Œé…ç½®</p><ul><li>é…ç½®æ–‡ä»¶ä¸­çš„Rediså®¢æˆ·ç«¯é…ç½®å¯ä»¥ä¸å†™ï¼Œåˆ™Spring Boot(2.XåŠä»¥ä¸Šç‰ˆæœ¬)ä¼šé»˜è®¤ä½¿ç”¨Lettuceå®¢æˆ·ç«¯</li><li>å½“æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶æ˜¾å¼åœ°é…ç½®Rediså®¢æˆ·ç«¯æ—¶ï¼Œéœ€è¦æ·»åŠ commons-pool2è¿æ¥æ± ä¾èµ–</li></ul><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ é»˜è®¤ 8</span><br><span class="hljs-meta">spring.redis.lettuce.pool.max-active</span>=<span class="hljs-string">10</span><br><span class="hljs-comment"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥ é»˜è®¤ 8</span><br><span class="hljs-meta">spring.redis.lettuce.pool.max-idle</span>=<span class="hljs-string">10</span><br><span class="hljs-comment"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥ é»˜è®¤ 0</span><br><span class="hljs-meta">spring.redis.lettuce.pool.min-idle</span>=<span class="hljs-string">0</span><br><span class="hljs-comment"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ é»˜è®¤ -1</span><br><span class="hljs-meta">spring.redis.lettuce.pool.max-wait</span>=<span class="hljs-string">3</span><br></code></pre></td></tr></table></figure><h2 id="æ•´åˆæµ‹è¯•"><a href="#æ•´åˆæµ‹è¯•" class="headerlink" title="æ•´åˆæµ‹è¯•"></a>æ•´åˆæµ‹è¯•</h2><p>1ã€å¯¼å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- æ“ä½œredis --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€é…ç½®è¿æ¥</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># é…ç½®redis</span><br><span class="hljs-meta">spring.redis.host</span>=<span class="hljs-string">127.0.0.1</span><br><span class="hljs-meta">spring.redis.port</span>=<span class="hljs-string">6379</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Redis02SpringbootApplicationTests</span> </span>&#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisTemplate redisTemplate;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// redisTemplate æ“ä½œä¸åŒçš„æ•°æ®ç±»å‹ï¼Œapiå’Œæˆ‘ä»¬çš„æŒ‡ä»¤æ˜¯ä¸€æ ·çš„</span><br>        <span class="hljs-comment">// opsForValue æ“ä½œå­—ç¬¦ä¸² ç±»ä¼¼String</span><br>        <span class="hljs-comment">// opsForList æ“ä½œList ç±»ä¼¼List</span><br>        <span class="hljs-comment">// opsForSet</span><br>        <span class="hljs-comment">// opsForHash</span><br>        <span class="hljs-comment">// opsForZSet</span><br>        <span class="hljs-comment">// opsForGeo</span><br>        <span class="hljs-comment">// opsForHyperLogLog</span><br>        <span class="hljs-comment">// é™¤äº†è¿›æœ¬çš„æ“ä½œï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥é€šè¿‡redisTemplateæ“ä½œï¼Œæ¯”å¦‚äº‹åŠ¡ï¼Œå’ŒåŸºæœ¬çš„</span><br>        CRUD<br>            <span class="hljs-comment">// è·å–redisçš„è¿æ¥å¯¹è±¡</span><br>            <span class="hljs-comment">// RedisConnection connection =</span><br>            redisTemplate.getConnectionFactory().getConnection();<br>        <span class="hljs-comment">// connection.flushDb();</span><br>        <span class="hljs-comment">// connection.flushAll();</span><br>        redisTemplate.opsForValue().set(<span class="hljs-string">&quot;mykey&quot;</span>,<span class="hljs-string">&quot;å…³æ³¨ç‹‚ç¥è¯´å…¬ä¼—å·&quot;</span>);<br>        System.out.println(redisTemplate.opsForValue().get(<span class="hljs-string">&quot;mykey&quot;</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå¯¹äºæ‰€æœ‰çš„å¯¹è±¡éƒ½éœ€è¦åºåˆ—åŒ–</p><p>æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªè‡ªå·±çš„ RedisTemplete</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.core.RedisTemplate;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;<br><span class="hljs-keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;<br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisConfig</span> </span>&#123;<br>    <span class="hljs-comment">// è¿™æ˜¯æˆ‘ç»™å¤§å®¶å†™å¥½çš„ä¸€ä¸ªå›ºå®šæ¨¡æ¿ï¼Œå¤§å®¶åœ¨ä¼ä¸šä¸­ï¼Œæ‹¿å»å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼</span><br>    <span class="hljs-comment">// è‡ªå·±å®šä¹‰äº†ä¸€ä¸ª RedisTemplate</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;all&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="hljs-title">redisTemplate</span><span class="hljs-params">(RedisConnectionFactory factory)</span> </span>&#123;<br>        <span class="hljs-comment">// æˆ‘ä»¬ä¸ºäº†è‡ªå·±å¼€å‘æ–¹ä¾¿ï¼Œä¸€èˆ¬ç›´æ¥ä½¿ç”¨ &lt;String, Object&gt;</span><br>        RedisTemplate&lt;String, Object&gt; template = <span class="hljs-keyword">new</span> RedisTemplate&lt;String, Object&gt;();<br>        template.setConnectionFactory(factory);<br>        <span class="hljs-comment">// Jsonåºåˆ—åŒ–é…ç½®</span><br>        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="hljs-keyword">new</span> Jackson2JsonRedisSerializer(Object.class);<br>        ObjectMapper om = <span class="hljs-keyword">new</span> ObjectMapper();<br>        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);<br>        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);<br>        jackson2JsonRedisSerializer.setObjectMapper(om);<br>        <span class="hljs-comment">// String çš„åºåˆ—åŒ–</span><br>        StringRedisSerializer stringRedisSerializer = <span class="hljs-keyword">new</span> StringRedisSerializer();<br>        <span class="hljs-comment">// keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span><br>        template.setKeySerializer(stringRedisSerializer);<br>        <span class="hljs-comment">// hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span><br>        template.setHashKeySerializer(stringRedisSerializer);<br>        <span class="hljs-comment">// valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span><br>        template.setValueSerializer(jackson2JsonRedisSerializer);<br>        <span class="hljs-comment">// hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span><br>        template.setHashValueSerializer(jackson2JsonRedisSerializer);<br>        template.afterPropertiesSet();<br>        <span class="hljs-keyword">return</span> template;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Redis-confè¯¦è§£"><a href="#Redis-confè¯¦è§£" class="headerlink" title="Redis.confè¯¦è§£"></a>Redis.confè¯¦è§£</h1><p><strong>å•ä½</strong></p><p>ï¼ˆé…ç½®æ–‡ä»¶ unitå•ä½ å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼‰</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221105316873.png" alt="image-20210221105316873"></p><p><strong>åŒ…å«</strong></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221105511482.png" alt="image-20210221105511482"></p><p><strong>ç½‘ç»œ</strong></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221105720061.png" alt="image-20210221105720061"></p><p><strong>é€šç”¨GENERAL</strong></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221110130089.png" alt="image-20210221110130089"></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221110623621.png" alt="image-20210221110623621"></p><p><strong>å¿«ç…§</strong></p><p>æŒä¹…åŒ–ï¼Œ åœ¨è§„å®šçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡æ“ä½œï¼Œåˆ™ä¼šæŒä¹…åŒ–åˆ°æ–‡ä»¶ .rdb. aof</p><p>redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æ–­ç”µåŠå¤±ï¼</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221112246155.png" alt="image-20210221112246155"></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221112357621.png" alt="image-20210221112357621"></p><p><strong>å®‰å…¨</strong></p><p>å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®redisçš„å¯†ç ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; ping<br>PONG<br>127.0.0.1:6379&gt; config get requirepass # è·å–redisçš„å¯†ç <br>1) &quot;requirepass&quot;<br>2) &quot;&quot;<br>127.0.0.1:6379&gt; config set requirepass &quot;123456&quot; # è®¾ç½®redisçš„å¯†ç <br>OK<br>127.0.0.1:6379&gt; config get requirepass # å‘ç°æ‰€æœ‰çš„å‘½ä»¤éƒ½æ²¡æœ‰æƒé™äº†<br>(error) NOAUTH Authentication required.<br>127.0.0.1:6379&gt; ping<br>(error) NOAUTH Authentication required.<br>127.0.0.1:6379&gt; auth 123456 # ä½¿ç”¨å¯†ç è¿›è¡Œç™»å½•ï¼<br>OK<br>127.0.0.1:6379&gt; config get requirepass<br>1) &quot;requirepass&quot;<br>2) &quot;123456&quot;<br></code></pre></td></tr></table></figure><p><strong>é™åˆ¶CLIENTS</strong></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221112940978.png" alt="image-20210221112940978"></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221113120634.png" alt="image-20210221113120634"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">maxmemory-policy noeviction # å†…å­˜åˆ°è¾¾ä¸Šé™ä¹‹åçš„å¤„ç†ç­–ç•¥<br>    1ã€volatile-lruï¼šåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¿›è¡ŒLRUï¼ˆé»˜è®¤å€¼ï¼‰<br>    2ã€allkeys-lru ï¼š åˆ é™¤lruç®—æ³•çš„key<br>    3ã€volatile-randomï¼šéšæœºåˆ é™¤å³å°†è¿‡æœŸkey<br>    4ã€allkeys-randomï¼šéšæœºåˆ é™¤<br>    5ã€volatile-ttl ï¼š åˆ é™¤å³å°†è¿‡æœŸçš„<br>    6ã€noeviction ï¼š æ°¸ä¸è¿‡æœŸï¼Œè¿”å›é”™è¯¯<br></code></pre></td></tr></table></figure><p><strong>APPEND ONLY æ¨¡å¼ aofé…ç½®</strong></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221130457247.png" alt="image-20210221130457247"></p><h1 id="RedisæŒä¹…åŒ–"><a href="#RedisæŒä¹…åŒ–" class="headerlink" title="RedisæŒä¹…åŒ–"></a>RedisæŒä¹…åŒ–</h1><h2 id="RDBï¼ˆRedis-DataBaseï¼‰"><a href="#RDBï¼ˆRedis-DataBaseï¼‰" class="headerlink" title="RDBï¼ˆRedis DataBaseï¼‰"></a>RDBï¼ˆRedis DataBaseï¼‰</h2><p>åœ¨ä¸»ä»å¤åˆ¶ä¸­ï¼Œrdbå°±æ˜¯å¤‡ç”¨çš„ï¼åœ¨ä»æœºä¸Šé¢ï¼</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119113907477.png"></p><p>åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œä¹Ÿå°±æ˜¯è¡Œè¯è®²çš„Snapshotå¿«ç…§ï¼Œå®ƒæ¢å¤æ—¶æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œã€‚</p><p>Redisä¼šå•ç‹¬åˆ›å»ºï¼ˆforkï¼‰ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ã€‚è¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚æˆ‘ä»¬é»˜è®¤çš„å°±æ˜¯RDBï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹è¿™ä¸ªé…ç½®ã€‚</p><p>æœ‰æ—¶å€™åœ¨ç”Ÿäº§ç¯å¢ƒæˆ‘ä»¬ä¼šå°†è¿™ä¸ªæ–‡ä»¶è¿›è¡Œå¤‡ä»½ã€‚</p><p>rdbä¿å­˜çš„æ–‡ä»¶æ˜¯dump.rdb éƒ½æ˜¯åœ¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ä¸­å¿«ç…§ä¸­è¿›è¡Œé…ç½®çš„ã€‚</p><p>é‡æ–°å†™é…ç½®æ–‡ä»¶ï¼Œé‡æ–°æµ‹è¯•</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221154653313.png" alt="image-20210221154653313"></p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221155020687.png" alt="image-20210221155020687"></p><p>é‡æ–°å¼€å¯ä¸€ä¸ªçª—å£è¿æ¥redis</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221155451442.png" alt="image-20210221155451442"></p><p>å†æ¬¡å»åŸæ¥çš„çª—å£ï¼Œåˆå‘ç°äº†rdp</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221155600136.png" alt="image-20210221155600136"></p><p>å…³é—­ç¬¬äºŒä¸ªçª—å£</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221155839634.png" alt="image-20210221155839634"></p><p>å†æ¬¡å¼€æœºåï¼Œèƒ½çœ‹è§ä¹‹å‰å­˜å‚¨çš„å†…å®¹</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221162323469.png" alt="image-20210221162323469"></p><p><strong>è§¦å‘æœºåˆ¶</strong></p><p>1ã€saveçš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbè§„åˆ™<br>2ã€æ‰§è¡Œ flushall å‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘æˆ‘ä»¬çš„rdbè§„åˆ™ï¼<br>3ã€é€€å‡ºredisï¼Œä¹Ÿä¼šäº§ç”Ÿ rdb æ–‡ä»¶ï¼</p><p>å¤‡ä»½å°±è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª dump.rdb</p><p><strong>å¦‚ä½•æ¢å¤rdbæ–‡ä»¶ï¼</strong></p><p>1ã€åªéœ€è¦å°†rdbæ–‡ä»¶æ”¾åœ¨æˆ‘ä»¬rediså¯åŠ¨ç›®å½•å°±å¯ä»¥ï¼Œrediså¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ£€æŸ¥dump.rdb æ¢å¤å…¶ä¸­çš„æ•°æ®ï¼</p><p>2ã€æŸ¥çœ‹éœ€è¦å­˜åœ¨çš„ä½ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; config get dir<br>1) &quot;dir&quot;<br>2) &quot;/usr/local/bin&quot; # å¦‚æœåœ¨è¿™ä¸ªç›®å½•ä¸‹å­˜åœ¨ dump.rdb æ–‡ä»¶ï¼Œå¯åŠ¨å°±ä¼šè‡ªåŠ¨æ¢å¤å…¶ä¸­çš„æ•°æ®<br></code></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹ï¼š</strong><br>1ã€é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤ï¼</p><p>2ã€å¯¹æ•°æ®çš„å®Œæ•´æ€§è¦ä¸é«˜ï¼</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>1ã€éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›ç¨‹æ“ä½œï¼å¦‚æœredisæ„å¤–å®•æœºäº†ï¼Œè¿™ä¸ªæœ€åä¸€æ¬¡ä¿®æ”¹æ•°æ®å°±æ²¡æœ‰äº†ï¼</p><p>2ã€forkè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå ç”¨ä¸€å®šçš„å†…å®¹ç©ºé—´ï¼ï¼</p><h2 id="AOFï¼ˆAppend-Only-Fileï¼‰"><a href="#AOFï¼ˆAppend-Only-Fileï¼‰" class="headerlink" title="AOFï¼ˆAppend Only Fileï¼‰"></a>AOFï¼ˆAppend Only Fileï¼‰</h2><p>å°†æˆ‘ä»¬çš„æ‰€æœ‰å‘½ä»¤éƒ½è®°å½•ä¸‹æ¥ï¼Œhistoryï¼Œæ¢å¤çš„æ—¶å€™å°±æŠŠè¿™ä¸ªæ–‡ä»¶å…¨éƒ¨åœ¨æ‰§è¡Œä¸€é</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119114219942.png"></p><p>ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ</p><p><strong>Aofä¿å­˜çš„æ˜¯ appendonly.aof æ–‡ä»¶</strong></p><p>é»˜è®¤æ˜¯ä¸å¼€çš„ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯</p><p>æˆ‘ä»¬åªéœ€è¦å°† appendonly æ”¹ä¸ºyeså°±å¼€å¯äº† aofï¼</p><p>é‡å¯ï¼Œredis å°±å¯ä»¥ç”Ÿæ•ˆäº†ï¼</p><p>å¦‚æœè¿™ä¸ª aof æ–‡ä»¶æœ‰é”™ä½ï¼Œè¿™æ—¶å€™ redis æ˜¯å¯åŠ¨ä¸èµ·æ¥çš„å—ï¼Œæˆ‘ä»¬éœ€è¦ä¿®å¤è¿™ä¸ªaofæ–‡ä»¶</p><p>redis ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå·¥å…· <code>redis-check-aof --fix appendonly.aof</code></p><p>å¦‚æœæ–‡ä»¶æ­£å¸¸ï¼Œé‡å¯å°±å¯ä»¥ç›´æ¥æ¢å¤äº†ï¼</p><p><strong>é‡å†™è§„åˆ™è¯´æ˜</strong></p><p>aof é»˜è®¤å°±æ˜¯æ–‡ä»¶çš„æ— é™è¿½åŠ ï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼</p><p>å¦‚æœ aof æ–‡ä»¶å¤§äº 64mï¼Œå¤ªå¤§äº†ï¼ forkä¸€ä¸ªæ–°çš„è¿›ç¨‹æ¥å°†æˆ‘ä»¬çš„æ–‡ä»¶è¿›è¡Œé‡å†™ï¼</p><p><strong>ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">appendonly no # é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œ<br>rdbå®Œå…¨å¤Ÿç”¨ï¼<br>appendfilename &quot;appendonly.aof&quot; # æŒä¹…åŒ–çš„æ–‡ä»¶çš„åå­—<br><span class="hljs-meta">#</span><span class="bash"> appendfsync always <span class="hljs-comment"># æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncã€‚æ¶ˆè€—æ€§èƒ½</span></span><br>appendfsync everysec # æ¯ç§’æ‰§è¡Œä¸€æ¬¡ syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™1sçš„æ•°æ®ï¼<br><span class="hljs-meta">#</span><span class="bash"> appendfsync no <span class="hljs-comment"># ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</span></span><br><span class="hljs-meta">#</span><span class="bash"> rewrite é‡å†™ï¼Œ</span><br></code></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹ï¼š</strong><br>1ã€æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½åŒæ­¥ï¼Œæ–‡ä»¶çš„å®Œæ•´ä¼šæ›´åŠ å¥½ï¼</p><p>2ã€æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’çš„æ•°æ®</p><p>3ã€ä»ä¸åŒæ­¥ï¼Œæ•ˆç‡æœ€é«˜çš„ï¼</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>1ã€ç›¸å¯¹äºæ•°æ®æ–‡ä»¶æ¥è¯´ï¼Œaofè¿œè¿œå¤§äº rdbï¼Œä¿®å¤çš„é€Ÿåº¦ä¹Ÿæ¯” rdbæ…¢ï¼</p><p>2ã€Aof è¿è¡Œæ•ˆç‡ä¹Ÿè¦æ¯” rdb æ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬redisé»˜è®¤çš„é…ç½®å°±æ˜¯rdbæŒä¹…åŒ–ï¼</p><p><strong>æ‰©å±•ï¼š</strong></p><p>1ã€RDB æŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨</p><p>2ã€AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œï¼Œå½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼ŒAOFå‘½ä»¤ä»¥Redis åè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾ï¼ŒRedisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™ï¼Œä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§ã€‚</p><p>3ã€<strong>åªåšç¼“å­˜ï¼Œå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–</strong></p><p>4ã€åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼</p><ul><li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚</li><li>RDB çš„æ•°æ®ä¸å®æ—¶ï¼ŒåŒæ—¶ä½¿ç”¨ä¸¤è€…æ—¶æœåŠ¡å™¨é‡å¯ä¹Ÿåªä¼šæ‰¾AOFæ–‡ä»¶ï¼Œé‚£è¦ä¸è¦åªä½¿ç”¨AOFå‘¢ï¼Ÿä½œè€…å»ºè®®ä¸è¦ï¼Œå› ä¸ºRDBæ›´é€‚åˆç”¨äºå¤‡ä»½æ•°æ®åº“ï¼ˆAOFåœ¨ä¸æ–­å˜åŒ–ä¸å¥½å¤‡ä»½ï¼‰ï¼Œå¿«é€Ÿé‡å¯ï¼Œè€Œä¸”ä¸ä¼šæœ‰AOFå¯èƒ½æ½œåœ¨çš„Bugï¼Œç•™ç€ä½œä¸ºä¸€ä¸ªä¸‡ä¸€çš„æ‰‹æ®µã€‚</li></ul><p>5ã€æ€§èƒ½å»ºè®®</p><ul><li>å› ä¸ºRDBæ–‡ä»¶åªç”¨ä½œåå¤‡ç”¨é€”ï¼Œå»ºè®®åªåœ¨Slaveä¸ŠæŒä¹…åŒ–RDBæ–‡ä»¶ï¼Œè€Œä¸”åªè¦15åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡å°±å¤Ÿäº†ï¼Œåªä¿ç•™ save 900 1 è¿™æ¡è§„åˆ™ã€‚</li><li>å¦‚æœEnable AOF ï¼Œå¥½å¤„æ˜¯åœ¨æœ€æ¶åŠ£æƒ…å†µä¸‹ä¹Ÿåªä¼šä¸¢å¤±ä¸è¶…è¿‡ä¸¤ç§’æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬è¾ƒç®€å•åªloadè‡ªå·±çš„AOFæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä»£ä»·ä¸€æ˜¯å¸¦æ¥äº†æŒç»­çš„IOï¼ŒäºŒæ˜¯AOF rewrite çš„æœ€åå°† rewrite è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ–°æ•°æ®å†™åˆ°æ–°æ–‡ä»¶é€ æˆçš„é˜»å¡å‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚åªè¦ç¡¬ç›˜è®¸å¯ï¼Œåº”è¯¥å°½é‡å‡å°‘AOF rewriteçš„é¢‘ç‡ï¼ŒAOFé‡å†™çš„åŸºç¡€å¤§å°é»˜è®¤å€¼64Må¤ªå°äº†ï¼Œå¯ä»¥è®¾åˆ°5Gä»¥ä¸Šï¼Œé»˜è®¤è¶…è¿‡åŸå¤§å°100%å¤§å°é‡<br>å†™å¯ä»¥æ”¹åˆ°é€‚å½“çš„æ•°å€¼ã€‚</li><li>å¦‚æœä¸Enable AOF ï¼Œä»…é  Master-Slave Repllcation å®ç°é«˜å¯ç”¨æ€§ä¹Ÿå¯ä»¥ï¼Œèƒ½çœæ‰ä¸€å¤§ç¬”IOï¼Œä¹Ÿå‡å°‘äº†rewriteæ—¶å¸¦æ¥çš„ç³»ç»Ÿæ³¢åŠ¨ã€‚ä»£ä»·æ˜¯å¦‚æœMaster/Slave åŒæ—¶å€’æ‰ï¼Œä¼šä¸¢å¤±åå‡ åˆ†é’Ÿçš„æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬ä¹Ÿè¦æ¯”è¾ƒä¸¤ä¸ª Master/Slave ä¸­çš„ RDBæ–‡ä»¶ï¼Œè½½å…¥è¾ƒæ–°çš„é‚£ä¸ªï¼Œå¾®åšå°±æ˜¯è¿™ç§æ¶æ„ã€‚</li></ul><h1 id="Redis-å‘å¸ƒè®¢é˜…-pub-sub"><a href="#Redis-å‘å¸ƒè®¢é˜…-pub-sub" class="headerlink" title="Redis å‘å¸ƒè®¢é˜…(pub/sub)"></a>Redis å‘å¸ƒè®¢é˜…(pub/sub)</h1><p>æ˜¯ä¸€ç§<strong>æ¶ˆæ¯é€šä¿¡æ¨¡å¼</strong>ï¼šå‘é€è€…(pub)å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…(sub)æ¥æ”¶æ¶ˆæ¯ã€‚å¾®ä¿¡ã€å¾®åšã€å…³æ³¨ç³»ç»Ÿï¼</p><p>Redis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“ã€‚</p><p>è®¢é˜…/å‘å¸ƒæ¶ˆæ¯å›¾ï¼š</p><p>ç¬¬ä¸€ä¸ªï¼šæ¶ˆæ¯å‘é€è€…ï¼Œ ç¬¬äºŒä¸ªï¼šé¢‘é“ ç¬¬ä¸‰ä¸ªï¼šæ¶ˆæ¯è®¢é˜…è€…</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221173728102.png" alt="image-20210221173728102"></p><p>ä¸‹å›¾å±•ç¤ºäº†é¢‘é“ channel1 ï¼Œ ä»¥åŠè®¢é˜…è¿™ä¸ªé¢‘é“çš„ä¸‰ä¸ªå®¢æˆ·ç«¯ â€”â€” client2 ã€ client5 å’Œ client1 ä¹‹é—´çš„å…³ç³»ï¼š</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119140539964.png"></p><p>å½“æœ‰æ–°æ¶ˆæ¯é€šè¿‡ PUBLISH å‘½ä»¤å‘é€ç»™é¢‘é“ channel1 æ—¶ï¼Œ è¿™ä¸ªæ¶ˆæ¯å°±ä¼šè¢«å‘é€ç»™è®¢é˜…å®ƒçš„ä¸‰ä¸ªå®¢æˆ·ç«¯ï¼š</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2021011914060789.png"></p><h2 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h2><p>è¿™äº›å‘½ä»¤è¢«å¹¿æ³›ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨ï¼Œæ¯”å¦‚ç½‘ç»œèŠå¤©å®¤(chatroom)å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210116175434236.png"></p><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>è®¢é˜…ç«¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; SUBSCRIBE kuangshenshuo # è®¢é˜…ä¸€ä¸ªé¢‘é“ kuangshenshuo<br>Reading messages... (press Ctrl-C to quit)<br>1) &quot;subscribe&quot;<br>2) &quot;kuangshenshuo&quot;<br>3) (integer) 1<br><span class="hljs-meta">#</span><span class="bash"> ç­‰å¾…è¯»å–æ¨é€çš„ä¿¡æ¯</span><br>1) &quot;message&quot; # æ¶ˆæ¯<br>2) &quot;kuangshenshuo&quot; # é‚£ä¸ªé¢‘é“çš„æ¶ˆæ¯<br>3) &quot;hello,kuangshen&quot; # æ¶ˆæ¯çš„å…·ä½“å†…å®¹<br>1) &quot;message&quot;<br>2) &quot;kuangshenshuo&quot;<br>3) &quot;hello,redis&quot;<br></code></pre></td></tr></table></figure><p>å‘é€ç«¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; PUBLISH kuangshenshuo &quot;hello,kuangshen&quot; # å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯åˆ°é¢‘é“ï¼<br>(integer) 1<br>127.0.0.1:6379&gt; PUBLISH kuangshenshuo &quot;hello,redis&quot; # å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯åˆ°é¢‘é“ï¼<br>(integer) 1<br>127.0.0.1:6379&gt;<br></code></pre></td></tr></table></figure><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>Redisæ˜¯ä½¿ç”¨Cå®ç°çš„ï¼Œé€šè¿‡åˆ†æ Redis æºç é‡Œçš„ pubsub.c æ–‡ä»¶ï¼Œäº†è§£å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶çš„åº•å±‚å®ç°ï¼Œç±æ­¤åŠ æ·±å¯¹ Redis çš„ç†è§£ã€‚</p><p>Redis é€šè¿‡ PUBLISH ã€SUBSCRIBE å’Œ PSUBSCRIBE ç­‰å‘½ä»¤å®ç°å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½ã€‚</p><p>å¾®ä¿¡ï¼š</p><p>é€šè¿‡ SUBSCRIBE å‘½ä»¤è®¢é˜…æŸé¢‘é“åï¼Œredis-server é‡Œç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®å°±æ˜¯ä¸€ä¸ªä¸ª é¢‘é“ï¼ï¼Œè€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ª channel çš„å®¢æˆ·ç«¯ã€‚SUBSCRIBE å‘½ä»¤çš„å…³é”®ï¼Œå°±æ˜¯å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°ç»™å®š channel çš„è®¢é˜…é“¾è¡¨ä¸­ã€‚</p><h1 id="Redisä¸»ä»å¤åˆ¶"><a href="#Redisä¸»ä»å¤åˆ¶" class="headerlink" title="Redisä¸»ä»å¤åˆ¶"></a>Redisä¸»ä»å¤åˆ¶</h1><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master/leader)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave/follower)ï¼›æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Masterä»¥å†™ä¸ºä¸»ï¼ŒSlave ä»¥è¯»ä¸ºä¸»ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼›ä¸”ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä»èŠ‚ç‚¹(æˆ–æ²¡æœ‰ä»èŠ‚ç‚¹)ï¼Œä½†ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</p><p><strong>ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š</strong></p><p>1ã€æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</p><p>2ã€æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</p><p>3ã€è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</p><p>4ã€é«˜å¯ç”¨ï¼ˆé›†ç¾¤ï¼‰åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œè¦å°†Redisè¿ç”¨äºå·¥ç¨‹é¡¹ç›®ä¸­ï¼Œåªä½¿ç”¨ä¸€å°Redisæ˜¯ä¸‡ä¸‡ä¸èƒ½çš„ï¼ˆå®•æœºï¼‰ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><p>1ã€ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼Œå¹¶ä¸”ä¸€å°æœåŠ¡å™¨éœ€è¦å¤„ç†æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ï¼Œå‹åŠ›è¾ƒå¤§ï¼›</p><p>2ã€ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨å†…å­˜å®¹é‡æœ‰é™ï¼Œå°±ç®—ä¸€å°RedisæœåŠ¡å™¨å†…å­˜å®¹é‡ä¸º256Gï¼Œä¹Ÿä¸èƒ½å°†æ‰€æœ‰å†…å­˜ç”¨ä½œRediså­˜å‚¨å†…å­˜ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå•å°Redisæœ€å¤§ä½¿ç”¨å†…å­˜ä¸åº”è¯¥è¶…è¿‡20Gã€‚</p><p>ç”µå•†ç½‘ç«™ä¸Šçš„å•†å“ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸€æ¬¡ä¸Šä¼ ï¼Œæ— æ•°æ¬¡æµè§ˆçš„ï¼Œè¯´ä¸“ä¸šç‚¹ä¹Ÿå°±æ˜¯â€å¤šè¯»å°‘å†™â€ã€‚</p><p>å¯¹äºè¿™ç§åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¦‚ä¸‹è¿™ç§æ¶æ„ï¼š</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119140856469.png"></p><p>ä¸»ä»å¤åˆ¶ï¼Œè¯»å†™åˆ†ç¦»ï¼ 80% çš„æƒ…å†µä¸‹éƒ½æ˜¯åœ¨è¿›è¡Œè¯»æ“ä½œï¼å‡ç¼“æœåŠ¡å™¨çš„å‹åŠ›ï¼æ¶æ„ä¸­ç»å¸¸ä½¿ç”¨ï¼ ä¸€ä¸»äºŒä»ï¼</p><p>åªè¦åœ¨å…¬å¸ä¸­ï¼Œä¸»ä»å¤åˆ¶å°±æ˜¯å¿…é¡»è¦ä½¿ç”¨çš„ï¼Œå› ä¸ºåœ¨çœŸå®çš„é¡¹ç›®ä¸­ä¸å¯èƒ½å•æœºä½¿ç”¨Redisï¼</p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>åªé…ç½®ä»åº“ï¼Œä¸ç”¨é…ç½®ä¸»åº“ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6379&gt; info replication # æŸ¥çœ‹å½“å‰åº“çš„ä¿¡æ¯<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:master # è§’è‰² master<br>connected_slaves:0 # æ²¡æœ‰ä»æœº<br>master_replid:b63c90e6c501143759cb0e7f450bd1eb0c70882a<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:0<br>second_repl_offset:-1<br>repl_backlog_active:0<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:0<br>repl_backlog_histlen:0<br></code></pre></td></tr></table></figure><p>å¤åˆ¶3ä¸ªé…ç½®æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹å¯¹åº”çš„ä¿¡æ¯<br>1ã€ç«¯å£ ã€port 6379(ç«¯å£å·)ã€‘<br>2ã€pid åå­— ã€pidfile /var/run/redis_6379.pidã€‘<br>3ã€logæ–‡ä»¶åå­—ã€logfile â€œ6379.logâ€ã€‘<br>4ã€dump.rdb åå­—ã€dbfilename dump6381.rdbã€‘</p><p>ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œå¯åŠ¨æˆ‘ä»¬çš„3ä¸ªredisæœåŠ¡ï¼Œå¯ä»¥é€šè¿‡è¿›ç¨‹ä¿¡æ¯æŸ¥çœ‹</p><p><code>ps -cf|grep redis</code></p><h2 id="ä¸€ä¸»äºŒä»"><a href="#ä¸€ä¸»äºŒä»" class="headerlink" title="ä¸€ä¸»äºŒä»"></a>ä¸€ä¸»äºŒä»</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ï¼› æˆ‘ä»¬ä¸€èˆ¬æƒ…å†µä¸‹åªç”¨é…ç½®ä»æœºå°±å¥½äº†ï¼</p><p> ä¸€ä¸» ï¼ˆ79ï¼‰äºŒä»ï¼ˆ80ï¼Œ81ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs shell">127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 6379 # SLAVEOF host 6379 æ‰¾è°å½“è‡ªå·±çš„è€å¤§ï¼<br>OK<br>127.0.0.1:6380&gt; info replication<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:slave # å½“å‰è§’è‰²æ˜¯ä»æœº<br>master_host:127.0.0.1 # å¯ä»¥çš„çœ‹åˆ°ä¸»æœºçš„ä¿¡æ¯<br>master_port:6379<br>master_link_status:up<br>master_last_io_seconds_ago:3<br>master_sync_in_progress:0<br>slave_repl_offset:14<br>slave_priority:100<br>slave_read_only:1<br>connected_slaves:0<br>master_replid:a81be8dd257636b2d3e7a9f595e69d73ff03774e<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:14<br>second_repl_offset:-1<br>repl_backlog_active:1<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:1<br>repl_backlog_histlen:14<br><span class="hljs-meta">#</span><span class="bash"> åœ¨ä¸»æœºä¸­æŸ¥çœ‹ï¼</span><br>127.0.0.1:6379&gt; info replication<br><span class="hljs-meta">#</span><span class="bash"> Replication</span><br>role:master<br>connected_slaves:1 # å¤šäº†ä»æœºçš„é…ç½®<br>slave0:ip=127.0.0.1,port=6380,state=online,offset=42,lag=1 # å¤šäº†ä»æœºçš„é…ç½®<br>master_replid:a81be8dd257636b2d3e7a9f595e69d73ff03774e<br>master_replid2:0000000000000000000000000000000000000000<br>master_repl_offset:42<br>second_repl_offset:-1<br>repl_backlog_active:1<br>repl_backlog_size:1048576<br>repl_backlog_first_byte_offset:1<br>repl_backlog_histlen:42<br></code></pre></td></tr></table></figure><p>å¦‚æœä¸¤ä¸ªéƒ½é…ç½®å®Œäº†ï¼Œå°±æ˜¯æœ‰ä¸¤ä¸ªä»æœºçš„</p><p>çœŸå®çš„ä»ä¸»é…ç½®åº”è¯¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œè¿™æ ·çš„è¯æ˜¯æ°¸ä¹…çš„ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯å‘½ä»¤ï¼Œæš‚æ—¶çš„</p><h2 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h2><p>ä¸»æœºå¯ä»¥å†™ï¼Œä»æœºä¸èƒ½å†™åªèƒ½è¯»ï¼ä¸»æœºä¸­çš„æ‰€æœ‰ä¿¡æ¯å’Œæ•°æ®ï¼Œéƒ½ä¼šè‡ªåŠ¨è¢«ä»æœºä¿å­˜ï¼</p><p>ä¸»æœºå†™ï¼š</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2021011914110817.png"></p><p>æµ‹è¯•ï¼šä¸»æœºæ–­å¼€è¿æ¥ï¼Œä»æœºä¾æ—§è¿æ¥åˆ°ä¸»æœºçš„ï¼Œä½†æ˜¯æ²¡æœ‰å†™æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¸»æœºå¦‚æœå›æ¥äº†ï¼Œä»æœºä¾æ—§å¯ä»¥ç›´æ¥è·å–åˆ°ä¸»æœºå†™çš„ä¿¡æ¯ï¼</p><p>å¦‚æœæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œï¼Œæ¥é…ç½®çš„ä¸»ä»ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœé‡å¯äº†ï¼Œå°±ä¼šå˜å›ä¸»æœºï¼åªè¦å˜ä¸ºä»æœºï¼Œç«‹é©¬å°±ä¼šä»ä¸»æœºä¸­è·å–å€¼ï¼</p><h2 id="å¤åˆ¶åŸç†"><a href="#å¤åˆ¶åŸç†" class="headerlink" title="å¤åˆ¶åŸç†"></a>å¤åˆ¶åŸç†</h2><p>Slave å¯åŠ¨æˆåŠŸè¿æ¥åˆ° master åä¼šå‘é€ä¸€ä¸ªsyncåŒæ­¥å‘½ä»¤</p><p>Master æ¥åˆ°å‘½ä»¤ï¼Œå¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œ<strong>masterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°slaveï¼Œå¹¶å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥ã€‚</strong></p><p><strong>å…¨é‡å¤åˆ¶ï¼š</strong>è€ŒslaveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p><p><strong>å¢é‡å¤åˆ¶ï¼š</strong>Master ç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ ç»™slaveï¼Œå®ŒæˆåŒæ­¥</p><p>ä½†æ˜¯åªè¦æ˜¯é‡æ–°è¿æ¥masterï¼Œä¸€æ¬¡å®Œå…¨åŒæ­¥ï¼ˆå…¨é‡å¤åˆ¶ï¼‰å°†è¢«è‡ªåŠ¨æ‰§è¡Œï¼ æˆ‘ä»¬çš„æ•°æ®ä¸€å®šå¯ä»¥åœ¨ä»æœºä¸­çœ‹åˆ°ï¼</p><h2 id="å±‚å±‚é“¾è·¯"><a href="#å±‚å±‚é“¾è·¯" class="headerlink" title="å±‚å±‚é“¾è·¯"></a>å±‚å±‚é“¾è·¯</h2><p>ä¸Šä¸€ä¸ªMé“¾æ¥ä¸‹ä¸€ä¸ª Sï¼</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2021011914114815.png"></p><p>è¿™æ—¶å€™ä¹Ÿå¯ä»¥å®Œæˆæˆ‘ä»¬çš„ä¸»ä»å¤åˆ¶ï¼</p><p>å¦‚æœæ²¡æœ‰è€å¤§äº†ï¼Œè¿™ä¸ªæ—¶å€™èƒ½ä¸èƒ½é€‰æ‹©ä¸€ä¸ªè€å¤§å‡ºæ¥å‘¢ï¼Ÿ æ‰‹åŠ¨ï¼</p><h2 id="è°‹æœç¯¡ä½"><a href="#è°‹æœç¯¡ä½" class="headerlink" title="è°‹æœç¯¡ä½"></a>è°‹æœç¯¡ä½</h2><p>å¦‚æœä¸»æœºæ–­å¼€äº†è¿æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ==SLAVEOF no one== è®©è‡ªå·±å˜æˆä¸»æœºï¼å…¶ä»–çš„èŠ‚ç‚¹å°±å¯ä»¥æ‰‹åŠ¨è¿æ¥åˆ°æœ€æ–°çš„è¿™ä¸ªä¸»èŠ‚ç‚¹ï¼ˆæ‰‹åŠ¨ï¼‰ï¼å¦‚æœè¿™ä¸ªæ—¶å€™è€å¤§ä¿®å¤äº†ï¼Œé‚£å°±é‡æ–°è¿æ¥ï¼</p><h2 id="å“¨å…µæ¨¡å¼"><a href="#å“¨å…µæ¨¡å¼" class="headerlink" title="å“¨å…µæ¨¡å¼"></a>å“¨å…µæ¨¡å¼</h2><p>ï¼ˆè‡ªåŠ¨é€‰ä¸¾è€å¤§çš„æ¨¡å¼ï¼‰</p><p>ä¸»ä»åˆ‡æ¢æŠ€æœ¯çš„æ–¹æ³•æ˜¯ï¼šå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°ä»æœåŠ¡å™¨åˆ‡æ¢ä¸ºä¸»æœåŠ¡å™¨ï¼Œè¿™å°±éœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘å“¨å…µæ¨¡å¼ã€‚Redisä»2.8å¼€å§‹æ­£å¼æä¾›äº†Sentinelï¼ˆå“¨å…µï¼‰ æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>è°‹æœç¯¡ä½çš„è‡ªåŠ¨ç‰ˆï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œå¦‚æœæ•…éšœäº†æ ¹æ®æŠ•ç¥¨æ•°è‡ªåŠ¨å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“ã€‚</p><p>å“¨å…µæ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ï¼Œé¦–å…ˆRedisæä¾›äº†å“¨å…µçš„å‘½ä»¤ï¼Œå“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ç«‹è¿è¡Œã€‚å…¶åŸç†æ˜¯å“¨å…µé€šè¿‡å‘é€å‘½ä»¤ï¼Œç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹ã€‚</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119141235529.png"></p><p>è¿™é‡Œçš„å“¨å…µæœ‰ä¸¤ä¸ªä½œç”¨</p><ul><li>é€šè¿‡å‘é€å‘½ä»¤ï¼Œè®©RedisæœåŠ¡å™¨è¿”å›ç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨ã€‚</li><li>å½“å“¨å…µç›‘æµ‹åˆ°masterå®•æœºï¼Œä¼šè‡ªåŠ¨å°†slaveåˆ‡æ¢æˆmasterï¼Œç„¶åé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä»–çš„ä»æœåŠ¡å™¨ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒä»¬åˆ‡æ¢ä¸»æœºã€‚</li></ul><p>ç„¶è€Œä¸€ä¸ªå“¨å…µè¿›ç¨‹å¯¹RedisæœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚å„ä¸ªå“¨å…µä¹‹é—´è¿˜ä¼šè¿›è¡Œç›‘æ§ï¼Œè¿™æ ·å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119141251820.png"></p><p>å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œfailoverè¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡ç§°ä¸º<strong>ä¸»è§‚ä¸‹çº¿</strong>ã€‚å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œfailover[æ•…éšœè½¬ç§»]æ“ä½œã€‚åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å®¢è§‚ä¸‹çº¿</strong></p><h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>1ã€åœ¨é…ç½®æ–‡ä»¶çš„æ–‡ä»¶å†æ–°å»ºä¸€ä¸ªå“¨å…µé…ç½®æ–‡ä»¶<code>vi sentinel.conf</code>å¹¶ç¼–å†™å¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> sentinel monitor è¢«ç›‘æ§çš„åç§° host port 1</span><br>sentinel monitor myredis 127.0.0.1 6379 1<br></code></pre></td></tr></table></figure><p>åé¢çš„è¿™ä¸ªæ•°å­—1ï¼Œä»£è¡¨è‡³å°‘æœ‰ä¸€ä¸ªå“¨å…µè®¤ä¸ºä¸»æœºå®•æœºæ—¶ï¼Œè¯¥ä¸»æœºæ‰è¢«åˆ¤å®šä¸ºå®•æœºï¼ŒslaveæŠ•ç¥¨çœ‹è®©è°æ¥æ›¿æˆä¸ºä¸»æœºï¼Œç¥¨æ•°æœ€å¤šçš„ï¼Œå°±ä¼šæˆä¸ºä¸»æœºï¼</p><p>2ã€å¯åŠ¨å“¨å…µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen bin]# redis-sentinel kconfig/sentinel.conf<br>26607:X 31 Mar 2020 21:13:10.027 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo<br>26607:X 31 Mar 2020 21:13:10.027 # Redis version=5.0.8, bits=64,<br>commit=00000000, modified=0, pid=26607, just started<br>26607:X 31 Mar 2020 21:13:10.027 # Configuration loaded<br>_._<br>_.-``__ &#x27;&#x27;-._<br>_.-`` `. `_. &#x27;&#x27;-._ Redis 5.0.8 (00000000/0) 64 bit<br>.-`` .-```. ```\/ _.,_ &#x27;&#x27;-._<br>( &#x27; , .-` | `, ) Running in sentinel mode<br>|`-._`-...-` __...-.``-._|&#x27;` _.-&#x27;| Port: 26379<br>| `-._ `._ / _.-&#x27; | PID: 26607<br>`-._ `-._ `-./ _.-&#x27; _.-&#x27;<br>|`-._`-._ `-.__.-&#x27; _.-&#x27;_.-&#x27;|<br>| `-._`-._ _.-&#x27;_.-&#x27; | http://redis.io<br>`-._ `-._`-.__.-&#x27;_.-&#x27; _.-&#x27;<br>|`-._`-._ `-.__.-&#x27; _.-&#x27;_.-&#x27;|<br>| `-._`-._ _.-&#x27;_.-&#x27; |<br>`-._ `-._`-.__.-&#x27;_.-&#x27; _.-&#x27;<br>`-._ `-.__.-&#x27; _.-&#x27;<br>`-._ _.-&#x27;<br>`-.__.-&#x27;<br>26607:X 31 Mar 2020 21:13:10.029 # WARNING: The TCP backlog setting of 511<br>cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value<br>of 128.<br>26607:X 31 Mar 2020 21:13:10.031 # Sentinel ID is<br>4c780da7e22d2aebe3bc20c333746f202ce72996<br>26607:X 31 Mar 2020 21:13:10.031 # +monitor master myredis 127.0.0.1 6379 quorum<br>1<br>26607:X 31 Mar 2020 21:13:10.031 * +slave slave 127.0.0.1:6380 127.0.0.1 6380 @<br>myredis 127.0.0.1 6379<br>26607:X 31 Mar 2020 21:13:10.033 * +slave slave 127.0.0.1:6381 127.0.0.1 6381 @<br>myredis 127.0.0.1 6379<br></code></pre></td></tr></table></figure><p>å¦‚æœMaster èŠ‚ç‚¹æ–­å¼€äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šä»ä»æœºä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæœåŠ¡å™¨ï¼ ï¼ˆè¿™é‡Œé¢æœ‰ä¸€ä¸ªæŠ•ç¥¨ç®—æ³•ï¼ï¼‰</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221211540696.png" alt="image-20210221211540696"></p><p>å“¨å…µæ—¥å¿—ï¼</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210221211650440.png" alt="image-20210221211650440"></p><p>å¦‚æœä¸»æœºæ­¤æ—¶å›æ¥äº†ï¼Œåªèƒ½å½’å¹¶åˆ°æ–°çš„ä¸»æœºä¸‹ï¼Œå½“åšä»æœºï¼Œè¿™å°±æ˜¯å“¨å…µæ¨¡å¼çš„è§„åˆ™ï¼</p><p>ä¼˜ç‚¹ï¼š</p><p>1ã€å“¨å…µé›†ç¾¤ï¼ŒåŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œæ‰€æœ‰çš„ä¸»ä»é…ç½®ä¼˜ç‚¹ï¼Œå®ƒå…¨æœ‰</p><p>2ã€ ä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœå¯ä»¥è½¬ç§»ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§å°±ä¼šæ›´å¥½</p><p>3ã€å“¨å…µæ¨¡å¼å°±æ˜¯ä¸»ä»æ¨¡å¼çš„å‡çº§ï¼Œæ‰‹åŠ¨åˆ°è‡ªåŠ¨ï¼Œæ›´åŠ å¥å£®ï¼</p><p>ç¼ºç‚¹ï¼š</p><p>1ã€Redis ä¸å¥½åœ¨çº¿æ‰©å®¹çš„ï¼Œé›†ç¾¤å®¹é‡ä¸€æ—¦åˆ°è¾¾ä¸Šé™ï¼Œåœ¨çº¿æ‰©å®¹å°±ååˆ†éº»çƒ¦ï¼</p><p>2ã€å®ç°å“¨å…µæ¨¡å¼çš„é…ç½®å…¶å®æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œé‡Œé¢æœ‰å¾ˆå¤šé€‰æ‹©ï¼</p><h3 id="å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®"><a href="#å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®" class="headerlink" title="å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®"></a>å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Example sentinel.conf</span><br><span class="hljs-meta">#</span><span class="bash"> å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379</span><br>port 26379<br><span class="hljs-meta">#</span><span class="bash"> å“¨å…µsentinelçš„å·¥ä½œç›®å½•</span><br>dir /tmp<br><span class="hljs-meta">#</span><span class="bash"> å“¨å…µsentinelç›‘æ§çš„redisä¸»èŠ‚ç‚¹çš„ ip port</span><br><span class="hljs-meta">#</span><span class="bash"> master-name å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€è¿™ä¸‰ä¸ªå­—ç¬¦<span class="hljs-string">&quot;.-_&quot;</span>ç»„æˆã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> quorum é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆè¿™æ—¶å®¢è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹å¤±è”äº†</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span><br>sentinel monitor mymaster 127.0.0.1 6379 2<br><span class="hljs-meta">#</span><span class="bash"> å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„å®¢æˆ·ç«¯éƒ½è¦æä¾›å¯†ç </span><br><span class="hljs-meta">#</span><span class="bash"> è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç </span><br><span class="hljs-meta">#</span><span class="bash"> sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span><br>sentinel auth-pass mymaster MySUPER--secret-0123passw0rd<br><span class="hljs-meta">#</span><span class="bash"> æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel æ­¤æ—¶ å“¨å…µä¸»è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿ é»˜è®¤30ç§’</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span><br>sentinel down-after-milliseconds mymaster 30000<br><span class="hljs-meta">#</span><span class="bash"> è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„masterè¿›è¡Œ åŒæ­¥ï¼Œ</span><br>è¿™ä¸ªæ•°å­—è¶Šå°ï¼Œå®Œæˆfailoveræ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œ<br>ä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œå°±æ„å‘³ç€è¶Š å¤šçš„slaveå› ä¸ºreplicationè€Œä¸å¯ç”¨ã€‚<br>å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªslave å¤„äºä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚<br><span class="hljs-meta">#</span><span class="bash"> sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;</span><br>sentinel parallel-syncs mymaster 1<br><span class="hljs-meta">#</span><span class="bash"> æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š</span><br><span class="hljs-meta">#</span><span class="bash">1. åŒä¸€ä¸ªsentinelå¯¹åŒä¸€ä¸ªmasterä¸¤æ¬¡failoverä¹‹é—´çš„é—´éš”æ—¶é—´ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">2. å½“ä¸€ä¸ªslaveä»ä¸€ä¸ªé”™è¯¯çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®å¼€å§‹è®¡ç®—æ—¶é—´ã€‚ç›´åˆ°slaveè¢«çº æ­£ä¸ºå‘æ­£ç¡®çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®æ—¶ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">3.å½“æƒ³è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„failoveræ‰€éœ€è¦çš„æ—¶é—´ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">4.å½“è¿›è¡Œfailoveræ—¶ï¼Œé…ç½®æ‰€æœ‰slavesæŒ‡å‘æ–°çš„masteræ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚ä¸è¿‡ï¼Œå³ä½¿è¿‡äº†è¿™ä¸ªè¶…æ—¶ï¼Œslavesä¾ç„¶ä¼šè¢«æ­£ç¡®é…ç½®ä¸ºæŒ‡å‘masterï¼Œä½†æ˜¯å°±ä¸æŒ‰parallel-syncsæ‰€é…ç½®çš„è§„åˆ™æ¥äº†</span><br><span class="hljs-meta">#</span><span class="bash"> é»˜è®¤ä¸‰åˆ†é’Ÿ</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</span><br>sentinel failover-timeout mymaster 180000<br><span class="hljs-meta">#</span><span class="bash"> SCRIPTS EXECUTION</span><br><span class="hljs-meta">#</span><span class="bash">é…ç½®å½“æŸä¸€äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æ¥é€šçŸ¥ç®¡ç†å‘˜ï¼Œä¾‹å¦‚å½“ç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸æ—¶å‘é‚®ä»¶é€šçŸ¥ç›¸å…³äººå‘˜ã€‚</span><br><span class="hljs-meta">#</span><span class="bash">å¯¹äºè„šæœ¬çš„è¿è¡Œç»“æœæœ‰ä»¥ä¸‹è§„åˆ™ï¼š</span><br><span class="hljs-meta">#</span><span class="bash">è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›1ï¼Œé‚£ä¹ˆè¯¥è„šæœ¬ç¨åå°†ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œé‡å¤æ¬¡æ•°ç›®å‰é»˜è®¤ä¸º10</span><br><span class="hljs-meta">#</span><span class="bash">è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›2ï¼Œæˆ–è€…æ¯”2æ›´é«˜çš„ä¸€ä¸ªè¿”å›å€¼ï¼Œè„šæœ¬å°†ä¸ä¼šé‡å¤æ‰§è¡Œã€‚</span><br><span class="hljs-meta">#</span><span class="bash">å¦‚æœè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºæ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·è¢«ç»ˆæ­¢äº†ï¼Œåˆ™åŒè¿”å›å€¼ä¸º1æ—¶çš„è¡Œä¸ºç›¸åŒã€‚</span><br><span class="hljs-meta">#</span><span class="bash">ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º60sï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè„šæœ¬å°†ä¼šè¢«ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢ï¼Œä¹‹åé‡æ–°æ‰§è¡Œã€‚</span><br><span class="hljs-meta">#</span><span class="bash">é€šçŸ¥å‹è„šæœ¬:å½“sentinelæœ‰ä»»ä½•è­¦å‘Šçº§åˆ«çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯´rediså®ä¾‹çš„ä¸»è§‚å¤±æ•ˆå’Œå®¢è§‚å¤±æ•ˆç­‰ç­‰ï¼‰ï¼Œå°†ä¼šå»è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œè¿™æ—¶è¿™ä¸ªè„šæœ¬åº”è¯¥é€šè¿‡é‚®ä»¶ï¼ŒSMSç­‰æ–¹å¼å»é€šçŸ¥ç³»ç»Ÿç®¡ç†å‘˜å…³äºç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„ä¿¡æ¯ã€‚è°ƒç”¨è¯¥è„šæœ¬æ—¶ï¼Œå°†ä¼ ç»™è„šæœ¬ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„ç±»å‹ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„æè¿°ã€‚å¦‚æœsentinel.confé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿™ä¸ªè„šæœ¬è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»ä¿è¯è¿™ä¸ªè„šæœ¬å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ï¼Œå¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¦åˆ™sentinelæ— æ³•æ­£å¸¸å¯åŠ¨æˆåŠŸã€‚</span><br><span class="hljs-meta">#</span><span class="bash">é€šçŸ¥è„šæœ¬</span><br><span class="hljs-meta">#</span><span class="bash"> shellç¼–ç¨‹</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;</span><br>sentinel notification-script mymaster /var/redis/notify.sh<br><span class="hljs-meta">#</span><span class="bash"> å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬</span><br><span class="hljs-meta">#</span><span class="bash"> å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯å…³äºmasteråœ°å€å·²ç»å‘ç”Ÿæ”¹å˜çš„ä¿¡æ¯ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;</span><br><span class="hljs-meta">#</span><span class="bash"> ç›®å‰&lt;state&gt;æ€»æ˜¯â€œfailoverâ€,</span><br><span class="hljs-meta">#</span><span class="bash"> &lt;role&gt;æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§çš„slave)é€šä¿¡çš„</span><br><span class="hljs-meta">#</span><span class="bash"> è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚</span><br><span class="hljs-meta">#</span><span class="bash"> sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;</span><br>sentinel client-reconfig-script mymaster /var/redis/reconfig.sh # ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼<br></code></pre></td></tr></table></figure><h1 id="Redisç¼“å­˜ç©¿é€å’Œé›ªå´©"><a href="#Redisç¼“å­˜ç©¿é€å’Œé›ªå´©" class="headerlink" title="Redisç¼“å­˜ç©¿é€å’Œé›ªå´©"></a>Redisç¼“å­˜ç©¿é€å’Œé›ªå´©</h1><p>æœåŠ¡çš„é«˜å¯ç”¨é—®é¢˜ã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸ä¼šè¯¦ç»†çš„åŒºåˆ†æè§£å†³æ–¹æ¡ˆçš„åº•å±‚ï¼</p><p>Redisç¼“å­˜çš„ä½¿ç”¨ï¼Œæå¤§çš„æå‡äº†åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯æ•°æ®æŸ¥è¯¢æ–¹é¢ã€‚ä½†åŒæ—¶ï¼Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ã€‚å…¶ä¸­ï¼Œæœ€è¦å®³çš„é—®é¢˜ï¼Œå°±æ˜¯æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä»ä¸¥æ ¼æ„ä¹‰ä¸Šè®²ï¼Œè¿™ä¸ªé—®é¢˜æ— è§£ã€‚å¦‚æœå¯¹æ•°æ®çš„ä¸€è‡´æ€§è¦æ±‚å¾ˆé«˜ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨ç¼“å­˜ã€‚å¦å¤–çš„ä¸€äº›å…¸å‹é—®é¢˜å°±æ˜¯ï¼Œç¼“å­˜ç©¿é€ã€ç¼“å­˜é›ªå´©å’Œç¼“å­˜å‡»ç©¿ã€‚ç›®å‰ï¼Œä¸šç•Œä¹Ÿéƒ½æœ‰æ¯”è¾ƒæµè¡Œçš„è§£å†³æ–¹æ¡ˆã€‚</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119141626477.png"></p><h2 id="ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰"><a href="#ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰" class="headerlink" title="ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰"></a>ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰</h2><p>ç¼“å­˜ç©¿é€çš„æ¦‚å¿µå¾ˆç®€å•ï¼Œç”¨æˆ·æƒ³è¦æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œäºæ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ã€‚å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æœ¬æ¬¡æŸ¥è¯¢å¤±è´¥ã€‚å½“ç”¨æˆ·å¾ˆå¤šçš„æ—¶å€™ï¼Œç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­ï¼ˆç§’æ€ï¼ï¼‰ï¼Œäºæ˜¯éƒ½å»è¯·æ±‚äº†æŒä¹…å±‚æ•°æ®åº“ã€‚è¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œè¿™æ—¶å€™å°±ç›¸å½“äºå‡ºç°äº†ç¼“å­˜ç©¿é€ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="å¸ƒéš†è¿‡æ»¤å™¨"><a href="#å¸ƒéš†è¿‡æ»¤å™¨" class="headerlink" title="å¸ƒéš†è¿‡æ»¤å™¨"></a>å¸ƒéš†è¿‡æ»¤å™¨</h4><p>å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ä¸¢å¼ƒï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ï¼›</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119141654814.png"></p><h4 id="ç¼“å­˜ç©ºå¯¹è±¡"><a href="#ç¼“å­˜ç©ºå¯¹è±¡" class="headerlink" title="ç¼“å­˜ç©ºå¯¹è±¡"></a>ç¼“å­˜ç©ºå¯¹è±¡</h4><p>å½“å­˜å‚¨å±‚ä¸å‘½ä¸­åï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•°æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤äº†åç«¯æ•°æ®æºï¼›</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2021011914171586.png"></p><p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><p>1ã€å¦‚æœç©ºå€¼èƒ½å¤Ÿè¢«ç¼“å­˜èµ·æ¥ï¼Œè¿™å°±æ„å‘³ç€ç¼“å­˜éœ€è¦æ›´å¤šçš„ç©ºé—´å­˜å‚¨æ›´å¤šçš„é”®ï¼Œå› ä¸ºè¿™å½“ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤šçš„ç©ºå€¼çš„é”®ï¼›</p><p>2ã€å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äºéœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ã€‚</p><h2 id="ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰"><a href="#ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰" class="headerlink" title="ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰"></a>ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰</h2><p>è¿™é‡Œéœ€è¦æ³¨æ„å’Œç¼“å­˜å‡»ç©¿çš„åŒºåˆ«ï¼Œç¼“å­˜å‡»ç©¿ï¼Œæ˜¯æŒ‡ä¸€ä¸ªkeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªkeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå±éšœä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚</p><p>å½“æŸä¸ªkeyåœ¨è¿‡æœŸçš„ç¬é—´ï¼Œæœ‰å¤§é‡çš„è¯·æ±‚å¹¶å‘è®¿é—®ï¼Œè¿™ç±»æ•°æ®ä¸€èˆ¬æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œç”±äºç¼“å­˜è¿‡æœŸï¼Œä¼šåŒæ—¶è®¿é—®æ•°æ®åº“æ¥æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”å›å†™ç¼“å­˜ï¼Œä¼šå¯¼ä½¿æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ"><a href="#è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ" class="headerlink" title="è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ"></a><strong>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ</strong></h4><p>ä»ç¼“å­˜å±‚é¢æ¥çœ‹ï¼Œæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°çƒ­ç‚¹ key è¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜ã€‚</p><h4 id="åŠ äº’æ–¥é”"><a href="#åŠ äº’æ–¥é”" class="headerlink" title="åŠ äº’æ–¥é”"></a><strong>åŠ äº’æ–¥é”</strong></h4><p>åˆ†å¸ƒå¼é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œä¿è¯å¯¹äºæ¯ä¸ªkeyåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢åç«¯æœåŠ¡ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰è·å¾—åˆ†å¸ƒå¼é”çš„æƒé™ï¼Œå› æ­¤åªéœ€è¦ç­‰å¾…å³å¯ã€‚è¿™ç§æ–¹å¼å°†é«˜å¹¶å‘çš„å‹åŠ›è½¬ç§»åˆ°äº†åˆ†å¸ƒå¼é”ï¼Œå› æ­¤å¯¹åˆ†å¸ƒå¼é”çš„è€ƒéªŒå¾ˆå¤§ã€‚</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119141741444.png"></p><h2 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h2><p>ç¼“å­˜é›ªå´©ï¼Œæ˜¯æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆã€‚Redis å®•æœºï¼</p><p>äº§ç”Ÿé›ªå´©çš„åŸå› ä¹‹ä¸€ï¼Œæ¯”å¦‚åœ¨å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œé©¬ä¸Šå°±è¦åˆ°åŒåäºŒé›¶ç‚¹ï¼Œå¾ˆå¿«å°±ä¼šè¿æ¥ä¸€æ³¢æŠ¢è´­ï¼Œè¿™æ³¢å•†å“æ—¶é—´æ¯”è¾ƒé›†ä¸­çš„æ”¾å…¥äº†ç¼“å­˜ï¼Œå‡è®¾ç¼“å­˜ä¸€ä¸ªå°æ—¶ã€‚é‚£ä¹ˆåˆ°äº†å‡Œæ™¨ä¸€ç‚¹é’Ÿçš„æ—¶å€™ï¼Œè¿™æ‰¹å•†å“çš„ç¼“å­˜å°±éƒ½è¿‡æœŸäº†ã€‚è€Œå¯¹è¿™æ‰¹å•†å“çš„è®¿é—®æŸ¥è¯¢ï¼Œéƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹äºæ•°æ®åº“è€Œè¨€ï¼Œå°±ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢å³°ã€‚äºæ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¾¾åˆ°å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šæŒ‚æ‰çš„æƒ…å†µã€‚</p><p><img src="/2021/02/19/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20210119141803494.png"></p><p>å…¶å®é›†ä¸­è¿‡æœŸï¼Œå€’ä¸æ˜¯éå¸¸è‡´å‘½ï¼Œæ¯”è¾ƒè‡´å‘½çš„ç¼“å­˜é›ªå´©ï¼Œæ˜¯ç¼“å­˜æœåŠ¡å™¨æŸä¸ªèŠ‚ç‚¹å®•æœºæˆ–æ–­ç½‘ã€‚å› ä¸ºè‡ªç„¶å½¢æˆçš„ç¼“å­˜é›ªå´©ï¼Œä¸€å®šæ˜¯åœ¨æŸä¸ªæ—¶é—´æ®µé›†ä¸­åˆ›å»ºç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ•°æ®åº“ä¹Ÿæ˜¯å¯ä»¥é¡¶ä½å‹åŠ›çš„ã€‚æ— éå°±æ˜¯å¯¹æ•°æ®åº“äº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›è€Œå·²ã€‚è€Œç¼“å­˜æœåŠ¡èŠ‚ç‚¹çš„å®•æœºï¼Œå¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆçš„å‹åŠ›æ˜¯ä¸å¯é¢„çŸ¥çš„ï¼Œå¾ˆæœ‰å¯èƒ½ç¬é—´å°±æŠŠæ•°æ®åº“å‹å®ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ-2"><a href="#è§£å†³æ–¹æ¡ˆ-2" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="redisé«˜å¯ç”¨"><a href="#redisé«˜å¯ç”¨" class="headerlink" title="redisé«˜å¯ç”¨"></a><strong>redisé«˜å¯ç”¨</strong></h4><p>è¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤ã€‚ï¼ˆå¼‚åœ°å¤šæ´»ï¼ï¼‰</p><h4 id="é™æµé™çº§"><a href="#é™æµé™çº§" class="headerlink" title="é™æµé™çº§"></a><strong>é™æµé™çº§</strong></h4><p>è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</p><h4 id="æ•°æ®é¢„çƒ­"><a href="#æ•°æ®é¢„çƒ­" class="headerlink" title="æ•°æ®é¢„çƒ­"></a><strong>æ•°æ®é¢„çƒ­</strong></h4><p>æ•°æ®åŠ çƒ­çš„å«ä¹‰å°±æ˜¯åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½çš„æ•°æ®å…ˆé¢„å…ˆè®¿é—®ä¸€éï¼Œè¿™æ ·éƒ¨åˆ†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®å°±ä¼šåŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</p><p>ç¬”è®°å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1S54y1R7SB">https://www.bilibili.com/video/BV1S54y1R7SB</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¤§æ•°æ®</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxè´¦å·ä¸ç£ç›˜ç®¡ç†</title>
    <link href="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86/"/>
    <url>/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="è´¦å·ç®¡ç†"><a href="#è´¦å·ç®¡ç†" class="headerlink" title="è´¦å·ç®¡ç†"></a>è´¦å·ç®¡ç†</h1><p>Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡çš„åˆ†æ—¶æ“ä½œç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªè¦ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„ç”¨æˆ·ï¼Œéƒ½å¿…é¡»é¦–å…ˆå‘ç³»ç»Ÿç®¡ç†å‘˜ç”³è¯·ä¸€ä¸ªè´¦å·ï¼Œç„¶åä»¥è¿™ä¸ªè´¦å·çš„èº«ä»½è¿›å…¥ç³»ç»Ÿã€‚</p><p>ç”¨æˆ·çš„è´¦å·ä¸€æ–¹é¢å¯ä»¥å¸®åŠ©ç³»ç»Ÿç®¡ç†å‘˜å¯¹ä½¿ç”¨ç³»ç»Ÿçš„ç”¨æˆ·è¿›è¡Œè·Ÿè¸ªï¼Œå¹¶æ§åˆ¶ä»–ä»¬å¯¹ç³»ç»Ÿèµ„æºçš„è®¿é—®ï¼›å¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥å¸®åŠ©ç”¨æˆ·ç»„ç»‡æ–‡ä»¶ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›å®‰å…¨æ€§ä¿æŠ¤ã€‚</p><p>æ¯ä¸ªç”¨æˆ·è´¦å·éƒ½æ‹¥æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ·åå’Œå„è‡ªçš„å£ä»¤ã€‚</p><p>ç”¨æˆ·åœ¨ç™»å½•æ—¶é”®å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå£ä»¤åï¼Œå°±èƒ½å¤Ÿè¿›å…¥ç³»ç»Ÿå’Œè‡ªå·±çš„ä¸»ç›®å½•ã€‚</p><p>å®ç°ç”¨æˆ·è´¦å·çš„ç®¡ç†ï¼Œè¦å®Œæˆçš„å·¥ä½œä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>ç”¨æˆ·è´¦å·çš„æ·»åŠ ã€åˆ é™¤ä¸ä¿®æ”¹ã€‚</li><li>ç”¨æˆ·å£ä»¤çš„ç®¡ç†ã€‚</li><li>ç”¨æˆ·ç»„çš„ç®¡ç†ã€‚</li></ul><h2 id="ç”¨æˆ·è´¦å·çš„ç®¡ç†"><a href="#ç”¨æˆ·è´¦å·çš„ç®¡ç†" class="headerlink" title="ç”¨æˆ·è´¦å·çš„ç®¡ç†"></a>ç”¨æˆ·è´¦å·çš„ç®¡ç†</h2><p>ç”¨æˆ·è´¦å·çš„ç®¡ç†å·¥ä½œä¸»è¦æ¶‰åŠåˆ°ç”¨æˆ·è´¦å·çš„æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤ã€‚</p><p>æ·»åŠ ç”¨æˆ·è´¦å·å°±æ˜¯åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªæ–°è´¦å·ï¼Œç„¶åä¸ºæ–°è´¦å·åˆ†é…ç”¨æˆ·å·ã€ç”¨æˆ·ç»„ã€ä¸»ç›®å½•å’Œç™»å½•Shellç­‰èµ„æºã€‚</p><h2 id="æ·»åŠ è´¦å·-useradd"><a href="#æ·»åŠ è´¦å·-useradd" class="headerlink" title="æ·»åŠ è´¦å· useradd"></a>æ·»åŠ è´¦å· useradd</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">useradd é€‰é¡¹ ç”¨æˆ·å<br></code></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><p>é€‰é¡¹ :</p></li><li><ul><li>-c comment æŒ‡å®šä¸€æ®µæ³¨é‡Šæ€§æè¿°ã€‚</li><li>-d ç›®å½• æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•ï¼Œå¦‚æœæ­¤ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åŒæ—¶ä½¿ç”¨-mé€‰é¡¹ï¼Œå¯ä»¥åˆ›å»ºä¸»ç›®å½•ã€‚</li><li>-g ç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚</li><li>-G ç”¨æˆ·ç»„ï¼Œç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„ã€‚</li><li>-mã€€ä½¿ç”¨è€…ç›®å½•å¦‚ä¸å­˜åœ¨åˆ™è‡ªåŠ¨å»ºç«‹ã€‚</li><li>-s Shellæ–‡ä»¶ æŒ‡å®šç”¨æˆ·çš„ç™»å½•Shellã€‚</li><li>-u ç”¨æˆ·å· æŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·å·ï¼Œå¦‚æœåŒæ—¶æœ‰-oé€‰é¡¹ï¼Œåˆ™å¯ä»¥é‡å¤ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„æ ‡è¯†å·ã€‚</li></ul></li><li><p>ç”¨æˆ·å :</p></li><li><ul><li>æŒ‡å®šæ–°è´¦å·çš„ç™»å½•åã€‚</li></ul></li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ­¤å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ªç”¨æˆ·kuangshenï¼Œå…¶ä¸­-mé€‰é¡¹ç”¨æ¥ä¸ºç™»å½•åkuangshenäº§ç”Ÿä¸€ä¸ªä¸»ç›®å½• /home/kuangshen</span><br>[root@kuangshen home]# useradd -m kuangshen<br></code></pre></td></tr></table></figure><p>å¢åŠ ç”¨æˆ·è´¦å·å°±æ˜¯åœ¨/etc/passwdæ–‡ä»¶ä¸­ä¸ºæ–°ç”¨æˆ·å¢åŠ ä¸€æ¡è®°å½•ï¼ŒåŒæ—¶æ›´æ–°å…¶ä»–ç³»ç»Ÿæ–‡ä»¶å¦‚/etc/shadow, /etc/groupç­‰ã€‚</p><h2 id="Linuxä¸‹å¦‚ä½•åˆ‡æ¢ç”¨æˆ·"><a href="#Linuxä¸‹å¦‚ä½•åˆ‡æ¢ç”¨æˆ·" class="headerlink" title="Linuxä¸‹å¦‚ä½•åˆ‡æ¢ç”¨æˆ·"></a>Linuxä¸‹å¦‚ä½•åˆ‡æ¢ç”¨æˆ·</h2><p>1.åˆ‡æ¢ç”¨æˆ·çš„å‘½ä»¤ä¸ºï¼šsu username ã€usernameæ˜¯ä½ çš„ç”¨æˆ·åå“¦ã€‘</p><p>2.ä»æ™®é€šç”¨æˆ·åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼šsudo su</p><p>3.åœ¨ç»ˆç«¯è¾“å…¥exitæˆ–logoutæˆ–ä½¿ç”¨å¿«æ·æ–¹å¼ctrl+dï¼Œå¯ä»¥é€€å›åˆ°åŸæ¥ç”¨æˆ·ï¼Œå…¶å®ctrl+dä¹Ÿæ˜¯æ‰§è¡Œçš„exitå‘½ä»¤</p><p>4.åœ¨åˆ‡æ¢ç”¨æˆ·æ—¶ï¼Œå¦‚æœæƒ³åœ¨åˆ‡æ¢ç”¨æˆ·ä¹‹åä½¿ç”¨æ–°ç”¨æˆ·çš„å·¥ä½œç¯å¢ƒï¼Œå¯ä»¥åœ¨suå’Œusernameä¹‹é—´åŠ -ï¼Œä¾‹å¦‚ï¼šã€su - rootã€‘</p><p>$è¡¨ç¤ºæ™®é€šç”¨æˆ·</p><p>#è¡¨ç¤ºè¶…çº§ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯rootç”¨æˆ·</p><h2 id="åˆ é™¤å¸å·"><a href="#åˆ é™¤å¸å·" class="headerlink" title="åˆ é™¤å¸å·"></a>åˆ é™¤å¸å·</h2><p>å¦‚æœä¸€ä¸ªç”¨æˆ·çš„è´¦å·ä¸å†ä½¿ç”¨ï¼Œå¯ä»¥ä»ç³»ç»Ÿä¸­åˆ é™¤ã€‚</p><p>åˆ é™¤ç”¨æˆ·è´¦å·å°±æ˜¯è¦å°†/etc/passwdç­‰ç³»ç»Ÿæ–‡ä»¶ä¸­çš„è¯¥ç”¨æˆ·è®°å½•åˆ é™¤ï¼Œå¿…è¦æ—¶è¿˜åˆ é™¤ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚</p><p>åˆ é™¤ä¸€ä¸ªå·²æœ‰çš„ç”¨æˆ·è´¦å·ä½¿ç”¨userdelå‘½ä»¤ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">userdel é€‰é¡¹ ç”¨æˆ·å<br></code></pre></td></tr></table></figure><p>å¸¸ç”¨çš„é€‰é¡¹æ˜¯ <strong>-r</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠç”¨æˆ·çš„ä¸»ç›®å½•ä¸€èµ·åˆ é™¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen home]# userdel -r kuangshen<br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤åˆ é™¤ç”¨æˆ·kuangshenåœ¨ç³»ç»Ÿæ–‡ä»¶ä¸­ï¼ˆä¸»è¦æ˜¯/etc/passwd, /etc/shadow, /etc/groupç­‰ï¼‰çš„è®°å½•ï¼ŒåŒæ—¶åˆ é™¤ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚</p><h2 id="ä¿®æ”¹å¸å·"><a href="#ä¿®æ”¹å¸å·" class="headerlink" title="ä¿®æ”¹å¸å·"></a>ä¿®æ”¹å¸å·</h2><p>ä¿®æ”¹ç”¨æˆ·è´¦å·å°±æ˜¯æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹ç”¨æˆ·çš„æœ‰å…³å±æ€§ï¼Œå¦‚ç”¨æˆ·å·ã€ä¸»ç›®å½•ã€ç”¨æˆ·ç»„ã€ç™»å½•Shellç­‰ã€‚</p><p>ä¿®æ”¹å·²æœ‰ç”¨æˆ·çš„ä¿¡æ¯ä½¿ç”¨usermodå‘½ä»¤ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">usermod é€‰é¡¹ ç”¨æˆ·å<br></code></pre></td></tr></table></figure><p>å¸¸ç”¨çš„é€‰é¡¹åŒ…æ‹¬-c, -d, -m, -g, -G, -s, -uä»¥åŠ-oç­‰ï¼Œè¿™äº›é€‰é¡¹çš„æ„ä¹‰ä¸useraddå‘½ä»¤ä¸­çš„é€‰é¡¹ä¸€æ ·ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æŒ‡å®šæ–°çš„èµ„æºå€¼ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> usermod -s /bin/ksh -d /home/z â€“g developer kuangshen</span><br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å°†ç”¨æˆ·kuangshençš„ç™»å½•Shellä¿®æ”¹ä¸ºkshï¼Œä¸»ç›®å½•æ”¹ä¸º/home/zï¼Œç”¨æˆ·ç»„æ”¹ä¸ºdeveloperã€‚</p><h2 id="ç”¨æˆ·å£ä»¤çš„ç®¡ç†"><a href="#ç”¨æˆ·å£ä»¤çš„ç®¡ç†" class="headerlink" title="ç”¨æˆ·å£ä»¤çš„ç®¡ç†"></a>ç”¨æˆ·å£ä»¤çš„ç®¡ç†</h2><p>ç”¨æˆ·ç®¡ç†çš„ä¸€é¡¹é‡è¦å†…å®¹æ˜¯ç”¨æˆ·å£ä»¤çš„ç®¡ç†ã€‚ç”¨æˆ·è´¦å·åˆšåˆ›å»ºæ—¶æ²¡æœ‰å£ä»¤ï¼Œä½†æ˜¯è¢«ç³»ç»Ÿé”å®šï¼Œæ— æ³•ä½¿ç”¨ï¼Œå¿…é¡»ä¸ºå…¶æŒ‡å®šå£ä»¤åæ‰å¯ä»¥ä½¿ç”¨ï¼Œå³ä½¿æ˜¯æŒ‡å®šç©ºå£ä»¤ã€‚</p><p>æŒ‡å®šå’Œä¿®æ”¹ç”¨æˆ·å£ä»¤çš„Shellå‘½ä»¤æ˜¯passwdã€‚è¶…çº§ç”¨æˆ·å¯ä»¥ä¸ºè‡ªå·±å’Œå…¶ä»–ç”¨æˆ·æŒ‡å®šå£ä»¤ï¼Œæ™®é€šç”¨æˆ·åªèƒ½ç”¨å®ƒä¿®æ”¹è‡ªå·±çš„å£ä»¤ã€‚</p><p>å‘½ä»¤çš„æ ¼å¼ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">passwd é€‰é¡¹ ç”¨æˆ·å<br></code></pre></td></tr></table></figure><p>å¯ä½¿ç”¨çš„é€‰é¡¹ï¼š</p><ul><li>-l é”å®šå£ä»¤ï¼Œå³ç¦ç”¨è´¦å·ã€‚</li><li>-u å£ä»¤è§£é”ã€‚</li><li>-d ä½¿è´¦å·æ— å£ä»¤ã€‚</li><li>-f å¼ºè¿«ç”¨æˆ·ä¸‹æ¬¡ç™»å½•æ—¶ä¿®æ”¹å£ä»¤ã€‚</li></ul><p>å¦‚æœé»˜è®¤ç”¨æˆ·åï¼Œåˆ™ä¿®æ”¹å½“å‰ç”¨æˆ·çš„å£ä»¤ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾å½“å‰ç”¨æˆ·æ˜¯kuangshenï¼Œåˆ™ä¸‹é¢çš„å‘½ä»¤ä¿®æ”¹è¯¥ç”¨æˆ·è‡ªå·±çš„å£ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> passwd</span><br>Old password:******<br>New password:*******<br>Re-enter new password:*******<br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯è¶…çº§ç”¨æˆ·ï¼Œå¯ä»¥ç”¨ä¸‹åˆ—å½¢å¼æŒ‡å®šä»»ä½•ç”¨æˆ·çš„å£ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> passwd kuangshen</span><br>New password:*******<br>Re-enter new password:*******<br></code></pre></td></tr></table></figure><p>æ™®é€šç”¨æˆ·ä¿®æ”¹è‡ªå·±çš„å£ä»¤æ—¶ï¼Œpasswdå‘½ä»¤ä¼šå…ˆè¯¢é—®åŸå£ä»¤ï¼ŒéªŒè¯åå†è¦æ±‚ç”¨æˆ·è¾“å…¥ä¸¤éæ–°å£ä»¤ï¼Œå¦‚æœä¸¤æ¬¡è¾“å…¥çš„å£ä»¤ä¸€è‡´ï¼Œåˆ™å°†è¿™ä¸ªå£ä»¤æŒ‡å®šç»™ç”¨æˆ·ï¼›è€Œè¶…çº§ç”¨æˆ·ä¸ºç”¨æˆ·æŒ‡å®šå£ä»¤æ—¶ï¼Œå°±ä¸éœ€è¦çŸ¥é“åŸå£ä»¤ã€‚</p><p>ä¸ºäº†ç³»ç»Ÿå®‰å…¨èµ·è§ï¼Œç”¨æˆ·åº”è¯¥é€‰æ‹©æ¯”è¾ƒå¤æ‚çš„å£ä»¤ï¼Œä¾‹å¦‚æœ€å¥½ä½¿ç”¨8ä½é•¿çš„å£ä»¤ï¼Œå£ä»¤ä¸­åŒ…å«æœ‰å¤§å†™ã€å°å†™å­—æ¯å’Œæ•°å­—ï¼Œå¹¶ä¸”åº”è¯¥ä¸å§“åã€ç”Ÿæ—¥ç­‰ä¸ç›¸åŒã€‚</p><p>ä¸ºç”¨æˆ·æŒ‡å®šç©ºå£ä»¤æ—¶ï¼Œæ‰§è¡Œä¸‹åˆ—å½¢å¼çš„å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> passwd -d kuangshen</span><br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å°†ç”¨æˆ· kuangshençš„å£ä»¤åˆ é™¤ï¼Œè¿™æ ·ç”¨æˆ· kuangshenä¸‹ä¸€æ¬¡ç™»å½•æ—¶ï¼Œç³»ç»Ÿå°±ä¸å†å…è®¸è¯¥ç”¨æˆ·ç™»å½•äº†ã€‚</p><p>passwd å‘½ä»¤è¿˜å¯ä»¥ç”¨ -l(lock) é€‰é¡¹é”å®šæŸä¸€ç”¨æˆ·ï¼Œä½¿å…¶ä¸èƒ½ç™»å½•ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> passwd -l kuangshen</span><br></code></pre></td></tr></table></figure><h1 id="ç”¨æˆ·ç»„ç®¡ç†"><a href="#ç”¨æˆ·ç»„ç®¡ç†" class="headerlink" title="ç”¨æˆ·ç»„ç®¡ç†"></a>ç”¨æˆ·ç»„ç®¡ç†</h1><p>æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œç³»ç»Ÿå¯ä»¥å¯¹ä¸€ä¸ªç”¨æˆ·ç»„ä¸­çš„æ‰€æœ‰ç”¨æˆ·è¿›è¡Œé›†ä¸­ç®¡ç†ã€‚ä¸åŒLinux ç³»ç»Ÿå¯¹ç”¨æˆ·ç»„çš„è§„å®šæœ‰æ‰€ä¸åŒï¼Œå¦‚Linuxä¸‹çš„ç”¨æˆ·å±äºä¸å®ƒåŒåçš„ç”¨æˆ·ç»„ï¼Œè¿™ä¸ªç”¨æˆ·ç»„åœ¨åˆ›å»ºç”¨æˆ·æ—¶åŒæ—¶åˆ›å»ºã€‚</p><p>ç”¨æˆ·ç»„çš„ç®¡ç†æ¶‰åŠç”¨æˆ·ç»„çš„æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹ã€‚ç»„çš„å¢åŠ ã€åˆ é™¤å’Œä¿®æ”¹å®é™…ä¸Šå°±æ˜¯å¯¹/etc/groupæ–‡ä»¶çš„æ›´æ–°ã€‚</p><h2 id="å¢åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·ç»„ä½¿ç”¨groupaddå‘½ä»¤"><a href="#å¢åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·ç»„ä½¿ç”¨groupaddå‘½ä»¤" class="headerlink" title="å¢åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·ç»„ä½¿ç”¨groupaddå‘½ä»¤"></a>å¢åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·ç»„ä½¿ç”¨groupaddå‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">groupadd é€‰é¡¹ ç”¨æˆ·ç»„<br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨çš„é€‰é¡¹æœ‰ï¼š</p><ul><li>-g GID æŒ‡å®šæ–°ç”¨æˆ·ç»„çš„ç»„æ ‡è¯†å·ï¼ˆGIDï¼‰ã€‚</li><li>-o ä¸€èˆ¬ä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œè¡¨ç¤ºæ–°ç”¨æˆ·ç»„çš„GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚</li></ul><p>å®ä¾‹1ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> groupadd group1</span><br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å‘ç³»ç»Ÿä¸­å¢åŠ äº†ä¸€ä¸ªæ–°ç»„group1ï¼Œæ–°ç»„çš„ç»„æ ‡è¯†å·æ˜¯åœ¨å½“å‰å·²æœ‰çš„æœ€å¤§ç»„æ ‡è¯†å·çš„åŸºç¡€ä¸ŠåŠ 1ã€‚</p><p>å®ä¾‹2ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> groupadd -g 101 group2</span><br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å‘ç³»ç»Ÿä¸­å¢åŠ äº†ä¸€ä¸ªæ–°ç»„group2ï¼ŒåŒæ—¶æŒ‡å®šæ–°ç»„çš„ç»„æ ‡è¯†å·æ˜¯101ã€‚</p><h2 id="åˆ é™¤ä¸€ä¸ªå·²æœ‰çš„ç”¨æˆ·ç»„ï¼Œä½¿ç”¨groupdelå‘½ä»¤"><a href="#åˆ é™¤ä¸€ä¸ªå·²æœ‰çš„ç”¨æˆ·ç»„ï¼Œä½¿ç”¨groupdelå‘½ä»¤" class="headerlink" title="åˆ é™¤ä¸€ä¸ªå·²æœ‰çš„ç”¨æˆ·ç»„ï¼Œä½¿ç”¨groupdelå‘½ä»¤"></a>åˆ é™¤ä¸€ä¸ªå·²æœ‰çš„ç”¨æˆ·ç»„ï¼Œä½¿ç”¨groupdelå‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">groupdel ç”¨æˆ·ç»„<br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> groupdel group1</span><br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤ä»ç³»ç»Ÿä¸­åˆ é™¤ç»„group1ã€‚</p><h2 id="ä¿®æ”¹ç”¨æˆ·ç»„çš„å±æ€§ä½¿ç”¨groupmodå‘½ä»¤"><a href="#ä¿®æ”¹ç”¨æˆ·ç»„çš„å±æ€§ä½¿ç”¨groupmodå‘½ä»¤" class="headerlink" title="ä¿®æ”¹ç”¨æˆ·ç»„çš„å±æ€§ä½¿ç”¨groupmodå‘½ä»¤"></a>ä¿®æ”¹ç”¨æˆ·ç»„çš„å±æ€§ä½¿ç”¨groupmodå‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">groupmod é€‰é¡¹ ç”¨æˆ·ç»„<br></code></pre></td></tr></table></figure><p>å¸¸ç”¨çš„é€‰é¡¹æœ‰ï¼š</p><ul><li>-g GID ä¸ºç”¨æˆ·ç»„æŒ‡å®šæ–°çš„ç»„æ ‡è¯†å·ã€‚</li><li>-o ä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œç”¨æˆ·ç»„çš„æ–°GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚</li><li>-næ–°ç”¨æˆ·ç»„ å°†ç”¨æˆ·ç»„çš„åå­—æ”¹ä¸ºæ–°åå­—</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ­¤å‘½ä»¤å°†ç»„group2çš„ç»„æ ‡è¯†å·ä¿®æ”¹ä¸º102ã€‚</span><br>groupmod -g 102 group2<br><br><span class="hljs-meta">#</span><span class="bash"> å°†ç»„group2çš„æ ‡è¯†å·æ”¹ä¸º10000ï¼Œç»„åä¿®æ”¹ä¸ºgroup3ã€‚</span><br>groupmod â€“g 10000 -n group3 group2<br></code></pre></td></tr></table></figure><h2 id="åˆ‡æ¢ç»„"><a href="#åˆ‡æ¢ç»„" class="headerlink" title="åˆ‡æ¢ç»„"></a>åˆ‡æ¢ç»„</h2><p>å¦‚æœä¸€ä¸ªç”¨æˆ·åŒæ—¶å±äºå¤šä¸ªç”¨æˆ·ç»„ï¼Œé‚£ä¹ˆç”¨æˆ·å¯ä»¥åœ¨ç”¨æˆ·ç»„ä¹‹é—´åˆ‡æ¢ï¼Œä»¥ä¾¿å…·æœ‰å…¶ä»–ç”¨æˆ·ç»„çš„æƒé™ã€‚</p><p>ç”¨æˆ·å¯ä»¥åœ¨ç™»å½•åï¼Œä½¿ç”¨å‘½ä»¤newgrpåˆ‡æ¢åˆ°å…¶ä»–ç”¨æˆ·ç»„ï¼Œè¿™ä¸ªå‘½ä»¤çš„å‚æ•°å°±æ˜¯ç›®çš„ç”¨æˆ·ç»„ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> newgrp root</span><br></code></pre></td></tr></table></figure><p>è¿™æ¡å‘½ä»¤å°†å½“å‰ç”¨æˆ·åˆ‡æ¢åˆ°rootç”¨æˆ·ç»„ï¼Œå‰ææ¡ä»¶æ˜¯rootç”¨æˆ·ç»„ç¡®å®æ˜¯è¯¥ç”¨æˆ·çš„ä¸»ç»„æˆ–é™„åŠ ç»„ã€‚</p><h2 id="etc-passwd"><a href="#etc-passwd" class="headerlink" title="/etc/passwd"></a>/etc/passwd</h2><p>å®Œæˆç”¨æˆ·ç®¡ç†çš„å·¥ä½œæœ‰è®¸å¤šç§æ–¹æ³•ï¼Œä½†æ˜¯æ¯ä¸€ç§æ–¹æ³•å®é™…ä¸Šéƒ½æ˜¯å¯¹æœ‰å…³çš„ç³»ç»Ÿæ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚</p><p>ä¸ç”¨æˆ·å’Œç”¨æˆ·ç»„ç›¸å…³çš„ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ä¸€äº›ç³»ç»Ÿæ–‡ä»¶ä¸­ï¼Œè¿™äº›æ–‡ä»¶åŒ…æ‹¬/etc/passwd, /etc/shadow, /etc/groupç­‰ã€‚</p><p>ä¸‹é¢åˆ†åˆ«ä»‹ç»è¿™äº›æ–‡ä»¶çš„å†…å®¹ã€‚</p><p><strong>/etc/passwdæ–‡ä»¶æ˜¯ç”¨æˆ·ç®¡ç†å·¥ä½œæ¶‰åŠçš„æœ€é‡è¦çš„ä¸€ä¸ªæ–‡ä»¶ã€‚</strong></p><p>Linuxç³»ç»Ÿä¸­çš„æ¯ä¸ªç”¨æˆ·éƒ½åœ¨/etc/passwdæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªå¯¹åº”çš„è®°å½•è¡Œï¼Œå®ƒè®°å½•äº†è¿™ä¸ªç”¨æˆ·çš„ä¸€äº›åŸºæœ¬å±æ€§ã€‚</p><p>è¿™ä¸ªæ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯å¯è¯»çš„ã€‚å®ƒçš„å†…å®¹ç±»ä¼¼ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">ï¼ƒ cat /etc/passwd<br><br>root:x:0:0:Superuser:/:<br>daemon:x:1:1:System daemons:/etc:<br>bin:x:2:2:Owner of system commands:/bin:<br>sys:x:3:3:Owner of system files:/usr/sys:<br>adm:x:4:4:System accounting:/usr/adm:<br>uucp:x:5:5:UUCP administrator:/usr/lib/uucp:<br>auth:x:7:21:Authentication administrator:/tcb/files/auth:<br>cron:x:9:16:Cron daemon:/usr/spool/cron:<br>listen:x:37:4:Network daemon:/usr/net/nls:<br>lp:x:71:18:Printer administrator:/usr/spool/lp:<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ/etc/passwdä¸­ä¸€è¡Œè®°å½•å¯¹åº”ç€ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯è¡Œè®°å½•åˆè¢«å†’å·(:)åˆ†éš”ä¸º7ä¸ªå­—æ®µï¼Œå…¶æ ¼å¼å’Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shell<br></code></pre></td></tr></table></figure><ul><li>â€œç”¨æˆ·åâ€æ˜¯ä»£è¡¨ç”¨æˆ·è´¦å·çš„å­—ç¬¦ä¸²ã€‚<ul><li>é€šå¸¸é•¿åº¦ä¸è¶…è¿‡8ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ç”±å¤§å°å†™å­—æ¯å’Œ/æˆ–æ•°å­—ç»„æˆã€‚ç™»å½•åä¸­ä¸èƒ½æœ‰å†’å·(:)ï¼Œå› ä¸ºå†’å·åœ¨è¿™é‡Œæ˜¯åˆ†éš”ç¬¦ã€‚</li></ul></li></ul><p>ä¸ºäº†å…¼å®¹èµ·è§ï¼Œç™»å½•åä¸­æœ€å¥½ä¸è¦åŒ…å«ç‚¹å­—ç¬¦(.)ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨è¿å­—ç¬¦(-)å’ŒåŠ å·(+)æ‰“å¤´ã€‚</p><ul><li><p>â€œå£ä»¤â€ä¸€äº›ç³»ç»Ÿä¸­ï¼Œå­˜æ”¾ç€åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—ã€‚</p><ul><li>è™½ç„¶è¿™ä¸ªå­—æ®µå­˜æ”¾çš„åªæ˜¯ç”¨æˆ·å£ä»¤çš„åŠ å¯†ä¸²ï¼Œä¸æ˜¯æ˜æ–‡ï¼Œä½†æ˜¯ç”±äº/etc/passwdæ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»ï¼Œæ‰€ä»¥è¿™ä»æ˜¯ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚å› æ­¤ï¼Œç°åœ¨è®¸å¤šLinux ç³»ç»Ÿï¼ˆå¦‚SVR4ï¼‰éƒ½ä½¿ç”¨äº†shadowæŠ€æœ¯ï¼ŒæŠŠçœŸæ­£çš„åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—å­˜æ”¾åˆ°/etc/shadowæ–‡ä»¶ä¸­ï¼Œè€Œåœ¨/etc/passwdæ–‡ä»¶çš„å£ä»¤å­—æ®µä¸­åªå­˜æ”¾ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œä¾‹å¦‚â€œxâ€æˆ–è€…â€œ*â€ã€‚</li></ul></li><li><p>â€œç”¨æˆ·æ ‡è¯†å·â€æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç³»ç»Ÿå†…éƒ¨ç”¨å®ƒæ¥æ ‡è¯†ç”¨æˆ·ã€‚</p><ul><li><p>ä¸€èˆ¬æƒ…å†µä¸‹å®ƒä¸ç”¨æˆ·åæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚å¦‚æœå‡ ä¸ªç”¨æˆ·åå¯¹åº”çš„ç”¨æˆ·æ ‡è¯†å·æ˜¯ä¸€æ ·çš„ï¼Œç³»ç»Ÿå†…éƒ¨å°†æŠŠå®ƒä»¬è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å£ä»¤ã€ä¸åŒçš„ä¸»ç›®å½•ä»¥åŠä¸åŒçš„ç™»å½•Shellç­‰ã€‚</p></li><li><p>é€šå¸¸ç”¨æˆ·æ ‡è¯†å·çš„å–å€¼èŒƒå›´æ˜¯0ï½65 535ã€‚0æ˜¯è¶…çº§ç”¨æˆ·rootçš„æ ‡è¯†å·ï¼Œ1ï½99ç”±ç³»ç»Ÿä¿ç•™ï¼Œä½œä¸ºç®¡ç†è´¦å·ï¼Œæ™®é€šç”¨æˆ·çš„æ ‡è¯†å·ä»100å¼€å§‹ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªç•Œé™æ˜¯500ã€‚</p></li></ul></li><li><p>â€œç»„æ ‡è¯†å·â€å­—æ®µè®°å½•çš„æ˜¯ç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚</p><ul><li>å®ƒå¯¹åº”ç€/etc/groupæ–‡ä»¶ä¸­çš„ä¸€æ¡è®°å½•ã€‚</li></ul></li><li><p>â€œæ³¨é‡Šæ€§æè¿°â€å­—æ®µè®°å½•ç€ç”¨æˆ·çš„ä¸€äº›ä¸ªäººæƒ…å†µã€‚</p><ul><li>ä¾‹å¦‚ç”¨æˆ·çš„çœŸå®å§“åã€ç”µè¯ã€åœ°å€ç­‰ï¼Œè¿™ä¸ªå­—æ®µå¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ç”¨é€”ã€‚åœ¨ä¸åŒçš„Linux ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µçš„æ ¼å¼å¹¶æ²¡æœ‰ç»Ÿä¸€ã€‚åœ¨è®¸å¤šLinuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µå­˜æ”¾çš„æ˜¯ä¸€æ®µä»»æ„çš„æ³¨é‡Šæ€§æè¿°æ–‡å­—ï¼Œç”¨ä½œfingerå‘½ä»¤çš„è¾“å‡ºã€‚</li></ul></li><li><p>â€œä¸»ç›®å½•â€ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·çš„èµ·å§‹å·¥ä½œç›®å½•ã€‚</p><ul><li>å®ƒæ˜¯ç”¨æˆ·åœ¨ç™»å½•åˆ°ç³»ç»Ÿä¹‹åæ‰€å¤„çš„ç›®å½•ã€‚åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå„ç”¨æˆ·çš„ä¸»ç›®å½•éƒ½è¢«ç»„ç»‡åœ¨åŒä¸€ä¸ªç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œè€Œç”¨æˆ·ä¸»ç›®å½•çš„åç§°å°±æ˜¯è¯¥ç”¨æˆ·çš„ç™»å½•åã€‚å„ç”¨æˆ·å¯¹è‡ªå·±çš„ä¸»ç›®å½•æœ‰è¯»ã€å†™ã€æ‰§è¡Œï¼ˆæœç´¢ï¼‰æƒé™ï¼Œå…¶ä»–ç”¨æˆ·å¯¹æ­¤ç›®å½•çš„è®¿é—®æƒé™åˆ™æ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®ã€‚</li></ul></li><li><p>ç”¨æˆ·ç™»å½•åï¼Œè¦å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œè´Ÿè´£å°†ç”¨æˆ·çš„æ“ä½œä¼ ç»™å†…æ ¸ï¼Œè¿™ä¸ªè¿›ç¨‹æ˜¯ç”¨æˆ·ç™»å½•åˆ°ç³»ç»Ÿåè¿è¡Œçš„å‘½ä»¤è§£é‡Šå™¨æˆ–æŸä¸ªç‰¹å®šçš„ç¨‹åºï¼Œå³Shellã€‚</p><ul><li><p>Shellæ˜¯ç”¨æˆ·ä¸Linuxç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚Linuxçš„Shellæœ‰è®¸å¤šç§ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹ã€‚å¸¸ç”¨çš„æœ‰sh(Bourne Shell), csh(C Shell), ksh(Korn Shell), tcsh(TENEX/TOPS-20 type C Shell), bash(Bourne Again Shell)ç­‰ã€‚</p></li><li><p>ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æ ¹æ®ç³»ç»Ÿæƒ…å†µå’Œç”¨æˆ·ä¹ æƒ¯ä¸ºç”¨æˆ·æŒ‡å®šæŸä¸ªShellã€‚å¦‚æœä¸æŒ‡å®šShellï¼Œé‚£ä¹ˆç³»ç»Ÿä½¿ç”¨shä¸ºé»˜è®¤çš„ç™»å½•Shellï¼Œå³è¿™ä¸ªå­—æ®µçš„å€¼ä¸º/bin/shã€‚</p></li><li><p>ç”¨æˆ·çš„ç™»å½•Shellä¹Ÿå¯ä»¥æŒ‡å®šä¸ºæŸä¸ªç‰¹å®šçš„ç¨‹åºï¼ˆæ­¤ç¨‹åºä¸æ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ï¼‰ã€‚</p></li><li><p>åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é™åˆ¶ç”¨æˆ·åªèƒ½è¿è¡ŒæŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼Œåœ¨è¯¥åº”ç”¨ç¨‹åºè¿è¡Œç»“æŸåï¼Œç”¨æˆ·å°±è‡ªåŠ¨é€€å‡ºäº†ç³»ç»Ÿã€‚æœ‰äº›Linux ç³»ç»Ÿè¦æ±‚åªæœ‰é‚£äº›åœ¨ç³»ç»Ÿä¸­ç™»è®°äº†çš„ç¨‹åºæ‰èƒ½å‡ºç°åœ¨è¿™ä¸ªå­—æ®µä¸­ã€‚</p></li></ul></li><li><p>ç³»ç»Ÿä¸­æœ‰ä¸€ç±»ç”¨æˆ·ç§°ä¸ºä¼ªç”¨æˆ·ï¼ˆpseudo usersï¼‰ã€‚</p><ul><li><p>è¿™äº›ç”¨æˆ·åœ¨/etc/passwdæ–‡ä»¶ä¸­ä¹Ÿå æœ‰ä¸€æ¡è®°å½•ï¼Œä½†æ˜¯ä¸èƒ½ç™»å½•ï¼Œå› ä¸ºå®ƒä»¬çš„ç™»å½•Shellä¸ºç©ºã€‚å®ƒä»¬çš„å­˜åœ¨ä¸»è¦æ˜¯æ–¹ä¾¿ç³»ç»Ÿç®¡ç†ï¼Œæ»¡è¶³ç›¸åº”çš„ç³»ç»Ÿè¿›ç¨‹å¯¹æ–‡ä»¶å±ä¸»çš„è¦æ±‚ã€‚</p></li><li><p>å¸¸è§çš„ä¼ªç”¨æˆ·å¦‚ä¸‹æ‰€ç¤ºï¼š</p></li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ä¼ª ç”¨ æˆ· å« ä¹‰</span><br>bin # æ‹¥æœ‰å¯æ‰§è¡Œçš„ç”¨æˆ·å‘½ä»¤æ–‡ä»¶<br>sys # æ‹¥æœ‰ç³»ç»Ÿæ–‡ä»¶<br>adm # æ‹¥æœ‰å¸æˆ·æ–‡ä»¶<br>uucp # UUCPä½¿ç”¨<br>lp # lpæˆ–lpdå­ç³»ç»Ÿä½¿ç”¨<br>nobody # NFSä½¿ç”¨<br></code></pre></td></tr></table></figure><h2 id="etc-shadow"><a href="#etc-shadow" class="headerlink" title="/etc/shadow"></a>/etc/shadow</h2><p><strong>1ã€é™¤äº†ä¸Šé¢åˆ—å‡ºçš„ä¼ªç”¨æˆ·å¤–ï¼Œè¿˜æœ‰è®¸å¤šæ ‡å‡†çš„ä¼ªç”¨æˆ·ï¼Œä¾‹å¦‚ï¼šaudit, cron, mail, usenetç­‰ï¼Œå®ƒä»¬ä¹Ÿéƒ½å„è‡ªä¸ºç›¸å…³çš„è¿›ç¨‹å’Œæ–‡ä»¶æ‰€éœ€è¦ã€‚</strong></p><p>ç”±äº/etc/passwdæ–‡ä»¶æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»çš„ï¼Œå¦‚æœç”¨æˆ·çš„å¯†ç å¤ªç®€å•æˆ–è§„å¾‹æ¯”è¾ƒæ˜æ˜¾çš„è¯ï¼Œä¸€å°æ™®é€šçš„è®¡ç®—æœºå°±èƒ½å¤Ÿå¾ˆå®¹æ˜“åœ°å°†å®ƒç ´è§£ï¼Œå› æ­¤å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„Linuxç³»ç»Ÿéƒ½æŠŠåŠ å¯†åçš„å£ä»¤å­—åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯/etc/shadowæ–‡ä»¶ã€‚æœ‰è¶…çº§ç”¨æˆ·æ‰æ‹¥æœ‰è¯¥æ–‡ä»¶è¯»æƒé™ï¼Œè¿™å°±ä¿è¯äº†ç”¨æˆ·å¯†ç çš„å®‰å…¨æ€§ã€‚</p><p><strong>2ã€/etc/shadowä¸­çš„è®°å½•è¡Œä¸/etc/passwdä¸­çš„ä¸€ä¸€å¯¹åº”ï¼Œå®ƒç”±pwconvå‘½ä»¤æ ¹æ®/etc/passwdä¸­çš„æ•°æ®è‡ªåŠ¨äº§ç”Ÿ</strong></p><p>å®ƒçš„æ–‡ä»¶æ ¼å¼ä¸/etc/passwdç±»ä¼¼ï¼Œç”±è‹¥å¹²ä¸ªå­—æ®µç»„æˆï¼Œå­—æ®µä¹‹é—´ç”¨â€:â€éš”å¼€ã€‚è¿™äº›å­—æ®µæ˜¯ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">ç™»å½•å:åŠ å¯†å£ä»¤:æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´:æœ€å°æ—¶é—´é—´éš”:æœ€å¤§æ—¶é—´é—´éš”:è­¦å‘Šæ—¶é—´:ä¸æ´»åŠ¨æ—¶é—´:å¤±æ•ˆæ—¶é—´:æ ‡å¿—</span><br></code></pre></td></tr></table></figure><ol><li>â€œç™»å½•åâ€æ˜¯ä¸/etc/passwdæ–‡ä»¶ä¸­çš„ç™»å½•åç›¸ä¸€è‡´çš„ç”¨æˆ·è´¦å·</li><li>â€œå£ä»¤â€å­—æ®µå­˜æ”¾çš„æ˜¯åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—ï¼Œé•¿åº¦ä¸º13ä¸ªå­—ç¬¦ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™å¯¹åº”ç”¨æˆ·æ²¡æœ‰å£ä»¤ï¼Œç™»å½•æ—¶ä¸éœ€è¦å£ä»¤ï¼›å¦‚æœå«æœ‰ä¸å±äºé›†åˆ { ./0-9A-Za-z }ä¸­çš„å­—ç¬¦ï¼Œåˆ™å¯¹åº”çš„ç”¨æˆ·ä¸èƒ½ç™»å½•ã€‚</li><li>â€œæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´â€è¡¨ç¤ºçš„æ˜¯ä»æŸä¸ªæ—¶åˆ»èµ·ï¼Œåˆ°ç”¨æˆ·æœ€åä¸€æ¬¡ä¿®æ”¹å£ä»¤æ—¶çš„å¤©æ•°ã€‚æ—¶é—´èµ·ç‚¹å¯¹ä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¸ä¸€æ ·ã€‚ä¾‹å¦‚åœ¨SCO Linux ä¸­ï¼Œè¿™ä¸ªæ—¶é—´èµ·ç‚¹æ˜¯1970å¹´1æœˆ1æ—¥ã€‚</li><li>â€œæœ€å°æ—¶é—´é—´éš”â€æŒ‡çš„æ˜¯ä¸¤æ¬¡ä¿®æ”¹å£ä»¤ä¹‹é—´æ‰€éœ€çš„æœ€å°å¤©æ•°ã€‚</li><li>â€œæœ€å¤§æ—¶é—´é—´éš”â€æŒ‡çš„æ˜¯å£ä»¤ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</li><li>â€œè­¦å‘Šæ—¶é—´â€å­—æ®µè¡¨ç¤ºçš„æ˜¯ä»ç³»ç»Ÿå¼€å§‹è­¦å‘Šç”¨æˆ·åˆ°ç”¨æˆ·å¯†ç æ­£å¼å¤±æ•ˆä¹‹é—´çš„å¤©æ•°ã€‚</li><li>â€œä¸æ´»åŠ¨æ—¶é—´â€è¡¨ç¤ºçš„æ˜¯ç”¨æˆ·æ²¡æœ‰ç™»å½•æ´»åŠ¨ä½†è´¦å·ä»èƒ½ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</li><li>â€œå¤±æ•ˆæ—¶é—´â€å­—æ®µç»™å‡ºçš„æ˜¯ä¸€ä¸ªç»å¯¹çš„å¤©æ•°ï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸ªå­—æ®µï¼Œé‚£ä¹ˆå°±ç»™å‡ºç›¸åº”è´¦å·çš„ç”Ÿå­˜æœŸã€‚æœŸæ»¡åï¼Œè¯¥è´¦å·å°±ä¸å†æ˜¯ä¸€ä¸ªåˆæ³•çš„è´¦å·ï¼Œä¹Ÿå°±ä¸èƒ½å†ç”¨æ¥ç™»å½•äº†ã€‚</li></ol><h2 id="etc-group"><a href="#etc-group" class="headerlink" title="/etc/group"></a>/etc/group</h2><p>ç”¨æˆ·ç»„çš„æ‰€æœ‰ä¿¡æ¯éƒ½å­˜æ”¾åœ¨/etc/groupæ–‡ä»¶ä¸­ã€‚</p><p>å°†ç”¨æˆ·åˆ†ç»„æ˜¯Linux ç³»ç»Ÿä¸­å¯¹ç”¨æˆ·è¿›è¡Œç®¡ç†åŠæ§åˆ¶è®¿é—®æƒé™çš„ä¸€ç§æ‰‹æ®µã€‚</p><p>æ¯ä¸ªç”¨æˆ·éƒ½å±äºæŸä¸ªç”¨æˆ·ç»„ï¼›ä¸€ä¸ªç»„ä¸­å¯ä»¥æœ‰å¤šä¸ªç”¨æˆ·ï¼Œä¸€ä¸ªç”¨æˆ·ä¹Ÿå¯ä»¥å±äºä¸åŒçš„ç»„ã€‚</p><p>å½“ä¸€ä¸ªç”¨æˆ·åŒæ—¶æ˜¯å¤šä¸ªç»„ä¸­çš„æˆå‘˜æ—¶ï¼Œåœ¨/etc/passwdæ–‡ä»¶ä¸­è®°å½•çš„æ˜¯ç”¨æˆ·æ‰€å±çš„ä¸»ç»„ï¼Œä¹Ÿå°±æ˜¯ç™»å½•æ—¶æ‰€å±çš„é»˜è®¤ç»„ï¼Œè€Œå…¶ä»–ç»„ç§°ä¸ºé™„åŠ ç»„ã€‚</p><p>ç”¨æˆ·è¦è®¿é—®å±äºé™„åŠ ç»„çš„æ–‡ä»¶æ—¶ï¼Œå¿…é¡»é¦–å…ˆä½¿ç”¨newgrpå‘½ä»¤ä½¿è‡ªå·±æˆä¸ºæ‰€è¦è®¿é—®çš„ç»„ä¸­çš„æˆå‘˜ã€‚</p><p>ç”¨æˆ·ç»„çš„æ‰€æœ‰ä¿¡æ¯éƒ½å­˜æ”¾åœ¨/etc/groupæ–‡ä»¶ä¸­ã€‚æ­¤æ–‡ä»¶çš„æ ¼å¼ä¹Ÿç±»ä¼¼äº/etc/passwdæ–‡ä»¶ï¼Œç”±å†’å·(:)éš”å¼€è‹¥å¹²ä¸ªå­—æ®µï¼Œè¿™äº›å­—æ®µæœ‰ï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">ç»„å:å£ä»¤:ç»„æ ‡è¯†å·:ç»„å†…ç”¨æˆ·åˆ—è¡¨</span><br></code></pre></td></tr></table></figure><ol><li><p>â€œç»„åâ€æ˜¯ç”¨æˆ·ç»„çš„åç§°ï¼Œç”±å­—æ¯æˆ–æ•°å­—æ„æˆã€‚ä¸/etc/passwdä¸­çš„ç™»å½•åä¸€æ ·ï¼Œç»„åä¸åº”é‡å¤ã€‚</p></li><li><p>â€œå£ä»¤â€å­—æ®µå­˜æ”¾çš„æ˜¯ç”¨æˆ·ç»„åŠ å¯†åçš„å£ä»¤å­—ã€‚ä¸€èˆ¬Linux ç³»ç»Ÿçš„ç”¨æˆ·ç»„éƒ½æ²¡æœ‰å£ä»¤ï¼Œå³è¿™ä¸ªå­—æ®µä¸€èˆ¬ä¸ºç©ºï¼Œæˆ–è€…æ˜¯*ã€‚</p></li><li><p>â€œç»„æ ‡è¯†å·â€ä¸ç”¨æˆ·æ ‡è¯†å·ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¢«ç³»ç»Ÿå†…éƒ¨ç”¨æ¥æ ‡è¯†ç»„ã€‚</p></li><li><p>â€œç»„å†…ç”¨æˆ·åˆ—è¡¨â€æ˜¯å±äºè¿™ä¸ªç»„çš„æ‰€æœ‰ç”¨æˆ·çš„åˆ—è¡¨/b]ï¼Œä¸åŒç”¨æˆ·ä¹‹é—´ç”¨é€—å·(,)åˆ†éš”ã€‚è¿™ä¸ªç”¨æˆ·ç»„å¯èƒ½æ˜¯ç”¨æˆ·çš„ä¸»ç»„ï¼Œä¹Ÿå¯èƒ½æ˜¯é™„åŠ ç»„ã€‚</p></li></ol><h1 id="ç£ç›˜ç®¡ç†"><a href="#ç£ç›˜ç®¡ç†" class="headerlink" title="ç£ç›˜ç®¡ç†"></a>ç£ç›˜ç®¡ç†</h1><p>Linuxç£ç›˜ç®¡ç†å¥½åç›´æ¥å…³ç³»åˆ°æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚</p><p>Linuxç£ç›˜ç®¡ç†å¸¸ç”¨å‘½ä»¤ä¸º dfã€duã€‚</p><ul><li>df ï¼šåˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ç£ç›˜ä½¿ç”¨é‡</li><li>duï¼šæ£€æŸ¥ç£ç›˜ç©ºé—´ä½¿ç”¨é‡</li></ul><h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><p>dfå‘½ä»¤å‚æ•°åŠŸèƒ½ï¼šæ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´å ç”¨æƒ…å†µã€‚å¯ä»¥åˆ©ç”¨è¯¥å‘½ä»¤æ¥è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ã€‚</p><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">df [-ahikHTm] [ç›®å½•æˆ–æ–‡ä»¶å]<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-a ï¼šåˆ—å‡ºæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç³»ç»Ÿç‰¹æœ‰çš„ /proc ç­‰æ–‡ä»¶ç³»ç»Ÿï¼›</li><li>-k ï¼šä»¥ KBytes çš„å®¹é‡æ˜¾ç¤ºå„æ–‡ä»¶ç³»ç»Ÿï¼›</li><li>-m ï¼šä»¥ MBytes çš„å®¹é‡æ˜¾ç¤ºå„æ–‡ä»¶ç³»ç»Ÿï¼›</li><li>-h ï¼šä»¥äººä»¬è¾ƒæ˜“é˜…è¯»çš„ GBytes, MBytes, KBytes ç­‰æ ¼å¼è‡ªè¡Œæ˜¾ç¤ºï¼›</li><li>-H ï¼šä»¥ M=1000K å–ä»£ M=1024K çš„è¿›ä½æ–¹å¼ï¼›</li><li>-T ï¼šæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç±»å‹, è¿åŒè¯¥ partition çš„ filesystem åç§° (ä¾‹å¦‚ ext3) ä¹Ÿåˆ—å‡ºï¼›</li><li>-i ï¼šä¸ç”¨ç¡¬ç›˜å®¹é‡ï¼Œè€Œä»¥ inode çš„æ•°é‡æ¥æ˜¾ç¤º</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°†ç³»ç»Ÿå†…æ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿåˆ—å‡ºæ¥ï¼</span><br><span class="hljs-meta">#</span><span class="bash"> åœ¨ Linux åº•ä¸‹å¦‚æœ df æ²¡æœ‰åŠ ä»»ä½•é€‰é¡¹</span><br><span class="hljs-meta">#</span><span class="bash"> é‚£ä¹ˆé»˜è®¤ä¼šå°†ç³»ç»Ÿå†…æ‰€æœ‰çš„ (ä¸å«ç‰¹æ®Šå†…å­˜å†…çš„æ–‡ä»¶ç³»ç»Ÿä¸ swap) éƒ½ä»¥ 1 Kbytes çš„å®¹é‡æ¥åˆ—å‡ºæ¥ï¼</span><br>[root@kuangshen /]# df<br>Filesystem     1K-blocks   Used Available Use% Mounted on<br>devtmpfs          889100       0    889100   0% /dev<br>tmpfs             899460     704    898756   1% /dev/shm<br>tmpfs             899460     496    898964   1% /run<br>tmpfs             899460       0    899460   0% /sys/fs/cgroup<br>/dev/vda1       41152812 6586736  32662368  17% /<br>tmpfs             179896       0    179896   0% /run/user/0<br><span class="hljs-meta">#</span><span class="bash"> å°†å®¹é‡ç»“æœä»¥æ˜“è¯»çš„å®¹é‡æ ¼å¼æ˜¾ç¤ºå‡ºæ¥</span><br>[root@kuangshen /]# df -h<br>Filesystem     Size Used Avail Use% Mounted on<br>devtmpfs       869M     0 869M   0% /dev<br>tmpfs           879M 708K 878M   1% /dev/shm<br>tmpfs           879M 496K 878M   1% /run<br>tmpfs           879M     0 879M   0% /sys/fs/cgroup<br>/dev/vda1       40G  6.3G   32G  17% /<br>tmpfs           176M     0 176M   0% /run/user/0<br><span class="hljs-meta">#</span><span class="bash"> å°†ç³»ç»Ÿå†…çš„æ‰€æœ‰ç‰¹æ®Šæ–‡ä»¶æ ¼å¼åŠåç§°éƒ½åˆ—å‡ºæ¥</span><br>[root@kuangshen /]# df -aT<br>Filesystem     Type       1K-blocks   Used Available Use% Mounted on<br>sysfs         sysfs               0       0         0    - /sys<br>proc           proc                0       0         0    - /proc<br>devtmpfs       devtmpfs       889100       0    889100   0% /dev<br>securityfs     securityfs          0       0         0    - /sys/kernel/security<br>tmpfs         tmpfs          899460     708    898752   1% /dev/shm<br>devpts         devpts              0       0         0    - /dev/pts<br>tmpfs         tmpfs          899460     496    898964   1% /run<br>tmpfs         tmpfs          899460       0    899460   0% /sys/fs/cgroup<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/systemd<br>pstore         pstore              0       0         0    - /sys/fs/pstore<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/freezer<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/cpuset<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/hugetlb<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/blkio<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/net_cls,net_prio<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/memory<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/pids<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/cpu,cpuacct<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/devices<br>cgroup         cgroup              0       0         0    - /sys/fs/cgroup/perf_event<br>configfs       configfs            0       0         0    - /sys/kernel/config<br>/dev/vda1     ext4         41152812 6586748  32662356  17% /<br>systemd-1      -                   -       -         -    - /proc/sys/fs/binfmt_misc<br>mqueue         mqueue              0       0         0    - /dev/mqueue<br>debugfs       debugfs             0       0         0    - /sys/kernel/debug<br>hugetlbfs     hugetlbfs           0       0         0    - /dev/hugepages<br>tmpfs         tmpfs          179896       0    179896   0% /run/user/0<br>binfmt_misc   binfmt_misc         0       0         0    - /proc/sys/fs/binfmt_misc<br><span class="hljs-meta">#</span><span class="bash"> å°† /etc åº•ä¸‹çš„å¯ç”¨çš„ç£ç›˜å®¹é‡ä»¥æ˜“è¯»çš„å®¹é‡æ ¼å¼æ˜¾ç¤º</span><br><br>[root@kuangshen /]# df -h /etc<br>Filesystem     Size Used Avail Use% Mounted on<br>/dev/vda1       40G  6.3G   32G  17% /<br></code></pre></td></tr></table></figure><h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><p>Linux duå‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸dfå‘½ä»¤ä¸åŒçš„æ˜¯Linux duå‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼Œè¿˜æ˜¯å’Œdfå‘½ä»¤æœ‰ä¸€äº›åŒºåˆ«çš„ï¼Œè¿™é‡Œä»‹ç»Linux duå‘½ä»¤ã€‚</p><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">du [-ahskm] æ–‡ä»¶æˆ–ç›®å½•åç§°<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-a ï¼šåˆ—å‡ºæ‰€æœ‰çš„æ–‡ä»¶ä¸ç›®å½•å®¹é‡ï¼Œå› ä¸ºé»˜è®¤ä»…ç»Ÿè®¡ç›®å½•åº•ä¸‹çš„æ–‡ä»¶é‡è€Œå·²ã€‚</li><li>-h ï¼šä»¥äººä»¬è¾ƒæ˜“è¯»çš„å®¹é‡æ ¼å¼ (G/M) æ˜¾ç¤ºï¼›</li><li>-s ï¼šåˆ—å‡ºæ€»é‡è€Œå·²ï¼Œè€Œä¸åˆ—å‡ºæ¯ä¸ªå„åˆ«çš„ç›®å½•å ç”¨å®¹é‡ï¼›</li><li>-S ï¼šä¸åŒ…æ‹¬å­ç›®å½•ä¸‹çš„æ€»è®¡ï¼Œä¸ -s æœ‰ç‚¹å·®åˆ«ã€‚</li><li>-k ï¼šä»¥ KBytes åˆ—å‡ºå®¹é‡æ˜¾ç¤ºï¼›</li><li>-m ï¼šä»¥ MBytes åˆ—å‡ºå®¹é‡æ˜¾ç¤ºï¼›</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åªåˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤¹å®¹é‡ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶å¤¹ï¼‰:</span><br><span class="hljs-meta">#</span><span class="bash"> ç›´æ¥è¾“å…¥ du æ²¡æœ‰åŠ ä»»ä½•é€‰é¡¹æ—¶ï¼Œåˆ™ du ä¼šåˆ†æå½“å‰æ‰€åœ¨ç›®å½•çš„æ–‡ä»¶ä¸ç›®å½•æ‰€å ç”¨çš„ç¡¬ç›˜ç©ºé—´ã€‚</span><br>[root@kuangshen home]# du<br>16./redis<br>8./www/.oracle_jre_usage  # åŒ…æ‹¬éšè—æ–‡ä»¶çš„ç›®å½•<br>24./www<br>48.                        # è¿™ä¸ªç›®å½•(.)æ‰€å ç”¨çš„æ€»é‡<br><span class="hljs-meta">#</span><span class="bash"> å°†æ–‡ä»¶çš„å®¹é‡ä¹Ÿåˆ—å‡ºæ¥</span><br>[root@kuangshen home]# du -a<br>4./redis/.bash_profile<br>4./redis/.bash_logout    <br>....ä¸­é—´çœç•¥....<br>4./kuangstudy.txt # æœ‰æ–‡ä»¶çš„åˆ—è¡¨äº†<br>48.<br><span class="hljs-meta">#</span><span class="bash"> æ£€æŸ¥æ ¹ç›®å½•åº•ä¸‹æ¯ä¸ªç›®å½•æ‰€å ç”¨çš„å®¹é‡</span><br>[root@kuangshen home]# du -sm /*<br>0/bin<br>146/boot<br>.....ä¸­é—´çœç•¥....<br>0/proc<br>.....ä¸­é—´çœç•¥....<br>1/tmp<br>3026/usr  # ç³»ç»ŸåˆæœŸæœ€å¤§å°±æ˜¯ä»–äº†å•¦ï¼<br>513/var<br>2666/www<br></code></pre></td></tr></table></figure><p>é€šé…ç¬¦ * æ¥ä»£è¡¨æ¯ä¸ªç›®å½•ã€‚</p><p>ä¸ df ä¸ä¸€æ ·çš„æ˜¯ï¼Œdu è¿™ä¸ªå‘½ä»¤å…¶å®ä¼šç›´æ¥åˆ°æ–‡ä»¶ç³»ç»Ÿå†…å»æœå¯»æ‰€æœ‰çš„æ–‡ä»¶æ•°æ®ã€‚</p><h2 id="ç£ç›˜æŒ‚è½½ä¸å¸é™¤"><a href="#ç£ç›˜æŒ‚è½½ä¸å¸é™¤" class="headerlink" title="ç£ç›˜æŒ‚è½½ä¸å¸é™¤"></a>ç£ç›˜æŒ‚è½½ä¸å¸é™¤</h2><p>æ ¹æ–‡ä»¶ç³»ç»Ÿä¹‹å¤–çš„å…¶ä»–æ–‡ä»¶è¦æƒ³èƒ½å¤Ÿè¢«è®¿é—®ï¼Œéƒ½å¿…é¡»é€šè¿‡â€œå…³è”â€è‡³æ ¹æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æŸä¸ªç›®å½•æ¥å®ç°ï¼Œæ­¤å…³è”æ“ä½œå³ä¸ºâ€œæŒ‚è½½â€ï¼Œæ­¤ç›®å½•å³ä¸ºâ€œæŒ‚è½½ç‚¹â€,è§£é™¤æ­¤å…³è”å…³ç³»çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºâ€œå¸è½½â€</p><p>Linux çš„ç£ç›˜æŒ‚è½½ä½¿ç”¨mountå‘½ä»¤ï¼Œå¸è½½ä½¿ç”¨umountå‘½ä»¤ã€‚</p><p>ç£ç›˜æŒ‚è½½è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mount [-t æ–‡ä»¶ç³»ç»Ÿ] [-L Labelå] [-o é¢å¤–é€‰é¡¹] [-n] è£…ç½®æ–‡ä»¶å æŒ‚è½½ç‚¹<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°† /dev/hdc6 æŒ‚è½½åˆ° /mnt/hdc6 ä¸Šé¢ï¼</span><br>[root@www ~]# mkdir /mnt/hdc6<br>[root@www ~]# mount /dev/hdc6 /mnt/hdc6<br>[root@www ~]# df<br>Filesystem           1K-blocks     Used Available Use% Mounted on<br>/dev/hdc6              1976312     42072   1833836   3% /mnt/hdc6<br></code></pre></td></tr></table></figure><p>ç£ç›˜å¸è½½å‘½ä»¤ umount è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">umount [-fn] è£…ç½®æ–‡ä»¶åæˆ–æŒ‚è½½ç‚¹<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-f ï¼šå¼ºåˆ¶å¸é™¤ï¼å¯ç”¨åœ¨ç±»ä¼¼ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ (NFS) æ— æ³•è¯»å–åˆ°çš„æƒ…å†µä¸‹ï¼›</li><li>-n ï¼šä¸å‡çº§ /etc/mtab æƒ…å†µä¸‹å¸é™¤ã€‚</li></ul><p>å¸è½½/dev/hdc6</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@www ~]# umount /dev/hdc6<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linuxç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vimç¼–è¾‘å™¨</title>
    <link href="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Vim%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    <url>/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Vim%E7%BC%96%E8%BE%91%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<p>Vimæ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p><p>ç®€å•çš„æ¥è¯´ï¼Œ vi æ˜¯è€å¼çš„å­—å¤„ç†å™¨ï¼Œä¸è¿‡åŠŸèƒ½å·²ç»å¾ˆé½å…¨äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¯ä»¥è¿›æ­¥çš„åœ°æ–¹ã€‚</p><p>vim åˆ™å¯ä»¥è¯´æ˜¯ç¨‹åºå¼€å‘è€…çš„ä¸€é¡¹å¾ˆå¥½ç”¨çš„å·¥å…·ã€‚</p><p>æ‰€æœ‰çš„ Unix Like ç³»ç»Ÿéƒ½ä¼šå†…å»º vi æ–‡ä¹¦ç¼–è¾‘å™¨ï¼Œå…¶ä»–çš„æ–‡ä¹¦ç¼–è¾‘å™¨åˆ™ä¸ä¸€å®šä¼šå­˜åœ¨ã€‚</p><p>è¿ vim çš„å®˜æ–¹ç½‘ç«™ (<a href="http://www.vim.org/">http://www.vim.org</a>) è‡ªå·±ä¹Ÿè¯´ vim æ˜¯ä¸€ä¸ªç¨‹åºå¼€å‘å·¥å…·è€Œä¸æ˜¯æ–‡å­—å¤„ç†è½¯ä»¶ã€‚</p><h1 id="Vimé”®ç›˜å›¾"><a href="#Vimé”®ç›˜å›¾" class="headerlink" title="Vimé”®ç›˜å›¾"></a>Vimé”®ç›˜å›¾</h1><p><img src="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Vim%E7%BC%96%E8%BE%91%E5%99%A8/1.jpg"></p><h1 id="ä¸‰ç§ä½¿ç”¨æ¨¡å¼"><a href="#ä¸‰ç§ä½¿ç”¨æ¨¡å¼" class="headerlink" title="ä¸‰ç§ä½¿ç”¨æ¨¡å¼"></a>ä¸‰ç§ä½¿ç”¨æ¨¡å¼</h1><p>åŸºæœ¬ä¸Š vi/vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯<strong>å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰</strong>ï¼Œ<strong>è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰</strong>å’Œ<strong>åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰</strong>ã€‚è¿™ä¸‰ç§æ¨¡å¼çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p><p><img src="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Vim%E7%BC%96%E8%BE%91%E5%99%A8/2.png"></p><h2 id="å‘½ä»¤æ¨¡å¼ï¼š"><a href="#å‘½ä»¤æ¨¡å¼ï¼š" class="headerlink" title="å‘½ä»¤æ¨¡å¼ï¼š"></a>å‘½ä»¤æ¨¡å¼ï¼š</h2><p>ç”¨æˆ·åˆšåˆšå¯åŠ¨ vi/vimï¼Œä¾¿è¿›å…¥äº†å‘½ä»¤æ¨¡å¼ã€‚</p><p>æ­¤çŠ¶æ€ä¸‹æ•²å‡»é”®ç›˜åŠ¨ä½œä¼šè¢«Vimè¯†åˆ«ä¸ºå‘½ä»¤ï¼Œè€Œéè¾“å…¥å­—ç¬¦ã€‚æ¯”å¦‚æˆ‘ä»¬æ­¤æ—¶æŒ‰ä¸‹iï¼Œå¹¶ä¸ä¼šè¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œiè¢«å½“ä½œäº†ä¸€ä¸ªå‘½ä»¤ã€‚</p><p>ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤ï¼š</p><ul><li><strong>i</strong> åˆ‡æ¢åˆ°è¾“å…¥æ¨¡å¼ï¼Œä»¥è¾“å…¥å­—ç¬¦ã€‚</li><li><strong>x</strong> åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨å¤„çš„å­—ç¬¦ã€‚</li><li><strong>:</strong> åˆ‡æ¢åˆ°åº•çº¿å‘½ä»¤æ¨¡å¼ï¼Œä»¥åœ¨æœ€åº•ä¸€è¡Œè¾“å…¥å‘½ä»¤ã€‚</li></ul><p>è‹¥æƒ³è¦ç¼–è¾‘æ–‡æœ¬ï¼šå¯åŠ¨Vimï¼Œè¿›å…¥äº†å‘½ä»¤æ¨¡å¼ï¼ŒæŒ‰ä¸‹iï¼Œåˆ‡æ¢åˆ°è¾“å…¥æ¨¡å¼ã€‚</p><p>å‘½ä»¤æ¨¡å¼åªæœ‰ä¸€äº›æœ€åŸºæœ¬çš„å‘½ä»¤ï¼Œå› æ­¤ä»è¦ä¾é åº•çº¿å‘½ä»¤æ¨¡å¼è¾“å…¥æ›´å¤šå‘½ä»¤ã€‚</p><h2 id="è¾“å…¥æ¨¡å¼ï¼š"><a href="#è¾“å…¥æ¨¡å¼ï¼š" class="headerlink" title="è¾“å…¥æ¨¡å¼ï¼š"></a>è¾“å…¥æ¨¡å¼ï¼š</h2><p>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ä¸‹iå°±è¿›å…¥äº†è¾“å…¥æ¨¡å¼ã€‚</p><p>åœ¨è¾“å…¥æ¨¡å¼ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‰é”®ï¼š</p><ul><li><strong>å­—ç¬¦æŒ‰é”®ä»¥åŠShiftç»„åˆ</strong>ï¼Œè¾“å…¥å­—ç¬¦</li><li><strong>ENTER</strong>ï¼Œå›è½¦é”®ï¼Œæ¢è¡Œ</li><li><strong>BACK SPACE</strong>ï¼Œé€€æ ¼é”®ï¼Œåˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦</li><li><strong>DEL</strong>ï¼Œåˆ é™¤é”®ï¼Œåˆ é™¤å…‰æ ‡åä¸€ä¸ªå­—ç¬¦</li><li><strong>æ–¹å‘é”®</strong>ï¼Œåœ¨æ–‡æœ¬ä¸­ç§»åŠ¨å…‰æ ‡</li><li><strong>HOME</strong>/<strong>END</strong>ï¼Œç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–/è¡Œå°¾</li><li><strong>Page Up</strong>/<strong>Page Down</strong>ï¼Œä¸Š/ä¸‹ç¿»é¡µ</li><li><strong>Insert</strong>ï¼Œåˆ‡æ¢å…‰æ ‡ä¸ºè¾“å…¥/æ›¿æ¢æ¨¡å¼ï¼Œå…‰æ ‡å°†å˜æˆç«–çº¿/ä¸‹åˆ’çº¿</li><li><strong>ESC</strong>ï¼Œé€€å‡ºè¾“å…¥æ¨¡å¼ï¼Œåˆ‡æ¢åˆ°å‘½ä»¤æ¨¡å¼</li></ul><h2 id="åº•çº¿å‘½ä»¤æ¨¡å¼"><a href="#åº•çº¿å‘½ä»¤æ¨¡å¼" class="headerlink" title="åº•çº¿å‘½ä»¤æ¨¡å¼"></a>åº•çº¿å‘½ä»¤æ¨¡å¼</h2><p>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ä¸‹:ï¼ˆè‹±æ–‡å†’å·ï¼‰å°±è¿›å…¥äº†åº•çº¿å‘½ä»¤æ¨¡å¼ã€‚</p><p>åº•çº¿å‘½ä»¤æ¨¡å¼å¯ä»¥è¾“å…¥å•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦çš„å‘½ä»¤ï¼Œå¯ç”¨çš„å‘½ä»¤éå¸¸å¤šã€‚</p><p>åœ¨åº•çº¿å‘½ä»¤æ¨¡å¼ä¸­ï¼ŒåŸºæœ¬çš„å‘½ä»¤æœ‰ï¼ˆå·²ç»çœç•¥äº†å†’å·ï¼‰ï¼š</p><ul><li>q é€€å‡ºç¨‹åº</li><li>w ä¿å­˜æ–‡ä»¶</li></ul><p>æŒ‰ESCé”®å¯éšæ—¶é€€å‡ºåº•çº¿å‘½ä»¤æ¨¡å¼ã€‚</p><h1 id="Vim-æŒ‰é”®è¯´æ˜"><a href="#Vim-æŒ‰é”®è¯´æ˜" class="headerlink" title="Vim æŒ‰é”®è¯´æ˜"></a>Vim æŒ‰é”®è¯´æ˜</h1><p>é™¤äº†ä¸Šé¢ç®€æ˜“èŒƒä¾‹çš„ i, Esc, :wq ä¹‹å¤–ï¼Œå…¶å® vim è¿˜æœ‰éå¸¸å¤šçš„æŒ‰é”®å¯ä»¥ä½¿ç”¨ã€‚</p><h2 id="ä¸€èˆ¬æ¨¡å¼å¯ç”¨çš„å…‰æ ‡ç§»åŠ¨ã€å¤åˆ¶ç²˜è´´ã€æœç´¢æ›¿æ¢ç­‰"><a href="#ä¸€èˆ¬æ¨¡å¼å¯ç”¨çš„å…‰æ ‡ç§»åŠ¨ã€å¤åˆ¶ç²˜è´´ã€æœç´¢æ›¿æ¢ç­‰" class="headerlink" title="ä¸€èˆ¬æ¨¡å¼å¯ç”¨çš„å…‰æ ‡ç§»åŠ¨ã€å¤åˆ¶ç²˜è´´ã€æœç´¢æ›¿æ¢ç­‰**"></a>ä¸€èˆ¬æ¨¡å¼å¯ç”¨çš„å…‰æ ‡ç§»åŠ¨ã€å¤åˆ¶ç²˜è´´ã€æœç´¢æ›¿æ¢ç­‰**</h2><table><thead><tr><th align="left">ç§»åŠ¨å…‰æ ‡çš„æ–¹æ³•</th><th></th></tr></thead><tbody><tr><td align="left">h æˆ– å‘å·¦ç®­å¤´é”®(â†)</td><td>å…‰æ ‡å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">j æˆ– å‘ä¸‹ç®­å¤´é”®(â†“)</td><td>å…‰æ ‡å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">k æˆ– å‘ä¸Šç®­å¤´é”®(â†‘)</td><td>å…‰æ ‡å‘ä¸Šç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">l æˆ– å‘å³ç®­å¤´é”®(â†’)</td><td>å…‰æ ‡å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">[Ctrl] + [f]</td><td>å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Down]æŒ‰é”® (å¸¸ç”¨)</td></tr><tr><td align="left">[Ctrl] + [b]</td><td>å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Up] æŒ‰é”® (å¸¸ç”¨)</td></tr><tr><td align="left">[Ctrl] + [d]</td><td>å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨åŠé¡µ</td></tr><tr><td align="left">[Ctrl] + [u]</td><td>å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨åŠé¡µ</td></tr><tr><td align="left">+</td><td>å…‰æ ‡ç§»åŠ¨åˆ°éç©ºæ ¼ç¬¦çš„ä¸‹ä¸€è¡Œ</td></tr><tr><td align="left">-</td><td>å…‰æ ‡ç§»åŠ¨åˆ°éç©ºæ ¼ç¬¦çš„ä¸Šä¸€è¡Œ</td></tr><tr><td align="left">n&lt; space&gt;</td><td>é‚£ä¸ª n è¡¨ç¤ºã€æ•°å­—ã€ï¼Œä¾‹å¦‚ 20 ã€‚æŒ‰ä¸‹æ•°å­—åå†æŒ‰ç©ºæ ¼é”®ï¼Œå…‰æ ‡ä¼šå‘å³ç§»åŠ¨è¿™ä¸€è¡Œçš„ n ä¸ªå­—ç¬¦ã€‚</td></tr><tr><td align="left">0 æˆ–åŠŸèƒ½é”®[Home]</td><td>è¿™æ˜¯æ•°å­—ã€ 0 ã€ï¼šç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€å‰é¢å­—ç¬¦å¤„ (å¸¸ç”¨)</td></tr><tr><td align="left">$ æˆ–åŠŸèƒ½é”®[End]</td><td>ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€åé¢å­—ç¬¦å¤„(å¸¸ç”¨)</td></tr><tr><td align="left">H</td><td>å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸Šæ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">M</td><td>å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„ä¸­å¤®é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">L</td><td>å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸‹æ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">G</td><td>ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„æœ€åä¸€è¡Œ(å¸¸ç”¨)</td></tr><tr><td align="left">nG</td><td>n ä¸ºæ•°å­—ã€‚ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ n è¡Œã€‚ä¾‹å¦‚ 20G åˆ™ä¼šç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ 20 è¡Œ(å¯é…åˆ :set nu)</td></tr><tr><td align="left">gg</td><td>ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ä¸€è¡Œï¼Œç›¸å½“äº 1G å•Šï¼(å¸¸ç”¨)</td></tr><tr><td align="left">n&lt; Enter&gt;</td><td>n ä¸ºæ•°å­—ã€‚å…‰æ ‡å‘ä¸‹ç§»åŠ¨ n è¡Œ(å¸¸ç”¨)</td></tr></tbody></table><table><thead><tr><th align="left">æœç´¢æ›¿æ¢</th><th></th></tr></thead><tbody><tr><td align="left">/word</td><td>å‘å…‰æ ‡ä¹‹ä¸‹å¯»æ‰¾ä¸€ä¸ªåç§°ä¸º word çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚è¦åœ¨æ¡£æ¡ˆå†…æœå¯» vbird è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå°±è¾“å…¥ /vbird å³å¯ï¼(å¸¸ç”¨)</td></tr><tr><td align="left">?word</td><td>å‘å…‰æ ‡ä¹‹ä¸Šå¯»æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²åç§°ä¸º word çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left">n</td><td>è¿™ä¸ª n æ˜¯è‹±æ–‡æŒ‰é”®ã€‚ä»£è¡¨é‡å¤å‰ä¸€ä¸ªæœå¯»çš„åŠ¨ä½œã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ å¦‚æœåˆšåˆšæˆ‘ä»¬æ‰§è¡Œ /vbird å»å‘ä¸‹æœå¯» vbird è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™æŒ‰ä¸‹ n åï¼Œä¼šå‘ä¸‹ç»§ç»­æœå¯»ä¸‹ä¸€ä¸ªåç§°ä¸º vbird çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæ˜¯æ‰§è¡Œ ?vbird çš„è¯ï¼Œé‚£ä¹ˆæŒ‰ä¸‹ n åˆ™ä¼šå‘ä¸Šç»§ç»­æœå¯»åç§°ä¸º vbird çš„å­—ç¬¦ä¸²ï¼</td></tr><tr><td align="left">N</td><td>è¿™ä¸ª N æ˜¯è‹±æ–‡æŒ‰é”®ã€‚ä¸ n åˆšå¥½ç›¸åï¼Œä¸ºã€åå‘ã€è¿›è¡Œå‰ä¸€ä¸ªæœå¯»åŠ¨ä½œã€‚ä¾‹å¦‚ /vbird åï¼ŒæŒ‰ä¸‹ N åˆ™è¡¨ç¤ºã€å‘ä¸Šã€æœå¯» vbird ã€‚</td></tr></tbody></table><table><thead><tr><th align="left">åˆ é™¤ã€å¤åˆ¶ä¸ç²˜è´´</th><th></th></tr></thead><tbody><tr><td align="left">x, X</td><td>åœ¨ä¸€è¡Œå­—å½“ä¸­ï¼Œx ä¸ºå‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ (ç›¸å½“äº [del] æŒ‰é”®)ï¼Œ X ä¸ºå‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦(ç›¸å½“äº [backspace] äº¦å³æ˜¯é€€æ ¼é”®) (å¸¸ç”¨)</td></tr><tr><td align="left">nx</td><td>n ä¸ºæ•°å­—ï¼Œè¿ç»­å‘ååˆ é™¤ n ä¸ªå­—ç¬¦ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘è¦è¿ç»­åˆ é™¤ 10 ä¸ªå­—ç¬¦ï¼Œ ã€10xã€ã€‚</td></tr><tr><td align="left">dd</td><td>åˆ é™¤æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€æ•´è¡Œ(å¸¸ç”¨)</td></tr><tr><td align="left">ndd</td><td>n ä¸ºæ•°å­—ã€‚åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n è¡Œï¼Œä¾‹å¦‚ 20dd åˆ™æ˜¯åˆ é™¤ 20 è¡Œ (å¸¸ç”¨)</td></tr><tr><td align="left">d1G</td><td>åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td></tr><tr><td align="left">dG</td><td>åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°æœ€åä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td></tr><tr><td align="left">d$</td><td>åˆ é™¤æ¸¸æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">d0</td><td>é‚£ä¸ªæ˜¯æ•°å­—çš„ 0 ï¼Œåˆ é™¤æ¸¸æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œçš„æœ€å‰é¢ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td align="left">yy</td><td>å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œ(å¸¸ç”¨)</td></tr><tr><td align="left">nyy</td><td>n ä¸ºæ•°å­—ã€‚å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n è¡Œï¼Œä¾‹å¦‚ 20yy åˆ™æ˜¯å¤åˆ¶ 20 è¡Œ(å¸¸ç”¨)</td></tr><tr><td align="left">y1G</td><td>å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨è¡Œåˆ°ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td></tr><tr><td align="left">yG</td><td>å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨è¡Œåˆ°æœ€åä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td></tr><tr><td align="left">y0</td><td>å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸ªå­—ç¬¦åˆ°è¯¥è¡Œè¡Œé¦–çš„æ‰€æœ‰æ•°æ®</td></tr><tr><td align="left">y$</td><td>å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸ªå­—ç¬¦åˆ°è¯¥è¡Œè¡Œå°¾çš„æ‰€æœ‰æ•°æ®</td></tr><tr><td align="left">p, P</td><td>p ä¸ºå°†å·²å¤åˆ¶çš„æ•°æ®åœ¨å…‰æ ‡ä¸‹ä¸€è¡Œè´´ä¸Šï¼ŒP åˆ™ä¸ºè´´åœ¨æ¸¸æ ‡ä¸Šä¸€è¡Œï¼ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ç›®å‰å…‰æ ‡åœ¨ç¬¬ 20 è¡Œï¼Œä¸”å·²ç»å¤åˆ¶äº† 10 è¡Œæ•°æ®ã€‚åˆ™æŒ‰ä¸‹ p åï¼Œ é‚£ 10 è¡Œæ•°æ®ä¼šè´´åœ¨åŸæœ¬çš„ 20 è¡Œä¹‹åï¼Œäº¦å³ç”± 21 è¡Œå¼€å§‹è´´ã€‚ä½†å¦‚æœæ˜¯æŒ‰ä¸‹ P å‘¢ï¼Ÿé‚£ä¹ˆåŸæœ¬çš„ç¬¬ 20 è¡Œä¼šè¢«æ¨åˆ°å˜æˆ 30 è¡Œã€‚(å¸¸ç”¨)</td></tr><tr><td align="left">J</td><td>å°†å…‰æ ‡æ‰€åœ¨è¡Œä¸ä¸‹ä¸€è¡Œçš„æ•°æ®ç»“åˆæˆåŒä¸€è¡Œ</td></tr><tr><td align="left">c</td><td>é‡å¤åˆ é™¤å¤šä¸ªæ•°æ®ï¼Œä¾‹å¦‚å‘ä¸‹åˆ é™¤ 10 è¡Œï¼Œ[ 10cj ]</td></tr><tr><td align="left">u</td><td>å¤åŸå‰ä¸€ä¸ªåŠ¨ä½œã€‚(å¸¸ç”¨)</td></tr><tr><td align="left">[Ctrl]+r</td><td>é‡åšä¸Šä¸€ä¸ªåŠ¨ä½œã€‚(å¸¸ç”¨)</td></tr></tbody></table><h2 id="ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜"><a href="#ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜" class="headerlink" title="ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜"></a>ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜</h2><table><thead><tr><th align="left">è¿›å…¥è¾“å…¥æˆ–å–ä»£çš„ç¼–è¾‘æ¨¡å¼</th><th></th></tr></thead><tbody><tr><td align="left">i, I</td><td>è¿›å…¥è¾“å…¥æ¨¡å¼(Insert mode)ï¼ši ä¸ºã€ä»ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„è¾“å…¥ã€ï¼Œ I ä¸ºã€åœ¨ç›®å‰æ‰€åœ¨è¡Œçš„ç¬¬ä¸€ä¸ªéç©ºæ ¼ç¬¦å¤„å¼€å§‹è¾“å…¥ã€ã€‚(å¸¸ç”¨)</td></tr><tr><td align="left">a, A</td><td>è¿›å…¥è¾“å…¥æ¨¡å¼(Insert mode)ï¼ša ä¸ºã€ä»ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥ã€ï¼Œ A ä¸ºã€ä»å…‰æ ‡æ‰€åœ¨è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥ã€ã€‚(å¸¸ç”¨)</td></tr><tr><td align="left">o, O</td><td>è¿›å…¥è¾“å…¥æ¨¡å¼(Insert mode)ï¼šè¿™æ˜¯è‹±æ–‡å­—æ¯ o çš„å¤§å°å†™ã€‚o ä¸ºã€åœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€è¡Œå¤„è¾“å…¥æ–°çš„ä¸€è¡Œã€ï¼›O ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„çš„ä¸Šä¸€è¡Œè¾“å…¥æ–°çš„ä¸€è¡Œï¼(å¸¸ç”¨)</td></tr><tr><td align="left">r, R</td><td>è¿›å…¥å–ä»£æ¨¡å¼(Replace mode)ï¼šr åªä¼šå–ä»£å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€ä¸ªå­—ç¬¦ä¸€æ¬¡ï¼›Rä¼šä¸€ç›´å–ä»£å…‰æ ‡æ‰€åœ¨çš„æ–‡å­—ï¼Œç›´åˆ°æŒ‰ä¸‹ ESC ä¸ºæ­¢ï¼›(å¸¸ç”¨)</td></tr><tr><td align="left">[Esc]</td><td>é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå›åˆ°ä¸€èˆ¬æ¨¡å¼ä¸­(å¸¸ç”¨)</td></tr></tbody></table><h2 id="ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜"><a href="#ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜" class="headerlink" title="ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜"></a>ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜</h2><table><thead><tr><th align="left">æŒ‡ä»¤è¡Œçš„å‚¨å­˜ã€ç¦»å¼€ç­‰æŒ‡ä»¤</th><th></th></tr></thead><tbody><tr><td align="left">:w</td><td>å°†ç¼–è¾‘çš„æ•°æ®å†™å…¥ç¡¬ç›˜æ¡£æ¡ˆä¸­(å¸¸ç”¨)</td></tr><tr><td align="left">:w!</td><td>è‹¥æ–‡ä»¶å±æ€§ä¸ºã€åªè¯»ã€æ—¶ï¼Œå¼ºåˆ¶å†™å…¥è¯¥æ¡£æ¡ˆã€‚ä¸è¿‡ï¼Œåˆ°åº•èƒ½ä¸èƒ½å†™å…¥ï¼Œ è¿˜æ˜¯è·Ÿä½ å¯¹è¯¥æ¡£æ¡ˆçš„æ¡£æ¡ˆæƒé™æœ‰å…³å•Šï¼</td></tr><tr><td align="left">:q</td><td>ç¦»å¼€ vi (å¸¸ç”¨)</td></tr><tr><td align="left">:q!</td><td>è‹¥æ›¾ä¿®æ”¹è¿‡æ¡£æ¡ˆï¼Œåˆä¸æƒ³å‚¨å­˜ï¼Œä½¿ç”¨ ! ä¸ºå¼ºåˆ¶ç¦»å¼€ä¸å‚¨å­˜æ¡£æ¡ˆã€‚</td></tr><tr><td align="left">æ³¨æ„ä¸€ä¸‹å•Šï¼Œé‚£ä¸ªæƒŠå¹å· (!) åœ¨ vi å½“ä¸­ï¼Œå¸¸å¸¸å…·æœ‰ã€å¼ºåˆ¶ã€çš„æ„æ€ï½</td><td></td></tr><tr><td align="left">:wq</td><td>å‚¨å­˜åç¦»å¼€ï¼Œè‹¥ä¸º :wq! åˆ™ä¸ºå¼ºåˆ¶å‚¨å­˜åç¦»å¼€ (å¸¸ç”¨)</td></tr><tr><td align="left">ZZ</td><td>è¿™æ˜¯å¤§å†™çš„ Z å–”ï¼è‹¥æ¡£æ¡ˆæ²¡æœ‰æ›´åŠ¨ï¼Œåˆ™ä¸å‚¨å­˜ç¦»å¼€ï¼Œè‹¥æ¡£æ¡ˆå·²ç»è¢«æ›´åŠ¨è¿‡ï¼Œåˆ™å‚¨å­˜åç¦»å¼€ï¼</td></tr><tr><td align="left">:w [filename]</td><td>å°†ç¼–è¾‘çš„æ•°æ®å‚¨å­˜æˆå¦ä¸€ä¸ªæ¡£æ¡ˆï¼ˆç±»ä¼¼å¦å­˜æ–°æ¡£ï¼‰</td></tr><tr><td align="left">:r [filename]</td><td>åœ¨ç¼–è¾‘çš„æ•°æ®ä¸­ï¼Œè¯»å…¥å¦ä¸€ä¸ªæ¡£æ¡ˆçš„æ•°æ®ã€‚äº¦å³å°† ã€filenameã€ è¿™ä¸ªæ¡£æ¡ˆå†…å®¹åŠ åˆ°æ¸¸æ ‡æ‰€åœ¨è¡Œåé¢</td></tr><tr><td align="left">:n1,n2 w [filename]</td><td>å°† n1 åˆ° n2 çš„å†…å®¹å‚¨å­˜æˆ filename è¿™ä¸ªæ¡£æ¡ˆã€‚</td></tr><tr><td align="left">:! command</td><td>æš‚æ—¶ç¦»å¼€ vi åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼ä¸‹æ‰§è¡Œ command çš„æ˜¾ç¤ºç»“æœï¼ä¾‹å¦‚ ã€:! ls /homeã€å³å¯åœ¨ vi å½“ä¸­çœ‹ /home åº•ä¸‹ä»¥ ls è¾“å‡ºçš„æ¡£æ¡ˆä¿¡æ¯ï¼</td></tr><tr><td align="left">:set nu</td><td>æ˜¾ç¤ºè¡Œå·ï¼Œè®¾å®šä¹‹åï¼Œä¼šåœ¨æ¯ä¸€è¡Œçš„å‰ç¼€æ˜¾ç¤ºè¯¥è¡Œçš„è¡Œå·</td></tr><tr><td align="left">:set nonu</td><td>ä¸ set nu ç›¸åï¼Œä¸ºå–æ¶ˆè¡Œå·ï¼</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>Linuxç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LinuxåŸºæœ¬å‘½ä»¤æ€»ç»“</title>
    <link href="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/"/>
    <url>/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="ç›®å½•ç®¡ç†"><a href="#ç›®å½•ç®¡ç†" class="headerlink" title="ç›®å½•ç®¡ç†"></a>ç›®å½•ç®¡ç†</h1><ul><li>ls: åˆ—å‡ºç›®å½•</li><li>cdï¼šåˆ‡æ¢ç›®å½•</li><li>pwdï¼šæ˜¾ç¤ºç›®å‰çš„ç›®å½•</li><li>mkdirï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•</li><li>rmdirï¼šåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•</li><li>cp: å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</li><li>rm: ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•</li><li>mv: ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹æ–‡ä»¶ä¸ç›®å½•çš„åç§°</li></ul><p>å¯ä»¥ä½¿ç”¨ <em>man [å‘½ä»¤]</em> æ¥æŸ¥çœ‹å„ä¸ªå‘½ä»¤çš„ä½¿ç”¨æ–‡æ¡£ï¼Œå¦‚ ï¼šman cpã€‚</p><h2 id="ls-ï¼ˆåˆ—å‡ºç›®å½•ï¼‰"><a href="#ls-ï¼ˆåˆ—å‡ºç›®å½•ï¼‰" class="headerlink" title="ls ï¼ˆåˆ—å‡ºç›®å½•ï¼‰"></a>ls ï¼ˆåˆ—å‡ºç›®å½•ï¼‰</h2><p>åœ¨Linuxç³»ç»Ÿå½“ä¸­ï¼Œ ls å‘½ä»¤å¯èƒ½æ˜¯æœ€å¸¸è¢«è¿è¡Œçš„ã€‚</p><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@www ~]# ls [-aAdfFhilnrRSt] ç›®å½•åç§°<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-a ï¼šå…¨éƒ¨çš„æ–‡ä»¶ï¼Œè¿åŒéšè—æ–‡ä»¶( å¼€å¤´ä¸º . çš„æ–‡ä»¶) ä¸€èµ·åˆ—å‡ºæ¥(å¸¸ç”¨)</li><li>-l ï¼šé•¿æ•°æ®ä¸²åˆ—å‡ºï¼ŒåŒ…å«æ–‡ä»¶çš„å±æ€§ä¸æƒé™ç­‰ç­‰æ•°æ®ï¼›(å¸¸ç”¨)</li></ul><p>å°†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ—å‡ºæ¥(å«å±æ€§ä¸éšè—æ¡£)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@www ~]# ls -al ~<br></code></pre></td></tr></table></figure><h2 id="cd-ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰"><a href="#cd-ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰" class="headerlink" title="cd ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰"></a>cd ï¼ˆåˆ‡æ¢ç›®å½•ï¼‰</h2><p>cdæ˜¯Change Directoryçš„ç¼©å†™ï¼Œè¿™æ˜¯ç”¨æ¥å˜æ¢å·¥ä½œç›®å½•çš„å‘½ä»¤ã€‚</p><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd [ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„]<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åˆ‡æ¢åˆ°ç”¨æˆ·ç›®å½•ä¸‹</span><br>[root@kuangshen /]# cd home  <br><br><span class="hljs-meta">#</span><span class="bash"> ä½¿ç”¨ mkdir å‘½ä»¤åˆ›å»º kuangstudy ç›®å½•</span><br>[root@kuangshen home]# mkdir kuangstudy<br><br><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥ kuangstudy ç›®å½•</span><br>[root@kuangshen home]# cd kuangstudy<br><br><span class="hljs-meta">#</span><span class="bash"> å›åˆ°ä¸Šä¸€çº§</span><br>[root@kuangshen kuangstudy]# cd ..<br><br><span class="hljs-meta">#</span><span class="bash"> å›åˆ°æ ¹ç›®å½•</span><br>[root@kuangshen kuangstudy]# cd /<br><br><span class="hljs-meta">#</span><span class="bash"> è¡¨ç¤ºå›åˆ°è‡ªå·±çš„å®¶ç›®å½•ï¼Œäº¦å³æ˜¯ /root è¿™ä¸ªç›®å½•</span><br>[root@kuangshen kuangstudy]# cd ~<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¤§å®¶å¤šæ“ä½œå‡ æ¬¡åº”è¯¥å°±å¯ä»¥å¾ˆå¥½çš„ç†è§£ cd å‘½ä»¤çš„ã€‚</p><h2 id="pwd-æ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„ç›®å½•"><a href="#pwd-æ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„ç›®å½•" class="headerlink" title="pwd ( æ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„ç›®å½• )"></a>pwd ( æ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„ç›®å½• )</h2><p>pwd æ˜¯ <strong>Print Working Directory</strong> çš„ç¼©å†™ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºç›®å‰æ‰€åœ¨ç›®å½•çš„å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen kuangstudy]#pwd [-P]<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š**-P** ï¼šæ˜¾ç¤ºå‡ºç¡®å®çš„è·¯å¾„ï¼Œè€Œéä½¿ç”¨è¿æ¥(link) è·¯å¾„ã€‚</p><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å•çº¯æ˜¾ç¤ºå‡ºç›®å‰çš„å·¥ä½œç›®å½•</span><br>[root@kuangshen ~]# pwd<br>/root<br><br><span class="hljs-meta">#</span><span class="bash"> å¦‚æœæ˜¯é“¾æ¥ï¼Œè¦æ˜¾ç¤ºçœŸå®åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨ -På‚æ•°</span><br>[root@kuangshen /]# cd bin<br>[root@kuangshen bin]# pwd -P<br>/usr/bin<br></code></pre></td></tr></table></figure><h2 id="mkdir-ï¼ˆåˆ›å»ºæ–°ç›®å½•ï¼‰"><a href="#mkdir-ï¼ˆåˆ›å»ºæ–°ç›®å½•ï¼‰" class="headerlink" title="mkdir ï¼ˆåˆ›å»ºæ–°ç›®å½•ï¼‰"></a>mkdir ï¼ˆåˆ›å»ºæ–°ç›®å½•ï¼‰</h2><p>å¦‚æœæƒ³è¦åˆ›å»ºæ–°çš„ç›®å½•çš„è¯ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨mkdir (make directory)å§ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir [-mp] ç›®å½•åç§°<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-m ï¼šé…ç½®æ–‡ä»¶çš„æƒé™å–”ï¼ç›´æ¥é…ç½®ï¼Œä¸éœ€è¦çœ‹é»˜è®¤æƒé™ (umask) çš„è„¸è‰²ï½</li><li>-p ï¼šå¸®åŠ©ä½ ç›´æ¥å°†æ‰€éœ€è¦çš„ç›®å½•(åŒ…å«ä¸Šä¸€çº§ç›®å½•)é€’å½’åˆ›å»ºèµ·æ¥ï¼</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># è¿›å…¥æˆ‘ä»¬ç”¨æˆ·ç›®å½•ä¸‹</span><br>[root@kuangshen /]<span class="hljs-comment"># cd /home</span><br><br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª test æ–‡ä»¶å¤¹</span><br>[root@kuangshen home]<span class="hljs-comment"># mkdir test</span><br><br><span class="hljs-comment"># åˆ›å»ºå¤šå±‚çº§ç›®å½•</span><br>[root@kuangshen home]<span class="hljs-comment"># mkdir test1/test2/test3/test4</span><br>mkdir: cannot create directory â€˜test1/test2/test3/test4â€™:<br>No such file or directory  <span class="hljs-comment"># &lt;== æ²¡åŠæ³•ç›´æ¥åˆ›å»ºæ­¤ç›®å½•å•Šï¼</span><br><br><span class="hljs-comment"># åŠ äº†è¿™ä¸ª -p çš„é€‰é¡¹ï¼Œå¯ä»¥è‡ªè¡Œå¸®ä½ åˆ›å»ºå¤šå±‚ç›®å½•ï¼</span><br>[root@kuangshen home]<span class="hljs-comment"># mkdir -p test1/test2/test3/test4</span><br><br><span class="hljs-comment"># åˆ›å»ºæƒé™ä¸º rwx--x--x çš„ç›®å½•ã€‚</span><br>[root@kuangshen home]<span class="hljs-comment"># mkdir -m 711 test2</span><br>[root@kuangshen home]<span class="hljs-comment"># ls -l</span><br>drwxr-xr-x 2 root root  4096 Mar 12 21:55 <span class="hljs-built_in">test</span><br>drwxr-xr-x 3 root root  4096 Mar 12 21:56 test1<br>drwx--x--x 2 root root  4096 Mar 12 21:58 test2<br></code></pre></td></tr></table></figure><h2 id="rmdir-åˆ é™¤ç©ºçš„ç›®å½•"><a href="#rmdir-åˆ é™¤ç©ºçš„ç›®å½•" class="headerlink" title="rmdir ( åˆ é™¤ç©ºçš„ç›®å½• )"></a>rmdir ( åˆ é™¤ç©ºçš„ç›®å½• )</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rmdir [-p] ç›®å½•åç§°<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š**-p ï¼š**è¿åŒä¸Šä¸€çº§ã€ç©ºçš„ã€ç›®å½•ä¹Ÿä¸€èµ·åˆ é™¤</p><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> çœ‹çœ‹æœ‰å¤šå°‘ç›®å½•å­˜åœ¨ï¼Ÿ</span><br>[root@kuangshen home]# ls -l<br>drwxr-xr-x 2 root root  4096 Mar 12 21:55 test<br>drwxr-xr-x 3 root root  4096 Mar 12 21:56 test1<br>drwx--x--x 2 root root  4096 Mar 12 21:58 test2<br><br><span class="hljs-meta">#</span><span class="bash"> å¯ç›´æ¥åˆ é™¤æ‰ï¼Œæ²¡é—®é¢˜</span><br>[root@kuangshen home]# rmdir test<br><br><span class="hljs-meta">#</span><span class="bash"> å› ä¸ºå°šæœ‰å†…å®¹ï¼Œæ‰€ä»¥æ— æ³•åˆ é™¤ï¼</span><br>[root@kuangshen home]# rmdir test1<br>rmdir: failed to remove â€˜test1â€™: Directory not empty<br><br><span class="hljs-meta">#</span><span class="bash"> åˆ©ç”¨ -p è¿™ä¸ªé€‰é¡¹ï¼Œç«‹åˆ»å°±å¯ä»¥å°† test1/test2/test3/test4 ä¾æ¬¡åˆ é™¤ã€‚</span><br>[root@kuangshen home]# rmdir -p test1/test2/test3/test4<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè¿™ä¸ª rmdir ä»…èƒ½åˆ é™¤ç©ºçš„ç›®å½•ï¼Œä½ å¯ä»¥ä½¿ç”¨ rm å‘½ä»¤æ¥åˆ é™¤éç©ºç›®å½•ï¼Œåé¢æˆ‘ä»¬ä¼šå°†ï¼</p><h2 id="cp-å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•"><a href="#cp-å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•" class="headerlink" title="cp ( å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½• )"></a>cp ( å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½• )</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@www ~]# cp [-adfilprsu] æ¥æºæ¡£(source) ç›®æ ‡æ¡£(destination)<br>[root@www ~]# cp [options] source1 source2 source3 .... directory<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li><strong>-aï¼š</strong>ç›¸å½“æ–¼ -pdr çš„æ„æ€ï¼Œè‡³æ–¼ pdr è¯·å‚è€ƒä¸‹åˆ—è¯´æ˜ï¼›(å¸¸ç”¨)</li><li><strong>-pï¼š</strong>è¿åŒæ–‡ä»¶çš„å±æ€§ä¸€èµ·å¤åˆ¶è¿‡å»ï¼Œè€Œéä½¿ç”¨é»˜è®¤å±æ€§(å¤‡ä»½å¸¸ç”¨)ï¼›</li><li><strong>-dï¼š</strong>è‹¥æ¥æºæ¡£ä¸ºè¿ç»“æ¡£çš„å±æ€§(link file)ï¼Œåˆ™å¤åˆ¶è¿ç»“æ¡£å±æ€§è€Œéæ–‡ä»¶æœ¬èº«ï¼›</li><li><strong>-rï¼š</strong>é€’å½’æŒç»­å¤åˆ¶ï¼Œç”¨æ–¼ç›®å½•çš„å¤åˆ¶è¡Œä¸ºï¼›(å¸¸ç”¨)</li><li><strong>-fï¼š</strong>ä¸ºå¼ºåˆ¶(force)çš„æ„æ€ï¼Œè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¸”æ— æ³•å¼€å¯ï¼Œåˆ™ç§»é™¤åå†å°è¯•ä¸€æ¬¡ï¼›</li><li><strong>-iï¼š</strong>è‹¥ç›®æ ‡æ¡£(destination)å·²ç»å­˜åœ¨æ—¶ï¼Œåœ¨è¦†ç›–æ—¶ä¼šå…ˆè¯¢é—®åŠ¨ä½œçš„è¿›è¡Œ(å¸¸ç”¨)</li><li><strong>-lï¼š</strong>è¿›è¡Œç¡¬å¼è¿ç»“(hard link)çš„è¿ç»“æ¡£åˆ›å»ºï¼Œè€Œéå¤åˆ¶æ–‡ä»¶æœ¬èº«ã€‚</li><li><strong>-sï¼š</strong>å¤åˆ¶æˆä¸ºç¬¦å·è¿ç»“æ¡£ (symbolic link)ï¼Œäº¦å³ã€æ·å¾„ã€æ–‡ä»¶ï¼›</li><li><strong>-uï¼š</strong>è‹¥ destination æ¯” source æ—§æ‰å‡çº§ destination ï¼</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ‰¾ä¸€ä¸ªæœ‰æ–‡ä»¶çš„ç›®å½•ï¼Œæˆ‘è¿™é‡Œæ‰¾åˆ° rootç›®å½•</span><br>[root@kuangshen home]# cd /root<br>[root@kuangshen ~]# ls<br>install.sh<br>[root@kuangshen ~]# cd /home<br><br><span class="hljs-meta">#</span><span class="bash"> å¤åˆ¶ rootç›®å½•ä¸‹çš„install.sh åˆ° homeç›®å½•ä¸‹</span><br>[root@kuangshen home]# cp /root/install.sh /home<br>[root@kuangshen home]# ls<br>install.sh<br><br><span class="hljs-meta">#</span><span class="bash"> å†æ¬¡å¤åˆ¶ï¼ŒåŠ ä¸Š-iå‚æ•°ï¼Œå¢åŠ è¦†ç›–è¯¢é—®ï¼Ÿ</span><br>[root@kuangshen home]# cp -i /root/install.sh /home<br>cp: overwrite â€˜/home/install.shâ€™? y # nä¸è¦†ç›–ï¼Œyä¸ºè¦†ç›–<br></code></pre></td></tr></table></figure><h2 id="rm-ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•"><a href="#rm-ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•" class="headerlink" title="rm ( ç§»é™¤æ–‡ä»¶æˆ–ç›®å½• )"></a>rm ( ç§»é™¤æ–‡ä»¶æˆ–ç›®å½• )</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">rm [-fir] æ–‡ä»¶æˆ–ç›®å½•<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-f ï¼šå°±æ˜¯ force çš„æ„æ€ï¼Œå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¸ä¼šå‡ºç°è­¦å‘Šä¿¡æ¯ï¼›</li><li>-i ï¼šäº’åŠ¨æ¨¡å¼ï¼Œåœ¨åˆ é™¤å‰ä¼šè¯¢é—®ä½¿ç”¨è€…æ˜¯å¦åŠ¨ä½œ</li><li>-r ï¼šé€’å½’åˆ é™¤å•Šï¼æœ€å¸¸ç”¨åœ¨ç›®å½•çš„åˆ é™¤äº†ï¼è¿™æ˜¯éå¸¸å±é™©çš„é€‰é¡¹ï¼ï¼ï¼</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°†åˆšåˆšåœ¨ cp çš„å®ä¾‹ä¸­åˆ›å»ºçš„ install.shåˆ é™¤æ‰ï¼</span><br>[root@kuangshen home]# rm -i install.sh<br>rm: remove regular file â€˜install.shâ€™? y<br><span class="hljs-meta">#</span><span class="bash"> å¦‚æœåŠ ä¸Š -i çš„é€‰é¡¹å°±ä¼šä¸»åŠ¨è¯¢é—®å–”ï¼Œé¿å…ä½ åˆ é™¤åˆ°é”™è¯¯çš„æ¡£åï¼</span><br><br><span class="hljs-meta">#</span><span class="bash"> å°½é‡ä¸è¦åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ rm -rf /</span><br></code></pre></td></tr></table></figure><h2 id="mv-ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹åç§°"><a href="#mv-ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹åç§°" class="headerlink" title="mv  ( ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹åç§° )"></a>mv  ( ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹åç§° )</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@www ~]# mv [-fiu] source destination<br>[root@www ~]# mv [options] source1 source2 source3 .... directory<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-f ï¼šforce å¼ºåˆ¶çš„æ„æ€ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸ä¼šè¯¢é—®è€Œç›´æ¥è¦†ç›–ï¼›</li><li>-i ï¼šè‹¥ç›®æ ‡æ–‡ä»¶ (destination) å·²ç»å­˜åœ¨æ—¶ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–ï¼</li><li>-u ï¼šè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸” source æ¯”è¾ƒæ–°ï¼Œæ‰ä¼šå‡çº§ (update)</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶åˆ°å½“å‰ç›®å½•</span><br>[root@kuangshen home]# cp /root/install.sh /home<br><br><span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ <span class="hljs-built_in">test</span></span><br>[root@kuangshen home]# mkdir test<br><br><span class="hljs-meta">#</span><span class="bash"> å°†å¤åˆ¶è¿‡æ¥çš„æ–‡ä»¶ç§»åŠ¨åˆ°æˆ‘ä»¬åˆ›å»ºçš„ç›®å½•ï¼Œå¹¶æŸ¥çœ‹</span><br>[root@kuangshen home]# mv install.sh test<br>[root@kuangshen home]# ls<br>test<br>[root@kuangshen home]# cd test<br>[root@kuangshen test]# ls<br>install.sh<br><br><span class="hljs-meta">#</span><span class="bash"> å°†æ–‡ä»¶å¤¹é‡å‘½åï¼Œç„¶åå†æ¬¡æŸ¥çœ‹ï¼</span><br>[root@kuangshen test]# cd ..<br>[root@kuangshen home]# mv test mvtest<br>[root@kuangshen home]# ls<br>mvtest<br></code></pre></td></tr></table></figure><h1 id="åŸºæœ¬å±æ€§"><a href="#åŸºæœ¬å±æ€§" class="headerlink" title="åŸºæœ¬å±æ€§"></a>åŸºæœ¬å±æ€§</h1><h2 id="çœ‹æ‡‚æ–‡ä»¶å±æ€§"><a href="#çœ‹æ‡‚æ–‡ä»¶å±æ€§" class="headerlink" title="çœ‹æ‡‚æ–‡ä»¶å±æ€§"></a>çœ‹æ‡‚æ–‡ä»¶å±æ€§</h2><p>Linuxç³»ç»Ÿæ˜¯ä¸€ç§å…¸å‹çš„å¤šç”¨æˆ·ç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·å¤„äºä¸åŒçš„åœ°ä½ï¼Œæ‹¥æœ‰ä¸åŒçš„æƒé™ã€‚ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼ŒLinuxç³»ç»Ÿå¯¹ä¸åŒçš„ç”¨æˆ·è®¿é—®åŒä¸€æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•æ–‡ä»¶ï¼‰çš„æƒé™åšäº†ä¸åŒçš„è§„å®šã€‚</p><p>åœ¨Linuxä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>ll</code>æˆ–è€…<code>ls â€“l</code>å‘½ä»¤æ¥æ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶çš„å±æ€§ä»¥åŠæ–‡ä»¶æ‰€å±çš„ç”¨æˆ·å’Œç»„ï¼Œå¦‚ï¼š</p><p><img src="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/image-20210218113008568.png" alt="image-20210218113008568"></p><p>åœ¨Linuxä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨è¿™ä¸ªæ–‡ä»¶æ˜¯ç›®å½•ã€æ–‡ä»¶æˆ–é“¾æ¥æ–‡ä»¶ç­‰ç­‰ï¼š</p><ul><li>å½“ä¸º[ <strong>d</strong> ]åˆ™æ˜¯ç›®å½•</li><li>å½“ä¸º[ <strong>-</strong> ]åˆ™æ˜¯æ–‡ä»¶ï¼›</li><li>è‹¥æ˜¯[ <strong>l</strong> ]åˆ™è¡¨ç¤ºä¸ºé“¾æ¥æ–‡æ¡£ ( link file )ï¼›</li><li>è‹¥æ˜¯[ <strong>b</strong> ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æ¥å£è®¾å¤‡ ( å¯éšæœºå­˜å–è£…ç½® )ï¼›</li><li>è‹¥æ˜¯[ <strong>c</strong> ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡ ( ä¸€æ¬¡æ€§è¯»å–è£…ç½® )ã€‚</li></ul><p>æ¥ä¸‹æ¥çš„å­—ç¬¦ä¸­ï¼Œä»¥ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œä¸”å‡ä¸ºã€rwxã€ çš„ä¸‰ä¸ªå‚æ•°çš„ç»„åˆã€‚</p><p>å…¶ä¸­ï¼Œ[ r ]ä»£è¡¨å¯è¯»(read)ã€[ w ]ä»£è¡¨å¯å†™(write)ã€[ x ]ä»£è¡¨å¯æ‰§è¡Œ(execute)ã€‚</p><p>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ªæƒé™çš„ä½ç½®ä¸ä¼šæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æƒé™ï¼Œå°±ä¼šå‡ºç°å‡å·[ - ]è€Œå·²ã€‚</p><p>æ¯ä¸ªæ–‡ä»¶çš„å±æ€§ç”±å·¦è¾¹ç¬¬ä¸€éƒ¨åˆ†çš„10ä¸ªå­—ç¬¦æ¥ç¡®å®š</p><p><img src="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/640.jpg"></p><p>ä»å·¦è‡³å³ç”¨0-9è¿™äº›æ•°å­—æ¥è¡¨ç¤ºã€‚</p><p>ç¬¬0ä½ç¡®å®šæ–‡ä»¶ç±»å‹ï¼Œç¬¬1-3ä½ç¡®å®šå±ä¸»ï¼ˆè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼‰æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ã€‚ç¬¬4-6ä½ç¡®å®šå±ç»„ï¼ˆæ‰€æœ‰è€…çš„åŒç»„ç”¨æˆ·ï¼‰æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ï¼Œç¬¬7-9ä½ç¡®å®šå…¶ä»–ç”¨æˆ·æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ã€‚</p><p>å…¶ä¸­ï¼š</p><p>ç¬¬1ã€4ã€7ä½è¡¨ç¤ºè¯»æƒé™ï¼Œå¦‚æœç”¨â€râ€å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æœ‰è¯»æƒé™ï¼Œå¦‚æœç”¨â€-â€œå­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æ²¡æœ‰è¯»æƒé™ï¼›</p><p>ç¬¬2ã€5ã€8ä½è¡¨ç¤ºå†™æƒé™ï¼Œå¦‚æœç”¨â€wâ€å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æœ‰å†™æƒé™ï¼Œå¦‚æœç”¨â€-â€œå­—ç¬¦è¡¨ç¤ºæ²¡æœ‰å†™æƒé™ï¼›</p><p>ç¬¬3ã€6ã€9ä½è¡¨ç¤ºå¯æ‰§è¡Œæƒé™ï¼Œå¦‚æœç”¨â€xâ€å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æœ‰æ‰§è¡Œæƒé™ï¼Œå¦‚æœç”¨â€-â€œå­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æ²¡æœ‰æ‰§è¡Œæƒé™ã€‚</p><p>å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œå®ƒéƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„æ‰€æœ‰è€…ï¼Œä¹Ÿå°±æ˜¯å¯¹è¯¥æ–‡ä»¶å…·æœ‰æ‰€æœ‰æƒçš„ç”¨æˆ·ã€‚</p><p>åŒæ—¶ï¼Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æ˜¯æŒ‰ç»„åˆ†ç±»çš„ï¼Œä¸€ä¸ªç”¨æˆ·å±äºä¸€ä¸ªæˆ–å¤šä¸ªç»„ã€‚</p><p>æ–‡ä»¶æ‰€æœ‰è€…ä»¥å¤–çš„ç”¨æˆ·åˆå¯ä»¥åˆ†ä¸ºæ–‡ä»¶æ‰€æœ‰è€…çš„åŒç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·ã€‚</p><p>å› æ­¤ï¼ŒLinuxç³»ç»ŸæŒ‰æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶æ‰€æœ‰è€…åŒç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·æ¥è§„å®šäº†ä¸åŒçš„æ–‡ä»¶è®¿é—®æƒé™ã€‚</p><h2 id="ä¿®æ”¹æ–‡ä»¶å±æ€§"><a href="#ä¿®æ”¹æ–‡ä»¶å±æ€§" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶å±æ€§"></a>ä¿®æ”¹æ–‡ä»¶å±æ€§</h2><p><strong>1ã€chgrpï¼šæ›´æ”¹æ–‡ä»¶å±ç»„</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">chgrp [-R] å±ç»„å æ–‡ä»¶å<br></code></pre></td></tr></table></figure><p>-Rï¼šé€’å½’æ›´æ”¹æ–‡ä»¶å±ç»„ï¼Œå°±æ˜¯åœ¨æ›´æ”¹æŸä¸ªç›®å½•æ–‡ä»¶çš„å±ç»„æ—¶ï¼Œå¦‚æœåŠ ä¸Š-Rçš„å‚æ•°ï¼Œé‚£ä¹ˆè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„å±ç»„éƒ½ä¼šæ›´æ”¹ã€‚</p><p><strong>2ã€chownï¼šæ›´æ”¹æ–‡ä»¶å±ä¸»ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ›´æ”¹æ–‡ä»¶å±ç»„</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">chown [â€“R] å±ä¸»å æ–‡ä»¶å<br>chown [-R] å±ä¸»åï¼šå±ç»„å æ–‡ä»¶å<br></code></pre></td></tr></table></figure><p><strong>3ã€chmodï¼šæ›´æ”¹æ–‡ä»¶9ä¸ªå±æ€§</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod [-R] xyz æ–‡ä»¶æˆ–ç›®å½•<br></code></pre></td></tr></table></figure><p>Linuxæ–‡ä»¶å±æ€§æœ‰ä¸¤ç§è®¾ç½®æ–¹æ³•ï¼Œä¸€ç§æ˜¯æ•°å­—ï¼Œä¸€ç§æ˜¯ç¬¦å·ã€‚</p><p>Linuxæ–‡ä»¶çš„åŸºæœ¬æƒé™å°±æœ‰ä¹ä¸ªï¼Œåˆ†åˆ«æ˜¯owner/group/othersä¸‰ç§èº«ä»½å„æœ‰è‡ªå·±çš„read/write/executeæƒé™ã€‚</p><p>å…ˆå¤ä¹ ä¸€ä¸‹åˆšåˆšä¸Šé¢æåˆ°çš„æ•°æ®ï¼šæ–‡ä»¶çš„æƒé™å­—ç¬¦ä¸ºï¼šã€-rwxrwxrwxã€ï¼Œ è¿™ä¹ä¸ªæƒé™æ˜¯ä¸‰ä¸ªä¸‰ä¸ªä¸€ç»„çš„ï¼å…¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°å­—æ¥ä»£è¡¨å„ä¸ªæƒé™ï¼Œå„æƒé™çš„åˆ†æ•°å¯¹ç…§è¡¨å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">r:4     w:2         x:1<br></code></pre></td></tr></table></figure><p>æ¯ç§èº«ä»½(owner/group/others)å„è‡ªçš„ä¸‰ä¸ªæƒé™(r/w/x)åˆ†æ•°æ˜¯éœ€è¦ç´¯åŠ çš„ï¼Œä¾‹å¦‚å½“æƒé™ä¸ºï¼š[-rwxrwxâ€”] åˆ†æ•°åˆ™æ˜¯ï¼š</p><ul><li><p>owner = rwx = 4+2+1 = 7</p></li><li><p>group = rwx = 4+2+1 = 7</p></li><li><p>others= â€” = 0+0+0 = 0</p><p>æ‰€ä»¥777æ˜¯æ–‡ä»¶æœ€é«˜æƒé™</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod 770 filename<br></code></pre></td></tr></table></figure><h1 id="æ–‡ä»¶å†…å®¹æŸ¥çœ‹"><a href="#æ–‡ä»¶å†…å®¹æŸ¥çœ‹" class="headerlink" title="æ–‡ä»¶å†…å®¹æŸ¥çœ‹"></a>æ–‡ä»¶å†…å®¹æŸ¥çœ‹</h1><p>Linuxç³»ç»Ÿä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ï¼š</p><ul><li>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li><li>tac ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ï¼</li><li>nl  æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºé“è¾“å‡ºè¡Œå·ï¼</li><li>more ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li><li>less ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥å¾€å‰ç¿»é¡µï¼</li><li>head åªçœ‹å¤´å‡ è¡Œ</li><li>tail åªçœ‹å°¾å·´å‡ è¡Œ</li></ul><p>ä½ å¯ä»¥ä½¿ç”¨ *man [å‘½ä»¤]*æ¥æŸ¥çœ‹å„ä¸ªå‘½ä»¤çš„ä½¿ç”¨æ–‡æ¡£ï¼Œå¦‚ ï¼šman cpã€‚</p><h2 id="cat-ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹"><a href="#cat-ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹" class="headerlink" title="cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹"></a>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat [-AbEnTv]<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-A ï¼šç›¸å½“æ–¼ -vET çš„æ•´åˆé€‰é¡¹ï¼Œå¯åˆ—å‡ºä¸€äº›ç‰¹æ®Šå­—ç¬¦è€Œä¸æ˜¯ç©ºç™½è€Œå·²ï¼›</li><li>-b ï¼šåˆ—å‡ºè¡Œå·ï¼Œä»…é’ˆå¯¹éç©ºç™½è¡Œåšè¡Œå·æ˜¾ç¤ºï¼Œç©ºç™½è¡Œä¸æ ‡è¡Œå·ï¼</li><li>-E ï¼šå°†ç»“å°¾çš„æ–­è¡Œå­—èŠ‚ $ æ˜¾ç¤ºå‡ºæ¥ï¼›</li><li>-n ï¼šåˆ—å°å‡ºè¡Œå·ï¼Œè¿åŒç©ºç™½è¡Œä¹Ÿä¼šæœ‰è¡Œå·ï¼Œä¸ -b çš„é€‰é¡¹ä¸åŒï¼›</li><li>-T ï¼šå°† [tab] æŒ‰é”®ä»¥ ^I æ˜¾ç¤ºå‡ºæ¥ï¼›</li><li>-v ï¼šåˆ—å‡ºä¸€äº›çœ‹ä¸å‡ºæ¥çš„ç‰¹æ®Šå­—ç¬¦</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹ç½‘ç»œé…ç½®: æ–‡ä»¶åœ°å€ /etc/sysconfig/network-scripts/</span><br>[root@kuangshen ~]# cat /etc/sysconfig/network-scripts/ifcfg-eth0<br>DEVICE=eth0<br>BOOTPROTO=dhcp<br>ONBOOT=yes<br></code></pre></td></tr></table></figure><h2 id="tac"><a href="#tac" class="headerlink" title="tac"></a>tac</h2><p>tacä¸catå‘½ä»¤åˆšå¥½ç›¸åï¼Œæ–‡ä»¶å†…å®¹ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ï¼å¦‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen ~]# tac /etc/sysconfig/network-scripts/ifcfg-eth0<br>ONBOOT=yes<br>BOOTPROTO=dhcp<br>DEVICE=eth0<br></code></pre></td></tr></table></figure><h2 id="nl-æ˜¾ç¤ºè¡Œå·"><a href="#nl-æ˜¾ç¤ºè¡Œå·" class="headerlink" title="nl  æ˜¾ç¤ºè¡Œå·"></a>nl  æ˜¾ç¤ºè¡Œå·</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nl [-bnw] æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-b ï¼šæŒ‡å®šè¡Œå·æŒ‡å®šçš„æ–¹å¼ï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š-b a ï¼šè¡¨ç¤ºä¸è®ºæ˜¯å¦ä¸ºç©ºè¡Œï¼Œä¹ŸåŒæ ·åˆ—å‡ºè¡Œå·(ç±»ä¼¼ cat -n)ï¼›-b t ï¼šå¦‚æœæœ‰ç©ºè¡Œï¼Œç©ºçš„é‚£ä¸€è¡Œä¸è¦åˆ—å‡ºè¡Œå·(é»˜è®¤å€¼)ï¼›</li><li>-n ï¼šåˆ—å‡ºè¡Œå·è¡¨ç¤ºçš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼š-n ln ï¼šè¡Œå·åœ¨è§å¹•çš„æœ€å·¦æ–¹æ˜¾ç¤ºï¼›-n rn ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”ä¸åŠ  0 ï¼›-n rz ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”åŠ  0 ï¼›</li><li>-w ï¼šè¡Œå·æ ä½çš„å ç”¨çš„ä½æ•°ã€‚</li></ul><p>æµ‹è¯•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen ~]# nl /etc/sysconfig/network-scripts/ifcfg-eth0<br>1DEVICE=eth0<br>2BOOTPROTO=dhcp<br>3ONBOOT=yes<br></code></pre></td></tr></table></figure><h2 id="more-ä¸€é¡µä¸€é¡µç¿»åŠ¨"><a href="#more-ä¸€é¡µä¸€é¡µç¿»åŠ¨" class="headerlink" title="more  ä¸€é¡µä¸€é¡µç¿»åŠ¨"></a>more  ä¸€é¡µä¸€é¡µç¿»åŠ¨</h2><p>åœ¨ more è¿™ä¸ªç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä½ æœ‰å‡ ä¸ªæŒ‰é”®å¯ä»¥æŒ‰çš„ï¼š</p><ul><li>ç©ºç™½é”® (space)ï¼šä»£è¡¨å‘ä¸‹ç¿»ä¸€é¡µï¼›</li><li>Enter   ï¼šä»£è¡¨å‘ä¸‹ç¿»ã€ä¸€è¡Œã€ï¼›</li><li>/å­—ä¸²   ï¼šä»£è¡¨åœ¨è¿™ä¸ªæ˜¾ç¤ºçš„å†…å®¹å½“ä¸­ï¼Œå‘ä¸‹æœå¯»ã€å­—ä¸²ã€è¿™ä¸ªå…³é”®å­—ï¼›</li><li>:f    ï¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¡£åä»¥åŠç›®å‰æ˜¾ç¤ºçš„è¡Œæ•°ï¼›</li><li>q    ï¼šä»£è¡¨ç«‹åˆ»ç¦»å¼€ more ï¼Œä¸å†æ˜¾ç¤ºè¯¥æ–‡ä»¶å†…å®¹ã€‚</li><li>b æˆ– [ctrl]-b ï¼šä»£è¡¨å¾€å›ç¿»é¡µï¼Œä¸è¿‡è¿™åŠ¨ä½œåªå¯¹æ–‡ä»¶æœ‰ç”¨ï¼Œå¯¹ç®¡çº¿æ— ç”¨ã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen etc]# more /etc/csh.login<br>....(ä¸­é—´çœç•¥)....<br><span class="hljs-meta">--More--(28%</span><span class="bash">) <span class="hljs-comment"># é‡ç‚¹åœ¨è¿™ä¸€è¡Œå–”ï¼ä½ çš„å…‰æ ‡ä¹Ÿä¼šåœ¨è¿™é‡Œç­‰å¾…ä½ çš„å‘½ä»¤</span></span><br></code></pre></td></tr></table></figure><h2 id="less-ä¸€é¡µä¸€é¡µç¿»åŠ¨"><a href="#less-ä¸€é¡µä¸€é¡µç¿»åŠ¨" class="headerlink" title="less  ä¸€é¡µä¸€é¡µç¿»åŠ¨"></a>less  ä¸€é¡µä¸€é¡µç¿»åŠ¨</h2><p>ä»¥ä¸‹å®ä¾‹è¾“å‡º/etc/man.configæ–‡ä»¶çš„å†…å®¹ï¼š</p><p>lessè¿è¡Œæ—¶å¯ä»¥è¾“å…¥çš„å‘½ä»¤æœ‰ï¼š</p><ul><li>ç©ºç™½é”®  ï¼šå‘ä¸‹ç¿»åŠ¨ä¸€é¡µï¼›</li><li>[pagedown]ï¼šå‘ä¸‹ç¿»åŠ¨ä¸€é¡µï¼›</li><li>[pageup] ï¼šå‘ä¸Šç¿»åŠ¨ä¸€é¡µï¼›</li><li>/å­—ä¸²  ï¼šå‘ä¸‹æœå¯»ã€å­—ä¸²ã€çš„åŠŸèƒ½ï¼›</li><li>?å­—ä¸²  ï¼šå‘ä¸Šæœå¯»ã€å­—ä¸²ã€çš„åŠŸèƒ½ï¼›</li><li>n   ï¼šé‡å¤å‰ä¸€ä¸ªæœå¯» (ä¸ / æˆ– ? æœ‰å…³ï¼)</li><li>N   ï¼šåå‘çš„é‡å¤å‰ä¸€ä¸ªæœå¯» (ä¸ / æˆ– ? æœ‰å…³ï¼)</li><li>q   ï¼šç¦»å¼€ less è¿™ä¸ªç¨‹åºï¼›</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen etc]# more /etc/csh.login<br>....(ä¸­é—´çœç•¥)....<br>:   # è¿™é‡Œå¯ä»¥ç­‰å¾…ä½ è¾“å…¥å‘½ä»¤ï¼<br></code></pre></td></tr></table></figure><h2 id="head-å–å‡ºæ–‡ä»¶å‰é¢å‡ è¡Œ"><a href="#head-å–å‡ºæ–‡ä»¶å‰é¢å‡ è¡Œ" class="headerlink" title="head  å–å‡ºæ–‡ä»¶å‰é¢å‡ è¡Œ"></a>head  å–å‡ºæ–‡ä»¶å‰é¢å‡ è¡Œ</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">head [-n number] æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š**-n** åé¢æ¥æ•°å­—ï¼Œä»£è¡¨æ˜¾ç¤ºå‡ è¡Œçš„æ„æ€ï¼</p><p>é»˜è®¤çš„æƒ…å†µä¸­ï¼Œæ˜¾ç¤ºå‰é¢ 10 è¡Œï¼è‹¥è¦æ˜¾ç¤ºå‰ 20 è¡Œï¼Œå°±å¾—è¦è¿™æ ·ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen etc]# head -n 20 /etc/csh.login<br></code></pre></td></tr></table></figure><h2 id="tail-å–å‡ºæ–‡ä»¶åé¢å‡ è¡Œ"><a href="#tail-å–å‡ºæ–‡ä»¶åé¢å‡ è¡Œ" class="headerlink" title="tail  å–å‡ºæ–‡ä»¶åé¢å‡ è¡Œ"></a>tail  å–å‡ºæ–‡ä»¶åé¢å‡ è¡Œ</h2><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tail [-n number] æ–‡ä»¶<br></code></pre></td></tr></table></figure><p>é€‰é¡¹ä¸å‚æ•°ï¼š</p><ul><li>-n ï¼šåé¢æ¥æ•°å­—ï¼Œä»£è¡¨æ˜¾ç¤ºå‡ è¡Œçš„æ„æ€</li></ul><p>é»˜è®¤çš„æƒ…å†µä¸­ï¼Œæ˜¾ç¤ºæœ€å 10 è¡Œï¼è‹¥è¦æ˜¾ç¤ºæœ€å 20 è¡Œï¼Œå°±å¾—è¦è¿™æ ·ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen etc]# tail -n 20 /etc/csh.login<br></code></pre></td></tr></table></figure><h1 id="æ‹“å±•ï¼šLinux-é“¾æ¥æ¦‚å¿µ"><a href="#æ‹“å±•ï¼šLinux-é“¾æ¥æ¦‚å¿µ" class="headerlink" title="æ‹“å±•ï¼šLinux é“¾æ¥æ¦‚å¿µ"></a>æ‹“å±•ï¼šLinux é“¾æ¥æ¦‚å¿µ</h1><p>Linux é“¾æ¥åˆ†ä¸¤ç§ï¼Œä¸€ç§è¢«ç§°ä¸ºç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰ï¼Œå¦ä¸€ç§è¢«ç§°ä¸ºç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰ã€‚</p><p>æƒ…å†µä¸‹ï¼Œ<strong>ln</strong> å‘½ä»¤äº§ç”Ÿç¡¬é“¾æ¥ã€‚</p><h2 id="ç¡¬è¿æ¥"><a href="#ç¡¬è¿æ¥" class="headerlink" title="ç¡¬è¿æ¥"></a><strong>ç¡¬è¿æ¥</strong></h2><p>ç¡¬è¿æ¥æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œè¿æ¥ã€‚åœ¨ Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹å·(Inode Index)ã€‚åœ¨ Linux ä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹æ˜¯å­˜åœ¨çš„ã€‚æ¯”å¦‚ï¼šA æ˜¯ B çš„ç¡¬é“¾æ¥ï¼ˆA å’Œ B éƒ½æ˜¯æ–‡ä»¶åï¼‰ï¼Œåˆ™ A çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ä¸ B çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ç›¸åŒï¼Œå³ä¸€ä¸ª inode èŠ‚ç‚¹å¯¹åº”ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶åï¼Œä¸¤ä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ï¼ŒA å’Œ B å¯¹æ–‡ä»¶ç³»ç»Ÿæ¥è¯´æ˜¯å®Œå…¨å¹³ç­‰çš„ã€‚åˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ªéƒ½ä¸ä¼šå½±å“å¦å¤–ä¸€ä¸ªçš„è®¿é—®ã€‚</p><p>ç¡¬è¿æ¥çš„ä½œç”¨æ˜¯å…è®¸ä¸€ä¸ªæ–‡ä»¶æ‹¥æœ‰å¤šä¸ªæœ‰æ•ˆè·¯å¾„åï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å»ºç«‹ç¡¬è¿æ¥åˆ°é‡è¦æ–‡ä»¶ï¼Œä»¥é˜²æ­¢â€œè¯¯åˆ â€çš„åŠŸèƒ½ã€‚å…¶åŸå› å¦‚ä¸Šæ‰€è¿°ï¼Œå› ä¸ºå¯¹åº”è¯¥ç›®å½•çš„ç´¢å¼•èŠ‚ç‚¹æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¿æ¥ã€‚åªåˆ é™¤ä¸€ä¸ªè¿æ¥å¹¶ä¸å½±å“ç´¢å¼•èŠ‚ç‚¹æœ¬èº«å’Œå…¶å®ƒçš„è¿æ¥ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªè¿æ¥è¢«åˆ é™¤åï¼Œæ–‡ä»¶çš„æ•°æ®å—åŠç›®å½•çš„è¿æ¥æ‰ä¼šè¢«é‡Šæ”¾ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶çœŸæ­£åˆ é™¤çš„æ¡ä»¶æ˜¯ä¸ä¹‹ç›¸å…³çš„æ‰€æœ‰ç¡¬è¿æ¥æ–‡ä»¶å‡è¢«åˆ é™¤ã€‚</p><h2 id="è½¯è¿æ¥"><a href="#è½¯è¿æ¥" class="headerlink" title="è½¯è¿æ¥"></a><strong>è½¯è¿æ¥</strong></h2><p>å¦å¤–ä¸€ç§è¿æ¥ç§°ä¹‹ä¸ºç¬¦å·è¿æ¥ï¼ˆSymbolic Linkï¼‰ï¼Œä¹Ÿå«è½¯è¿æ¥ã€‚è½¯é“¾æ¥æ–‡ä»¶æœ‰ç±»ä¼¼äº Windows çš„å¿«æ·æ–¹å¼ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ã€‚åœ¨ç¬¦å·è¿æ¥ä¸­ï¼Œæ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«çš„æœ‰å¦ä¸€æ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ã€‚æ¯”å¦‚ï¼šA æ˜¯ B çš„è½¯é“¾æ¥ï¼ˆA å’Œ B éƒ½æ˜¯æ–‡ä»¶åï¼‰ï¼ŒA çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ä¸ B çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ä¸ç›¸åŒï¼ŒA å’Œ B æŒ‡å‘çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„ inodeï¼Œç»§è€ŒæŒ‡å‘ä¸¤å—ä¸åŒçš„æ•°æ®å—ã€‚ä½†æ˜¯ A çš„æ•°æ®å—ä¸­å­˜æ”¾çš„åªæ˜¯ B çš„è·¯å¾„åï¼ˆå¯ä»¥æ ¹æ®è¿™ä¸ªæ‰¾åˆ° B çš„ç›®å½•é¡¹ï¼‰ã€‚A å’Œ B ä¹‹é—´æ˜¯â€œä¸»ä»â€å…³ç³»ï¼Œå¦‚æœ B è¢«åˆ é™¤äº†ï¼ŒA ä»ç„¶å­˜åœ¨ï¼ˆå› ä¸ºä¸¤ä¸ªæ˜¯ä¸åŒçš„æ–‡ä»¶ï¼‰ï¼Œä½†æŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ— æ•ˆçš„é“¾æ¥ã€‚</p><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@kuangshen /]# cd /home<br>[root@kuangshen home]# touch f1 # åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶f1<br>[root@kuangshen home]# ls<br>f1<br>[root@kuangshen home]# ln f1 f2     # åˆ›å»ºf1çš„ä¸€ä¸ªç¡¬è¿æ¥æ–‡ä»¶f2<br>[root@kuangshen home]# ln -s f1 f3   # åˆ›å»ºf1çš„ä¸€ä¸ªç¬¦å·è¿æ¥æ–‡ä»¶f3<br>[root@kuangshen home]# ls -li       # -iå‚æ•°æ˜¾ç¤ºæ–‡ä»¶çš„inodeèŠ‚ç‚¹ä¿¡æ¯<br>397247 -rw-r--r-- 2 root root     0 Mar 13 00:50 f1<br>397247 -rw-r--r-- 2 root root     0 Mar 13 00:50 f2<br>397248 lrwxrwxrwx 1 root root     2 Mar 13 00:50 f3 -&gt; f1<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œç¡¬è¿æ¥æ–‡ä»¶ f2 ä¸åŸæ–‡ä»¶ f1 çš„ inode èŠ‚ç‚¹ç›¸åŒï¼Œå‡ä¸º 397247ï¼Œç„¶è€Œç¬¦å·è¿æ¥æ–‡ä»¶çš„ inode èŠ‚ç‚¹ä¸åŒã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">echo</span> å­—ç¬¦ä¸²è¾“å‡º &gt;&gt; f1 è¾“å‡ºåˆ° f1æ–‡ä»¶</span><br>[root@kuangshen home]# echo &quot;I am f1 file&quot; &gt;&gt;f1<br>[root@kuangshen home]# cat f1<br>I am f1 file<br>[root@kuangshen home]# cat f2<br>I am f1 file<br>[root@kuangshen home]# cat f3<br>I am f1 file<br>[root@kuangshen home]# rm -f f1<br>[root@kuangshen home]# cat f2<br>I am f1 file<br>[root@kuangshen home]# cat f3<br>cat: f3: No such file or directory<br></code></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢çš„æµ‹è¯•å¯ä»¥çœ‹å‡ºï¼šå½“åˆ é™¤åŸå§‹æ–‡ä»¶ f1 åï¼Œç¡¬è¿æ¥ f2 ä¸å—å½±å“ï¼Œä½†æ˜¯ç¬¦å·è¿æ¥ f1 æ–‡ä»¶æ— æ•ˆï¼›</p><p>ä¾æ­¤å¯ä»¥åšä¸€äº›ç›¸å…³çš„æµ‹è¯•ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å…¨éƒ¨ç»“è®ºï¼š</p><ul><li>åˆ é™¤ç¬¦å·è¿æ¥f3,å¯¹f1,f2æ— å½±å“ï¼›</li><li>åˆ é™¤ç¡¬è¿æ¥f2ï¼Œå¯¹f1,f3ä¹Ÿæ— å½±å“ï¼›</li><li>åˆ é™¤åŸæ–‡ä»¶f1ï¼Œå¯¹ç¡¬è¿æ¥f2æ²¡æœ‰å½±å“ï¼Œå¯¼è‡´ç¬¦å·è¿æ¥f3å¤±æ•ˆï¼›</li><li>åŒæ—¶åˆ é™¤åŸæ–‡ä»¶f1,ç¡¬è¿æ¥f2ï¼Œæ•´ä¸ªæ–‡ä»¶ä¼šçœŸæ­£çš„è¢«åˆ é™¤ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>Linuxç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxç³»ç»Ÿäº†è§£</title>
    <link href="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E7%B3%BB%E7%BB%9F%E4%BA%86%E8%A7%A3/"/>
    <url>/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E7%B3%BB%E7%BB%9F%E4%BA%86%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼€æœºç™»å½•"><a href="#å¼€æœºç™»å½•" class="headerlink" title="å¼€æœºç™»å½•"></a>å¼€æœºç™»å½•</h1><p>å¼€æœºä¼šå¯åŠ¨è®¸å¤šç¨‹åºã€‚å®ƒä»¬åœ¨Windowså«åšâ€æœåŠ¡â€ï¼ˆserviceï¼‰ï¼Œåœ¨Linuxå°±å«åšâ€å®ˆæŠ¤è¿›ç¨‹â€ï¼ˆdaemonï¼‰ã€‚</p><p>å¼€æœºæˆåŠŸåï¼Œå®ƒä¼šæ˜¾ç¤ºä¸€ä¸ªæ–‡æœ¬ç™»å½•ç•Œé¢ï¼Œè¿™ä¸ªç•Œé¢å°±æ˜¯æˆ‘ä»¬ç»å¸¸çœ‹åˆ°çš„ç™»å½•ç•Œé¢ï¼Œåœ¨è¿™ä¸ªç™»å½•ç•Œé¢ä¸­ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç”¨æˆ·åï¼Œè€Œç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·å°†ä½œä¸ºå‚æ•°ä¼ ç»™loginç¨‹åºæ¥éªŒè¯ç”¨æˆ·çš„èº«ä»½ï¼Œå¯†ç æ˜¯ä¸æ˜¾ç¤ºçš„ï¼Œè¾“å®Œå›è½¦å³å¯ï¼</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·çš„ç™»å½•æ–¹å¼æœ‰ä¸‰ç§ï¼š</p><ul><li>å‘½ä»¤è¡Œç™»å½•</li><li>sshç™»å½•</li><li>å›¾å½¢ç•Œé¢ç™»å½•</li></ul><p>æœ€é«˜æƒé™è´¦æˆ·ä¸º rootï¼Œå¯ä»¥æ“ä½œä¸€åˆ‡ï¼</p><h1 id="å…³æœº"><a href="#å…³æœº" class="headerlink" title="å…³æœº"></a>å…³æœº</h1><p>åœ¨linuxé¢†åŸŸå†…å¤§å¤šç”¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¾ˆå°‘é‡åˆ°å…³æœºçš„æ“ä½œã€‚æ¯•ç«ŸæœåŠ¡å™¨ä¸Šè·‘ä¸€ä¸ªæœåŠ¡æ˜¯æ°¸æ— æ­¢å¢ƒçš„ï¼Œé™¤éç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¸å¾—å·²æ‰ä¼šå…³æœºã€‚</p><p>å…³æœºæŒ‡ä»¤ä¸ºï¼šshutdown ï¼›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">sync # å°†æ•°æ®ç”±å†…å­˜åŒæ­¥åˆ°ç¡¬ç›˜ä¸­ã€‚<br><br>shutdown # å…³æœºæŒ‡ä»¤ï¼Œä½ å¯ä»¥man shutdown æ¥çœ‹ä¸€ä¸‹å¸®åŠ©æ–‡æ¡£ã€‚ä¾‹å¦‚ä½ å¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å…³æœºï¼š<br><br>shutdown â€“h 10 # è¿™ä¸ªå‘½ä»¤å‘Šè¯‰å¤§å®¶ï¼Œè®¡ç®—æœºå°†åœ¨10åˆ†é’Ÿåå…³æœº<br><br>shutdown â€“h now # ç«‹é©¬å…³æœº<br><br>shutdown â€“h 20:25 # ç³»ç»Ÿä¼šåœ¨ä»Šå¤©20:25å…³æœº<br><br>shutdown â€“h +10 # ååˆ†é’Ÿåå…³æœº<br><br>shutdown â€“r now # ç³»ç»Ÿç«‹é©¬é‡å¯<br><br>shutdown â€“r +10 # ç³»ç»Ÿååˆ†é’Ÿåé‡å¯<br><br>reboot # å°±æ˜¯é‡å¯ï¼Œç­‰åŒäº shutdown â€“r now<br><br>halt # å…³é—­ç³»ç»Ÿï¼Œç­‰åŒäºshutdown â€“h now å’Œ poweroff<br></code></pre></td></tr></table></figure><p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼Œä¸ç®¡æ˜¯é‡å¯ç³»ç»Ÿè¿˜æ˜¯å…³é—­ç³»ç»Ÿï¼Œé¦–å…ˆè¦è¿è¡Œ <strong>sync</strong> å‘½ä»¤ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®å†™åˆ°ç£ç›˜ä¸­ã€‚</p><h1 id="ç³»ç»Ÿç›®å½•ç»“æ„"><a href="#ç³»ç»Ÿç›®å½•ç»“æ„" class="headerlink" title="ç³»ç»Ÿç›®å½•ç»“æ„"></a>ç³»ç»Ÿç›®å½•ç»“æ„</h1><p>ç™»å½•ç³»ç»Ÿåï¼Œåœ¨å½“å‰å‘½ä»¤çª—å£ä¸‹è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls /<br></code></pre></td></tr></table></figure><p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2021/02/18/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E7%B3%BB%E7%BB%9F%E4%BA%86%E8%A7%A3/image-20210218102534449.png" alt="image-20210218102534449"></p><p>ï¼ˆLinuxçš„ä¸€åˆ‡èµ„æºéƒ½æŒ‚è½½åœ¨è¿™ä¸ª / æ ¹èŠ‚ç‚¹ä¸‹ï¼‰</p><p><strong>å¯¹è¿™äº›ç›®å½•çš„è§£é‡Šï¼š</strong></p><ul><li><strong>/bin</strong>ï¼šbinæ˜¯Binaryçš„ç¼©å†™, è¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ã€‚</li><li><strong>/bootï¼š</strong> è¿™é‡Œå­˜æ”¾çš„æ˜¯å¯åŠ¨Linuxæ—¶ä½¿ç”¨çš„ä¸€äº›æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶ã€‚</li><li><strong>/dev ï¼š</strong> devæ˜¯Device(è®¾å¤‡)çš„ç¼©å†™, å­˜æ”¾çš„æ˜¯Linuxçš„å¤–éƒ¨è®¾å¤‡ï¼Œåœ¨Linuxä¸­è®¿é—®è®¾å¤‡çš„æ–¹å¼å’Œè®¿é—®æ–‡ä»¶çš„æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚</li><li><strong>/etcï¼š</strong> è¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ç³»ç»Ÿç®¡ç†æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶å’Œå­ç›®å½•ã€‚</li><li><strong>/home</strong>ï¼šç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨Linuxä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ã€‚</li><li><strong>/lib</strong>ï¼šè¿™ä¸ªç›®å½•é‡Œå­˜æ”¾ç€ç³»ç»Ÿæœ€åŸºæœ¬çš„åŠ¨æ€è¿æ¥å…±äº«åº“ï¼Œå…¶ä½œç”¨ç±»ä¼¼äºWindowsé‡Œçš„DLLæ–‡ä»¶ã€‚</li><li><strong>/lost+found</strong>ï¼šè¿™ä¸ªç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç©ºçš„ï¼Œå½“ç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾äº†ä¸€äº›æ–‡ä»¶ã€‚(æœ‰äº›ç³»ç»Ÿæ²¡æœ‰è¿™ä¸ªç›®å½•)</li><li><strong>/media</strong>ï¼šlinuxç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ä¸€äº›è®¾å¤‡ï¼Œä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œå½“è¯†åˆ«åï¼Œlinuxä¼šæŠŠè¯†åˆ«çš„è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚</li><li><strong>/mnt</strong>ï¼šç³»ç»Ÿæä¾›è¯¥ç›®å½•æ˜¯ä¸ºäº†è®©ç”¨æˆ·ä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…‰é©±æŒ‚è½½åœ¨/mnt/ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹å…‰é©±é‡Œçš„å†…å®¹äº†ã€‚</li><li><strong>/opt</strong>ï¼š<strong>è¿™æ˜¯ç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚æ¯”å¦‚ä½ å®‰è£…ä¸€ä¸ªORACLEæ•°æ®åº“åˆ™å°±å¯ä»¥æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚é»˜è®¤æ˜¯ç©ºçš„ã€‚</strong></li><li><strong>/proc</strong>ï¼šè¿™ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç›®å½•ï¼Œå®ƒæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥è·å–ç³»ç»Ÿä¿¡æ¯ã€‚</li><li><strong>/root</strong>ï¼š<strong>è¯¥ç›®å½•ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œä¹Ÿç§°ä½œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½•ã€‚</strong></li><li><strong>/sbin</strong>ï¼šså°±æ˜¯Super Userçš„æ„æ€ï¼Œè¿™é‡Œå­˜æ”¾çš„æ˜¯ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åºã€‚</li><li><strong>/srv</strong>ï¼šè¯¥ç›®å½•å­˜æ”¾ä¸€äº›æœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦æå–çš„æ•°æ®ã€‚</li><li><strong>/sys</strong>ï¼šè¿™æ˜¯linux2.6å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº†2.6å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs ã€‚</li><li><strong>/tmp</strong>ï¼š<strong>è¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„ã€‚</strong></li><li><strong>/usrï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼äºwindowsä¸‹çš„program filesç›®å½•ã€‚</strong></li><li><strong>/usr/binï¼š</strong> ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚</li><li><strong>/usr/sbinï¼š</strong> è¶…çº§ç”¨æˆ·ä½¿ç”¨çš„æ¯”è¾ƒé«˜çº§çš„ç®¡ç†ç¨‹åºå’Œç³»ç»Ÿå®ˆæŠ¤ç¨‹åºã€‚</li><li><strong>/usr/srcï¼š</strong> å†…æ ¸æºä»£ç é»˜è®¤çš„æ”¾ç½®ç›®å½•ã€‚</li><li><strong>/var</strong>ï¼š<strong>è¿™ä¸ªç›®å½•ä¸­å­˜æ”¾ç€åœ¨ä¸æ–­æ‰©å……ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†é‚£äº›ç»å¸¸è¢«ä¿®æ”¹çš„ç›®å½•æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ã€‚åŒ…æ‹¬å„ç§æ—¥å¿—æ–‡ä»¶ã€‚</strong></li><li><strong>/run</strong>ï¼šæ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ä¿¡æ¯ã€‚å½“ç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åº”è¯¥è¢«åˆ æ‰æˆ–æ¸…é™¤ã€‚</li></ul><h1 id="è·¯å¾„è§£é‡Š"><a href="#è·¯å¾„è§£é‡Š" class="headerlink" title="è·¯å¾„è§£é‡Š"></a>è·¯å¾„è§£é‡Š</h1><p>Linuxçš„ç›®å½•ç»“æ„ä¸ºæ ‘çŠ¶ç»“æ„ï¼Œæœ€é¡¶çº§çš„ç›®å½•ä¸ºæ ¹ç›®å½• /ã€‚</p><p>å…¶ä»–ç›®å½•é€šè¿‡æŒ‚è½½å¯ä»¥å°†å®ƒä»¬æ·»åŠ åˆ°æ ‘ä¸­ï¼Œé€šè¿‡è§£é™¤æŒ‚è½½å¯ä»¥ç§»é™¤å®ƒä»¬ã€‚</p><p>æˆ‘ä»¬éœ€è¦å…ˆçŸ¥é“ä»€ä¹ˆæ˜¯ç»å¯¹è·¯å¾„ä¸ç›¸å¯¹è·¯å¾„ã€‚</p><h2 id="ç»å¯¹è·¯å¾„ï¼š"><a href="#ç»å¯¹è·¯å¾„ï¼š" class="headerlink" title="ç»å¯¹è·¯å¾„ï¼š"></a><strong>ç»å¯¹è·¯å¾„ï¼š</strong></h2><p>è·¯å¾„çš„å†™æ³•ï¼Œç”±æ ¹ç›®å½• / å†™èµ·ï¼Œä¾‹å¦‚ï¼š/usr/share/doc è¿™ä¸ªç›®å½•ã€‚</p><h2 id="ç›¸å¯¹è·¯å¾„ï¼š"><a href="#ç›¸å¯¹è·¯å¾„ï¼š" class="headerlink" title="ç›¸å¯¹è·¯å¾„ï¼š"></a><strong>ç›¸å¯¹è·¯å¾„ï¼š</strong></h2><p>è·¯å¾„çš„å†™æ³•ï¼Œä¸æ˜¯ç”± / å†™èµ·ï¼Œä¾‹å¦‚ç”± /usr/share/doc è¦åˆ° /usr/share/man åº•ä¸‹æ—¶ï¼Œå¯ä»¥å†™æˆï¼šcd ../man è¿™å°±æ˜¯ç›¸å¯¹è·¯å¾„çš„å†™æ³•å•¦ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Linuxç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dubbo+Zookeeperå®‰è£…æµ‹è¯•</title>
    <link href="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/"/>
    <url>/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h1 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h1><ul><li><p>RPCã€Remote Procedure Callã€‘æ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚å®ƒå…è®¸ç¨‹åºè°ƒç”¨å¦ä¸€ä¸ªåœ°å€ç©ºé—´ï¼ˆé€šå¸¸æ˜¯å…±äº«ç½‘ç»œçš„å¦ä¸€å°æœºå™¨ä¸Šï¼‰çš„è¿‡ç¨‹æˆ–å‡½æ•°ï¼Œè€Œä¸ç”¨ç¨‹åºå‘˜æ˜¾å¼ç¼–ç è¿™ä¸ªè¿œç¨‹è°ƒç”¨çš„ç»†èŠ‚ã€‚å³ç¨‹åºå‘˜æ— è®ºæ˜¯è°ƒç”¨æœ¬åœ°çš„è¿˜æ˜¯è¿œç¨‹çš„å‡½æ•°ï¼Œæœ¬è´¨ä¸Šç¼–å†™çš„è°ƒç”¨ä»£ç åŸºæœ¬ç›¸åŒã€‚</p></li><li><p>ä¹Ÿå°±æ˜¯è¯´ä¸¤å°æœåŠ¡å™¨Aï¼ŒBï¼Œä¸€ä¸ªåº”ç”¨éƒ¨ç½²åœ¨AæœåŠ¡å™¨ä¸Šï¼Œæƒ³è¦è°ƒç”¨BæœåŠ¡å™¨ä¸Šåº”ç”¨æä¾›çš„å‡½æ•°/æ–¹æ³•ï¼Œç”±äºä¸åœ¨ä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œæ¥è¡¨è¾¾è°ƒç”¨çš„è¯­ä¹‰å’Œä¼ è¾¾è°ƒç”¨çš„æ•°æ®ã€‚ä¸ºä»€ä¹ˆè¦ç”¨RPCå‘¢ï¼Ÿå°±æ˜¯æ— æ³•åœ¨ä¸€ä¸ªè¿›ç¨‹å†…ï¼Œç”šè‡³ä¸€ä¸ªè®¡ç®—æœºå†…é€šè¿‡æœ¬åœ°è°ƒç”¨çš„æ–¹å¼å®Œæˆçš„éœ€æ±‚ï¼Œæ¯”å¦‚ä¸åŒçš„ç³»ç»Ÿé—´çš„é€šè®¯ï¼Œç”šè‡³ä¸åŒçš„ç»„ç»‡é—´çš„é€šè®¯ï¼Œç”±äºè®¡ç®—èƒ½åŠ›éœ€è¦æ¨ªå‘æ‰©å±•ï¼Œéœ€è¦åœ¨å¤šå°æœºå™¨ç»„æˆçš„é›†ç¾¤ä¸Šéƒ¨ç½²åº”ç”¨ã€‚RPCå°±æ˜¯è¦åƒè°ƒç”¨æœ¬åœ°çš„å‡½æ•°ä¸€æ ·å»è°ƒè¿œç¨‹å‡½æ•°ï¼›</p></li><li><p>æ¨èé˜…è¯»æ–‡ç« ï¼š<a href="https://www.jianshu.com/p/2accc2840a1b">https://www.jianshu.com/p/2accc2840a1b</a></p></li></ul><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/2.png"></p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/3.png"></p><p>RPCä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šé€šè®¯ï¼Œåºåˆ—åŒ–</p><h1 id="Dubboç®€ä»‹"><a href="#Dubboç®€ä»‹" class="headerlink" title="Dubboç®€ä»‹"></a>Dubboç®€ä»‹</h1><p>dubboå®˜ç½‘ <a href="http://dubbo.apache.org/zh-cn/index.html">http://dubbo.apache.org/zh-cn/index.html</a></p><p>Apache Dubbo æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava RPCæ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°ã€‚</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/1.png"></p><p><strong>æœåŠ¡æä¾›è€…</strong>ï¼ˆProviderï¼‰ï¼šæš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</p><p><strong>æœåŠ¡æ¶ˆè´¹è€…</strong>ï¼ˆConsumerï¼‰ï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</p><p><strong>æ³¨å†Œä¸­å¿ƒ</strong>ï¼ˆRegistryï¼‰ï¼šæ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…</p><p><strong>ç›‘æ§ä¸­å¿ƒ</strong>ï¼ˆMonitorï¼‰ï¼šæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒ</p><p><strong>è°ƒç”¨å…³ç³»è¯´æ˜</strong></p><ul><li><p>æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</p></li><li><p>æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</p></li><li><p>æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</p></li><li><p>æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚</p></li><li><p>æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</p></li><li><p>æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</p></li></ul><h1 id="Dubboç¯å¢ƒæ­å»º"><a href="#Dubboç¯å¢ƒæ­å»º" class="headerlink" title="Dubboç¯å¢ƒæ­å»º"></a>Dubboç¯å¢ƒæ­å»º</h1><p>ç‚¹è¿›dubboå®˜æ–¹æ–‡æ¡£ï¼Œæ¨èæˆ‘ä»¬ä½¿ç”¨Zookeeper æ³¨å†Œä¸­å¿ƒ</p><p>Zookeeperå®˜ç½‘ï¼š<a href="https://zookeeper.apache.org/">https://zookeeper.apache.org/</a></p><h1 id="Windowä¸‹å®‰è£…zookeeper"><a href="#Windowä¸‹å®‰è£…zookeeper" class="headerlink" title="Windowä¸‹å®‰è£…zookeeper"></a>Windowä¸‹å®‰è£…zookeeper</h1><p>1ã€ä¸‹è½½Zookeeperï¼Œåœ°å€ä¸º<a href="http://archive.apache.org/dist/zookeeper/%EF%BC%8C%E6%89%BE%E5%88%B0%E4%BD%A0%E8%A6%81%E4%B8%8B%E8%BD%BD%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8C%E6%88%91%E4%B8%8B%E8%BD%BD%E4%BA%86%E8%BF%99%E4%B8%AA%E7%89%88%E6%9C%ACapache-zookeeper-3.6.2-bin.tar.gz">http://archive.apache.org/dist/zookeeper/ï¼Œæ‰¾åˆ°ä½ è¦ä¸‹è½½çš„ç‰ˆæœ¬ï¼Œæˆ‘ä¸‹è½½äº†è¿™ä¸ªç‰ˆæœ¬apache-zookeeper-3.6.2-bin.tar.gz</a></p><p>2ã€è¿è¡Œ/bin/zkServer.cmd </p><p>é‡åˆ°é—®é¢˜ï¼šé—ªé€€ !</p><p>è§£å†³æ–¹æ¡ˆï¼šç¼–è¾‘zkServer.cmdæ–‡ä»¶æœ«å°¾æ·»åŠ pause ã€‚è¿™æ ·è¿è¡Œå‡ºé”™å°±ä¸ä¼šé€€å‡ºï¼Œä¼šæç¤ºé”™è¯¯ä¿¡æ¯ï¼Œæ–¹ä¾¿æ‰¾åˆ°åŸå› ã€‚</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205162644323.png" alt="image-20210205162644323"></p><p>å†æ¬¡è¿è¡Œå¯æŸ¥çœ‹é”™è¯¯æ˜¯ç¼ºå°‘zoo.cfgæ–‡ä»¶</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205162813360.png" alt="image-20210205162813360"></p><p>3ã€ä¿®æ”¹zoo.cfgé…ç½®æ–‡ä»¶</p><p>å°†confæ–‡ä»¶å¤¹ä¸‹é¢çš„zoo_sample.cfgå¤åˆ¶ä¸€ä»½æ”¹åä¸ºzoo.cfgå³å¯ã€‚</p><p>æ³¨æ„å‡ ä¸ªé‡è¦ä½ç½®ï¼š</p><p>dataDir=./  ä¸´æ—¶æ•°æ®å­˜å‚¨çš„ç›®å½•ï¼ˆå¯å†™ç›¸å¯¹è·¯å¾„ï¼‰</p><p>clientPort=2181  zookeeperçš„ç«¯å£å·</p><p>ä¿®æ”¹å®Œæˆåå†æ¬¡å¯åŠ¨zookeeper</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205163115219.png" alt="image-20210205163115219"></p><p>ä¿®æ”¹zoo.cfgä¸­çš„é…ç½®</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205210228065.png" alt="image-20210205210228065"></p><p>å‚æ•°è¯´æ˜ï¼š</p><p>tickTimeï¼šè¿™ä¸ªæ—¶é—´æ˜¯ä½œä¸º Zookeeper æœåŠ¡å™¨ä¹‹é—´æˆ–å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ç»´æŒå¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ª tickTime æ—¶é—´å°±ä¼šå‘é€ä¸€ä¸ªå¿ƒè·³ã€‚<br>initLimitï¼šè¿™ä¸ªé…ç½®é¡¹æ˜¯ç”¨æ¥é…ç½® Zookeeper æ¥å—å®¢æˆ·ç«¯ï¼ˆè¿™é‡Œæ‰€è¯´çš„å®¢æˆ·ç«¯ä¸æ˜¯ç”¨æˆ·è¿æ¥ Zookeeper æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ï¼Œè€Œæ˜¯ Zookeeper æœåŠ¡å™¨é›†ç¾¤ä¸­è¿æ¥åˆ° Leader çš„ Follower æœåŠ¡å™¨ï¼‰åˆå§‹åŒ–è¿æ¥æ—¶æœ€é•¿èƒ½å¿å—å¤šå°‘ä¸ªå¿ƒè·³æ—¶é—´é—´éš”æ•°ã€‚å½“å·²ç»è¶…è¿‡ 10 ä¸ªå¿ƒè·³çš„æ—¶é—´ï¼ˆä¹Ÿå°±æ˜¯ tickTimeï¼‰é•¿åº¦å Zookeeper æœåŠ¡å™¨è¿˜æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿”å›ä¿¡æ¯ï¼Œé‚£ä¹ˆè¡¨æ˜è¿™ä¸ªå®¢æˆ·ç«¯è¿æ¥å¤±è´¥ã€‚æ€»çš„æ—¶é—´é•¿åº¦å°±æ˜¯ 5<em>2000=10 ç§’<br>syncLimitï¼šè¿™ä¸ªé…ç½®é¡¹æ ‡è¯† Leader ä¸ Follower ä¹‹é—´å‘é€æ¶ˆæ¯ï¼Œè¯·æ±‚å’Œåº”ç­”æ—¶é—´é•¿åº¦ï¼Œæœ€é•¿ä¸èƒ½è¶…è¿‡å¤šå°‘ä¸ª tickTime çš„æ—¶é—´é•¿åº¦ï¼Œæ€»çš„æ—¶é—´é•¿åº¦å°±æ˜¯ 2</em>2000=4 ç§’<br>dataDirï¼šé¡¾åæ€ä¹‰å°±æ˜¯ Zookeeper ä¿å­˜æ•°æ®çš„ç›®å½•ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒZookeeper å°†å†™æ•°æ®çš„æ—¥å¿—æ–‡ä»¶ä¹Ÿä¿å­˜åœ¨è¿™ä¸ªç›®å½•é‡Œã€‚<br>clientPortï¼šè¿™ä¸ªç«¯å£å°±æ˜¯å®¢æˆ·ç«¯è¿æ¥ Zookeeper æœåŠ¡å™¨çš„ç«¯å£ï¼ŒZookeeper ä¼šç›‘å¬è¿™ä¸ªç«¯å£ï¼Œæ¥å—å®¢æˆ·ç«¯çš„è®¿é—®è¯·æ±‚ã€‚</p><p>é‡å¯zkServe.cmd</p><p>å‘ç°æ§åˆ¶å°è¾“å‡º ZooKeeper audit is disabled</p><p>ä¿®æ”¹zkServer.cmd:  å¦‚ä¸‹â€-Dzookeeper.audit.enable=trueâ€</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205210338696.png" alt="image-20210205210338696"></p><p>å†æ¬¡å¯åŠ¨zkServe.cmd</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205210450001.png" alt="image-20210205210450001"></p><p>ä½¿ç”¨zkCli.cmdæµ‹è¯•</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205220118339.png" alt="image-20210205220118339"></p><p>è¾“å…¥ls /  ï¼š åˆ—å‡ºzookeeperæ ¹ä¸‹ä¿å­˜çš„æ‰€æœ‰èŠ‚ç‚¹</p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/image-20210205220220014.png" alt="image-20210205220220014"></p><h1 id="SpringBoot-Dubbo-zookeeper"><a href="#SpringBoot-Dubbo-zookeeper" class="headerlink" title="SpringBoot + Dubbo + zookeeper"></a>SpringBoot + Dubbo + zookeeper</h1><h2 id="æ¡†æ¶æ­å»º"><a href="#æ¡†æ¶æ­å»º" class="headerlink" title="æ¡†æ¶æ­å»º"></a>æ¡†æ¶æ­å»º</h2><p><strong>1. å¯åŠ¨zookeeper ï¼</strong></p><p><strong>2. IDEAåˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®ï¼›</strong></p><p><strong>3.åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œå®ç°æœåŠ¡æä¾›è€…ï¼šprovider-server ï¼Œ é€‰æ‹©webä¾èµ–å³å¯</strong></p><p><strong>4.é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚å–ç¥¨çš„æœåŠ¡ï¼›</strong></p><p>ç¼–å†™æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.provider.service;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TicketService</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getTicket</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–å†™å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.provider.service;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TicketServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">TicketService</span> </span>&#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getTicket</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ã€Šç‹‚ç¥è¯´Javaã€‹&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>5.åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œå®ç°æœåŠ¡æ¶ˆè´¹è€…ï¼šconsumer-server ï¼Œ é€‰æ‹©webä¾èµ–å³å¯</strong></p><p><strong>6.é¡¹ç›®åˆ›å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·çš„æœåŠ¡ï¼›</strong></p><p>ç¼–å†™service</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.consumer.service;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserService</span> </span>&#123;<br>   <span class="hljs-comment">//æˆ‘ä»¬éœ€è¦å»æ‹¿å»æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>éœ€æ±‚ï¼šç°åœ¨æˆ‘ä»¬çš„ç”¨æˆ·æƒ³ä½¿ç”¨ä¹°ç¥¨çš„æœåŠ¡ï¼Œè¿™è¦æ€ä¹ˆå¼„å‘¢ ï¼Ÿ</strong></p><h2 id="æœåŠ¡æä¾›è€…"><a href="#æœåŠ¡æä¾›è€…" class="headerlink" title="æœåŠ¡æä¾›è€…"></a>æœåŠ¡æä¾›è€…</h2><p><strong>1ã€å°†æœåŠ¡æä¾›è€…æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘ä»¬éœ€è¦æ•´åˆDubboå’Œzookeeperï¼Œæ‰€ä»¥éœ€è¦å¯¼åŒ…</strong></p><p><strong>æˆ‘ä»¬ä»dubboå®˜ç½‘è¿›å…¥githubï¼Œçœ‹ä¸‹æ–¹çš„å¸®åŠ©æ–‡æ¡£ï¼Œæ‰¾åˆ°dubbo-springbootï¼Œæ‰¾åˆ°ä¾èµ–åŒ…</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- Dubbo Spring Boot Starter --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.dubbo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>    <br></code></pre></td></tr></table></figure><p><strong>zookeeperçš„åŒ…æˆ‘ä»¬å»mavenä»“åº“ä¸‹è½½ï¼Œzkclientï¼›</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.sgroschupf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>zkclient<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>ã€æ–°ç‰ˆçš„å‘ã€‘zookeeperåŠå…¶ä¾èµ–åŒ…ï¼Œè§£å†³æ—¥å¿—å†²çªï¼Œè¿˜éœ€è¦å‰”é™¤æ—¥å¿—ä¾èµ–ï¼›</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥zookeeper --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-framework<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-recipes<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.14<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>2ã€åœ¨springbooté…ç½®æ–‡ä»¶ä¸­é…ç½®dubboç›¸å…³å±æ€§ï¼</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#å½“å‰åº”ç”¨åå­—</span><br><span class="hljs-string">dubbo.application.name=provider-server</span><br><span class="hljs-comment">#æ³¨å†Œä¸­å¿ƒåœ°å€</span><br><span class="hljs-string">dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br><span class="hljs-comment">#æ‰«ææŒ‡å®šåŒ…ä¸‹æœåŠ¡</span><br><span class="hljs-string">dubbo.scan.base-packages=com.kuang.provider.service</span><br></code></pre></td></tr></table></figure><p><strong>3ã€åœ¨serviceçš„å®ç°ç±»ä¸­é…ç½®æœåŠ¡æ³¨è§£ï¼Œå‘å¸ƒæœåŠ¡ï¼æ³¨æ„å¯¼åŒ…é—®é¢˜</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.dubbo.config.annotation.Service;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Service</span> <span class="hljs-comment">//å°†æœåŠ¡å‘å¸ƒå‡ºå»</span><br><span class="hljs-meta">@Component</span> <span class="hljs-comment">//æ”¾åœ¨å®¹å™¨ä¸­</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TicketServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">TicketService</span> </span>&#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getTicket</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;ã€Šç‹‚ç¥è¯´Javaã€‹&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>é€»è¾‘ç†è§£ ï¼šåº”ç”¨å¯åŠ¨èµ·æ¥ï¼Œdubboå°±ä¼šæ‰«ææŒ‡å®šçš„åŒ…ä¸‹å¸¦æœ‰@componentæ³¨è§£çš„æœåŠ¡ï¼Œå°†å®ƒå‘å¸ƒåœ¨æŒ‡å®šçš„æ³¨å†Œä¸­å¿ƒä¸­ï¼</strong></p><h2 id="æœåŠ¡æ¶ˆè´¹è€…"><a href="#æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…"></a>æœåŠ¡æ¶ˆè´¹è€…</h2><p><strong>1ã€å¯¼å…¥ä¾èµ–ï¼Œå’Œä¹‹å‰çš„ä¾èµ–ä¸€æ ·ï¼›</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--dubbo--&gt;</span><br><span class="hljs-comment">&lt;!-- Dubbo Spring Boot Starter --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.dubbo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--zookeeper--&gt;</span><br><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.sgroschupf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>zkclient<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!-- å¼•å…¥zookeeper --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-framework<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-recipes<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.14<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--æ’é™¤è¿™ä¸ªslf4j-log4j12--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€<strong>é…ç½®å‚æ•°</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#å½“å‰åº”ç”¨åå­—</span><br><span class="hljs-string">dubbo.application.name=consumer-server</span><br><span class="hljs-comment">#æ³¨å†Œä¸­å¿ƒåœ°å€</span><br><span class="hljs-string">dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br></code></pre></td></tr></table></figure><p><strong>3. æœ¬æ¥æ­£å¸¸æ­¥éª¤æ˜¯éœ€è¦å°†æœåŠ¡æä¾›è€…çš„æ¥å£æ‰“åŒ…ï¼Œç„¶åç”¨pomæ–‡ä»¶å¯¼å…¥ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥å°†æœåŠ¡çš„æ¥å£æ‹¿è¿‡æ¥ï¼Œè·¯å¾„å¿…é¡»ä¿è¯æ­£ç¡®ï¼Œå³å’ŒæœåŠ¡æä¾›è€…ç›¸åŒï¼›</strong></p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/4.png"></p><p><strong>4. å®Œå–„æ¶ˆè´¹è€…çš„æœåŠ¡ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.consumer.service;<br><br><span class="hljs-keyword">import</span> com.kuang.provider.service.TicketService;<br><span class="hljs-keyword">import</span> org.apache.dubbo.config.annotation.Reference;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span> <span class="hljs-comment">//æ³¨å…¥åˆ°å®¹å™¨ä¸­</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserService</span> </span>&#123;<br><br>   <span class="hljs-meta">@Reference</span> <span class="hljs-comment">//è¿œç¨‹å¼•ç”¨æŒ‡å®šçš„æœåŠ¡ï¼Œä»–ä¼šæŒ‰ç…§å…¨ç±»åè¿›è¡ŒåŒ¹é…ï¼Œçœ‹è°ç»™æ³¨å†Œä¸­å¿ƒæ³¨å†Œäº†è¿™ä¸ªå…¨ç±»å</span><br>   TicketService ticketService;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bugTicket</span><span class="hljs-params">()</span></span>&#123;<br>       String ticket = ticketService.getTicket();<br>       System.out.println(<span class="hljs-string">&quot;åœ¨æ³¨å†Œä¸­å¿ƒä¹°åˆ°&quot;</span>+ticket);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>5. æµ‹è¯•ç±»ç¼–å†™ï¼›</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConsumerServerApplicationTests</span> </span>&#123;<br><br>   <span class="hljs-meta">@Autowired</span><br>   UserService userService;<br><br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<br><br>       userService.bugTicket();<br><br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å¯åŠ¨æµ‹è¯•"><a href="#å¯åŠ¨æµ‹è¯•" class="headerlink" title="å¯åŠ¨æµ‹è¯•"></a>å¯åŠ¨æµ‹è¯•</h2><p><strong>1. å¼€å¯zookeeper</strong></p><p><strong>2. æ‰“å¼€dubbo-adminå®ç°ç›‘æ§ã€å¯ä»¥ä¸ç”¨åšã€‘</strong></p><p><strong>3. å¼€å¯æœåŠ¡è€…</strong></p><p><strong>4. æ¶ˆè´¹è€…æ¶ˆè´¹æµ‹è¯•ï¼Œç»“æœï¼š</strong></p><p><img src="/2021/02/05/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Dubbo-Zookeeper%E5%AE%89%E8%A3%85%E6%B5%8B%E8%AF%95/5.png"></p>]]></content>
    
    
    <categories>
      
      <category>åˆ†å¸ƒå¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringSecurityå®‰å…¨æ¡†æ¶</title>
    <link href="/2021/02/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringSecurity%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/"/>
    <url>/2021/02/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringSecurity%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/</url>
    
    <content type="html"><![CDATA[<p>å¸‚é¢ä¸Šå­˜åœ¨æ¯”è¾ƒæœ‰åçš„å®‰å…¨æ¡†æ¶ï¼šShiroï¼ŒSpringSecurity</p><h1 id="è®¤è¯å’Œæˆæƒ"><a href="#è®¤è¯å’Œæˆæƒ" class="headerlink" title="è®¤è¯å’Œæˆæƒ"></a>è®¤è¯å’Œæˆæƒ</h1><p>ç›®å‰ï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç¯å¢ƒï¼Œæ˜¯è°éƒ½å¯ä»¥è®¿é—®çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨ Spring Security å¢åŠ ä¸Šè®¤è¯å’Œæˆæƒçš„åŠŸèƒ½</p><p>1ã€å¼•å…¥ Spring Security æ¨¡å—</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™ Spring Security é…ç½®ç±»</p><p>å‚è€ƒå®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-security">https://spring.io/projects/spring-security</a> </p><p>æŸ¥çœ‹æˆ‘ä»¬è‡ªå·±é¡¹ç›®ä¸­çš„ç‰ˆæœ¬ï¼Œæ‰¾åˆ°å¯¹åº”çš„å¸®åŠ©æ–‡æ¡£ï¼š</p><p><a href="https://docs.spring.io/spring-security/site/docs/5.3.0.RELEASE/reference/html5">https://docs.spring.io/spring-security/site/docs/5.3.0.RELEASE/reference/html5</a>  #servlet-applications 8.16.4</p><p>3ã€ç¼–å†™åŸºç¡€é…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.config;<br><br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><br><span class="hljs-meta">@EnableWebSecurity</span> <span class="hljs-comment">// å¼€å¯WebSecurityæ¨¡å¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebSecurityConfigurerAdapter</span> </span>&#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>   <span class="hljs-comment">// å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span><br>   <span class="hljs-comment">// é¦–é¡µæ‰€æœ‰äººå¯ä»¥è®¿é—®</span><br>   http.authorizeRequests().antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll()<br>  .antMatchers(<span class="hljs-string">&quot;/level1/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip1&quot;</span>)<br>  .antMatchers(<span class="hljs-string">&quot;/level2/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip2&quot;</span>)<br>  .antMatchers(<span class="hljs-string">&quot;/level3/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip3&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ä¸€ä¸‹ï¼šå‘ç°é™¤äº†é¦–é¡µéƒ½è¿›ä¸å»äº†ï¼å› ä¸ºæˆ‘ä»¬ç›®å‰æ²¡æœ‰ç™»å½•çš„è§’è‰²ï¼Œå› ä¸ºè¯·æ±‚éœ€è¦ç™»å½•çš„è§’è‰²æ‹¥æœ‰å¯¹åº”çš„æƒé™æ‰å¯ä»¥ï¼</p><p>6ã€åœ¨configure()æ–¹æ³•ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ï¼Œå¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½</span><br><span class="hljs-comment">// /login è¯·æ±‚æ¥åˆ°ç™»å½•é¡µ</span><br><span class="hljs-comment">// /login?error é‡å®šå‘åˆ°è¿™é‡Œè¡¨ç¤ºç™»å½•å¤±è´¥</span><br>http.formLogin();<br></code></pre></td></tr></table></figure><p>7ã€æµ‹è¯•ä¸€ä¸‹ï¼šå‘ç°ï¼Œæ²¡æœ‰æƒé™çš„æ—¶å€™ï¼Œä¼šè·³è½¬åˆ°ç™»å½•çš„é¡µé¢ï¼</p><p>8ã€æŸ¥çœ‹åˆšæ‰ç™»å½•é¡µçš„æ³¨é‡Šä¿¡æ¯ï¼›</p><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰è®¤è¯è§„åˆ™ï¼Œé‡å†™configure(AuthenticationManagerBuilder auth)æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰è®¤è¯è§„åˆ™</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>   <br>   <span class="hljs-comment">//åœ¨å†…å­˜ä¸­å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨jdbcä¸­å»æ‹¿....</span><br>   auth.inMemoryAuthentication()<br>          .withUser(<span class="hljs-string">&quot;kuangshen&quot;</span>).password(<span class="hljs-string">&quot;123456&quot;</span>).roles(<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>)<br>          .and()<br>          .withUser(<span class="hljs-string">&quot;root&quot;</span>).password(<span class="hljs-string">&quot;123456&quot;</span>).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>)<br>          .and()<br>          .withUser(<span class="hljs-string">&quot;guest&quot;</span>).password(<span class="hljs-string">&quot;123456&quot;</span>).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>9ã€æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›è´¦å·ç™»å½•è¿›è¡Œæµ‹è¯•ï¼å‘ç°ä¼šæŠ¥é”™ï¼</p><p>There is no PasswordEncoder mapped for the id â€œnullâ€</p><p>10ã€åŸå› ï¼Œæˆ‘ä»¬è¦å°†å‰ç«¯ä¼ è¿‡æ¥çš„å¯†ç è¿›è¡ŒæŸç§æ–¹å¼åŠ å¯†ï¼Œå¦åˆ™å°±æ— æ³•ç™»å½•ï¼Œä¿®æ”¹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰è®¤è¯è§„åˆ™</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>   <span class="hljs-comment">//åœ¨å†…å­˜ä¸­å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨jdbcä¸­å»æ‹¿....</span><br>   <span class="hljs-comment">//Spring security 5.0ä¸­æ–°å¢äº†å¤šç§åŠ å¯†æ–¹å¼ï¼Œä¹Ÿæ”¹å˜äº†å¯†ç çš„æ ¼å¼ã€‚</span><br>   <span class="hljs-comment">//è¦æƒ³æˆ‘ä»¬çš„é¡¹ç›®è¿˜èƒ½å¤Ÿæ­£å¸¸ç™»é™†ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹configureä¸­çš„ä»£ç ã€‚æˆ‘ä»¬è¦å°†å‰ç«¯ä¼ è¿‡æ¥çš„å¯†ç è¿›è¡ŒæŸç§æ–¹å¼åŠ å¯†</span><br>   <span class="hljs-comment">//spring security å®˜æ–¹æ¨èçš„æ˜¯ä½¿ç”¨bcryptåŠ å¯†æ–¹å¼ã€‚</span><br>   <br>   auth.inMemoryAuthentication().passwordEncoder(<span class="hljs-keyword">new</span> BCryptPasswordEncoder())<br>          .withUser(<span class="hljs-string">&quot;kuangshen&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>)<br>          .and()<br>          .withUser(<span class="hljs-string">&quot;root&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>)<br>          .and()<br>          .withUser(<span class="hljs-string">&quot;guest&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æƒé™æ§åˆ¶å’Œæ³¨é”€"><a href="#æƒé™æ§åˆ¶å’Œæ³¨é”€" class="headerlink" title="æƒé™æ§åˆ¶å’Œæ³¨é”€"></a>æƒé™æ§åˆ¶å’Œæ³¨é”€</h1><p>1ã€å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨é”€çš„åŠŸèƒ½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>   <span class="hljs-comment">//....</span><br>   <span class="hljs-comment">//å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨é”€çš„åŠŸèƒ½</span><br>      <span class="hljs-comment">// /logout æ³¨é”€è¯·æ±‚</span><br>   http.logout();<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æˆ‘ä»¬åœ¨å‰ç«¯ï¼Œå¢åŠ ä¸€ä¸ªæ³¨é”€çš„æŒ‰é’®ï¼Œindex.html å¯¼èˆªæ ä¸­</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/logout&#125;&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;address card icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> æ³¨é”€<br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬å¯ä»¥å»æµ‹è¯•ä¸€ä¸‹ï¼Œç™»å½•æˆåŠŸåç‚¹å‡»æ³¨é”€ï¼Œå‘ç°æ³¨é”€å®Œæ¯•ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼</p><p>4ã€ä½†æ˜¯ï¼Œæˆ‘ä»¬æƒ³è®©ä»–æ³¨é”€æˆåŠŸåï¼Œä¾æ—§å¯ä»¥è·³è½¬åˆ°é¦–é¡µï¼Œè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// .logoutSuccessUrl(&quot;/&quot;); æ³¨é”€æˆåŠŸæ¥åˆ°é¦–é¡µ</span><br>http.logout().logoutSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>);<br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ï¼Œæ³¨é”€å®Œæ¯•åï¼Œå‘ç°è·³è½¬åˆ°é¦–é¡µOK</p><p>6ã€æˆ‘ä»¬ç°åœ¨åˆæ¥ä¸€ä¸ªéœ€æ±‚ï¼šç”¨æˆ·æ²¡æœ‰ç™»å½•çš„æ—¶å€™ï¼Œå¯¼èˆªæ ä¸Šåªæ˜¾ç¤ºç™»å½•æŒ‰é’®ï¼Œç”¨æˆ·ç™»å½•ä¹‹åï¼Œå¯¼èˆªæ å¯ä»¥æ˜¾ç¤ºç™»å½•çš„ç”¨æˆ·ä¿¡æ¯åŠæ³¨é”€æŒ‰é’®ï¼è¿˜æœ‰å°±æ˜¯ï¼Œæ¯”å¦‚kuangshenè¿™ä¸ªç”¨æˆ·ï¼Œå®ƒåªæœ‰ vip2ï¼Œvip3åŠŸèƒ½ï¼Œé‚£ä¹ˆç™»å½•åˆ™åªæ˜¾ç¤ºè¿™ä¸¤ä¸ªåŠŸèƒ½ï¼Œè€Œvip1çš„åŠŸèƒ½èœå•ä¸æ˜¾ç¤ºï¼è¿™ä¸ªå°±æ˜¯çœŸå®çš„ç½‘ç«™æƒ…å†µäº†ï¼è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬éœ€è¦ç»“åˆthymeleafä¸­çš„ä¸€äº›åŠŸèƒ½</p><p>secï¼šauthorize=â€isAuthenticated()â€:æ˜¯å¦è®¤è¯ç™»å½•ï¼æ¥æ˜¾ç¤ºä¸åŒçš„é¡µé¢</p><p>Mavenä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.thymeleaf.extras/thymeleaf-extras-springsecurity4 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.thymeleaf.extras<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>thymeleaf-extras-springsecurity5<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.4.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>7ã€ä¿®æ”¹æˆ‘ä»¬çš„ å‰ç«¯é¡µé¢</p><ol><li><p>å¯¼å…¥å‘½åç©ºé—´</p></li><li><pre><code class="java">xmlns:sec=&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity5&quot;<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs dust"><br><span class="xml">3. ä¿®æ”¹å¯¼èˆªæ ï¼Œå¢åŠ è®¤è¯åˆ¤æ–­</span><br><br><span class="xml">4. ```html</span><br><span class="xml">   <span class="hljs-comment">&lt;!--ç™»å½•æ³¨é”€--&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;right menu&quot;</span>&gt;</span></span><br><span class="xml">   </span><br><span class="xml">      <span class="hljs-comment">&lt;!--å¦‚æœæœªç™»å½•--&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;!isAuthenticated()&quot;</span>&gt;</span></span><br><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@</span></span></span><span class="hljs-template-tag">&#123;/<span class="hljs-name">login</span>&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span></span><br><span class="xml">              <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;address card icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> ç™»å½•</span><br><span class="xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">   </span><br><span class="xml">      <span class="hljs-comment">&lt;!--å¦‚æœå·²ç™»å½•--&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;isAuthenticated()&quot;</span>&gt;</span></span><br><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span></span><br><span class="xml">              <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;address card icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span></span><br><span class="xml">             ç”¨æˆ·åï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">sec:authentication</span>=<span class="hljs-string">&quot;principal.username&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="xml">             è§’è‰²ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">sec:authentication</span>=<span class="hljs-string">&quot;principal.authorities&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">   </span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;isAuthenticated()&quot;</span>&gt;</span></span><br><span class="xml">          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@</span></span></span><span class="hljs-template-tag">&#123;/<span class="hljs-name">logout</span>&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span></span><br><span class="xml">              <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;address card icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> æ³¨é”€</span><br><span class="xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br></code></pre></td></tr></table></figure></code></pre></li></ol><p>8ã€é‡å¯æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç™»å½•è¯•è¯•çœ‹ï¼Œç™»å½•æˆåŠŸåç¡®å®ï¼Œæ˜¾ç¤ºäº†æˆ‘ä»¬æƒ³è¦çš„é¡µé¢ï¼›</p><p>9ã€å¦‚æœæ³¨é”€404äº†ï¼Œå°±æ˜¯å› ä¸ºå®ƒé»˜è®¤é˜²æ­¢csrfè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œå› ä¸ºä¼šäº§ç”Ÿå®‰å…¨é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯·æ±‚æ”¹ä¸ºpostè¡¨å•æäº¤ï¼Œæˆ–è€…åœ¨spring securityä¸­å…³é—­csrfåŠŸèƒ½ï¼›æˆ‘ä»¬è¯•è¯•ï¼šåœ¨ é…ç½®ä¸­å¢åŠ  <code>http.csrf().disable();</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">http.csrf().disable();<span class="hljs-comment">//å…³é—­csrfåŠŸèƒ½:è·¨ç«™è¯·æ±‚ä¼ªé€ ,é»˜è®¤åªèƒ½é€šè¿‡postæ–¹å¼æäº¤logoutè¯·æ±‚</span><br>http.logout().logoutSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>);<br></code></pre></td></tr></table></figure><p>10ã€æˆ‘ä»¬ç»§ç»­å°†ä¸‹é¢çš„è§’è‰²åŠŸèƒ½å—è®¤è¯å®Œæˆï¼</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- sec:authorize=&quot;hasRole(&#x27;vip1&#x27;)&quot; --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column&quot;</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;hasRole(&#x27;vip1&#x27;)&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui raised segment&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>Level 1<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level1/1&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-1-1<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level1/2&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-1-2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level1/3&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-1-3<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column&quot;</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;hasRole(&#x27;vip2&#x27;)&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui raised segment&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>Level 2<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level2/1&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-2-1<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level2/2&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-2-2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level2/3&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-2-3<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;column&quot;</span> <span class="hljs-attr">sec:authorize</span>=<span class="hljs-string">&quot;hasRole(&#x27;vip3&#x27;)&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui raised segment&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>Level 3<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level3/1&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-3-1<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level3/2&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-3-2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/level3/3&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bullhorn icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> Level-3-3<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>11ã€æµ‹è¯•ä¸€ä¸‹ï¼</p><p>12ã€æƒé™æ§åˆ¶å’Œæ³¨é”€æå®šï¼</p><h1 id="è®°ä½æˆ‘"><a href="#è®°ä½æˆ‘" class="headerlink" title="è®°ä½æˆ‘"></a>è®°ä½æˆ‘</h1><p>ç°åœ¨çš„æƒ…å†µï¼Œæˆ‘ä»¬åªè¦ç™»å½•ä¹‹åï¼Œå…³é—­æµè§ˆå™¨ï¼Œå†ç™»å½•ï¼Œå°±ä¼šè®©æˆ‘ä»¬é‡æ–°ç™»å½•ï¼Œä½†æ˜¯å¾ˆå¤šç½‘ç«™çš„æƒ…å†µï¼Œå°±æ˜¯æœ‰ä¸€ä¸ªè®°ä½å¯†ç çš„åŠŸèƒ½ï¼Œè¿™ä¸ªè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿå¾ˆç®€å•</p><p>1ã€å¼€å¯è®°ä½æˆ‘åŠŸèƒ½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><span class="hljs-comment">//ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br>   <span class="hljs-comment">//è®°ä½æˆ‘</span><br>   http.rememberMe();<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æˆ‘ä»¬å†æ¬¡å¯åŠ¨é¡¹ç›®æµ‹è¯•ä¸€ä¸‹ï¼Œå‘ç°ç™»å½•é¡µå¤šäº†ä¸€ä¸ªè®°ä½æˆ‘åŠŸèƒ½ï¼Œæˆ‘ä»¬ç™»å½•ä¹‹åå…³é—­ æµè§ˆå™¨ï¼Œç„¶åé‡æ–°æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼Œå‘ç°ç”¨æˆ·ä¾æ—§å­˜åœ¨ï¼</p><p>æ€è€ƒï¼šå¦‚ä½•å®ç°çš„å‘¢ï¼Ÿå…¶å®éå¸¸ç®€å•</p><p>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æµè§ˆå™¨çš„cookie</p><p><img src="/2021/02/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringSecurity%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/1.png"></p><p>3ã€æˆ‘ä»¬ç‚¹å‡»æ³¨é”€çš„æ—¶å€™ï¼Œå¯ä»¥å‘ç°ï¼Œspring security å¸®æˆ‘ä»¬è‡ªåŠ¨åˆ é™¤äº†è¿™ä¸ª cookie</p><p>4ã€ç»“è®ºï¼šç™»å½•æˆåŠŸåï¼Œå°†cookieå‘é€ç»™æµè§ˆå™¨ä¿å­˜ï¼Œä»¥åç™»å½•å¸¦ä¸Šè¿™ä¸ªcookieï¼Œåªè¦é€šè¿‡æ£€æŸ¥å°±å¯ä»¥å…ç™»å½•äº†ã€‚å¦‚æœç‚¹å‡»æ³¨é”€ï¼Œåˆ™ä¼šåˆ é™¤è¿™ä¸ªcookie</p><h1 id="å®šåˆ¶ç™»å½•é¡µ"><a href="#å®šåˆ¶ç™»å½•é¡µ" class="headerlink" title="å®šåˆ¶ç™»å½•é¡µ"></a>å®šåˆ¶ç™»å½•é¡µ</h1><p>ç°åœ¨è¿™ä¸ªç™»å½•é¡µé¢éƒ½æ˜¯spring security é»˜è®¤çš„ï¼Œæ€ä¹ˆæ ·å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±å†™çš„Loginç•Œé¢å‘¢ï¼Ÿ</p><p>1ã€åœ¨åˆšæ‰çš„ç™»å½•é¡µé…ç½®åé¢æŒ‡å®š loginpage</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">http.formLogin().loginPage(<span class="hljs-string">&quot;/toLogin&quot;</span>);<br></code></pre></td></tr></table></figure><p>2ã€ç„¶åå‰ç«¯ä¹Ÿéœ€è¦æŒ‡å‘æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ loginè¯·æ±‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/toLogin&#125;&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;address card icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> ç™»å½•<br><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬ç™»å½•ï¼Œéœ€è¦å°†è¿™äº›ä¿¡æ¯å‘é€åˆ°å“ªé‡Œï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦é…ç½®ï¼Œlogin.html é…ç½®æäº¤è¯·æ±‚åŠæ–¹å¼ï¼Œæ–¹å¼å¿…é¡»ä¸ºpost:</p><p>åœ¨ loginPage()æºç ä¸­çš„æ³¨é‡Šä¸Šæœ‰å†™æ˜ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">&quot;@&#123;/login&#125;&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;field&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Username<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui left icon input&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Username&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;user icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;field&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui left icon input&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;lock icon&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ui blue submit button&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€è¿™ä¸ªè¯·æ±‚æäº¤ä¸Šæ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦éªŒè¯å¤„ç†ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹formLogin()æ–¹æ³•çš„æºç ï¼æˆ‘ä»¬é…ç½®æ¥æ”¶ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç çš„å‚æ•°ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">http.formLogin()<br>  .usernameParameter(<span class="hljs-string">&quot;username&quot;</span>)<br>  .passwordParameter(<span class="hljs-string">&quot;password&quot;</span>)<br>  .loginPage(<span class="hljs-string">&quot;/toLogin&quot;</span>)<br>  .loginProcessingUrl(<span class="hljs-string">&quot;/login&quot;</span>); <span class="hljs-comment">// ç™»é™†è¡¨å•æäº¤è¯·æ±‚</span><br></code></pre></td></tr></table></figure><p>5ã€åœ¨ç™»å½•é¡µå¢åŠ è®°ä½æˆ‘çš„å¤šé€‰æ¡†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;remember&quot;</span>&gt;</span> è®°ä½æˆ‘<br></code></pre></td></tr></table></figure><p>6ã€åç«¯éªŒè¯å¤„ç†ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šåˆ¶è®°ä½æˆ‘çš„å‚æ•°ï¼</span><br>http.rememberMe().rememberMeParameter(<span class="hljs-string">&quot;remember&quot;</span>);<br></code></pre></td></tr></table></figure><p>7ã€æµ‹è¯•ï¼ŒOK</p><h1 id="å®Œæ•´é…ç½®ä»£ç "><a href="#å®Œæ•´é…ç½®ä»£ç " class="headerlink" title="å®Œæ•´é…ç½®ä»£ç "></a>å®Œæ•´é…ç½®ä»£ç </h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.config;<br><br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br><br><span class="hljs-meta">@EnableWebSecurity</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebSecurityConfigurerAdapter</span> </span>&#123;<br><br>   <span class="hljs-comment">//å®šåˆ¶è¯·æ±‚çš„æˆæƒè§„åˆ™</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>       http.authorizeRequests().antMatchers(<span class="hljs-string">&quot;/&quot;</span>).permitAll()<br>      .antMatchers(<span class="hljs-string">&quot;/level1/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip1&quot;</span>)<br>      .antMatchers(<span class="hljs-string">&quot;/level2/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip2&quot;</span>)<br>      .antMatchers(<span class="hljs-string">&quot;/level3/**&quot;</span>).hasRole(<span class="hljs-string">&quot;vip3&quot;</span>);<br><br><br>       <span class="hljs-comment">//å¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½ï¼šå¦‚æœæ²¡æœ‰æƒé™ï¼Œå°±ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼</span><br>           <span class="hljs-comment">// /login è¯·æ±‚æ¥åˆ°ç™»å½•é¡µ</span><br>           <span class="hljs-comment">// /login?error é‡å®šå‘åˆ°è¿™é‡Œè¡¨ç¤ºç™»å½•å¤±è´¥</span><br>       http.formLogin()<br>          .usernameParameter(<span class="hljs-string">&quot;username&quot;</span>)<br>          .passwordParameter(<span class="hljs-string">&quot;password&quot;</span>)<br>          .loginPage(<span class="hljs-string">&quot;/toLogin&quot;</span>)<br>          .loginProcessingUrl(<span class="hljs-string">&quot;/login&quot;</span>); <span class="hljs-comment">// ç™»é™†è¡¨å•æäº¤è¯·æ±‚</span><br><br>       <span class="hljs-comment">//å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨é”€çš„åŠŸèƒ½</span><br>           <span class="hljs-comment">// /logout æ³¨é”€è¯·æ±‚</span><br>           <span class="hljs-comment">// .logoutSuccessUrl(&quot;/&quot;); æ³¨é”€æˆåŠŸæ¥åˆ°é¦–é¡µ</span><br><br>       http.csrf().disable();<span class="hljs-comment">//å…³é—­csrfåŠŸèƒ½:è·¨ç«™è¯·æ±‚ä¼ªé€ ,é»˜è®¤åªèƒ½é€šè¿‡postæ–¹å¼æäº¤logoutè¯·æ±‚</span><br>       http.logout().logoutSuccessUrl(<span class="hljs-string">&quot;/&quot;</span>);<br><br>       <span class="hljs-comment">//è®°ä½æˆ‘</span><br>       http.rememberMe().rememberMeParameter(<span class="hljs-string">&quot;remember&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-comment">//å®šä¹‰è®¤è¯è§„åˆ™</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">configure</span><span class="hljs-params">(AuthenticationManagerBuilder auth)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">//åœ¨å†…å­˜ä¸­å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨jdbcä¸­å»æ‹¿....</span><br>       <span class="hljs-comment">//Spring security 5.0ä¸­æ–°å¢äº†å¤šç§åŠ å¯†æ–¹å¼ï¼Œä¹Ÿæ”¹å˜äº†å¯†ç çš„æ ¼å¼ã€‚</span><br>       <span class="hljs-comment">//è¦æƒ³æˆ‘ä»¬çš„é¡¹ç›®è¿˜èƒ½å¤Ÿæ­£å¸¸ç™»é™†ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹configureä¸­çš„ä»£ç ã€‚æˆ‘ä»¬è¦å°†å‰ç«¯ä¼ è¿‡æ¥çš„å¯†ç è¿›è¡ŒæŸç§æ–¹å¼åŠ å¯†</span><br>       <span class="hljs-comment">//spring security å®˜æ–¹æ¨èçš„æ˜¯ä½¿ç”¨bcryptåŠ å¯†æ–¹å¼ã€‚</span><br><br>       auth.inMemoryAuthentication().passwordEncoder(<span class="hljs-keyword">new</span> BCryptPasswordEncoder())<br>              .withUser(<span class="hljs-string">&quot;kuangshen&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>)<br>              .and()<br>              .withUser(<span class="hljs-string">&quot;root&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>,<span class="hljs-string">&quot;vip3&quot;</span>)<br>              .and()<br>              .withUser(<span class="hljs-string">&quot;guest&quot;</span>).password(<span class="hljs-keyword">new</span> BCryptPasswordEncoder().encode(<span class="hljs-string">&quot;123456&quot;</span>)).roles(<span class="hljs-string">&quot;vip1&quot;</span>,<span class="hljs-string">&quot;vip2&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Swaggeræ¡†æ¶</title>
    <link href="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/"/>
    <url>/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/</url>
    
    <content type="html"><![CDATA[<p><strong>äº§ç”Ÿçš„é—®é¢˜</strong></p><ul><li>å‰åç«¯é›†æˆï¼Œå‰ç«¯æˆ–è€…åç«¯æ— æ³•åšåˆ°â€œåŠæ—¶åå•†ï¼Œå°½æ—©è§£å†³â€ï¼Œæœ€ç»ˆå¯¼è‡´é—®é¢˜é›†ä¸­çˆ†å‘</li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><ul><li>é¦–å…ˆå®šä¹‰schema [ è®¡åˆ’çš„æçº² ]ï¼Œå¹¶å®æ—¶è·Ÿè¸ªæœ€æ–°çš„APIï¼Œé™ä½é›†æˆé£é™©</li></ul><p><strong>Swagger</strong></p><ul><li>å·ç§°ä¸–ç•Œä¸Šæœ€æµè¡Œçš„APIæ¡†æ¶</li><li>Restful Api æ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆå™¨ =&gt; <strong>API æ–‡æ¡£ ä¸API å®šä¹‰åŒæ­¥æ›´æ–°</strong></li><li>ç›´æ¥è¿è¡Œï¼Œåœ¨çº¿æµ‹è¯•API</li><li>æ”¯æŒå¤šç§è¯­è¨€ ï¼ˆå¦‚ï¼šJavaï¼ŒPHPç­‰ï¼‰</li><li>å®˜ç½‘ï¼š<a href="https://swagger.io/">https://swagger.io/</a></li></ul><p><strong>æœ€å¤§ç”¨é€”</strong></p><ul><li>å¯ä»¥é€šè¿‡swaggerç»™æ¯”è¾ƒéš¾ç†è§£çš„å±æ€§æˆ–æ¥å£ï¼Œå¢åŠ æ³¨é‡Šä¿¡æ¯</li><li>æ¥å£æ–‡æ¡£å®æ–½è·Ÿæ–°</li><li>å¯ä»¥åœ¨çº¿æµ‹è¯•æ¥å£</li></ul><h1 id="SpringBooté›†æˆSwagger"><a href="#SpringBooté›†æˆSwagger" class="headerlink" title="SpringBooté›†æˆSwagger"></a>SpringBooté›†æˆSwagger</h1><p>1ã€æ–°å»ºä¸€ä¸ªSpringBoot-webé¡¹ç›®</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210202161906039.png"></p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210202162059694.png" alt="image-20210202162059694"></p><p>2ã€æ·»åŠ Mavenä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-swagger2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€ç¼–å†™ä¸€ä¸ªhelloå·¥ç¨‹</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210202203910292.png" alt="image-20210202203910292"></p><p>è¿è¡Œé¡¹ç›®åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä»¥ä¸‹ç½‘å€</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210202203933467.png" alt="image-20210202203933467"></p><p>4ã€é›†æˆSwagger</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210202205250380.png" alt="image-20210202205250380"></p><p>5ã€æµ‹è¯•è¿è¡Œ<a href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210202205441380.png" alt="image-20210202205441380"></p><h1 id="æ›´æ”¹Swaggerä¿¡æ¯"><a href="#æ›´æ”¹Swaggerä¿¡æ¯" class="headerlink" title="æ›´æ”¹Swaggerä¿¡æ¯"></a>æ›´æ”¹Swaggerä¿¡æ¯</h1><p>ä¿®æ”¹SwaggerConfig.java</p><p>å¯ä»¥é€šè¿‡apiInfo()å±æ€§é…ç½®æ–‡æ¡£ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.swagger.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> springfox.documentation.service.ApiInfo;<br><span class="hljs-keyword">import</span> springfox.documentation.service.Contact;<br><span class="hljs-keyword">import</span> springfox.documentation.spi.DocumentationType;<br><span class="hljs-keyword">import</span> springfox.documentation.spring.web.plugins.Docket;<br><span class="hljs-keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableSwagger2</span><span class="hljs-comment">//å¼€å¯Swagger2</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SwaggerConfig</span> </span>&#123;<br>    <span class="hljs-comment">//é…ç½®äº†Swaggerçš„Docketçš„beanå®ä¾‹</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo());<br>    &#125;<br>    <span class="hljs-comment">//é…ç½®Swaggerä¿¡æ¯=apiInfo</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> ApiInfo <span class="hljs-title">apiInfo</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//ä½œè€…ä¿¡æ¯</span><br>        Contact contact = <span class="hljs-keyword">new</span> Contact(<span class="hljs-string">&quot;mochen&quot;</span>, <span class="hljs-string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>, <span class="hljs-string">&quot;2830524481@qq.com&quot;</span>);<br><br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ApiInfo(<br>                <span class="hljs-string">&quot;mochençš„apiæ–‡æ¡£&quot;</span>,<br>                <span class="hljs-string">&quot;å¥”è·‘çš„èœ—ç‰›&quot;</span>,<br>                <span class="hljs-string">&quot;v1.0&quot;</span>,<br>                <span class="hljs-string">&quot;urn:tos&quot;</span>,<br>                contact,<br>                <span class="hljs-string">&quot;Apache 2.0&quot;</span>,<br>                <span class="hljs-string">&quot;http://www.apache.org/licenses/LICENSE-2.0&quot;</span>,<br>                <span class="hljs-keyword">new</span> ArrayList()<br>        );<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>é‡æ–°è¿è¡Œ</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210203215521695.png" alt="image-20210203215521695"></p><h1 id="é…ç½®æ‰«ææ¥å£"><a href="#é…ç½®æ‰«ææ¥å£" class="headerlink" title="é…ç½®æ‰«ææ¥å£"></a>é…ç½®æ‰«ææ¥å£</h1><p>1ã€æ„å»ºDocketæ—¶é€šè¿‡select()æ–¹æ³•é…ç½®æ€ä¹ˆæ‰«ææ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket</span><span class="hljs-params">()</span> </span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2)<br>      .apiInfo(apiInfo())<br>      .select()<span class="hljs-comment">// é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£</span><br>      .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.mc.swagger.controller&quot;</span>))<br>      .build();<br>&#125;<br></code></pre></td></tr></table></figure><p>é‡å¯é¡¹ç›®æµ‹è¯•ï¼Œç”±äºæˆ‘ä»¬é…ç½®æ ¹æ®åŒ…çš„è·¯å¾„æ‰«ææ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½çœ‹åˆ°ä¸€ä¸ªç±»</p><p>é™¤äº†é€šè¿‡åŒ…è·¯å¾„é…ç½®æ‰«ææ¥å£å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡é…ç½®å…¶ä»–æ–¹å¼æ‰«ææ¥å£ï¼Œè¿™é‡Œæ³¨é‡Šä¸€ä¸‹æ‰€æœ‰çš„é…ç½®æ–¹å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">any() <span class="hljs-comment">// æ‰«ææ‰€æœ‰ï¼Œé¡¹ç›®ä¸­çš„æ‰€æœ‰æ¥å£éƒ½ä¼šè¢«æ‰«æåˆ°</span><br>none() <span class="hljs-comment">// ä¸æ‰«ææ¥å£</span><br><span class="hljs-comment">// é€šè¿‡æ–¹æ³•ä¸Šçš„æ³¨è§£æ‰«æï¼Œå¦‚withMethodAnnotation(GetMapping.class)åªæ‰«ægetè¯·æ±‚</span><br>withMethodAnnotation(<span class="hljs-keyword">final</span> Class&lt;? extends Annotation&gt; annotation)<br><span class="hljs-comment">// é€šè¿‡ç±»ä¸Šçš„æ³¨è§£æ‰«æï¼Œå¦‚.withClassAnnotation(Controller.class)åªæ‰«ææœ‰controlleræ³¨è§£çš„ç±»ä¸­çš„æ¥å£</span><br>withClassAnnotation(<span class="hljs-keyword">final</span> Class&lt;? extends Annotation&gt; annotation)<br>basePackage(<span class="hljs-keyword">final</span> String basePackage) <span class="hljs-comment">// æ ¹æ®åŒ…è·¯å¾„æ‰«ææ¥å£</span><br></code></pre></td></tr></table></figure><p>2ã€é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é…ç½®æ¥å£æ‰«æè¿‡æ»¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket</span><span class="hljs-params">()</span> </span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2)<br>      .apiInfo(apiInfo())<br>      .select()<span class="hljs-comment">// é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£</span><br>      .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.mc.swagger.controller&quot;</span>))<br>       <span class="hljs-comment">// é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/mcå¼€å¤´çš„æ¥å£</span><br>      .paths(PathSelectors.ant(<span class="hljs-string">&quot;/mc/**&quot;</span>))<br>      .build();<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="é…ç½®Swaggerå¼€å…³"><a href="#é…ç½®Swaggerå¼€å…³" class="headerlink" title="é…ç½®Swaggerå¼€å…³"></a>é…ç½®Swaggerå¼€å…³</h1><p>é€šè¿‡enable()æ–¹æ³•é…ç½®æ˜¯å¦å¯ç”¨swaggerï¼Œå¦‚æœæ˜¯falseï¼Œswaggerå°†ä¸èƒ½åœ¨æµè§ˆå™¨ä¸­è®¿é—®äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket</span><span class="hljs-params">()</span> </span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2)<br>      .apiInfo(apiInfo())<br>      .enable(<span class="hljs-keyword">false</span>) <span class="hljs-comment">//é…ç½®æ˜¯å¦å¯ç”¨Swaggerï¼Œå¦‚æœæ˜¯falseï¼Œåœ¨æµè§ˆå™¨å°†æ— æ³•è®¿é—®</span><br>      .select()<span class="hljs-comment">// é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£</span><br>      .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.kuang.swagger.controller&quot;</span>))<br>       <span class="hljs-comment">// é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/kuangå¼€å¤´çš„æ¥å£</span><br>      .paths(PathSelectors.ant(<span class="hljs-string">&quot;/kuang/**&quot;</span>))<br>      .build();<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ä½•åŠ¨æ€é…ç½®å½“é¡¹ç›®å¤„äºtestã€devç¯å¢ƒæ—¶æ˜¾ç¤ºswaggerï¼Œå¤„äºprodæ—¶ä¸æ˜¾ç¤ºï¼Ÿ</p><p>è®¾ç½®dev proç¯å¢ƒ</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204192410678.png" alt="image-20210204192410678"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket</span><span class="hljs-params">(Environment environment)</span> </span>&#123;<br>   <span class="hljs-comment">// è®¾ç½®è¦æ˜¾ç¤ºswaggerçš„ç¯å¢ƒ</span><br>   Profiles of = Profiles.of(<span class="hljs-string">&quot;dev&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br>   <span class="hljs-comment">// åˆ¤æ–­å½“å‰æ˜¯å¦å¤„äºè¯¥ç¯å¢ƒ</span><br>   <span class="hljs-comment">// é€šè¿‡ enable() æ¥æ”¶æ­¤å‚æ•°åˆ¤æ–­æ˜¯å¦è¦æ˜¾ç¤º</span><br>   <span class="hljs-keyword">boolean</span> b = environment.acceptsProfiles(of);<br>   <br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2)<br>      .apiInfo(apiInfo())<br>      .enable(b) <span class="hljs-comment">//é…ç½®æ˜¯å¦å¯ç”¨Swaggerï¼Œå¦‚æœæ˜¯falseï¼Œåœ¨æµè§ˆå™¨å°†æ— æ³•è®¿é—®</span><br>      .select()<span class="hljs-comment">// é€šè¿‡.select()æ–¹æ³•ï¼Œå»é…ç½®æ‰«ææ¥å£,RequestHandlerSelectorsé…ç½®å¦‚ä½•æ‰«ææ¥å£</span><br>      .apis(RequestHandlerSelectors.basePackage(<span class="hljs-string">&quot;com.kuang.swagger.controller&quot;</span>))<br>       <span class="hljs-comment">// é…ç½®å¦‚ä½•é€šè¿‡pathè¿‡æ»¤,å³è¿™é‡Œåªæ‰«æè¯·æ±‚ä»¥/kuangå¼€å¤´çš„æ¥å£</span><br>      .paths(PathSelectors.ant(<span class="hljs-string">&quot;/kuang/**&quot;</span>))<br>      .build();<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="é…ç½®APIåˆ†ç»„"><a href="#é…ç½®APIåˆ†ç»„" class="headerlink" title="é…ç½®APIåˆ†ç»„"></a>é…ç½®APIåˆ†ç»„</h1><p>å¦‚æœæ²¡æœ‰é…ç½®åˆ†ç»„ï¼Œé»˜è®¤æ˜¯default</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204194219156.png" alt="image-20210204194219156"></p><p>é€šè¿‡groupName()æ–¹æ³•å³å¯é…ç½®åˆ†ç»„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket</span><span class="hljs-params">(Environment environment)</span> </span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo())<br>      .groupName(<span class="hljs-string">&quot;hello&quot;</span>) <span class="hljs-comment">// é…ç½®åˆ†ç»„</span><br>       <span class="hljs-comment">// çœç•¥é…ç½®....</span><br>&#125;<br></code></pre></td></tr></table></figure><p>é‡å¯é¡¹ç›®æŸ¥çœ‹åˆ†ç»„</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204194538307.png" alt="image-20210204194538307"></p><p>å¦‚ä½•é…ç½®å¤šä¸ªåˆ†ç»„ï¼Ÿé…ç½®å¤šä¸ªåˆ†ç»„åªéœ€è¦é…ç½®å¤šä¸ªdocketå³å¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket1</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2).groupName(<span class="hljs-string">&quot;group1&quot;</span>);<br>&#125;<br><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket2</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2).groupName(<span class="hljs-string">&quot;group2&quot;</span>);<br>&#125;<br><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Docket <span class="hljs-title">docket3</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Docket(DocumentationType.SWAGGER_2).groupName(<span class="hljs-string">&quot;group3&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204195858090.png" alt="image-20210204195858090"></p><h1 id="å®ä½“é…ç½®"><a href="#å®ä½“é…ç½®" class="headerlink" title="å®ä½“é…ç½®"></a>å®ä½“é…ç½®</h1><p>1ã€æ–°å»ºä¸€ä¸ªå®ä½“ç±»</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204200416231.png" alt="image-20210204200416231"></p><p>2ã€åªè¦è¿™ä¸ªå®ä½“åœ¨<strong>è¯·æ±‚æ¥å£</strong>çš„è¿”å›å€¼ä¸Šï¼ˆå³ä½¿æ˜¯æ³›å‹ï¼‰ï¼Œéƒ½èƒ½æ˜ å°„åˆ°å®ä½“é¡¹ä¸­ï¼š</p><p><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204200656707.png" alt="image-20210204200656707"></p><p>é‡å¯æŸ¥çœ‹</p><p><strong><img src="/2021/02/02/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Swagger%E6%A1%86%E6%9E%B6/image-20210204200347318.png" alt="image-20210204200347318"></strong></p><p>æ³¨ï¼šå¹¶ä¸æ˜¯å› ä¸º@ApiModelè¿™ä¸ªæ³¨è§£è®©å®ä½“æ˜¾ç¤ºåœ¨è¿™é‡Œäº†ï¼Œè€Œæ˜¯åªè¦å‡ºç°åœ¨æ¥å£æ–¹æ³•çš„è¿”å›å€¼ä¸Šçš„å®ä½“éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œè€Œ@ApiModelå’Œ@ApiModelPropertyè¿™ä¸¤ä¸ªæ³¨è§£åªæ˜¯ä¸ºå®ä½“æ·»åŠ æ³¨é‡Šçš„ã€‚</p><p><strong>@ApiModelä¸ºç±»æ·»åŠ æ³¨é‡Š</strong></p><p><strong>@ApiModelPropertyä¸ºç±»å±æ€§æ·»åŠ æ³¨é‡Š</strong></p><h1 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h1><p>Swaggerçš„æ‰€æœ‰æ³¨è§£å®šä¹‰åœ¨io.swagger.annotationsåŒ…ä¸‹</p><p>ä¸‹é¢åˆ—ä¸€äº›ç»å¸¸ç”¨åˆ°çš„ï¼Œæœªåˆ—ä¸¾å‡ºæ¥çš„å¯ä»¥å¦è¡ŒæŸ¥é˜…è¯´æ˜ï¼š</p><table><thead><tr><th>Swaggeræ³¨è§£</th><th>ç®€å•è¯´æ˜</th></tr></thead><tbody><tr><td>@Api(tags = â€œxxxæ¨¡å—è¯´æ˜â€)</td><td>ä½œç”¨åœ¨æ¨¡å—ç±»ä¸Š</td></tr><tr><td>@ApiOperation(â€œxxxæ¥å£è¯´æ˜â€)</td><td>ä½œç”¨åœ¨æ¥å£æ–¹æ³•ä¸Š</td></tr><tr><td>@ApiModel(â€œxxxPOJOè¯´æ˜â€)</td><td>ä½œç”¨åœ¨æ¨¡å‹ç±»ä¸Šï¼šå¦‚VOã€BO</td></tr><tr><td>@ApiModelProperty(value = â€œxxxå±æ€§è¯´æ˜â€,hidden = true)</td><td>ä½œç”¨åœ¨ç±»æ–¹æ³•å’Œå±æ€§ä¸Šï¼Œhiddenè®¾ç½®ä¸ºtrueå¯ä»¥éšè—è¯¥å±æ€§</td></tr><tr><td>@ApiParam(â€œxxxå‚æ•°è¯´æ˜â€)</td><td>ä½œç”¨åœ¨å‚æ•°ã€æ–¹æ³•å’Œå­—æ®µä¸Šï¼Œç±»ä¼¼@ApiModelProperty</td></tr></tbody></table><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™è¯·æ±‚çš„æ¥å£é…ç½®ä¸€äº›æ³¨é‡Š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ApiOperation(&quot;mochençš„æ¥å£&quot;)</span><br><span class="hljs-meta">@PostMapping(&quot;/mc&quot;)</span><br><span class="hljs-meta">@ResponseBody</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">kuang</span><span class="hljs-params">(<span class="hljs-meta">@ApiParam(&quot;è¿™ä¸ªåå­—ä¼šè¢«è¿”å›&quot;)</span>String username)</span></span>&#123;<br>   <span class="hljs-keyword">return</span> username;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯ï¼Œå¯ä»¥ç»™ä¸€äº›æ¯”è¾ƒéš¾ç†è§£çš„å±æ€§æˆ–è€…æ¥å£ï¼Œå¢åŠ ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œè®©äººæ›´å®¹æ˜“é˜…è¯»ï¼</p><p>ç›¸è¾ƒäºä¼ ç»Ÿçš„Postmanæˆ–Curlæ–¹å¼æµ‹è¯•æ¥å£ï¼Œä½¿ç”¨swaggerç®€ç›´å°±æ˜¯å‚»ç“œå¼æ“ä½œï¼Œä¸éœ€è¦é¢å¤–è¯´æ˜æ–‡æ¡£(å†™å¾—å¥½æœ¬èº«å°±æ˜¯æ–‡æ¡£)è€Œä¸”æ›´ä¸å®¹æ˜“å‡ºé”™ï¼Œåªéœ€è¦å½•å…¥æ•°æ®ç„¶åç‚¹å‡»Executeï¼Œå¦‚æœå†é…åˆè‡ªåŠ¨åŒ–æ¡†æ¶ï¼Œå¯ä»¥è¯´åŸºæœ¬å°±ä¸éœ€è¦äººä¸ºæ“ä½œäº†ã€‚</p><p>Swaggeræ˜¯ä¸ªä¼˜ç§€çš„å·¥å…·ï¼Œç°åœ¨å›½å†…å·²ç»æœ‰å¾ˆå¤šçš„ä¸­å°å‹äº’è”ç½‘å…¬å¸éƒ½åœ¨ä½¿ç”¨å®ƒï¼Œç›¸è¾ƒäºä¼ ç»Ÿçš„è¦å…ˆå‡ºWordæ¥å£æ–‡æ¡£å†æµ‹è¯•çš„æ–¹å¼ï¼Œæ˜¾ç„¶è¿™æ ·ä¹Ÿæ›´ç¬¦åˆç°åœ¨çš„å¿«é€Ÿè¿­ä»£å¼€å‘è¡Œæƒ…ã€‚å½“ç„¶äº†ï¼Œæé†’ä¸‹å¤§å®¶åœ¨æ­£å¼ç¯å¢ƒè¦è®°å¾—å…³é—­Swaggerï¼Œä¸€æ¥å‡ºäºå®‰å…¨è€ƒè™‘äºŒæ¥ä¹Ÿå¯ä»¥èŠ‚çœè¿è¡Œæ—¶å†…å­˜ã€‚</p><h1 id="æ‹“å±•ï¼šå…¶ä»–çš®è‚¤"><a href="#æ‹“å±•ï¼šå…¶ä»–çš®è‚¤" class="headerlink" title="æ‹“å±•ï¼šå…¶ä»–çš®è‚¤"></a>æ‹“å±•ï¼šå…¶ä»–çš®è‚¤</h1><p>æˆ‘ä»¬å¯ä»¥å¯¼å…¥ä¸åŒçš„åŒ…å®ç°ä¸åŒçš„çš®è‚¤å®šä¹‰ï¼š</p><p>1ã€é»˜è®¤çš„  <strong>è®¿é—® <a href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></strong></p><p>å¦‚ä¸Šé¢æ‰€ç¤º</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€bootstrap-ui  <strong>è®¿é—® <a href="http://localhost:8080/doc.html">http://localhost:8080/doc.html</a></strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥swagger-bootstrap-uiåŒ… /doc.html--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.xiaoymin<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>swagger-bootstrap-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€Layui-ui  <strong>è®¿é—® <a href="http://localhost:8080/docs.html">http://localhost:8080/docs.html</a></strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥swagger-ui-layeråŒ… /docs.html--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.caspar-chen<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>swagger-ui-layer<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€mg-ui  <strong>è®¿é—® <a href="http://localhost:8080/document.html">http://localhost:8080/document.html</a></strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¼•å…¥swagger-ui-layeråŒ… /document.html--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.zyplayer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>swagger-mg-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Thymeleafæ¨¡æ¿å¼•æ“</title>
    <link href="/2021/01/29/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Thymeleaf%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/"/>
    <url>/2021/01/29/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Thymeleaf%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/</url>
    
    <content type="html"><![CDATA[<p>Thymeleaf å®˜ç½‘ï¼š<a href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a></p><p>Thymeleaf åœ¨Github çš„ä¸»é¡µï¼š<a href="https://github.com/thymeleaf/thymeleaf">https://github.com/thymeleaf/thymeleaf</a></p><p>Springå®˜æ–¹æ–‡æ¡£ï¼šæ‰¾åˆ°æˆ‘ä»¬å¯¹åº”çš„ç‰ˆæœ¬</p><p><a href="https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter">https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter</a> </p><p>æ‰¾åˆ°å¯¹åº”çš„pomä¾èµ–ï¼šå¯ä»¥é€‚å½“ç‚¹è¿›æºç çœ‹ä¸‹æœ¬æ¥çš„åŒ…ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--thymeleaf--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="Thymeleafåˆ†æ"><a href="#Thymeleafåˆ†æ" class="headerlink" title="Thymeleafåˆ†æ"></a>Thymeleafåˆ†æ</h1><p>æŒ‰ç…§SpringBootçš„è‡ªåŠ¨é…ç½®åŸç†çœ‹ä¸€ä¸‹æˆ‘ä»¬è¿™ä¸ªThymeleafçš„è‡ªåŠ¨é…ç½®è§„åˆ™ï¼Œåœ¨æŒ‰ç…§é‚£ä¸ªè§„åˆ™ï¼Œæˆ‘ä»¬è¿›è¡Œä½¿ç”¨ã€‚</p><p>æˆ‘ä»¬å»æ‰¾ä¸€ä¸‹Thymeleafçš„è‡ªåŠ¨é…ç½®ç±»ï¼šThymeleafProperties</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;spring.thymeleaf&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThymeleafProperties</span> </span>&#123;    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Charset DEFAULT_ENCODING;    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DEFAULT_PREFIX = <span class="hljs-string">&quot;classpath:/templates/&quot;</span>;    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DEFAULT_SUFFIX = <span class="hljs-string">&quot;.html&quot;</span>;    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> checkTemplate = <span class="hljs-keyword">true</span>;    <br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> checkTemplateLocation = <span class="hljs-keyword">true</span>;    <br>    <span class="hljs-keyword">private</span> String prefix = <span class="hljs-string">&quot;classpath:/templates/&quot;</span>;    <br>    <span class="hljs-keyword">private</span> String suffix = <span class="hljs-string">&quot;.html&quot;</span>;    <br>    <span class="hljs-keyword">private</span> String mode = <span class="hljs-string">&quot;HTML&quot;</span>;    <br>    <span class="hljs-keyword">private</span> Charset encoding;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­çœ‹åˆ°é»˜è®¤çš„å‰ç¼€å’Œåç¼€ï¼</p><p>æˆ‘ä»¬åªéœ€è¦æŠŠæˆ‘ä»¬çš„htmlé¡µé¢æ”¾åœ¨ç±»è·¯å¾„ä¸‹çš„templatesä¸‹ï¼Œthymeleafå°±å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨æ¸²æŸ“äº†ã€‚</p><p>ä½¿ç”¨thymeleafä»€ä¹ˆéƒ½ä¸éœ€è¦é…ç½®ï¼Œåªéœ€è¦å°†ä»–æ”¾åœ¨æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸‹å³å¯</p><p><img src="/2021/01/29/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Thymeleaf%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/image-20210304182325810.png" alt="image-20210304182325810"></p><h1 id="Thymeleaf-æµ‹è¯•"><a href="#Thymeleaf-æµ‹è¯•" class="headerlink" title="Thymeleaf æµ‹è¯•"></a>Thymeleaf æµ‹è¯•</h1><p>Thymeleaf å®˜ç½‘ï¼š<a href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a> </p><p><strong>ç®€å•çš„ç»ƒä¹  ï¼šæˆ‘ä»¬éœ€è¦æŸ¥å‡ºä¸€äº›æ•°æ®ï¼Œåœ¨é¡µé¢ä¸­å±•ç¤º</strong></p><p>1ã€ä¿®æ”¹æµ‹è¯•è¯·æ±‚ï¼Œå¢åŠ æ•°æ®ä¼ è¾“ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/t1&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test1</span><span class="hljs-params">(Model model)</span></span>&#123;    <br>    <span class="hljs-comment">//å­˜å…¥æ•°æ®    </span><br>    model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;Hello,Thymeleaf&quot;</span>);    <br>    <span class="hljs-comment">//classpath:/templates/test.html    </span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æˆ‘ä»¬è¦ä½¿ç”¨thymeleafï¼Œéœ€è¦åœ¨htmlæ–‡ä»¶ä¸­å¯¼å…¥å‘½åç©ºé—´çš„çº¦æŸï¼Œæ–¹ä¾¿æç¤ºã€‚</p><p>æˆ‘ä»¬å¯ä»¥å»å®˜æ–¹æ–‡æ¡£çš„#3ä¸­çœ‹ä¸€ä¸‹å‘½åç©ºé—´æ‹¿æ¥è¿‡æ¥ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">xmlns:th=&quot;http://www.thymeleaf.org&quot;<br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬å»ç¼–å†™ä¸‹å‰ç«¯é¡µé¢</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span>    <br>        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç‹‚ç¥è¯´<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-comment">&lt;!--th:textå°±æ˜¯å°†divä¸­çš„å†…å®¹è®¾ç½®ä¸ºå®ƒæŒ‡å®šçš„å€¼ï¼Œå’Œä¹‹å‰å­¦ä¹ çš„Vueä¸€æ ·--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€å¯åŠ¨æµ‹è¯•ï¼</p><p><img src="/2021/01/29/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Thymeleaf%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/image-20210205165049143.png" alt="image-20210205165049143"></p><h1 id="Thymeleaf-è¯­æ³•åˆ†æ"><a href="#Thymeleaf-è¯­æ³•åˆ†æ" class="headerlink" title="Thymeleaf è¯­æ³•åˆ†æ"></a>Thymeleaf è¯­æ³•åˆ†æ</h1><p><strong>1ã€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»æ„çš„ th:attr æ¥æ›¿æ¢Htmlä¸­åŸç”Ÿå±æ€§çš„å€¼ï¼</strong></p><p><img src="/2021/01/29/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Thymeleaf%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/1.jpg"></p><p><strong>2ã€èƒ½å†™å“ªäº›è¡¨è¾¾å¼ï¼Ÿ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><br>Simple expressions:ï¼ˆè¡¨è¾¾å¼è¯­æ³•ï¼‰<br>Variable Expressions: $&#123;...&#125;ï¼šè·å–å˜é‡å€¼ï¼›OGNLï¼›<br>    <span class="hljs-number">1</span>ï¼‰ã€è·å–å¯¹è±¡çš„å±æ€§ã€è°ƒç”¨æ–¹æ³•<br>    2ï¼‰ã€ä½¿ç”¨å†…ç½®çš„åŸºæœ¬å¯¹è±¡ï¼š#18<br>         #ctx : the context object.<br>         #vars: the context variables.<br>         #locale : the context locale.<br>         #request : (only in Web Contexts) the HttpServletRequest object.<br>         #response : (only in Web Contexts) the HttpServletResponse object.<br>         #session : (only in Web Contexts) the HttpSession object.<br>         #servletContext : (only in Web Contexts) the ServletContext object.<br><br>    <span class="hljs-number">3</span>ï¼‰ã€å†…ç½®çš„ä¸€äº›å·¥å…·å¯¹è±¡ï¼š<br>ã€€ã€€ã€€ã€€ã€€ã€€#execInfo : information about the template being processed.<br>ã€€ã€€ã€€ã€€ã€€ã€€#uris : methods for escaping parts of URLs/URIs<br>ã€€ã€€ã€€ã€€ã€€ã€€#conversions : methods for executing the configured conversion service (if any).<br>ã€€ã€€ã€€ã€€ã€€ã€€#dates : methods for java.util.Date objects: formatting, component extraction, etc.<br>ã€€ã€€ã€€ã€€ã€€ã€€#calendars : analogous to #dates , but for java.util.Calendar objects.<br>ã€€ã€€ã€€ã€€ã€€ã€€#numbers : methods for formatting numeric objects.<br>ã€€ã€€ã€€ã€€ã€€ã€€#strings : methods for String objects: contains, startsWith, prepending/appending, etc.<br>ã€€ã€€ã€€ã€€ã€€ã€€#objects : methods for objects in general.<br>ã€€ã€€ã€€ã€€ã€€ã€€#bools : methods for boolean evaluation.<br>ã€€ã€€ã€€ã€€ã€€ã€€#arrays : methods for arrays.<br>ã€€ã€€ã€€ã€€ã€€ã€€#lists : methods for lists.<br>ã€€ã€€ã€€ã€€ã€€ã€€#sets : methods for sets.<br>ã€€ã€€ã€€ã€€ã€€ã€€#maps : methods for maps.<br>ã€€ã€€ã€€ã€€ã€€ã€€#aggregates : methods for creating aggregates on arrays or collections.<br>==================================================================================<br><br>  Selection Variable Expressions: *&#123;...&#125;ï¼šé€‰æ‹©è¡¨è¾¾å¼ï¼šå’Œ$&#123;&#125;åœ¨åŠŸèƒ½ä¸Šæ˜¯ä¸€æ ·ï¼›<br>  Message Expressions: #&#123;...&#125;ï¼šè·å–å›½é™…åŒ–å†…å®¹<br>  Link URL Expressions: @&#123;...&#125;ï¼šå®šä¹‰URLï¼›<br>  Fragment Expressions: ~&#123;...&#125;ï¼šç‰‡æ®µå¼•ç”¨è¡¨è¾¾å¼<br><br>Literalsï¼ˆå­—é¢é‡ï¼‰<br>      Text literals: <span class="hljs-string">&#x27;one text&#x27;</span> , <span class="hljs-string">&#x27;Another one!&#x27;</span> ,â€¦<br>      Number literals: <span class="hljs-number">0</span> , <span class="hljs-number">34</span> , <span class="hljs-number">3.0</span> , <span class="hljs-number">12.3</span> ,â€¦<br>      Boolean literals: <span class="hljs-keyword">true</span> , <span class="hljs-keyword">false</span><br>      Null literal: <span class="hljs-keyword">null</span><br>      Literal tokens: one , sometext , main ,â€¦<br>      <br>Text operations:ï¼ˆæ–‡æœ¬æ“ä½œï¼‰<br>    String concatenation: +<br>    Literal substitutions: |The name is $&#123;name&#125;|<br>    <br>Arithmetic operations:ï¼ˆæ•°å­¦è¿ç®—ï¼‰<br>    Binary operators: + , - , * , / , %<br>    <span class="hljs-function">Minus <span class="hljs-title">sign</span> <span class="hljs-params">(unary operator)</span>: -</span><br><span class="hljs-function">    </span><br><span class="hljs-function">Boolean operations:ï¼ˆå¸ƒå°”è¿ç®—ï¼‰</span><br><span class="hljs-function">    Binary operators: and , or</span><br><span class="hljs-function">    Boolean <span class="hljs-title">negation</span> <span class="hljs-params">(unary operator)</span>: ! , not</span><br><span class="hljs-function">    </span><br><span class="hljs-function">Comparisons and equality:ï¼ˆæ¯”è¾ƒè¿ç®—ï¼‰</span><br><span class="hljs-function">    Comparators: &gt; , &lt; , &gt;</span>= , &lt;= ( gt , lt , ge , le )<br>    Equality operators: == , != ( eq , ne )<br>    <br>Conditional operators:æ¡ä»¶è¿ç®—ï¼ˆä¸‰å…ƒè¿ç®—ç¬¦ï¼‰<br>    If-then: (<span class="hljs-keyword">if</span>) ? (then)<br>    If-then-<span class="hljs-keyword">else</span>: (<span class="hljs-keyword">if</span>) ? (then) : (<span class="hljs-keyword">else</span>)<br>    Default: (value) ?: (defaultvalue)<br>    <br>Special tokens:<br>    No-Operation: _<br></code></pre></td></tr></table></figure><p><strong>ç»ƒä¹ æµ‹è¯•ï¼š</strong></p><p>æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªControllerï¼Œæ”¾ä¸€äº›æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-meta">@RequestMapping(&quot;/t2&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test2</span><span class="hljs-params">(Map&lt;String,Object&gt; map)</span></span>&#123;<br>    <span class="hljs-comment">//å­˜å…¥æ•°æ®</span><br>    map.put(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;&lt;h1&gt;Hello&lt;/h1&gt;&quot;</span>);<br>    map.put(<span class="hljs-string">&quot;users&quot;</span>, Arrays.asList(<span class="hljs-string">&quot;qinjiang&quot;</span>,<span class="hljs-string">&quot;kuangshen&quot;</span>));<br>    <span class="hljs-comment">//classpath:/templates/test.html</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æµ‹è¯•é¡µé¢å–å‡ºæ•°æ®</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç‹‚ç¥è¯´<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æµ‹è¯•é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-comment">&lt;!--ä¸è½¬ä¹‰--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:utext</span>=<span class="hljs-string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--éå†æ•°æ®--&gt;</span><br><span class="hljs-comment">&lt;!--th:eachæ¯æ¬¡éå†éƒ½ä¼šç”Ÿæˆå½“å‰è¿™ä¸ªæ ‡ç­¾ï¼šå®˜ç½‘#9--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;user :$&#123;users&#125;&quot;</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;user&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--è¡Œå†…å†™æ³•ï¼šå®˜ç½‘#12--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;user:$&#123;users&#125;&quot;</span>&gt;</span>[[$&#123;user&#125;]]<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€å¯åŠ¨é¡¹ç›®æµ‹è¯•ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>yamlåŸºç¡€</title>
    <link href="/2021/01/18/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/yaml%E5%9F%BA%E7%A1%80/"/>
    <url>/2021/01/18/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/yaml%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="yamlæ¦‚è¿°"><a href="#yamlæ¦‚è¿°" class="headerlink" title="yamlæ¦‚è¿°"></a>yamlæ¦‚è¿°</h1><p>YAMLæ˜¯ â€œYAML Ainâ€™t a Markup Languageâ€ ï¼ˆYAMLä¸æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼‰çš„é€’å½’ç¼©å†™ã€‚åœ¨å¼€å‘çš„è¿™ç§è¯­è¨€æ—¶ï¼ŒYAML çš„æ„æ€å…¶å®æ˜¯ï¼šâ€Yet Another Markup Languageâ€ï¼ˆä»æ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼‰</p><p><strong>è¿™ç§è¯­è¨€ä»¥æ•°æ®ä½œä¸ºä¸­å¿ƒï¼Œè€Œä¸æ˜¯ä»¥æ ‡è®°è¯­è¨€ä¸ºé‡ç‚¹ï¼</strong></p><p>ä»¥å‰çš„é…ç½®æ–‡ä»¶ï¼Œå¤§å¤šæ•°éƒ½æ˜¯ä½¿ç”¨xmlæ¥é…ç½®ï¼›æ¯”å¦‚ä¸€ä¸ªç®€å•çš„ç«¯å£é…ç½®ï¼Œæˆ‘ä»¬æ¥å¯¹æ¯”ä¸‹yamlå’Œxml</p><p>ä¼ ç»Ÿxmlé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span>8081<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br></code></pre></td></tr></table></figure><p>yamlé…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">serverï¼š</span>  <span class="hljs-attr">prot:</span> <span class="hljs-number">8080</span><br></code></pre></td></tr></table></figure><h1 id="yamlåŸºç¡€è¯­æ³•"><a href="#yamlåŸºç¡€è¯­æ³•" class="headerlink" title="yamlåŸºç¡€è¯­æ³•"></a>yamlåŸºç¡€è¯­æ³•</h1><p>è¯´æ˜ï¼šè¯­æ³•è¦æ±‚ä¸¥æ ¼ï¼</p><p>1ã€ç©ºæ ¼ä¸èƒ½çœç•¥</p><p>2ã€ä»¥ç¼©è¿›æ¥æ§åˆ¶å±‚çº§å…³ç³»ï¼Œåªè¦æ˜¯å·¦è¾¹å¯¹é½çš„ä¸€åˆ—æ•°æ®éƒ½æ˜¯åŒä¸€ä¸ªå±‚çº§çš„ã€‚</p><p>3ã€å±æ€§å’Œå€¼çš„å¤§å°å†™éƒ½æ˜¯ååˆ†æ•æ„Ÿçš„ã€‚</p><h2 id="å­—é¢é‡ï¼šæ™®é€šçš„å€¼-æ•°å­—ï¼Œå¸ƒå°”å€¼ï¼Œå­—ç¬¦ä¸²"><a href="#å­—é¢é‡ï¼šæ™®é€šçš„å€¼-æ•°å­—ï¼Œå¸ƒå°”å€¼ï¼Œå­—ç¬¦ä¸²" class="headerlink" title="å­—é¢é‡ï¼šæ™®é€šçš„å€¼  [ æ•°å­—ï¼Œå¸ƒå°”å€¼ï¼Œå­—ç¬¦ä¸²  ]"></a><strong>å­—é¢é‡ï¼šæ™®é€šçš„å€¼  [ æ•°å­—ï¼Œå¸ƒå°”å€¼ï¼Œå­—ç¬¦ä¸²  ]</strong></h2><p>å­—é¢é‡ç›´æ¥å†™åœ¨åé¢å°±å¯ä»¥ ï¼Œ å­—ç¬¦ä¸²é»˜è®¤ä¸ç”¨åŠ ä¸ŠåŒå¼•å·æˆ–è€…å•å¼•å·ï¼›</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">k:</span> <span class="hljs-string">v</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><ul><li><p>â€œ â€ åŒå¼•å·ï¼Œä¸ä¼šè½¬ä¹‰å­—ç¬¦ä¸²é‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦ ï¼Œ ç‰¹æ®Šå­—ç¬¦ä¼šä½œä¸ºæœ¬èº«æƒ³è¡¨ç¤ºçš„æ„æ€ï¼›</p><p>æ¯”å¦‚ ï¼šname: â€œkuang \n shenâ€  è¾“å‡º ï¼škuang  æ¢è¡Œ  shen</p></li><li><p>â€˜â€™ å•å¼•å·ï¼Œä¼šè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ ï¼Œ ç‰¹æ®Šå­—ç¬¦æœ€ç»ˆä¼šå˜æˆå’Œæ™®é€šå­—ç¬¦ä¸€æ ·è¾“å‡º</p><p>æ¯”å¦‚ ï¼šname: â€˜kuang \n shenâ€™  è¾“å‡º ï¼škuang  \n  shen</p></li></ul><h2 id="å¯¹è±¡ã€Mapï¼ˆé”®å€¼å¯¹ï¼‰"><a href="#å¯¹è±¡ã€Mapï¼ˆé”®å€¼å¯¹ï¼‰" class="headerlink" title="å¯¹è±¡ã€Mapï¼ˆé”®å€¼å¯¹ï¼‰"></a><strong>å¯¹è±¡ã€Mapï¼ˆé”®å€¼å¯¹ï¼‰</strong></h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#å¯¹è±¡ã€Mapæ ¼å¼</span><br><span class="hljs-attr">k:</span>     <br><span class="hljs-attr">v1:</span>    <br><span class="hljs-attr">v2:</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸‹ä¸€è¡Œæ¥å†™å¯¹è±¡çš„å±æ€§å’Œå€¼å¾—å…³ç³»ï¼Œæ³¨æ„ç¼©è¿›ï¼›æ¯”å¦‚ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">student:</span>    <br><span class="hljs-attr">name:</span> <span class="hljs-string">mocheng</span>    <br><span class="hljs-attr">age:</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>è¡Œå†…å†™æ³•</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">student:</span> &#123;<span class="hljs-attr">name:</span> <span class="hljs-string">qinjiang</span>,<span class="hljs-attr">age:</span> <span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ•°ç»„ï¼ˆ-Listã€set-ï¼‰"><a href="#æ•°ç»„ï¼ˆ-Listã€set-ï¼‰" class="headerlink" title="æ•°ç»„ï¼ˆ Listã€set ï¼‰"></a><strong>æ•°ç»„ï¼ˆ Listã€set ï¼‰</strong></h2><p>ç”¨ - å€¼è¡¨ç¤ºæ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ ,æ¯”å¦‚ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">pets:</span> <br><span class="hljs-bullet">-</span> <span class="hljs-string">cat</span> <br><span class="hljs-bullet">-</span> <span class="hljs-string">dog</span> <br><span class="hljs-bullet">-</span> <span class="hljs-string">pig</span><br></code></pre></td></tr></table></figure><p>è¡Œå†…å†™æ³•</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">pets:</span> [<span class="hljs-string">cat</span>,<span class="hljs-string">dog</span>,<span class="hljs-string">pig</span>]<br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹é»˜è®¤ç«¯å£å·"><a href="#ä¿®æ”¹é»˜è®¤ç«¯å£å·" class="headerlink" title="ä¿®æ”¹é»˜è®¤ç«¯å£å·"></a><strong>ä¿®æ”¹é»˜è®¤ç«¯å£å·</strong></h2><p>é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼Œç«¯å£å·çš„å‚æ•°ï¼Œå°±å¯ä»¥åˆ‡æ¢ç«¯å£ï¼›</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:  port:</span> <span class="hljs-number">8082</span><br></code></pre></td></tr></table></figure><h1 id="yamlæ³¨å…¥é…ç½®æ–‡ä»¶"><a href="#yamlæ³¨å…¥é…ç½®æ–‡ä»¶" class="headerlink" title="yamlæ³¨å…¥é…ç½®æ–‡ä»¶"></a>yamlæ³¨å…¥é…ç½®æ–‡ä»¶</h1><p>yamlæ–‡ä»¶æ›´å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼Œä»–å¯ä»¥ç»™æˆ‘ä»¬çš„å®ä½“ç±»ç›´æ¥æ³¨å…¥åŒ¹é…å€¼ï¼</p><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><p>1ã€åœ¨springbooté¡¹ç›®ä¸­çš„resourcesç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ application.yml</p><p>2ã€ç¼–å†™ä¸€ä¸ªå®ä½“ç±» personï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.springboot.pojo;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">@ConfigurationPropertiesä½œç”¨ï¼š</span><br><span class="hljs-comment">å°†é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ¯ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°è¿™ä¸ªç»„ä»¶ä¸­ï¼›</span><br><span class="hljs-comment">å‘Šè¯‰SpringBootå°†æœ¬ç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®š</span><br><span class="hljs-comment">å‚æ•° prefix = â€œpersonâ€ : å°†é…ç½®æ–‡ä»¶ä¸­çš„personä¸‹é¢çš„æ‰€æœ‰å±æ€§ä¸€ä¸€å¯¹åº”</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Component</span> <span class="hljs-comment">//æ³¨å†Œbean</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Boolean happy;<br>    <span class="hljs-keyword">private</span> Date birth;<br>    <span class="hljs-keyword">private</span> Map&lt;String,Object&gt; maps;<br>    <span class="hljs-keyword">private</span> List&lt;Object&gt; lists;<br>    <span class="hljs-keyword">private</span> Dog dog;<br>    <br>    <span class="hljs-comment">//æœ‰å‚æ— å‚æ„é€ ã€getã€setæ–¹æ³•ã€toString()æ–¹æ³•  </span><br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€ç¼–è¾‘application.yamlï¼ˆåŸapplication.propertiesï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">person:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">mocheng</span><br>  <span class="hljs-attr">age:</span> <span class="hljs-number">3</span><br>  <span class="hljs-attr">happy:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">birth:</span> <span class="hljs-number">2000</span><span class="hljs-string">/01/01</span><br>  <span class="hljs-attr">maps:</span> &#123;<span class="hljs-attr">k1:</span> <span class="hljs-string">v1</span>,<span class="hljs-attr">k2:</span> <span class="hljs-string">v2</span>&#125;<br>  <span class="hljs-attr">lists:</span><br>   <span class="hljs-bullet">-</span> <span class="hljs-string">code</span><br>   <span class="hljs-bullet">-</span> <span class="hljs-string">girl</span><br>   <span class="hljs-bullet">-</span> <span class="hljs-string">music</span><br>  <span class="hljs-attr">dog:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">æ—ºè´¢</span><br>    <span class="hljs-attr">age:</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>4ã€æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DemoApplicationTests</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    Person person; <span class="hljs-comment">//å°†personè‡ªåŠ¨æ³¨å…¥è¿›æ¥</span><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(person); <span class="hljs-comment">//æ‰“å°personä¿¡æ¯</span><br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong></p><p>è‹¥IDEA æç¤ºï¼Œspringbooté…ç½®æ³¨è§£å¤„ç†å™¨æ²¡æœ‰æ‰¾åˆ°ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><br><span class="hljs-comment">&lt;!-- å¯¼å…¥é…ç½®æ–‡ä»¶å¤„ç†å™¨ï¼Œé…ç½®æ–‡ä»¶è¿›è¡Œç»‘å®šå°±ä¼šæœ‰æç¤ºï¼Œéœ€è¦é‡å¯ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶"><a href="#åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶" class="headerlink" title="åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶"></a>åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶</h2><p><strong>@PropertySource ï¼š</strong>åŠ è½½æŒ‡å®šçš„é…ç½®æ–‡ä»¶ï¼›</p><p><strong>@configurationProperties</strong>ï¼šé»˜è®¤ä»å…¨å±€é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼›</p><p>1ã€æˆ‘ä»¬å»åœ¨resourcesç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<strong>person.properties</strong>æ–‡ä»¶</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">name</span> = <span class="hljs-string">kuangshen</span><br></code></pre></td></tr></table></figure><p>2ã€ç„¶ååœ¨æˆ‘ä»¬çš„ä»£ç ä¸­æŒ‡å®šåŠ è½½person.propertiesæ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@PropertySource(value = &quot;classpath:person.properties&quot;)</span><br><span class="hljs-meta">@Component</span> <span class="hljs-comment">//æ³¨å†Œbean</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;name&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    ......  <br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€å†æ¬¡è¾“å‡ºæµ‹è¯•ä¸€ä¸‹ï¼šæŒ‡å®šé…ç½®æ–‡ä»¶ç»‘å®šæˆåŠŸï¼</p><h2 id="é…ç½®æ–‡ä»¶å ä½ç¬¦"><a href="#é…ç½®æ–‡ä»¶å ä½ç¬¦" class="headerlink" title="é…ç½®æ–‡ä»¶å ä½ç¬¦"></a>é…ç½®æ–‡ä»¶å ä½ç¬¦</h2><p>é…ç½®æ–‡ä»¶è¿˜å¯ä»¥ç¼–å†™å ä½ç¬¦ç”Ÿæˆéšæœºæ•°</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">person:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">qinjiang$&#123;random.uuid&#125;</span> <span class="hljs-comment"># éšæœºuuid</span><br>    <span class="hljs-attr">age:</span> <span class="hljs-string">$&#123;random.int&#125;</span>  <span class="hljs-comment"># éšæœºint</span><br>    <span class="hljs-attr">happy:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">birth:</span> <span class="hljs-number">2000</span><span class="hljs-string">/01/01</span><br>    <span class="hljs-attr">maps:</span> &#123;<span class="hljs-attr">k1:</span> <span class="hljs-string">v1</span>,<span class="hljs-attr">k2:</span> <span class="hljs-string">v2</span>&#125;<br>    <span class="hljs-attr">lists:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">code</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">girl</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">music</span><br>    <span class="hljs-attr">dog:</span><br>      <span class="hljs-attr">name:</span> <span class="hljs-string">$&#123;person.hello:other&#125;_æ—ºè´¢</span><br>      <span class="hljs-attr">age:</span> <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h1 id="propertiesä¸yamlæ¯”è¾ƒ"><a href="#propertiesä¸yamlæ¯”è¾ƒ" class="headerlink" title="propertiesä¸yamlæ¯”è¾ƒ"></a>propertiesä¸yamlæ¯”è¾ƒ</h1><p><img src="/2021/01/18/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/yaml%E5%9F%BA%E7%A1%80/1.png"></p><p>1ã€@ConfigurationPropertiesåªéœ€è¦å†™ä¸€æ¬¡å³å¯ ï¼Œ @Valueåˆ™éœ€è¦æ¯ä¸ªå­—æ®µéƒ½æ·»åŠ </p><p>2ã€æ¾æ•£ç»‘å®šï¼šè¿™ä¸ªä»€ä¹ˆæ„æ€å‘¢? æ¯”å¦‚æˆ‘çš„ymlä¸­å†™çš„last-nameï¼Œè¿™ä¸ªå’ŒlastNameæ˜¯ä¸€æ ·çš„ï¼Œ - åé¢è·Ÿç€çš„å­—æ¯é»˜è®¤æ˜¯å¤§å†™çš„ã€‚è¿™å°±æ˜¯æ¾æ•£ç»‘å®šã€‚å¯ä»¥æµ‹è¯•ä¸€ä¸‹</p><p>3ã€JSR303æ•°æ®æ ¡éªŒ ï¼Œ è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å­—æ®µæ˜¯å¢åŠ ä¸€å±‚è¿‡æ»¤å™¨éªŒè¯ ï¼Œ å¯ä»¥ä¿è¯æ•°æ®çš„åˆæ³•æ€§</p><p>4ã€å¤æ‚ç±»å‹å°è£…ï¼Œymlä¸­å¯ä»¥å°è£…å¯¹è±¡ ï¼Œ ä½¿ç”¨valueå°±ä¸æ”¯æŒ</p><p><strong>ç»“è®ºï¼š</strong></p><p>é…ç½®ymlå’Œé…ç½®propertieséƒ½å¯ä»¥è·å–åˆ°å€¼ ï¼Œ å¼ºçƒˆæ¨è ymlï¼›</p><p>å¦‚æœæˆ‘ä»¬åœ¨æŸä¸ªä¸šåŠ¡ä¸­ï¼Œåªéœ€è¦è·å–é…ç½®æ–‡ä»¶ä¸­çš„æŸä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸‹ @valueï¼›</p><p>å¦‚æœè¯´ï¼Œæˆ‘ä»¬ä¸“é—¨ç¼–å†™äº†ä¸€ä¸ªJavaBeanæ¥å’Œé…ç½®æ–‡ä»¶è¿›è¡Œä¸€ä¸€æ˜ å°„ï¼Œå°±ç›´æ¥@configurationPropertiesï¼Œä¸è¦çŠ¹è±«ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå¸¸ç”¨å‘½ä»¤</title>
    <link href="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <url>/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="lsï¼ˆlistï¼‰"><a href="#lsï¼ˆlistï¼‰" class="headerlink" title="lsï¼ˆlistï¼‰"></a>lsï¼ˆlistï¼‰</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">ls -a åˆ—å‡ºç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…å«ä»¥.å¼€å§‹çš„éšè—æ–‡ä»¶<br>ls -A åˆ—å‡ºé™¤.åŠ..çš„å…¶å®ƒæ–‡ä»¶<br>ls -r ååºæ’åˆ—<br>ls -t ä»¥æ–‡ä»¶ä¿®æ”¹æ—¶é—´æ’åº<br>ls -S ä»¥æ–‡ä»¶å¤§å°æ’åº<br>ls -h ä»¥æ˜“è¯»å¤§å°æ˜¾ç¤º<br>ls -l é™¤äº†æ–‡ä»¶åä¹‹å¤–ï¼Œè¿˜å°†æ–‡ä»¶çš„æƒé™ã€æ‰€æœ‰è€…ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯è¯¦ç»†åˆ—å‡ºæ¥<br></code></pre></td></tr></table></figure><h1 id="cd-changeDirectory"><a href="#cd-changeDirectory" class="headerlink" title="cd(changeDirectory)"></a>cd(changeDirectory)</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cd</span><span class="hljs-meta"> [ç›®å½•å]</span><br></code></pre></td></tr></table></figure><p>è¯´æ˜ï¼šåˆ‡æ¢å½“å‰ç›®å½•è‡³ dirName</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd / #ï¼ˆ1ï¼‰è¿›å…¥è¦ç›®å½•<br>cd ~ #ï¼ˆ2ï¼‰è¿›å…¥ &quot;home&quot; ç›®å½•<br>cd - #ï¼ˆ3ï¼‰è¿›å…¥ä¸Šä¸€æ¬¡å·¥ä½œè·¯å¾„<br></code></pre></td></tr></table></figure><h1 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h1><p>pwd å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•è·¯å¾„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">pwd   #ï¼ˆ1ï¼‰æŸ¥çœ‹å½“å‰è·¯å¾„<br>pwd -P#ï¼ˆ2ï¼‰æŸ¥çœ‹è½¯é“¾æ¥çš„å®é™…è·¯å¾„<br></code></pre></td></tr></table></figure><h1 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h1><p>mkdir å‘½ä»¤ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ã€‚</p><ul><li><strong>-m</strong>: å¯¹æ–°å»ºç›®å½•è®¾ç½®å­˜å–æƒé™ï¼Œä¹Ÿå¯ä»¥ç”¨ chmod å‘½ä»¤è®¾ç½®;</li><li><strong>-p</strong>: å¯ä»¥æ˜¯ä¸€ä¸ªè·¯å¾„åç§°ã€‚æ­¤æ—¶è‹¥è·¯å¾„ä¸­çš„æŸäº›ç›®å½•å°šä¸å­˜åœ¨,åŠ ä¸Šæ­¤é€‰é¡¹åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨å»ºç«‹å¥½é‚£äº›å°šä¸åœ¨çš„ç›®å½•ï¼Œå³ä¸€æ¬¡å¯ä»¥å»ºç«‹å¤šä¸ªç›®å½•ã€‚</li></ul><h1 id="touch"><a href="#touch" class="headerlink" title="touch"></a>touch</h1><p>åˆ›å»ºæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">touch  somefile.1       <br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶</span></span><br></code></pre></td></tr></table></figure><h1 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h1><p>åˆ é™¤ä¸€ä¸ªç›®å½•ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ -r é€‰é¡¹ï¼Œåˆ™ rm ä¸ä¼šåˆ é™¤ç›®å½•ã€‚å¦‚æœä½¿ç”¨ rm æ¥åˆ é™¤æ–‡ä»¶ï¼Œé€šå¸¸ä»å¯ä»¥å°†è¯¥æ–‡ä»¶æ¢å¤åŸçŠ¶ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">rm</span> <span class="hljs-selector-attr">[é€‰é¡¹]</span> æ–‡ä»¶â€¦<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ï¼ˆ1ï¼‰åˆ é™¤ä»»ä½• .<span class="hljs-built_in">log</span> æ–‡ä»¶ï¼Œåˆ é™¤å‰é€ä¸€è¯¢é—®ç¡®è®¤ï¼š</span><br>rm -i *.log<br><span class="hljs-meta">#</span><span class="bash">ï¼ˆ2ï¼‰åˆ é™¤ <span class="hljs-built_in">test</span> å­ç›®å½•åŠå­ç›®å½•ä¸­æ‰€æœ‰æ¡£æ¡ˆåˆ é™¤ï¼Œå¹¶ä¸”ä¸ç”¨ä¸€ä¸€ç¡®è®¤ï¼š</span><br>rm -rf test<br><span class="hljs-meta">#</span><span class="bash">ï¼ˆ3ï¼‰åˆ é™¤ä»¥ -f å¼€å¤´çš„æ–‡ä»¶</span><br>rm -- -f*<br></code></pre></td></tr></table></figure><h1 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h1><p>ä»ä¸€ä¸ªç›®å½•ä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­ç›®å½•é¡¹ï¼Œåˆ é™¤æŸç›®å½•æ—¶ä¹Ÿå¿…é¡»å…·æœ‰å¯¹å…¶çˆ¶ç›®å½•çš„å†™æƒé™ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šä¸èƒ½åˆ é™¤éç©ºç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰å½“ parent å­ç›®å½•è¢«åˆ é™¤åä½¿å®ƒä¹Ÿæˆä¸ºç©ºç›®å½•çš„è¯ï¼Œåˆ™é¡ºä¾¿ä¸€å¹¶åˆ é™¤ï¼š</span><br>rmdir -p parent/child/child11<br></code></pre></td></tr></table></figure><h1 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h1><p>ç§»åŠ¨æ–‡ä»¶æˆ–ä¿®æ”¹æ–‡ä»¶åï¼Œæ ¹æ®ç¬¬äºŒå‚æ•°ç±»å‹ï¼ˆå¦‚ç›®å½•ï¼Œåˆ™ç§»åŠ¨æ–‡ä»¶ï¼›å¦‚ä¸ºæ–‡ä»¶åˆ™é‡å‘½ä»¤è¯¥æ–‡ä»¶ï¼‰ã€‚</p><p>å½“ç¬¬äºŒä¸ªå‚æ•°ä¸ºç›®å½•æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¤šä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œç„¶åç§»åŠ¨ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¤šä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„ç›®å½•ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰å°†æ–‡ä»¶ test.log é‡å‘½åä¸º test1.txt</span><br>mv test.log test1.txt<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰å°†æ–‡ä»¶ log1.txt,log2.txt,log3.txt ç§»åŠ¨åˆ°æ ¹çš„ test3 ç›®å½•ä¸­</span><br>mv llog1.txt log2.txt log3.txt /test3<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ3ï¼‰å°†æ–‡ä»¶ file1 æ”¹åä¸º file2ï¼Œå¦‚æœ file2 å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¢é—®æ˜¯å¦è¦†ç›–</span><br>mv -i log1.txt log2.txt<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ4ï¼‰ç§»åŠ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°ä¸Šä¸€çº§ç›®å½•</span><br>mv * ../<br></code></pre></td></tr></table></figure><h1 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h1><p>å°†æºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡æ–‡ä»¶ï¼Œæˆ–å°†å¤šä¸ªæºæ–‡ä»¶å¤åˆ¶è‡³ç›®æ ‡ç›®å½•ã€‚</p><p>æ³¨æ„ï¼šå‘½ä»¤è¡Œå¤åˆ¶ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¼šæç¤ºæ˜¯å¦è¦†ç›–ï¼Œè€Œåœ¨ shell è„šæœ¬ä¸­ï¼Œå¦‚æœä¸åŠ  -i å‚æ•°ï¼Œåˆ™ä¸ä¼šæç¤ºï¼Œè€Œæ˜¯ç›´æ¥è¦†ç›–ï¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> -i æç¤º</span><br><span class="hljs-meta">#</span><span class="bash"> -r å¤åˆ¶ç›®å½•åŠç›®å½•å†…æ‰€æœ‰é¡¹ç›®</span><br><span class="hljs-meta">#</span><span class="bash"> -a å¤åˆ¶çš„æ–‡ä»¶ä¸åŸæ–‡ä»¶æ—¶é—´ä¸€æ ·</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰å¤åˆ¶ a.txt åˆ° <span class="hljs-built_in">test</span> ç›®å½•ä¸‹ï¼Œä¿æŒåŸæ–‡ä»¶æ—¶é—´ï¼Œå¦‚æœåŸæ–‡ä»¶å­˜åœ¨æç¤ºæ˜¯å¦è¦†ç›–ã€‚</span><br>cp -ai a.txt test<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰ä¸º a.txt å»ºä¸€ä¸ªé“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰</span><br>cp -s a.txt link_a.txt<br></code></pre></td></tr></table></figure><h1 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h1><p>cat ä¸»è¦æœ‰ä¸‰å¤§åŠŸèƒ½ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> 1.ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶:</span><br>cat filename<br><span class="hljs-meta">#</span><span class="bash"> 2.ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶:åªèƒ½åˆ›å»ºæ–°æ–‡ä»¶ï¼Œä¸èƒ½ç¼–è¾‘å·²æœ‰æ–‡ä»¶ã€‚</span><br>cat &gt; filename<br><span class="hljs-meta">#</span><span class="bash"> 3.å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶:</span><br>cat file1 file2 &gt; file<br></code></pre></td></tr></table></figure><ul><li>-b å¯¹éç©ºè¾“å‡ºè¡Œå·</li><li>-n è¾“å‡ºæ‰€æœ‰è¡Œå·</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰æŠŠ log2012.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ log2013.log è¿™ä¸ªæ–‡ä»¶é‡Œ</span><br>cat -n log2012.log log2013.log<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰æŠŠ log2012.log å’Œ log2013.log çš„æ–‡ä»¶å†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° log.log é‡Œ</span><br>cat -b log2012.log log2013.log log.log<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ3ï¼‰ä½¿ç”¨ here doc ç”Ÿæˆæ–°æ–‡ä»¶</span><br>cat &gt;log.txt &lt;&lt;EOF<br><span class="hljs-meta">&gt;</span><span class="bash">Hello</span><br><span class="hljs-meta">&gt;</span><span class="bash">World</span><br><span class="hljs-meta">&gt;</span><span class="bash">PWD=$(<span class="hljs-built_in">pwd</span>)</span><br><span class="hljs-meta">&gt;</span><span class="bash">EOF</span><br>ls -l log.txt<br>cat log.txt<br>Hello<br>World<br>PWD=/opt/soft/test<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ4ï¼‰åå‘åˆ—ç¤º</span><br>tac log.txt<br>PWD=/opt/soft/test<br>World<br>Hello<br></code></pre></td></tr></table></figure><h1 id="which"><a href="#which" class="headerlink" title="which"></a>which</h1><p>åœ¨ linux è¦æŸ¥æ‰¾æŸä¸ªæ–‡ä»¶ï¼Œä½†ä¸çŸ¥é“æ”¾åœ¨å“ªé‡Œäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤æ¥æœç´¢ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">which</span>     <span class="hljs-string">æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®ã€‚</span><br><span class="hljs-attr">whereis</span> <span class="hljs-string">æŸ¥çœ‹æ–‡ä»¶çš„ä½ç½®ã€‚</span><br><span class="hljs-attr">locate</span>  <span class="hljs-string">é…åˆæ•°æ®åº“æŸ¥çœ‹æ–‡ä»¶ä½ç½®ã€‚</span><br><span class="hljs-attr">find</span>        <span class="hljs-string">å®é™…æœå¯»ç¡¬ç›˜æŸ¥è¯¢æ–‡ä»¶åç§°ã€‚</span><br></code></pre></td></tr></table></figure><h1 id="vi"><a href="#vi" class="headerlink" title="vi"></a>vi</h1><p>æ–‡æœ¬ç¼–è¾‘æ¨¡å¼</p><ul><li>è¿›å…¥æ–‡æœ¬åæŒ‰ i æˆ–è€… insertå¯è¿›å…¥ç¼–è¾‘</li><li>æŒ‰Escè¾“å…¥â€:â€,åœ¨åº•éƒ¨è¾“å…¥<ul><li>:q     é€€å‡º</li><li>:qï¼ ä¸ä¿å­˜å¼ºåˆ¶é€€å‡º</li><li>:wq  ä¿å­˜åé€€å‡º</li></ul></li></ul><h1 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h1><p>ç”¨äºæ”¹å˜ linux ç³»ç»Ÿæ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚ç”¨å®ƒæ§åˆ¶æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚è¯¥å‘½ä»¤æœ‰ä¸¤ç§ç”¨æ³•ã€‚ä¸€ç§æ˜¯åŒ…å«å­—æ¯å’Œæ“ä½œç¬¦è¡¨è¾¾å¼çš„æ–‡å­—è®¾å®šæ³•ï¼›å¦ä¸€ç§æ˜¯åŒ…å«æ•°å­—çš„æ•°å­—è®¾å®šæ³•ã€‚</p><p>æ¯ä¸€æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™éƒ½æœ‰ä¸‰ç»„ï¼Œæ¯ç»„ç”¨ä¸‰ä½è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºæ–‡ä»¶å±ä¸»çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ä¸å±ä¸»åŒç»„çš„ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼›ç³»ç»Ÿä¸­å…¶ä»–ç”¨æˆ·çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚å¯ä½¿ç”¨ ls -l test.txt æŸ¥æ‰¾ã€‚</p><p>ä»¥æ–‡ä»¶ log2012.log ä¸ºä¾‹ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">-rw-r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">296</span>K <span class="hljs-number">11</span><span class="hljs-number">-13</span> <span class="hljs-number">06</span>:<span class="hljs-number">03</span> log2012.log<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€åˆ—å…±æœ‰ 10 ä¸ªä½ç½®ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦æŒ‡å®šäº†æ–‡ä»¶ç±»å‹ã€‚åœ¨é€šå¸¸æ„ä¹‰ä¸Šï¼Œä¸€ä¸ªç›®å½•ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ¨ªçº¿ï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªéç›®å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ˜¯ dï¼Œè¡¨ç¤ºæ˜¯ä¸€ä¸ªç›®å½•ã€‚ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹åˆ°ç¬¬åä¸ª 9 ä¸ªå­—ç¬¦ï¼Œ3 ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºäº† 3 ç»„ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ã€‚æƒé™å­—ç¬¦ç”¨æ¨ªçº¿ä»£è¡¨ç©ºè®¸å¯ï¼Œr ä»£è¡¨åªè¯»ï¼Œw ä»£è¡¨å†™ï¼Œx ä»£è¡¨å¯æ‰§è¡Œã€‚</p><p>å¸¸ç”¨å‚æ•°ï¼š</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-c å½“å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒæŠ¥å‘Šå¤„ç†ä¿¡æ¯</span><br><span class="hljs-deletion">-R å¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><p>æƒé™èŒƒå›´ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">u</span> <span class="hljs-string">ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç”¨æˆ·</span><br><span class="hljs-attr">g</span> <span class="hljs-string">ï¼šç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰çš„ç¾¤ç»„</span><br><span class="hljs-attr">o</span> <span class="hljs-string">ï¼šé™¤äº†ç›®å½•æˆ–è€…æ–‡ä»¶çš„å½“å‰ç”¨æˆ·æˆ–ç¾¤ç»„ä¹‹å¤–çš„ç”¨æˆ·æˆ–è€…ç¾¤ç»„</span><br><span class="hljs-attr">a</span> <span class="hljs-string">ï¼šæ‰€æœ‰çš„ç”¨æˆ·åŠç¾¤ç»„</span><br></code></pre></td></tr></table></figure><p>æƒé™ä»£å·ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">r ï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—<span class="hljs-number">4</span>è¡¨ç¤º<br>w ï¼šå†™æƒé™ï¼Œç”¨æ•°å­—<span class="hljs-number">2</span>è¡¨ç¤º<br>x ï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—<span class="hljs-number">1</span>è¡¨ç¤º<br>- ï¼šåˆ é™¤æƒé™ï¼Œç”¨æ•°å­—<span class="hljs-number">0</span>è¡¨ç¤º<br>s ï¼šç‰¹æ®Šæƒé™<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰å¢åŠ æ–‡ä»¶ t.log æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™</span><br>chmod a+x t.log<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰æ’¤é”€åŸæ¥æ‰€æœ‰çš„æƒé™ï¼Œç„¶åä½¿æ‹¥æœ‰è€…å…·æœ‰å¯è¯»æƒé™,å¹¶è¾“å‡ºå¤„ç†ä¿¡æ¯</span><br>chmod u=r t.log -c<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ3ï¼‰ç»™ file çš„å±ä¸»åˆ†é…è¯»ã€å†™ã€æ‰§è¡Œ(7)çš„æƒé™ï¼Œç»™fileçš„æ‰€åœ¨ç»„åˆ†é…è¯»ã€æ‰§è¡Œ(5)çš„æƒé™ï¼Œç»™å…¶ä»–ç”¨æˆ·åˆ†é…æ‰§è¡Œ(1)çš„æƒé™</span><br>chmod 751 t.log -cï¼ˆæˆ–è€…ï¼šchmod u=rwx,g=rx,o=x t.log -c)<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ4ï¼‰å°† <span class="hljs-built_in">test</span> ç›®å½•åŠå…¶å­ç›®å½•æ‰€æœ‰æ–‡ä»¶æ·»åŠ å¯è¯»æƒé™</span><br>chmod u+r,g+r,o+r -R text/ -c<br></code></pre></td></tr></table></figure><h1 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h1><p>ç”¨æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚tar æœ¬èº«ä¸å…·æœ‰å‹ç¼©åŠŸèƒ½ï¼Œåªå…·æœ‰æ‰“åŒ…åŠŸèƒ½ï¼Œæœ‰å…³å‹ç¼©åŠè§£å‹æ˜¯è°ƒç”¨å…¶å®ƒçš„åŠŸèƒ½æ¥å®Œæˆã€‚</p><p>å¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæ‰“åŒ…å’Œå‹ç¼©ã€‚æ‰“åŒ…æ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼›å‹ç¼©åˆ™æ˜¯å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶é€šè¿‡ä¸€äº›å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶</p><p><strong>å¸¸ç”¨å‚æ•°ï¼š</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶</span><br><span class="hljs-deletion">-f æŒ‡å®šå‹ç¼©æ–‡ä»¶</span><br><span class="hljs-deletion">-r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©æ–‡ä»¶åŒ…ä¸­</span><br><span class="hljs-deletion">-u æ·»åŠ æ”¹äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å‹ç¼©åŒ…ä¸­</span><br><span class="hljs-deletion">-x ä»å‹ç¼©åŒ…ä¸­æŠ½å–æ–‡ä»¶</span><br><span class="hljs-deletion">-t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶ä¸­çš„å†…å®¹</span><br><span class="hljs-deletion">-z æ”¯æŒgzipå‹ç¼©</span><br><span class="hljs-deletion">-j æ”¯æŒbzip2å‹ç¼©</span><br><span class="hljs-deletion">-Z æ”¯æŒcompressè§£å‹æ–‡ä»¶</span><br><span class="hljs-deletion">-v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹</span><br></code></pre></td></tr></table></figure><p>æœ‰å…³ gzip åŠ bzip2 å‹ç¼©:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">gzip å®ä¾‹ï¼šå‹ç¼© gzip fileName .tar.gz å’Œ.tgz  è§£å‹ï¼šgunzip filename.gz æˆ– gzip -d filename.gz<br>          å¯¹åº”ï¼štar zcvf filename.tar.gz     tar zxvf filename.tar.gz<br><br>bz2å®ä¾‹ï¼šå‹ç¼© bzip2 -z filename .tar.bz2 è§£å‹ï¼šbunzip filename.bz2æˆ–bzip -d filename.bz2<br>       å¯¹åº”ï¼štar jcvf filename.tar.gz         è§£å‹ï¼štar jxvf filename.tar.bz2<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰å°†æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…æˆ tar åŒ…</span><br>tar -cvf log.tar 1.log,2.log æˆ–tar -cvf log.*<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰å°† /etc ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠç›®å½•æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶ä½¿ç”¨ gz å‹ç¼©</span><br>tar -zcvf /tmp/etc.tar.gz /etc<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ3ï¼‰æŸ¥çœ‹åˆšæ‰“åŒ…çš„æ–‡ä»¶å†…å®¹ï¼ˆä¸€å®šåŠ zï¼Œå› ä¸ºæ˜¯ä½¿ç”¨ gzip å‹ç¼©çš„ï¼‰</span><br>tar -ztvf /tmp/etc.tar.gz<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ4ï¼‰è¦å‹ç¼©æ‰“åŒ… /home, /etc ï¼Œä½†ä¸è¦ /home/dmtsai</span><br>tar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ5ï¼‰ä¸Šä¼ flumeåˆ°/toolsç›®å½•ä¸‹ï¼Œè§£å‹å®‰è£…</span><br>tar -zvxf /tools/apache-flume-1.9.0-bin.tar.gz -C /training/<br></code></pre></td></tr></table></figure><h1 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h1><p>å¼ºå¤§çš„æ–‡æœ¬æœç´¢å‘½ä»¤ï¼Œgrep(Global Regular Expression Print) å…¨å±€æ­£åˆ™è¡¨è¾¾å¼æœç´¢ã€‚</p><p>grep çš„å·¥ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²æ¨¡æ¿ã€‚å¦‚æœæ¨¡æ¿åŒ…æ‹¬ç©ºæ ¼ï¼Œåˆ™å¿…é¡»è¢«å¼•ç”¨ï¼Œæ¨¡æ¿åçš„æ‰€æœ‰å­—ç¬¦ä¸²è¢«çœ‹ä½œæ–‡ä»¶åã€‚æœç´¢çš„ç»“æœè¢«é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œä¸å½±å“åŸæ–‡ä»¶å†…å®¹ã€‚</p><p>å‘½ä»¤æ ¼å¼ï¼š</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">grep [<span class="hljs-keyword">option</span>] pattern <span class="hljs-keyword">file</span>|dir<br></code></pre></td></tr></table></figure><p>å¸¸ç”¨å‚æ•°ï¼š</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-A n --after-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦ånè¡Œ</span><br><span class="hljs-deletion">-B n --before-contextæ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰nè¡Œ</span><br><span class="hljs-deletion">-C n --context æ˜¾ç¤ºåŒ¹é…å­—ç¬¦å‰ånè¡Œ</span><br><span class="hljs-deletion">-c --count è®¡ç®—ç¬¦åˆæ ·å¼çš„åˆ—æ•°</span><br><span class="hljs-deletion">-i å¿½ç•¥å¤§å°å†™</span><br><span class="hljs-deletion">-l åªåˆ—å‡ºæ–‡ä»¶å†…å®¹ç¬¦åˆæŒ‡å®šçš„æ ·å¼çš„æ–‡ä»¶åç§°</span><br><span class="hljs-deletion">-f ä»æ–‡ä»¶ä¸­è¯»å–å…³é”®è¯</span><br><span class="hljs-deletion">-n æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„æ‰€åœ¨æ–‡ä»¶ä¸­è¡Œæ•°</span><br><span class="hljs-deletion">-R é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹</span><br></code></pre></td></tr></table></figure><p>grep çš„è§„åˆ™è¡¨è¾¾å¼:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">^  #é”šå®šè¡Œçš„å¼€å§‹ å¦‚ï¼š&#x27;^grep&#x27;åŒ¹é…æ‰€æœ‰ä»¥grepå¼€å¤´çš„è¡Œã€‚ <br><span class="hljs-meta">$</span><span class="bash">  <span class="hljs-comment">#é”šå®šè¡Œçš„ç»“æŸ å¦‚ï¼š&#x27;grep$&#x27;åŒ¹é…æ‰€æœ‰ä»¥grepç»“å°¾çš„è¡Œã€‚ </span></span><br>.  #åŒ¹é…ä¸€ä¸ªéæ¢è¡Œç¬¦çš„å­—ç¬¦ å¦‚ï¼š&#x27;gr.p&#x27;åŒ¹é…gråæ¥ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  <br>*  #åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå…ˆå‰å­—ç¬¦ å¦‚ï¼š&#x27;*grep&#x27;åŒ¹é…æ‰€æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åç´§è·Ÿgrepçš„è¡Œã€‚<br>.*   #ä¸€èµ·ç”¨ä»£è¡¨ä»»æ„å­—ç¬¦ã€‚  <br>[]   #åŒ¹é…ä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚&#x27;[Gg]rep&#x27;åŒ¹é…Grepå’Œgrepã€‚ <br>[^]  #åŒ¹é…ä¸€ä¸ªä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š&#x27;[^A-FH-Z]rep&#x27;åŒ¹é…ä¸åŒ…å«A-Rå’ŒT-Zçš„ä¸€ä¸ªå­—æ¯å¼€å¤´ï¼Œç´§è·Ÿrepçš„è¡Œã€‚  <br>\(..\)  #æ ‡è®°åŒ¹é…å­—ç¬¦ï¼Œå¦‚&#x27;\(love\)&#x27;ï¼Œloveè¢«æ ‡è®°ä¸º1ã€‚   <br>\&lt;      #é”šå®šå•è¯çš„å¼€å§‹ï¼Œå¦‚:&#x27;\&lt;grep&#x27;åŒ¹é…åŒ…å«ä»¥grepå¼€å¤´çš„å•è¯çš„è¡Œã€‚<br>\&gt;      #é”šå®šå•è¯çš„ç»“æŸï¼Œå¦‚&#x27;grep\&gt;&#x27;åŒ¹é…åŒ…å«ä»¥grepç»“å°¾çš„å•è¯çš„è¡Œã€‚<br>x\&#123;m\&#125;  #é‡å¤å­—ç¬¦xï¼Œmæ¬¡ï¼Œå¦‚ï¼š&#x27;0\&#123;5\&#125;&#x27;åŒ¹é…åŒ…å«5ä¸ªoçš„è¡Œã€‚ <br>x\&#123;m,\&#125;  #é‡å¤å­—ç¬¦x,è‡³å°‘mæ¬¡ï¼Œå¦‚ï¼š&#x27;o\&#123;5,\&#125;&#x27;åŒ¹é…è‡³å°‘æœ‰5ä¸ªoçš„è¡Œã€‚  <br>x\&#123;m,n\&#125;  #é‡å¤å­—ç¬¦xï¼Œè‡³å°‘mæ¬¡ï¼Œä¸å¤šäºnæ¬¡ï¼Œå¦‚ï¼š&#x27;o\&#123;5,10\&#125;&#x27;åŒ¹é…5--10ä¸ªoçš„è¡Œã€‚  <br>\w    #åŒ¹é…æ–‡å­—å’Œæ•°å­—å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯[A-Za-z0-9]ï¼Œå¦‚ï¼š&#x27;G\w*p&#x27;åŒ¹é…ä»¥Gåè·Ÿé›¶ä¸ªæˆ–å¤šä¸ªæ–‡å­—æˆ–æ•°å­—å­—ç¬¦ï¼Œç„¶åæ˜¯pã€‚  <br>\W    #\wçš„åç½®å½¢å¼ï¼ŒåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå•è¯å­—ç¬¦ï¼Œå¦‚ç‚¹å·å¥å·ç­‰ã€‚  <br>\b    #å•è¯é”å®šç¬¦ï¼Œå¦‚: &#x27;\bgrep\b&#x27;åªåŒ¹é…grepã€‚<br></code></pre></td></tr></table></figure><h1 id="ps-process-status"><a href="#ps-process-status" class="headerlink" title="ps (process status)"></a>ps (process status)</h1><p>ps(process status)ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ï¼Œä¸€æ¬¡æ€§æŸ¥çœ‹ï¼Œå¦‚æœéœ€è¦åŠ¨æ€è¿ç»­ç»“æœä½¿ç”¨ top</p><p>linuxä¸Šè¿›ç¨‹æœ‰5ç§çŠ¶æ€:</p><ul><li>\1. è¿è¡Œ(æ­£åœ¨è¿è¡Œæˆ–åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…)</li><li>\2. ä¸­æ–­(ä¼‘çœ ä¸­, å—é˜», åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å½¢æˆæˆ–æ¥å—åˆ°ä¿¡å·)</li><li>\3. ä¸å¯ä¸­æ–­(æ”¶åˆ°ä¿¡å·ä¸å”¤é†’å’Œä¸å¯è¿è¡Œ, è¿›ç¨‹å¿…é¡»ç­‰å¾…ç›´åˆ°æœ‰ä¸­æ–­å‘ç”Ÿ)</li><li>\4. åƒµæ­»(è¿›ç¨‹å·²ç»ˆæ­¢, ä½†è¿›ç¨‹æè¿°ç¬¦å­˜åœ¨, ç›´åˆ°çˆ¶è¿›ç¨‹è°ƒç”¨wait4()ç³»ç»Ÿè°ƒç”¨åé‡Šæ”¾)</li><li>\5. åœæ­¢(è¿›ç¨‹æ”¶åˆ°SIGSTOP, SIGSTP, SIGTIN, SIGTOUä¿¡å·ååœæ­¢è¿è¡Œè¿è¡Œ)</li></ul><p>ps å·¥å…·æ ‡è¯†è¿›ç¨‹çš„5ç§çŠ¶æ€ç :</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">D</span> <span class="hljs-string">ä¸å¯ä¸­æ–­ uninterruptible sleep (usually IO)</span><br><span class="hljs-attr">R</span> <span class="hljs-string">è¿è¡Œ runnable (on run queue)</span><br><span class="hljs-attr">S</span> <span class="hljs-string">ä¸­æ–­ sleeping</span><br><span class="hljs-attr">T</span> <span class="hljs-string">åœæ­¢ traced or stopped</span><br><span class="hljs-attr">Z</span> <span class="hljs-string">åƒµæ­» a defunct (â€zombieâ€) process</span><br></code></pre></td></tr></table></figure><p><strong>å‘½ä»¤å‚æ•°ï¼š</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">-A</span> <span class="hljs-string">æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</span><br><span class="hljs-attr">a</span> <span class="hljs-string">æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹</span><br><span class="hljs-meta">-a</span> <span class="hljs-string">æ˜¾ç¤ºåŒä¸€ç»ˆç«¯ä¸‹æ‰€æœ‰è¿›ç¨‹</span><br><span class="hljs-attr">c</span> <span class="hljs-string">æ˜¾ç¤ºè¿›ç¨‹çœŸå®åç§°</span><br><span class="hljs-attr">e</span> <span class="hljs-string">æ˜¾ç¤ºç¯å¢ƒå˜é‡</span><br><span class="hljs-attr">f</span> <span class="hljs-string">æ˜¾ç¤ºè¿›ç¨‹é—´çš„å…³ç³»</span><br><span class="hljs-attr">r</span> <span class="hljs-string">æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„è¿›ç¨‹</span><br><span class="hljs-meta">-aux</span> <span class="hljs-string">æ˜¾ç¤ºæ‰€æœ‰åŒ…å«å…¶å®ƒä½¿ç”¨çš„è¿›ç¨‹</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹ç¯å¢ƒå˜é‡åŠè¿›ç¨‹é—´å…³ç³»</span><br>ps -ef<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹</span><br>ps -A<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ3ï¼‰ä¸grepè”ç”¨æŸ¥æ‰¾æŸè¿›ç¨‹</span><br>ps -aux | grep apache<br></code></pre></td></tr></table></figure><h1 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h1><p>å‘é€æŒ‡å®šçš„ä¿¡å·åˆ°ç›¸åº”è¿›ç¨‹ã€‚ä¸æŒ‡å®šå‹å·å°†å‘é€SIGTERMï¼ˆ15ï¼‰ç»ˆæ­¢æŒ‡å®šè¿›ç¨‹ã€‚å¦‚æœä»»æ— æ³•ç»ˆæ­¢è¯¥ç¨‹åºå¯ç”¨â€-KILLâ€ å‚æ•°ï¼Œå…¶å‘é€çš„ä¿¡å·ä¸ºSIGKILL(9) ï¼Œå°†å¼ºåˆ¶ç»“æŸè¿›ç¨‹ï¼Œä½¿ç”¨pså‘½ä»¤æˆ–è€…jobs å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹å·ã€‚rootç”¨æˆ·å°†å½±å“ç”¨æˆ·çš„è¿›ç¨‹ï¼Œérootç”¨æˆ·åªèƒ½å½±å“è‡ªå·±çš„è¿›ç¨‹ã€‚</p><p><strong>å¸¸ç”¨å‚æ•°ï¼š</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-l  ä¿¡å·ï¼Œè‹¥æœä¸åŠ ä¿¡å·çš„ç¼–å·å‚æ•°ï¼Œåˆ™ä½¿ç”¨â€œ-lâ€å‚æ•°ä¼šåˆ—å‡ºå…¨éƒ¨çš„ä¿¡å·åç§°</span><br><span class="hljs-deletion">-a  å½“å¤„ç†å½“å‰è¿›ç¨‹æ—¶ï¼Œä¸é™åˆ¶å‘½ä»¤åå’Œè¿›ç¨‹å·çš„å¯¹åº”å…³ç³»</span><br><span class="hljs-deletion">-p  æŒ‡å®škill å‘½ä»¤åªæ‰“å°ç›¸å…³è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œè€Œä¸å‘é€ä»»ä½•ä¿¡å·</span><br><span class="hljs-deletion">-s  æŒ‡å®šå‘é€ä¿¡å·</span><br><span class="hljs-deletion">-u  æŒ‡å®šç”¨æˆ·</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">ï¼ˆ1ï¼‰å…ˆä½¿ç”¨psæŸ¥æ‰¾è¿›ç¨‹pro1ï¼Œç„¶åç”¨<span class="hljs-built_in">kill</span>æ€æ‰</span><br>kill -9 $(ps -ef | grep pro1)<br></code></pre></td></tr></table></figure><h1 id="free"><a href="#free" class="headerlink" title="free"></a>free</h1><p>æ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚</p><p><strong>å‘½ä»¤å‚æ•°ï¼š</strong></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-b ä»¥Byteæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class="hljs-deletion">-k ä»¥kbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class="hljs-deletion">-m ä»¥mbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class="hljs-deletion">-g ä»¥gbä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br><span class="hljs-deletion">-s&lt;é—´éš”ç§’æ•°&gt; æŒç»­æ˜¾ç¤ºå†…å­˜</span><br><span class="hljs-deletion">-t æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æ€»åˆ</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ1ï¼‰æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ</span><br>free<br>free -k<br>free -m<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ2ï¼‰ä»¥æ€»å’Œçš„å½¢å¼æ˜¾ç¤ºå†…å­˜çš„ä½¿ç”¨ä¿¡æ¯</span><br>free -t<br><span class="hljs-meta">#</span><span class="bash"> ï¼ˆ3ï¼‰å‘¨æœŸæ€§æŸ¥è¯¢å†…å­˜ä½¿ç”¨æƒ…å†µ</span><br>free -s 10<br></code></pre></td></tr></table></figure><h1 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š </span><br>systemctl status firewalld<br><br><span class="hljs-meta">#</span><span class="bash"> æ‰§è¡Œå…³é—­å‘½ä»¤ï¼š </span><br>systemctl stop firewalld<br><br><span class="hljs-meta">#</span><span class="bash"> æ‰§è¡Œå¼€æœºç¦ç”¨é˜²ç«å¢™è‡ªå¯å‘½ä»¤ï¼š</span><br>systemctl disable firewalld<br></code></pre></td></tr></table></figure><h1 id="ä¸»æœº"><a href="#ä¸»æœº" class="headerlink" title="ä¸»æœº"></a>ä¸»æœº</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è¿›è¡Œä¸»æœºåçš„ä¿®æ”¹ï¼š</span><br>vi /etc/hostsæˆ–vi /etc/hostname<br><br><span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹ä¸»æœºipåœ°å€</span><br>ifconfig<br></code></pre></td></tr></table></figure><h1 id="CPUè¿›ç¨‹"><a href="#CPUè¿›ç¨‹" class="headerlink" title="CPUè¿›ç¨‹"></a>CPUè¿›ç¨‹</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat /proc/cpuinfo | grep processor<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linuxç³»ç»Ÿ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>VMè™šæ‹Ÿæœºæ“ä½œè®°å½•ï¼šå¼€æœºå¡æ­»ã€è®¾ç½®é™æ€ip</title>
    <link href="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="ã€é‡åˆ°é—®é¢˜-å¼€æœºå¡æ­»ã€‘"><a href="#ã€é‡åˆ°é—®é¢˜-å¼€æœºå¡æ­»ã€‘" class="headerlink" title="ã€é‡åˆ°é—®é¢˜-å¼€æœºå¡æ­»ã€‘"></a>ã€é‡åˆ°é—®é¢˜-å¼€æœºå¡æ­»ã€‘</h1><p>ç”±äºéæ­£å¸¸æƒ…å†µé€€å‡ºé€ æˆçš„ï¼Œæ‰¾åˆ°è™šæ‹Ÿæœºæ‰€åœ¨ç›®å½•ï¼Œåˆ é™¤.lckæ–‡ä»¶å¤¹åˆ æ‰</p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/image-20210114112953853.png" alt="image-20210114112953853"></p><h1 id="ã€é‡åˆ°é—®é¢˜-è™šæ‹Ÿæœºipåœ°å€æ€»æ˜¯æ”¹å˜ã€‘"><a href="#ã€é‡åˆ°é—®é¢˜-è™šæ‹Ÿæœºipåœ°å€æ€»æ˜¯æ”¹å˜ã€‘" class="headerlink" title="ã€é‡åˆ°é—®é¢˜-è™šæ‹Ÿæœºipåœ°å€æ€»æ˜¯æ”¹å˜ã€‘"></a>ã€é‡åˆ°é—®é¢˜-è™šæ‹Ÿæœºipåœ°å€æ€»æ˜¯æ”¹å˜ã€‘</h1><p>é‡‡ç”¨æ–¹å¼ä¸ºNATæ¨¡å¼+å›ºå®šIPçš„æ¨¡å¼ã€‚</p><p><em>é…ç½®ç¯å¢ƒè¯´æ˜ï¼šä¸»æœºä¸ºWin10å®¶åº­ç‰ˆï¼Œè™šæ‹Ÿæœºä¸ºVMware Workstation 12 Proä¸­æ–‡ç‰ˆï¼Œè™šæ‹Ÿæœºä¸­çš„Linuxç³»ç»Ÿä¸ºCentOS 7 64ä½.</em></p><h2 id="ä¸€ã€æŸ¥çœ‹VMè™šæ‹Ÿæœºipåœ°å€èŒƒå›´"><a href="#ä¸€ã€æŸ¥çœ‹VMè™šæ‹Ÿæœºipåœ°å€èŒƒå›´" class="headerlink" title="ä¸€ã€æŸ¥çœ‹VMè™šæ‹Ÿæœºipåœ°å€èŒƒå›´"></a>ä¸€ã€æŸ¥çœ‹VMè™šæ‹Ÿæœºipåœ°å€èŒƒå›´</h2><p>åœ¨èœå•æ é€‰æ‹©ç¼–è¾‘â†’ è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ï¼Œæ‰“å¼€è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨å¯¹è¯æ¡†ï¼Œé€‰æ‹©Netç½‘ç»œè¿æ¥æ–¹å¼ï¼Œéšæ„è®¾ç½®å­ç½‘IPï¼Œç‚¹å‡»NATè®¾ç½®é¡µé¢ï¼ŒæŸ¥çœ‹å­ç½‘æ©ç å’Œç½‘å…³ï¼Œåé¢ä¿®æ”¹é™æ€IPä¼šç”¨åˆ°ã€‚</p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/20180224100549832" alt="img"></p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/20180224102024516" alt="img"></p><p>æ³¨ï¼šä¸Šé¢çš„â€œä½¿ç”¨æœ¬åœ°DHCPæœåŠ¡â€¦â€¦â€è¿™ä¸€é¡¹æ˜¯æ²¡æœ‰é’©é€‰çš„</p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/20180224101031639" alt="img"></p><h2 id="äºŒã€æ£€æŸ¥ç‰©ç†ä¸»æœº-è®¾ç½®ç½‘å¡"><a href="#äºŒã€æ£€æŸ¥ç‰©ç†ä¸»æœº-è®¾ç½®ç½‘å¡" class="headerlink" title="äºŒã€æ£€æŸ¥ç‰©ç†ä¸»æœº è®¾ç½®ç½‘å¡"></a>äºŒã€æ£€æŸ¥ç‰©ç†ä¸»æœº è®¾ç½®ç½‘å¡</h2><p>æ‰“å¼€ç½‘ç»œå’Œå…±äº«ä¸­å¿ƒâ†’ æ›´æ”¹é€‚é…å™¨è®¾ç½®â†’ï¼Œåœ¨VMware Network Adapter VMnet8ä¸Šå•å‡»å³é”®ï¼Œé€‰æ‹©å±æ€§æŒ‰é’®æ‰“å¼€å±æ€§å¯¹è¯æ¡†ã€‚ </p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/20180224101231991" alt="img"></p><p>ä¿®æ”¹IPåœ°å€æ³¨æ„å¡«å†™å’Œç¬¬ä¸€æ­¥è®¾ç½®çš„ä¸€æ ·</p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/20180224101523781" alt="img"></p><h2 id="ä¸‰ã€è¿›å…¥è™šæ‹Ÿæœºï¼Œè®¾ç½®å›ºå®šIPåœ°å€ã€‚"><a href="#ä¸‰ã€è¿›å…¥è™šæ‹Ÿæœºï¼Œè®¾ç½®å›ºå®šIPåœ°å€ã€‚" class="headerlink" title="ä¸‰ã€è¿›å…¥è™šæ‹Ÿæœºï¼Œè®¾ç½®å›ºå®šIPåœ°å€ã€‚"></a>ä¸‰ã€è¿›å…¥è™šæ‹Ÿæœºï¼Œè®¾ç½®å›ºå®šIPåœ°å€ã€‚</h2><p>è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼švi /etc/sysconfig/network-scripts/ifcfg-eth33</p><p><img src="/2021/01/14/%E5%88%86%E7%B1%BB-Linux%E7%B3%BB%E7%BB%9F/VM%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/20180224111420149.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">å°†IPV6â€¦..åè®®éƒ½æ³¨é‡Šï¼›åœ¨å‰é¢åŠ <span class="hljs-comment">#æ³¨é‡Šå³å¯</span></span><br>BOOTPROTO=static        #å¼€æœºåè®®ï¼Œæœ‰dhcpåŠstaticï¼›<br>ONBOOT=yes              #è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ï¼›<br>DNS1=114.114.114.114    #è¿™ä¸ªæ˜¯å›½å†…çš„DNSåœ°å€ï¼Œæ˜¯å›ºå®šçš„ï¼›<br>IPADDR=192.168.73.100      #ä½ æƒ³è¦è®¾ç½®çš„å›ºå®šIPï¼Œ<br>NETMASK=255.255.255.0   #å­ç½‘æ©ç ï¼Œä¸éœ€è¦ä¿®æ”¹ï¼›<br>GATEWAY=192.168.73.1     #ç½‘å…³ï¼Œè¿™é‡Œæ˜¯ä½ åœ¨â€œ2.é…ç½®è™šæ‹Ÿæœºçš„NATæ¨¡å¼å…·ä½“åœ°å€å‚æ•°â€ä¸­çš„ï¼ˆ2ï¼‰é€‰æ‹©VMnet8--å–æ¶ˆå‹¾é€‰ä½¿ç”¨æœ¬åœ°DHCP--è®¾ç½®å­ç½‘IP--ç½‘å…³IPè®¾ç½®ã€‚<br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰é‡å¯ç½‘ç»œæœåŠ¡</p><p>service network restart</p><h2 id="å››ã€æ£€éªŒé…ç½®æ˜¯å¦æˆåŠŸ"><a href="#å››ã€æ£€éªŒé…ç½®æ˜¯å¦æˆåŠŸ" class="headerlink" title="å››ã€æ£€éªŒé…ç½®æ˜¯å¦æˆåŠŸ"></a>å››ã€æ£€éªŒé…ç½®æ˜¯å¦æˆåŠŸ</h2><p>(1) æŸ¥çœ‹ä¿®æ”¹åçš„å›ºå®šIPä¸º192.168.2.2ï¼Œé…ç½®æ­£ç¡®ï¼›</p><p>ifconfigï¼ˆä¸æ”¯æŒifconfigå‘½ä»¤ï¼Œåˆ™ä½¿ç”¨ip addrï¼‰</p><p>(2) æµ‹è¯•è™šæ‹Ÿæœºä¸­çš„CentOS 7ç³»ç»Ÿæ˜¯å¦èƒ½è¿å¤–ç½‘ï¼Œæœ‰æ•°æ®è¿”å›ï¼Œè¯´æ˜å¯ä»¥è¿æ¥å¤–ç½‘ï¼›</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">ping</span> <span class="hljs-selector-tag">www</span><span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.com</span><br></code></pre></td></tr></table></figure><p>(3) æµ‹è¯•æœ¬æœºæ˜¯å¦èƒ½pingé€šè™šæ‹Ÿæœºçš„å›ºå®šIPï¼Œæœ‰æ•°æ®è¿”å›ï¼Œè¯´æ˜å¯ä»¥ä½¿ç”¨ç»ˆç«¯å·¥å…·æ­£å¸¸è¿æ¥ï¼›</p><p>é¼ æ ‡æ”¾åˆ°å¼€å§‹èœå•å³é”®ï¼Œé€‰æ‹©å‘½ä»¤æç¤ºç¬¦ï¼ˆç®¡ç†å‘˜ï¼‰ï¼Œæ‰“å¼€å‘½ä»¤æ“ä½œç•Œé¢ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">ping <span class="hljs-number">192.168</span><span class="hljs-number">.73</span><span class="hljs-number">.100</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linuxç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>é—®é¢˜è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TempNoteBook</title>
    <link href="/2021/01/13/TempNoteBook/"/>
    <url>/2021/01/13/TempNoteBook/</url>
    
    <content type="html"><![CDATA[<p>æœ€å°çš„åŸºæœ¬å•ä½æ˜¯bitï¼ŒæŒ‰é¡ºåºç»™å‡ºæ‰€æœ‰å•ä½ï¼šbitã€Byteã€KBã€MBã€GBã€TBã€PBã€EBã€ZBã€YBã€BBã€NBã€DBã€‚</p><p>1Byte = 8bit  1K = 1024bit 1MB = 1024K 1G = 1024M</p><p>1T = 1024G      1P = 1024T      1E = 1024P      1Z = 1024E      </p><p>1Y = 1024Z      1B = 1024Y     1N = 1024B     1D = 1024N</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>HDFSæ–‡ä»¶ç³»ç»Ÿ</title>
    <link href="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    <url>/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€HDFSæ¦‚å¿µ"><a href="#ä¸€ã€HDFSæ¦‚å¿µ" class="headerlink" title="ä¸€ã€HDFSæ¦‚å¿µ"></a><strong>ä¸€ã€HDFSæ¦‚å¿µ</strong></h1><h2 id="1-1-æ¦‚å¿µ"><a href="#1-1-æ¦‚å¿µ" class="headerlink" title="1.1 æ¦‚å¿µ"></a><strong>1.1</strong> <strong>æ¦‚å¿µ</strong></h2><p>HDFSï¼Œï¼ˆHadoopå¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰å®ƒæ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶ï¼Œé€šè¿‡ç›®å½•æ ‘æ¥å®šä½æ–‡ä»¶ï¼›å…¶æ¬¡ï¼Œå®ƒæ˜¯åˆ†å¸ƒå¼çš„ï¼Œç”±å¾ˆå¤šæœåŠ¡å™¨è”åˆèµ·æ¥å®ç°å…¶åŠŸèƒ½ï¼Œé›†ç¾¤ä¸­çš„æœåŠ¡å™¨æœ‰å„è‡ªçš„è§’è‰²ã€‚</p><p>HDFSçš„è®¾è®¡é€‚åˆä¸€æ¬¡å†™å…¥ï¼Œå¤šæ¬¡è¯»å‡ºçš„åœºæ™¯ï¼Œä¸”ä¸æ”¯æŒæ–‡ä»¶çš„ä¿®æ”¹ã€‚é€‚åˆç”¨æ¥åšæ•°æ®åˆ†æï¼Œå¹¶ä¸é€‚åˆç”¨æ¥åšç½‘ç›˜åº”ç”¨ã€‚</p><h2 id="1-2-ç»„æˆ"><a href="#1-2-ç»„æˆ" class="headerlink" title="1.2 ç»„æˆ"></a><strong>1.2</strong> ç»„æˆ</h2><p>1ï¼‰HDFSé›†ç¾¤åŒ…æ‹¬ï¼ŒNameNodeå’ŒDataNodeä»¥åŠSecondary Namenodeã€‚</p><p>2ï¼‰NameNodeè´Ÿè´£ç®¡ç†æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ï¼Œä»¥åŠæ¯ä¸€ä¸ªè·¯å¾„ï¼ˆæ–‡ä»¶ï¼‰æ‰€å¯¹åº”çš„æ•°æ®å—ä¿¡æ¯ã€‚</p><p>3ï¼‰DataNode è´Ÿè´£ç®¡ç†ç”¨æˆ·çš„æ–‡ä»¶æ•°æ®å—ï¼Œæ¯ä¸€ä¸ªæ•°æ®å—éƒ½å¯ä»¥åœ¨å¤šä¸ªdatanodeä¸Šå­˜å‚¨å¤šä¸ªå‰¯æœ¬ã€‚</p><p>4ï¼‰Secondary NameNodeç”¨æ¥ç›‘æ§HDFSçŠ¶æ€çš„è¾…åŠ©åå°ç¨‹åºï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è·å–HDFSå…ƒæ•°æ®çš„å¿«ç…§ã€‚</p><h2 id="1-3-HDFS-æ–‡ä»¶å—å¤§å°"><a href="#1-3-HDFS-æ–‡ä»¶å—å¤§å°" class="headerlink" title="1.3 HDFS æ–‡ä»¶å—å¤§å°"></a><strong>1.3 HDFS æ–‡ä»¶å—å¤§å°</strong></h2><p>HDFSä¸­çš„æ–‡ä»¶åœ¨ç‰©ç†ä¸Šæ˜¯åˆ†å—å­˜å‚¨ï¼ˆblockï¼‰ï¼Œå—çš„å¤§å°å¯ä»¥é€šè¿‡é…ç½®å‚æ•°( dfs.blocksize)æ¥è§„å®šï¼Œé»˜è®¤å¤§å°åœ¨hadoop2.xç‰ˆæœ¬ä¸­æ˜¯128Mï¼Œè€ç‰ˆæœ¬ä¸­æ˜¯64M</p><p>HDFSçš„å—æ¯”ç£ç›˜çš„å—å¤§ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†æœ€å°åŒ–å¯»å€å¼€é”€ã€‚å¦‚æœå—è®¾ç½®å¾—è¶³å¤Ÿå¤§ï¼Œä»ç£ç›˜ä¼ è¾“æ•°æ®çš„æ—¶é—´ä¼šæ˜æ˜¾å¤§äºå®šä½è¿™ä¸ªå—å¼€å§‹ä½ç½®æ‰€éœ€çš„æ—¶é—´ã€‚å› è€Œï¼Œä¼ è¾“ä¸€ä¸ªç”±å¤šä¸ªå—ç»„æˆçš„æ–‡ä»¶çš„æ—¶é—´å–å†³äºç£ç›˜ä¼ è¾“é€Ÿç‡ã€‚</p><p>å¦‚æœå¯»å€æ—¶é—´çº¦ä¸º10msï¼Œè€Œä¼ è¾“é€Ÿç‡ä¸º100MB/sï¼Œä¸ºäº†ä½¿å¯»å€æ—¶é—´ä»…å ä¼ è¾“æ—¶é—´çš„1%ï¼Œæˆ‘ä»¬è¦å°†å—å¤§å°è®¾ç½®çº¦ä¸º100MBã€‚é»˜è®¤çš„å—å¤§å°å®é™…ä¸º64MBï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µä¸‹HDFSä½¿ç”¨128MBçš„å—è®¾ç½®ã€‚</p><h1 id="äºŒã€HDFSæ“ä½œ"><a href="#äºŒã€HDFSæ“ä½œ" class="headerlink" title="äºŒã€HDFSæ“ä½œ"></a>äºŒã€HDFSæ“ä½œ</h1><h2 id="2-1-åŸºæœ¬è¯­æ³•"><a href="#2-1-åŸºæœ¬è¯­æ³•" class="headerlink" title="2.1 åŸºæœ¬è¯­æ³•"></a>2.1 åŸºæœ¬è¯­æ³•</h2><p>hadoop fs å…·ä½“å‘½ä»¤</p><h2 id="2-2-å‚æ•°å¤§å…¨"><a href="#2-2-å‚æ•°å¤§å…¨" class="headerlink" title="2.2 å‚æ•°å¤§å…¨"></a>2.2 å‚æ•°å¤§å…¨</h2><p>bin/hadoop fs</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image002.jpg" alt="img"></p><h2 id="2-3-å¸¸ç”¨å‘½ä»¤å®æ“"><a href="#2-3-å¸¸ç”¨å‘½ä»¤å®æ“" class="headerlink" title="2.3 å¸¸ç”¨å‘½ä»¤å®æ“"></a>2.3 å¸¸ç”¨å‘½ä»¤å®æ“</h2><p>ï¼ˆ1ï¼‰-helpï¼šè¾“å‡ºè¿™ä¸ªå‘½ä»¤å‚æ•°</p><p>â€‹       hdfs dfs -help rm</p><p>ï¼ˆ2ï¼‰-ls: æ˜¾ç¤ºç›®å½•ä¿¡æ¯</p><p>hadoop fs -ls /</p><p>ï¼ˆ3ï¼‰-mkdirï¼šåœ¨hdfsä¸Šåˆ›å»ºç›®å½•</p><p>hadoop fs -mkdir -p /aaa/bbb/cc/dd</p><p>ï¼ˆ4ï¼‰-moveFromLocalä»æœ¬åœ°å‰ªåˆ‡ç²˜è´´åˆ°hdfs</p><p>hadoop fs - moveFromLocal /home/hadoop/a.txt /aaa/bbb/cc/dd</p><p>ï¼ˆ5ï¼‰-moveToLocalï¼šä»hdfså‰ªåˆ‡ç²˜è´´åˆ°æœ¬åœ°</p><p>hadoop fs - moveToLocal  /aaa/bbb/cc/dd /home/hadoop/a.txt</p><p>ï¼ˆ6ï¼‰â€“appendToFile ï¼šè¿½åŠ ä¸€ä¸ªæ–‡ä»¶åˆ°å·²ç»å­˜åœ¨çš„æ–‡ä»¶æœ«å°¾</p><p>hadoop fs -appendToFile ./hello.txt /hello.txt</p><p>ï¼ˆ7ï¼‰-cat ï¼šæ˜¾ç¤ºæ–‡ä»¶å†…å®¹</p><p>ï¼ˆ8ï¼‰-tailï¼šæ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶çš„æœ«å°¾</p><p>hadoop fs -tail /weblog/access_log.1</p><p>ï¼ˆ9ï¼‰-textï¼šä»¥å­—ç¬¦å½¢å¼æ‰“å°ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹</p><p>hadoop fs -text /weblog/access_log.1</p><p>ï¼ˆ10ï¼‰-chgrp ã€-chmodã€-chownï¼šlinuxæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç”¨æ³•ä¸€æ ·ï¼Œä¿®æ”¹æ–‡ä»¶æ‰€å±æƒé™</p><p>hadoop fs -chmod 666 /hello.txt</p><p>hadoop fs -chown someuser:somegrp  /hello.txt</p><p>ï¼ˆ11ï¼‰-copyFromLocalï¼šä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­æ‹·è´æ–‡ä»¶åˆ°hdfsè·¯å¾„å»</p><p>hadoop fs -copyFromLocal ./jdk.tar.gz /aaa/</p><p>ï¼ˆ12ï¼‰-copyToLocalï¼šä»hdfsæ‹·è´åˆ°æœ¬åœ°</p><p>hadoop fs -copyToLocal /aaa/jdk.tar.gz</p><p>ï¼ˆ13ï¼‰-cp ï¼šä»hdfsçš„ä¸€ä¸ªè·¯å¾„æ‹·è´åˆ°hdfsçš„å¦ä¸€ä¸ªè·¯å¾„</p><p>hadoop fs -cp /aaa/jdk.tar.gz /bbb/jdk.tar.gz.2</p><p>ï¼ˆ14ï¼‰-mvï¼šåœ¨hdfsç›®å½•ä¸­ç§»åŠ¨æ–‡ä»¶</p><p>hadoop fs -mv /aaa/jdk.tar.gz /</p><p>ï¼ˆ15ï¼‰-getï¼šç­‰åŒäºcopyToLocalï¼Œå°±æ˜¯ä»hdfsä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°</p><p>hadoop fs -get /aaa/jdk.tar.gz</p><p>ï¼ˆ16ï¼‰-getmerge ï¼šåˆå¹¶ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚hdfsçš„ç›®å½• /aaa/ä¸‹æœ‰å¤šä¸ªæ–‡ä»¶:log.1, log.2,log.3,â€¦</p><p>hadoop fs -getmerge /aaa/log.* ./log.sum</p><p>ï¼ˆ17ï¼‰-putï¼šç­‰åŒäºcopyFromLocal</p><p>hadoop fs -put /aaa/jdk.tar.gz /bbb/jdk.tar.gz.2</p><p>ï¼ˆ18ï¼‰-rmï¼šåˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</p><p>hadoop fs -rm -r /aaa/bbb/</p><p>ï¼ˆ19ï¼‰-rmdirï¼šåˆ é™¤ç©ºç›®å½•</p><p>hadoop fs -rmdir  /aaa/bbb/ccc</p><p>ï¼ˆ20ï¼‰-df ï¼šç»Ÿè®¡æ–‡ä»¶ç³»ç»Ÿçš„å¯ç”¨ç©ºé—´ä¿¡æ¯</p><p>hadoop fs -df -h /</p><p>ï¼ˆ21ï¼‰-duç»Ÿè®¡æ–‡ä»¶å¤¹çš„å¤§å°ä¿¡æ¯</p><p>hadoop fs -du -s -h /aaa/*</p><p>ï¼ˆ22ï¼‰-countï¼šç»Ÿè®¡ä¸€ä¸ªæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶èŠ‚ç‚¹æ•°é‡</p><p>hadoop fs -count /aaa/</p><p>ï¼ˆ23ï¼‰-setrepï¼šè®¾ç½®hdfsä¸­æ–‡ä»¶çš„å‰¯æœ¬æ•°é‡</p><p>hadoop fs -setrep 3 /aaa/jdk.tar.gz</p><h1 id="ä¸‰ã€HDFSå®¢æˆ·ç«¯æ“ä½œ"><a href="#ä¸‰ã€HDFSå®¢æˆ·ç«¯æ“ä½œ" class="headerlink" title="ä¸‰ã€HDFSå®¢æˆ·ç«¯æ“ä½œ"></a>ä¸‰ã€HDFSå®¢æˆ·ç«¯æ“ä½œ</h1><h2 id="3-1-eclipseå‡†å¤‡ç¯å¢ƒ"><a href="#3-1-eclipseå‡†å¤‡ç¯å¢ƒ" class="headerlink" title="3.1 eclipseå‡†å¤‡ç¯å¢ƒ"></a>3.1 eclipseå‡†å¤‡ç¯å¢ƒ</h2><p>ï¼ˆ1ï¼‰jaråŒ…å‡†å¤‡</p><p>1ï¼‰è§£å‹hadoop-2.7.2.tar.gzåˆ°éä¸­æ–‡ç›®å½•</p><p>2ï¼‰è¿›å…¥shareæ–‡ä»¶å¤¹ï¼ŒæŸ¥æ‰¾æ‰€æœ‰jaråŒ…ï¼Œå¹¶æŠŠjaråŒ…æ‹·è´åˆ°_libæ–‡ä»¶å¤¹ä¸‹</p><p>3ï¼‰åœ¨å…¨éƒ¨jaråŒ…ä¸­æŸ¥æ‰¾.source.jarï¼Œå¹¶å‰ªåˆ‡åˆ°_sourceæ–‡ä»¶å¤¹ã€‚</p><p>4ï¼‰åœ¨å…¨éƒ¨jaråŒ…ä¸­æŸ¥æ‰¾tests.jarï¼Œå¹¶å‰ªåˆ‡åˆ°_testæ–‡ä»¶å¤¹ã€‚</p><p>ï¼ˆ2ï¼‰eclipseå‡†å¤‡</p><p>1ï¼‰é…ç½®HADOOP_HOMEç¯å¢ƒå˜é‡</p><p>2ï¼‰åˆ›å»ºç¬¬ä¸€ä¸ªjavaå·¥ç¨‹</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image003.png" alt="img"></p><p>ç„¶åæŠŠjaréƒ½æ‹·è´åˆ°javaå·¥ç¨‹ä¸­ï¼Œç„¶åè¿›è¡ŒBuild Path</p><p>â€‹    3ï¼‰åˆ›å»ºjavaç±»</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image005.jpg" alt="img"></p><p>â€‹    4ï¼‰æ‰§è¡Œç¨‹åº</p><p>å®¢æˆ·ç«¯å»æ“ä½œhdfsæ—¶ï¼Œæ˜¯æœ‰ä¸€ä¸ªç”¨æˆ·èº«ä»½çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œhdfså®¢æˆ·ç«¯apiä¼šä»jvmä¸­è·å–ä¸€ä¸ªå‚æ•°æ¥ä½œä¸ºè‡ªå·±çš„ç”¨æˆ·èº«ä»½ï¼š-DHADOOP_USER_NAME=atguiguï¼Œatguiguä¸ºç”¨æˆ·åç§°ã€‚</p><p>è¿™æ˜¯ä¸€ç§æ–¹å¼ï¼š</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image007.jpg" alt="img"></p><p>å¦ä¸€ç§æ–¹å¼ï¼š</p><p>FileSystem fs = FileSystem.<em>get</em>(<strong>new</strong> URI(â€œhdfs://192.168.181.128:9000â€), conf, â€œrootâ€);</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image009.jpg" alt="img"></p><h1 id="å››ã€é€šè¿‡APIæ“ä½œHDFS"><a href="#å››ã€é€šè¿‡APIæ“ä½œHDFS" class="headerlink" title="å››ã€é€šè¿‡APIæ“ä½œHDFS"></a>å››ã€é€šè¿‡APIæ“ä½œHDFS</h1><p><strong>4.1 HDFSè·å–æ–‡ä»¶ç³»ç»Ÿ</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image011.jpg" alt="img"></p><p><strong>4.2</strong> <strong>ä¸Šä¼ æ–‡ä»¶</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image013.jpg" alt="img"></p><p><strong>4.3</strong> <strong>ä¸‹è½½æ–‡ä»¶</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image015.jpg" alt="img"></p><p><strong>4.4</strong> <strong>åˆ›å»ºç›®å½•</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image017.jpg" alt="img"></p><p><strong>4.5</strong> <strong>åˆ é™¤æ–‡ä»¶å¤¹</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image019.jpg" alt="img"></p><p><strong>4.6</strong> <strong>ä¿®æ”¹æ–‡ä»¶å</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image021.jpg" alt="img"></p><p><strong>4.7</strong> <strong>æ–‡ä»¶è¯¦ç»†æŸ¥çœ‹</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image023.jpg" alt="img"></p><p><strong>4.8</strong> <strong>æ–‡ä»¶å¤¹æŸ¥çœ‹</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image025.jpg" alt="img"></p><h1 id="äº”ã€é€šè¿‡IOæµæ“ä½œHDFS"><a href="#äº”ã€é€šè¿‡IOæµæ“ä½œHDFS" class="headerlink" title="äº”ã€é€šè¿‡IOæµæ“ä½œHDFS"></a>äº”ã€é€šè¿‡IOæµæ“ä½œHDFS</h1><p><strong>5.1</strong> <strong>æ–‡ä»¶ä¸Šä¼ </strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image027.jpg" alt="img"></p><p><strong>5.2</strong> <strong>æ–‡ä»¶ä¸‹è½½</strong></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image029.jpg" alt="img"></p><h1 id="å…­ã€HDFSçš„æ•°æ®æµ"><a href="#å…­ã€HDFSçš„æ•°æ®æµ" class="headerlink" title="å…­ã€HDFSçš„æ•°æ®æµ"></a>å…­ã€HDFSçš„æ•°æ®æµ</h1><h2 id="6-1-å‰–ææ–‡ä»¶å†™å…¥"><a href="#6-1-å‰–ææ–‡ä»¶å†™å…¥" class="headerlink" title="6.1 å‰–ææ–‡ä»¶å†™å…¥"></a><strong>6.1</strong> <strong>å‰–ææ–‡ä»¶å†™å…¥</strong></h2><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image031.png" alt="img"></p><p>1ï¼‰å®¢æˆ·ç«¯é€šè¿‡Distributed FileSystemæ¨¡å—å‘NameNodeè¯·æ±‚ä¸Šä¼ æ–‡ä»¶ï¼ŒNameNodeæ£€æŸ¥ç›®æ ‡æ–‡ä»¶æ˜¯å¦å·²å­˜åœ¨ï¼Œçˆ¶ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</p><p>2ï¼‰NameNodeè¿”å›æ˜¯å¦å¯ä»¥ä¸Šä¼ ã€‚ï¼ˆå¦‚æœå·²ç»å­˜åœ¨ï¼Œä¼šè¿”å›already existï¼‰</p><p>3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¬¬ä¸€ä¸ª Blockä¸Šä¼ åˆ°å“ªå‡ ä¸ªDataNodeæœåŠ¡å™¨ä¸Šã€‚</p><p>4ï¼‰NameNodeè¿”å›3ä¸ªDataNodeèŠ‚ç‚¹ï¼Œåˆ†åˆ«ä¸ºdn1ã€dn2ã€dn3ã€‚ï¼ˆè·ç¦»è¿‘ï¼Œè´Ÿè½½å°ï¼‰</p><p>5ï¼‰å®¢æˆ·ç«¯é€šè¿‡FSDataOutputStreamæ¨¡å—è¯·æ±‚dn1ä¸Šä¼ æ•°æ®ï¼Œdn1æ”¶åˆ°è¯·æ±‚ä¼šç»§ç»­è°ƒç”¨dn2ï¼Œç„¶ådn2è°ƒç”¨dn3ï¼Œå°†è¿™ä¸ªé€šä¿¡ç®¡é“å»ºç«‹å®Œæˆã€‚</p><p>6ï¼‰dn1ã€dn2ã€dn3é€çº§åº”ç­”å®¢æˆ·ç«¯ã€‚</p><p>7ï¼‰å®¢æˆ·ç«¯å¼€å§‹å¾€dn1ä¸Šä¼ ç¬¬ä¸€ä¸ªBlockï¼ˆå…ˆä»ç£ç›˜è¯»å–æ•°æ®æ”¾åˆ°ä¸€ä¸ªæœ¬åœ°å†…å­˜ç¼“å­˜ï¼‰ï¼Œä»¥Packetä¸ºå•ä½ï¼Œdn1æ”¶åˆ°ä¸€ä¸ªPacketå°±ä¼šä¼ ç»™dn2ï¼Œdn2ä¼ ç»™dn3ï¼›dn1æ¯ä¼ ä¸€ä¸ªpacketä¼šæ”¾å…¥ä¸€ä¸ªåº”ç­”é˜Ÿåˆ—ç­‰å¾…åº”ç­”ã€‚</p><p>8ï¼‰å½“ä¸€ä¸ªBlockä¼ è¾“å®Œæˆä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡è¯·æ±‚NameNodeä¸Šä¼ ç¬¬äºŒä¸ªBlockçš„æœåŠ¡å™¨ã€‚ï¼ˆé‡å¤æ‰§è¡Œ3-7æ­¥ï¼‰ã€‚</p><h2 id="6-2-ç½‘ç»œæ‹“æ‰‘-èŠ‚ç‚¹è·ç¦»è®¡ç®—"><a href="#6-2-ç½‘ç»œæ‹“æ‰‘-èŠ‚ç‚¹è·ç¦»è®¡ç®—" class="headerlink" title="6.2 ç½‘ç»œæ‹“æ‰‘-èŠ‚ç‚¹è·ç¦»è®¡ç®—"></a><strong>6.2</strong> ç½‘ç»œæ‹“æ‰‘-èŠ‚ç‚¹è·ç¦»è®¡ç®—</h2><p>åœ¨HDFSå†™æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼ŒNameNodeä¼šé€‰æ‹©è·ç¦»å¾…ä¸Šä¼ æ•°æ®æœ€è¿‘è·ç¦»çš„DataNodeæ¥æ”¶æ•°æ®ã€‚</p><p>èŠ‚ç‚¹è·ç¦»ï¼šä¸¤ä¸ªèŠ‚ç‚¹åˆ°è¾¾æœ€è¿‘çš„å…±åŒç¥–å…ˆçš„è·ç¦»æ€»å’Œã€‚</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image033.png" alt="img"></p><p><a href="http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html#Data_Replication">http://hadoop.apache.org/docs/r2.7.2/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html#Data_Replication</a></p><p>é›†ç¾¤ä¸Šé»˜è®¤çš„å‰¯æœ¬æ•°æ˜¯3ï¼Œç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªï¼ŒåŒä¸€ä¸ªæœºæ¶ï¼ŒIOä¼ è¾“è·ç¦»çŸ­ï¼Œå¯ä»¥å¿«é€Ÿå¤‡ä»½ï¼Œè€ƒè™‘çš„æ˜¯é€Ÿåº¦çš„é—®é¢˜ï¼›å¦‚æœæœºæ¶r1å´©æºƒï¼Œæ‰€ä»¥å¿…é¡»åœ¨ä¸åŒçš„æœºæ¶ä¸Šå¤‡ä»½ä¸€ä¸ªï¼Œè€ƒè™‘çš„æ˜¯å®‰å…¨æ€§çš„é—®é¢˜ã€‚</p><h2 id="6-3-HDFSè¯»æ•°æ®æµç¨‹"><a href="#6-3-HDFSè¯»æ•°æ®æµç¨‹" class="headerlink" title="6.3 HDFSè¯»æ•°æ®æµç¨‹"></a>6.3 HDFSè¯»æ•°æ®æµç¨‹</h2><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/HDFS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/clip_image035.png" alt="img"></p><p>1ï¼‰å®¢æˆ·ç«¯é€šè¿‡Distributed FileSystemå‘NameNodeè¯·æ±‚ä¸‹è½½æ–‡ä»¶ï¼ŒNameNodeé€šè¿‡æŸ¥è¯¢å…ƒæ•°æ®ï¼Œæ‰¾åˆ°æ–‡ä»¶å—æ‰€åœ¨çš„DataNodeåœ°å€ã€‚</p><p>2ï¼‰æŒ‘é€‰ä¸€å°DataNodeï¼ˆå°±è¿‘åŸåˆ™ï¼Œç„¶åéšæœºï¼‰æœåŠ¡å™¨ï¼Œè¯·æ±‚è¯»å–æ•°æ®ã€‚</p><p>3ï¼‰DataNodeå¼€å§‹ä¼ è¾“æ•°æ®ç»™å®¢æˆ·ç«¯ï¼ˆä»ç£ç›˜é‡Œé¢è¯»å–æ•°æ®è¾“å…¥æµï¼Œä»¥Packetä¸ºå•ä½æ¥åšæ ¡éªŒï¼‰</p><p>4ï¼‰å®¢æˆ·ç«¯ä»¥Packetä¸ºå•ä½æ¥æ”¶ï¼Œå…ˆåœ¨æœ¬åœ°ç¼“å­˜ï¼Œç„¶åå†™å…¥ç›®æ ‡æ–‡ä»¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>åˆ†å¸ƒå¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hadoopå…¥é—¨</title>
    <link href="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/"/>
    <url>/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ä»Hadoopæ¡†æ¶è®¨è®ºå¤§æ•°æ®ç”Ÿæ€"><a href="#ä¸€ã€ä»Hadoopæ¡†æ¶è®¨è®ºå¤§æ•°æ®ç”Ÿæ€" class="headerlink" title="ä¸€ã€ä»Hadoopæ¡†æ¶è®¨è®ºå¤§æ•°æ®ç”Ÿæ€"></a><strong>ä¸€ã€ä»Hadoopæ¡†æ¶è®¨è®ºå¤§æ•°æ®ç”Ÿæ€</strong></h1><p>å¤§æ•°æ®ï¼ˆbig dataï¼‰ï¼ŒæŒ‡æ— æ³•åœ¨ä¸€å®šæ—¶é—´èŒƒå›´å†…ç”¨å¸¸è§„è½¯ä»¶å·¥å…·è¿›è¡Œæ•æ‰ã€ç®¡ç†å’Œå¤„ç†çš„æ•°æ®é›†åˆï¼Œæ˜¯éœ€è¦æ–°å¤„ç†æ¨¡å¼æ‰èƒ½å…·æœ‰æ›´å¼ºçš„å†³ç­–åŠ›ã€æ´å¯Ÿå‘ç°åŠ›å’Œæµç¨‹ä¼˜åŒ–èƒ½åŠ›çš„æµ·é‡ã€é«˜å¢é•¿ç‡å’Œå¤šæ ·åŒ–çš„ä¿¡æ¯èµ„äº§ã€‚</p><h2 id="1-1-Hadoopæ˜¯ä»€ä¹ˆ"><a href="#1-1-Hadoopæ˜¯ä»€ä¹ˆ" class="headerlink" title="1.1 Hadoopæ˜¯ä»€ä¹ˆ"></a>1.1 Hadoopæ˜¯ä»€ä¹ˆ</h2><ol><li>Hadoopæ˜¯ä¸€ä¸ªç”±ApacheåŸºé‡‘ä¼šæ‰€å¼€å‘çš„åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€æ¶æ„</li><li>ä¸»è¦è§£å†³ï¼Œæµ·é‡æ•°æ®çš„å­˜å‚¨å’Œæµ·é‡æ•°æ®çš„åˆ†æè®¡ç®—é—®é¢˜ã€‚</li><li>å¹¿ä¹‰ä¸Šæ¥è¯´ï¼ŒHADOOPé€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªæ›´å¹¿æ³›çš„æ¦‚å¿µâ€”â€”HADOOPç”Ÿæ€åœˆ</li></ol><h2 id="1-2-Hadoopå‘å±•å†å²"><a href="#1-2-Hadoopå‘å±•å†å²" class="headerlink" title="1.2 Hadoopå‘å±•å†å²"></a><strong>1.2 Hadoopå‘å±•å†å²</strong></h2><ul><li><p>Luceneâ€“Doug Cuttingå¼€åˆ›çš„å¼€æºè½¯ä»¶ï¼Œç”¨javaä¹¦å†™ä»£ç ï¼Œå®ç°ä¸Googleç±»ä¼¼çš„å…¨æ–‡æœç´¢åŠŸèƒ½ï¼Œå®ƒæä¾›äº†å…¨æ–‡æ£€ç´¢å¼•æ“çš„æ¶æ„ï¼ŒåŒ…æ‹¬å®Œæ•´çš„æŸ¥è¯¢å¼•æ“å’Œç´¢å¼•å¼•æ“ </p></li><li><p>2001å¹´å¹´åº•æˆä¸ºapacheåŸºé‡‘ä¼šçš„ä¸€ä¸ªå­é¡¹ç›®</p></li><li><p>å¯¹äºå¤§æ•°é‡çš„åœºæ™¯ï¼ŒLuceneé¢å¯¹ä¸GoogleåŒæ ·çš„å›°éš¾</p></li><li><p>å­¦ä¹ å’Œæ¨¡ä»¿Googleè§£å†³è¿™äº›é—®é¢˜çš„åŠæ³• ï¼šå¾®å‹ç‰ˆNutch</p></li><li><p>å¯ä»¥è¯´Googleæ˜¯hadoopçš„æ€æƒ³ä¹‹æº(Googleåœ¨å¤§æ•°æ®æ–¹é¢çš„ä¸‰ç¯‡è®ºæ–‡)</p><ul><li><p>GFS â€”&gt;HDFS</p></li><li><p>Map-Reduce â€”&gt;MR</p></li><li><p>BigTable â€”&gt;Hbase</p></li></ul></li><li><p>2003-2004å¹´ï¼ŒGoogleå…¬å¼€äº†éƒ¨åˆ†GFSå’ŒMapreduceæ€æƒ³çš„ç»†èŠ‚ï¼Œä»¥æ­¤ä¸ºåŸºç¡€Doug Cuttingç­‰äººç”¨äº†2å¹´ä¸šä½™æ—¶é—´å®ç°äº†DFSå’ŒMapreduceæœºåˆ¶ï¼Œä½¿Nutchæ€§èƒ½é£™å‡ </p></li><li><p>2005 å¹´Hadoop ä½œä¸º Luceneçš„å­é¡¹ç›® Nutchçš„ä¸€éƒ¨åˆ†æ­£å¼å¼•å…¥ApacheåŸºé‡‘ä¼šã€‚2006 å¹´ 3 æœˆä»½ï¼ŒMap-Reduceå’ŒNutch Distributed File System (NDFS) åˆ†åˆ«è¢«çº³å…¥ç§°ä¸º Hadoop çš„é¡¹ç›®ä¸­ </p></li><li><p>åå­—æ¥æºäºDoug Cuttingå„¿å­çš„ç©å…·å¤§è±¡</p></li></ul><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image004.jpg" alt="img"></p><ul><li>Hadoopå°±æ­¤è¯ç”Ÿå¹¶è¿…é€Ÿå‘å±•ï¼Œæ ‡å¿—è¿™äº‘è®¡ç®—æ—¶ä»£æ¥ä¸´</li></ul><h2 id="1-3-Hadoopä¸‰å¤§å‘è¡Œç‰ˆæœ¬"><a href="#1-3-Hadoopä¸‰å¤§å‘è¡Œç‰ˆæœ¬" class="headerlink" title="1.3 Hadoopä¸‰å¤§å‘è¡Œç‰ˆæœ¬"></a><strong>1.3 Hadoopä¸‰å¤§å‘è¡Œç‰ˆæœ¬</strong></h2><p>Hadoop ä¸‰å¤§å‘è¡Œç‰ˆæœ¬: Apacheã€Clouderaã€Hortonworks</p><ul><li><p>Apacheç‰ˆæœ¬æœ€åŸå§‹ï¼ˆæœ€åŸºç¡€ï¼‰çš„ç‰ˆæœ¬ï¼Œå¯¹äºå…¥é—¨å­¦ä¹ æœ€å¥½ã€‚</p></li><li><p>Clouderaåœ¨å¤§å‹äº’è”ç½‘ä¼ä¸šä¸­ç”¨çš„è¾ƒå¤šã€‚</p></li><li><p>Hortonworksæ–‡æ¡£è¾ƒå¥½ã€‚</p></li></ul><p><strong>1ï¼‰Cloudera Hadoop</strong></p><ol><li>2008å¹´æˆç«‹çš„Clouderaæ˜¯æœ€æ—©å°†Hadoopå•†ç”¨çš„å…¬å¸ï¼Œä¸ºåˆä½œä¼™ä¼´æä¾›Hadoopçš„å•†ç”¨è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦æ˜¯åŒ…æ‹¬æ”¯æŒã€å’¨è¯¢æœåŠ¡ã€åŸ¹è®­ã€‚</li><li>2009å¹´Hadoopçš„åˆ›å§‹äººDoug Cuttingä¹ŸåŠ ç›ŸClouderaå…¬å¸ã€‚Clouderaäº§å“ä¸»è¦ä¸ºCDHï¼ŒCloudera Managerï¼ŒCloudera Support</li><li>CDHæ˜¯Clouderaçš„Hadoopå‘è¡Œç‰ˆï¼Œå®Œå…¨å¼€æºï¼Œæ¯”Apache Hadoopåœ¨å…¼å®¹æ€§ï¼Œå®‰å…¨æ€§ï¼Œç¨³å®šæ€§ä¸Šæœ‰æ‰€å¢å¼ºã€‚</li><li>Cloudera Manageræ˜¯é›†ç¾¤çš„è½¯ä»¶åˆ†å‘åŠç®¡ç†ç›‘æ§å¹³å°ï¼Œå¯ä»¥åœ¨å‡ ä¸ªå°æ—¶å†…éƒ¨ç½²å¥½ä¸€ä¸ªHadoopé›†ç¾¤ï¼Œå¹¶å¯¹é›†ç¾¤çš„èŠ‚ç‚¹åŠæœåŠ¡è¿›è¡Œå®æ—¶ç›‘æ§ã€‚Cloudera Supportå³æ˜¯å¯¹Hadoopçš„æŠ€æœ¯æ”¯æŒã€‚</li><li>Clouderaçš„æ ‡ä»·ä¸ºæ¯å¹´æ¯ä¸ªèŠ‚ç‚¹4000ç¾å…ƒã€‚Clouderaå¼€å‘å¹¶è´¡çŒ®äº†å¯å®æ—¶å¤„ç†å¤§æ•°æ®çš„Impalaé¡¹ç›®ã€‚</li></ol><p><strong>2ï¼‰Hortonworks Hadoop</strong></p><ol><li>2011å¹´æˆç«‹çš„Hortonworksæ˜¯é›…è™ä¸ç¡…è°·é£æŠ•å…¬å¸Benchmark Capitalåˆèµ„ç»„å»ºã€‚</li><li>å…¬å¸æˆç«‹ä¹‹åˆå°±å¸çº³äº†å¤§çº¦25åè‡³30åä¸“é—¨ç ”ç©¶Hadoopçš„é›…è™å·¥ç¨‹å¸ˆï¼Œä¸Šè¿°å·¥ç¨‹å¸ˆå‡åœ¨2005å¹´å¼€å§‹ååŠ©é›…è™å¼€å‘Hadoopï¼Œè´¡çŒ®äº†Hadoop80%çš„ä»£ç ã€‚</li><li>é›…è™å·¥ç¨‹å‰¯æ€»è£ã€é›…è™Hadoopå¼€å‘å›¢é˜Ÿè´Ÿè´£äººEric Baldeschwielerå‡ºä»»Hortonworksçš„é¦–å¸­æ‰§è¡Œå®˜ã€‚</li><li>Hortonworksçš„ä¸»æ‰“äº§å“æ˜¯Hortonworks Data Platformï¼ˆHDPï¼‰ï¼Œä¹ŸåŒæ ·æ˜¯100%å¼€æºçš„äº§å“ï¼ŒHDPé™¤å¸¸è§çš„é¡¹ç›®å¤–è¿˜åŒ…æ‹¬äº†Ambariï¼Œä¸€æ¬¾å¼€æºçš„å®‰è£…å’Œç®¡ç†ç³»ç»Ÿã€‚</li><li>HCatalogï¼Œä¸€ä¸ªå…ƒæ•°æ®ç®¡ç†ç³»ç»Ÿï¼ŒHCatalogç°å·²é›†æˆåˆ°Facebookå¼€æºçš„Hiveä¸­ã€‚Hortonworksçš„Stingerå¼€åˆ›æ€§çš„æå¤§çš„ä¼˜åŒ–äº†Hiveé¡¹ç›®ã€‚Hortonworksä¸ºå…¥é—¨æä¾›äº†ä¸€ä¸ªéå¸¸å¥½çš„ï¼Œæ˜“äºä½¿ç”¨çš„æ²™ç›’ã€‚</li><li>Hortonworkså¼€å‘äº†å¾ˆå¤šå¢å¼ºç‰¹æ€§å¹¶æäº¤è‡³æ ¸å¿ƒä¸»å¹²ï¼Œè¿™ä½¿å¾—Apache Hadoopèƒ½å¤Ÿåœ¨åŒ…æ‹¬Window Serverå’ŒWindows Azureåœ¨å†…çš„microsoft Windowså¹³å°ä¸Šæœ¬åœ°è¿è¡Œã€‚å®šä»·ä»¥é›†ç¾¤ä¸ºåŸºç¡€ï¼Œæ¯10ä¸ªèŠ‚ç‚¹æ¯å¹´ä¸º12500ç¾å…ƒã€‚</li></ol><h2 id="1-4-Hadoopçš„ä¼˜åŠ¿"><a href="#1-4-Hadoopçš„ä¼˜åŠ¿" class="headerlink" title="1.4 Hadoopçš„ä¼˜åŠ¿"></a><strong>1.4 Hadoopçš„ä¼˜åŠ¿</strong></h2><ul><li><p>é«˜å¯é æ€§ï¼šå› ä¸ºHadoopå‡è®¾è®¡ç®—å…ƒç´ å’Œå­˜å‚¨ä¼šå‡ºç°æ•…éšœï¼Œå› ä¸ºå®ƒç»´æŠ¤å¤šä¸ªå·¥ä½œæ•°æ®å‰¯æœ¬ï¼Œåœ¨å‡ºç°æ•…éšœæ—¶å¯ä»¥å¯¹å¤±è´¥çš„èŠ‚ç‚¹é‡æ–°åˆ†å¸ƒå¤„ç†ã€‚</p></li><li><p>é«˜æ‰©å±•æ€§ï¼šåœ¨é›†ç¾¤é—´åˆ†é…ä»»åŠ¡æ•°æ®ï¼Œå¯æ–¹ä¾¿çš„æ‰©å±•æ•°ä»¥åƒè®¡çš„èŠ‚ç‚¹ã€‚</p></li><li><p> é«˜æ•ˆæ€§ï¼šåœ¨MapReduceçš„æ€æƒ³ä¸‹ï¼ŒHadoopæ˜¯å¹¶è¡Œå·¥ä½œçš„ï¼Œä»¥åŠ å¿«ä»»åŠ¡å¤„ç†é€Ÿåº¦ã€‚</p></li><li><p>é«˜å®¹é”™æ€§ï¼šè‡ªåŠ¨ä¿å­˜å¤šä»½å‰¯æœ¬æ•°æ®ï¼Œå¹¶ä¸”èƒ½å¤Ÿè‡ªåŠ¨å°†å¤±è´¥çš„ä»»åŠ¡é‡æ–°åˆ†é…ã€‚</p></li></ul><h2 id="1-5-Hadoopç»„æˆ"><a href="#1-5-Hadoopç»„æˆ" class="headerlink" title="1.5 Hadoopç»„æˆ"></a><strong>1.5 Hadoopç»„æˆ</strong></h2><ul><li><p>Hadoop HDFSï¼šä¸€ä¸ªé«˜å¯é ã€é«˜ååé‡çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚</p></li><li><p>Hadoop MapReduceï¼šä¸€ä¸ªåˆ†å¸ƒå¼çš„ç¦»çº¿å¹¶è¡Œè®¡ç®—æ¡†æ¶ã€‚</p></li><li><p>Hadoop YARNï¼šä½œä¸šè°ƒåº¦ä¸é›†ç¾¤èµ„æºç®¡ç†çš„æ¡†æ¶ã€‚</p></li><li><p>Hadoop Commonï¼šæ”¯æŒå…¶ä»–æ¨¡å—çš„å·¥å…·æ¨¡å—ã€‚</p></li></ul><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image006.jpg" alt="img"></p><p><strong>1ã€HDFSæ¶æ„æ¦‚è¿°</strong></p><p>â€‹    1ï¼‰NameNodeï¼ˆnnï¼‰ï¼šå­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œå¦‚æ–‡ä»¶åï¼Œæ–‡ä»¶ç›®å½•ç»“æ„ï¼Œæ–‡ä»¶å±æ€§ï¼ˆç”Ÿæˆæ—¶é—´ã€å‰¯æœ¬æ•°ã€æ–‡ä»¶æƒé™ï¼‰ï¼Œä»¥åŠæ¯ä¸ªæ–‡ä»¶çš„å—åˆ—è¡¨å’Œå—æ‰€åœ¨çš„DataNodeç­‰ã€‚</p><p>â€‹    2ï¼‰DataNode(dn)ï¼šåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨æ–‡ä»¶å—æ•°æ®ï¼Œä»¥åŠå—æ•°æ®çš„æ ¡éªŒå’Œã€‚</p><p>â€‹    3ï¼‰Secondary NameNode(2nn)ï¼šç”¨æ¥ç›‘æ§HDFSçŠ¶æ€çš„è¾…åŠ©åå°ç¨‹åºï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è·å–HDFSå…ƒæ•°æ®çš„å¿«ç…§ã€‚</p><p><strong>2ã€YARNæ¶æ„æ¦‚è¿°</strong></p><p>â€‹    1ï¼‰ResourceManager(rm)ï¼šå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ã€å¯åŠ¨/ç›‘æ§ApplicationMasterã€ç›‘æ§NodeManagerã€èµ„æºåˆ†é…ä¸è°ƒåº¦ï¼›</p><p>â€‹    2ï¼‰NodeManager(nm)ï¼šå•ä¸ªèŠ‚ç‚¹ä¸Šçš„èµ„æºç®¡ç†ã€å¤„ç†æ¥è‡ªResourceManagerçš„å‘½ä»¤ã€å¤„ç†æ¥è‡ªApplicationMasterçš„å‘½ä»¤ï¼›</p><p>â€‹    3ï¼‰ApplicationMasterï¼šæ•°æ®åˆ‡åˆ†ã€ä¸ºåº”ç”¨ç¨‹åºç”³è¯·èµ„æºï¼Œå¹¶åˆ†é…ç»™å†…éƒ¨ä»»åŠ¡ã€ä»»åŠ¡ç›‘æ§ä¸å®¹é”™ã€‚</p><p>â€‹    4ï¼‰Containerï¼šå¯¹ä»»åŠ¡è¿è¡Œç¯å¢ƒçš„æŠ½è±¡ï¼Œå°è£…äº†CPUã€å†…å­˜ç­‰å¤šç»´èµ„æºä»¥åŠç¯å¢ƒå˜é‡ã€å¯åŠ¨å‘½ä»¤ç­‰ä»»åŠ¡è¿è¡Œç›¸å…³çš„ä¿¡æ¯ã€‚</p><p><strong>3ã€MapReduceæ¶æ„æ¦‚è¿°</strong></p><p>MapReduceå°†è®¡ç®—è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šMapå’ŒReduce</p><p>â€‹    1ï¼‰Mapé˜¶æ®µå¹¶è¡Œå¤„ç†è¾“å…¥æ•°æ®</p><p>â€‹    2ï¼‰Reduceé˜¶æ®µå¯¹Mapç»“æœè¿›è¡Œæ±‡æ€»</p><h2 id="1-6-å¤§æ•°æ®ç”Ÿæ€ä½“ç³»"><a href="#1-6-å¤§æ•°æ®ç”Ÿæ€ä½“ç³»" class="headerlink" title="1.6 å¤§æ•°æ®ç”Ÿæ€ä½“ç³»"></a><strong>1.6</strong> å¤§æ•°æ®ç”Ÿæ€ä½“ç³»</h2><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image016.png" alt="img"></p><p><strong>1ï¼‰Sqoopï¼š</strong>Sqoopæ˜¯ä¸€æ¬¾å¼€æºçš„å·¥å…·ï¼Œä¸»è¦ç”¨äºåœ¨Hadoopã€Hiveä¸ä¼ ç»Ÿçš„æ•°æ®åº“(MySql)é—´è¿›è¡Œæ•°æ®çš„ä¼ é€’ï¼Œå¯ä»¥å°†ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ï¼ˆä¾‹å¦‚ ï¼šMySQLï¼ŒOracle ç­‰ï¼‰ä¸­çš„æ•°æ®å¯¼è¿›åˆ°Hadoopçš„HDFSä¸­ï¼Œä¹Ÿå¯ä»¥å°†HDFSçš„æ•°æ®å¯¼è¿›åˆ°å…³ç³»å‹æ•°æ®åº“ä¸­ã€‚</p><p><strong>2ï¼‰Flumeï¼š</strong>Flumeæ˜¯Clouderaæä¾›çš„ä¸€ä¸ªé«˜å¯ç”¨çš„ï¼Œé«˜å¯é çš„ï¼Œåˆ†å¸ƒå¼çš„æµ·é‡æ—¥å¿—é‡‡é›†ã€èšåˆå’Œä¼ è¾“çš„ç³»ç»Ÿï¼ŒFlumeæ”¯æŒåœ¨æ—¥å¿—ç³»ç»Ÿä¸­å®šåˆ¶å„ç±»æ•°æ®å‘é€æ–¹ï¼Œç”¨äºæ”¶é›†æ•°æ®ï¼›åŒæ—¶ï¼ŒFlumeæä¾›å¯¹æ•°æ®è¿›è¡Œç®€å•å¤„ç†ï¼Œå¹¶å†™åˆ°å„ç§æ•°æ®æ¥å—æ–¹ï¼ˆå¯å®šåˆ¶ï¼‰çš„èƒ½åŠ›ã€‚</p><p><strong>3ï¼‰Kafkaï¼š</strong>Kafkaæ˜¯ä¸€ç§é«˜ååé‡çš„åˆ†å¸ƒå¼å‘å¸ƒè®¢é˜…æ¶ˆæ¯ç³»ç»Ÿï¼Œæœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š</p><p>é€šè¿‡O(1)çš„ç£ç›˜æ•°æ®ç»“æ„æä¾›æ¶ˆæ¯çš„æŒä¹…åŒ–ï¼Œè¿™ç§ç»“æ„å¯¹äºå³ä½¿æ•°ä»¥TBçš„æ¶ˆæ¯å­˜å‚¨ä¹Ÿèƒ½å¤Ÿä¿æŒé•¿æ—¶é—´çš„ç¨³å®šæ€§èƒ½ã€‚</p><p>é«˜ååé‡ï¼šå³ä½¿æ˜¯éå¸¸æ™®é€šçš„ç¡¬ä»¶Kafkaä¹Ÿå¯ä»¥æ”¯æŒæ¯ç§’æ•°ç™¾ä¸‡çš„æ¶ˆæ¯ã€‚</p><p>æ”¯æŒé€šè¿‡KafkaæœåŠ¡å™¨å’Œæ¶ˆè´¹æœºé›†ç¾¤æ¥åˆ†åŒºæ¶ˆæ¯ã€‚</p><p>æ”¯æŒHadoopå¹¶è¡Œæ•°æ®åŠ è½½ã€‚</p><p><strong>4ï¼‰Stormï¼š</strong>Stormç”¨äºâ€œè¿ç»­è®¡ç®—â€ï¼Œå¯¹æ•°æ®æµåšè¿ç»­æŸ¥è¯¢ï¼Œåœ¨è®¡ç®—æ—¶å°±å°†ç»“æœä»¥æµçš„å½¢å¼è¾“å‡ºç»™ç”¨æˆ·ã€‚</p><p><strong>5ï¼‰Sparkï¼š</strong>Sparkæ˜¯å½“å‰æœ€æµè¡Œçš„å¼€æºå¤§æ•°æ®å†…å­˜è®¡ç®—æ¡†æ¶ã€‚å¯ä»¥åŸºäºHadoopä¸Šå­˜å‚¨çš„å¤§æ•°æ®è¿›è¡Œè®¡ç®—ã€‚</p><p><strong>6ï¼‰Oozieï¼š</strong>Oozieæ˜¯ä¸€ä¸ªç®¡ç†Hdoopä½œä¸šï¼ˆjobï¼‰çš„å·¥ä½œæµç¨‹è°ƒåº¦ç®¡ç†ç³»ç»Ÿã€‚</p><p><strong>7ï¼‰Hbaseï¼š</strong>HBaseæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€é¢å‘åˆ—çš„å¼€æºæ•°æ®åº“ã€‚HBaseä¸åŒäºä¸€èˆ¬çš„å…³ç³»æ•°æ®åº“ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€‚åˆäºéç»“æ„åŒ–æ•°æ®å­˜å‚¨çš„æ•°æ®åº“ã€‚</p><p><strong>8ï¼‰Hiveï¼š</strong>Hiveæ˜¯åŸºäºHadoopçš„ä¸€ä¸ªæ•°æ®ä»“åº“å·¥å…·ï¼Œå¯ä»¥å°†ç»“æ„åŒ–çš„æ•°æ®æ–‡ä»¶æ˜ å°„ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼Œå¹¶æä¾›ç®€å•çš„SQLæŸ¥è¯¢åŠŸèƒ½ï¼Œå¯ä»¥å°†SQLè¯­å¥è½¬æ¢ä¸ºMapReduceä»»åŠ¡è¿›è¡Œè¿è¡Œã€‚ å…¶ä¼˜ç‚¹æ˜¯å­¦ä¹ æˆæœ¬ä½ï¼Œå¯ä»¥é€šè¿‡ç±»SQLè¯­å¥å¿«é€Ÿå®ç°ç®€å•çš„MapReduceç»Ÿè®¡ï¼Œä¸å¿…å¼€å‘ä¸“é—¨çš„MapReduceåº”ç”¨ï¼Œååˆ†é€‚åˆæ•°æ®ä»“åº“çš„ç»Ÿè®¡åˆ†æã€‚</p><p><strong>9ï¼‰Rè¯­è¨€ï¼š</strong>Ræ˜¯ç”¨äºç»Ÿè®¡åˆ†æã€ç»˜å›¾çš„è¯­è¨€å’Œæ“ä½œç¯å¢ƒã€‚Ræ˜¯å±äºGNUç³»ç»Ÿçš„ä¸€ä¸ªè‡ªç”±ã€å…è´¹ã€æºä»£ç å¼€æ”¾çš„è½¯ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºç»Ÿè®¡è®¡ç®—å’Œç»Ÿè®¡åˆ¶å›¾çš„ä¼˜ç§€å·¥å…·ã€‚</p><p><strong>10ï¼‰Mahoutï¼š</strong>Apache Mahoutæ˜¯ä¸ªå¯æ‰©å±•çš„æœºå™¨å­¦ä¹ å’Œæ•°æ®æŒ–æ˜åº“ã€‚</p><p><strong>11ï¼‰ZooKeeperï¼š</strong>Zookeeperæ˜¯Googleçš„Chubbyä¸€ä¸ªå¼€æºçš„å®ç°ã€‚å®ƒæ˜¯ä¸€ä¸ªé’ˆå¯¹å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¯é åè°ƒç³»ç»Ÿï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åå­—æœåŠ¡ã€ åˆ†å¸ƒå¼åŒæ­¥ã€ç»„æœåŠ¡ç­‰ã€‚ZooKeeperçš„ç›®æ ‡å°±æ˜¯å°è£…å¥½å¤æ‚æ˜“å‡ºé”™çš„å…³é”®æœåŠ¡ï¼Œå°†ç®€å•æ˜“ç”¨çš„æ¥å£å’Œæ€§èƒ½é«˜æ•ˆã€åŠŸèƒ½ç¨³å®šçš„ç³»ç»Ÿæä¾›ç»™ç”¨æˆ·ã€‚</p><h1 id="äºŒã€Hadoopç¯å¢ƒé…ç½®"><a href="#äºŒã€Hadoopç¯å¢ƒé…ç½®" class="headerlink" title="äºŒã€Hadoopç¯å¢ƒé…ç½®"></a>äºŒã€Hadoopç¯å¢ƒé…ç½®</h1><p><strong>ä¸Šä¼ æ–‡ä»¶éœ€è¦æ–‡ä»¶</strong></p><p>è¿›å…¥åˆ°æ ¹ç›®å½•ä¸‹ï¼Œä¸¤ä¸ªç›®å½•</p><p>mkdir /tools ä½œä¸ºä¸Šä¼ å®‰è£…çš„æ–‡ä»¶</p><p>mkdir /training ä½œä¸ºåé¢ç¯å¢ƒçš„ä½¿ç”¨</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image018.jpg" alt="img"></p><h2 id="2-1-ä¿®æ”¹æ˜ å°„åå’Œé…ç½®hostæ–‡ä»¶"><a href="#2-1-ä¿®æ”¹æ˜ å°„åå’Œé…ç½®hostæ–‡ä»¶" class="headerlink" title="2.1 ä¿®æ”¹æ˜ å°„åå’Œé…ç½®hostæ–‡ä»¶"></a>2.1 ä¿®æ”¹æ˜ å°„åå’Œé…ç½®hostæ–‡ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚é€šè¿‡ç¼–è¾‘/etc/hostsæ–‡ä»¶</p><p><code> vi /etc/hosts</code></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image019.png" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image020.png" alt="img"></p><h2 id="2-2-å…³é—­é˜²ç«å¢™"><a href="#2-2-å…³é—­é˜²ç«å¢™" class="headerlink" title="2.2 å…³é—­é˜²ç«å¢™"></a><strong>2.2</strong> <strong>å…³é—­é˜²ç«å¢™</strong></h2><p>å…³é—­é˜²ç«å¢™(CentOS7ä¸‹)</p><p><code>systemctl stop firewalld.service</code></p><p><code>systemctl disable firewalld.service</code></p><h2 id="2-3-å®‰è£…JDK"><a href="#2-3-å®‰è£…JDK" class="headerlink" title="2.3 å®‰è£…JDK"></a>2.3 å®‰è£…JDK</h2><p>æŠŠä¸Šä¼ åˆ°toolsç›®å½•ä¸‹çš„JDKè¿›è¡Œè§£å‹</p><p><code>tar -zvxf jdk-7u80-linux-x64.tar.gz -C /tarining/</code></p><p>é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><p><code>vi ~/.bash_profile</code></p><p>â€‹    æ·»åŠ å¦‚ä¸‹ä¿¡æ¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml">export JAVA_HOME=/training/jdk1.8.0_171<br><br>export JRE_HOME=$JAVA_HOME/jre<br><br>export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/lib<br><br>export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin<br></code></pre></td></tr></table></figure><p>è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</p><p><code>source ~/.bash_profile</code></p><p>éªŒè¯jdkæ˜¯å¦å®‰è£…æˆåŠŸ</p><p><code>java -version</code></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image023.jpg" alt="img"></p><h2 id="2-4-å®‰è£…Hadoop"><a href="#2-4-å®‰è£…Hadoop" class="headerlink" title="2.4 å®‰è£…Hadoop"></a>2.4 å®‰è£…Hadoop</h2><p>æŠŠä¸Šä¼ åˆ°toolsç›®å½•ä¸‹çš„Hadoopè¿›è¡Œè§£å‹</p><p><code>tar -zvxf /hadoop-2.7.3.tar.gz -C /training/</code></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image025.jpg" alt="img"></p><p><code>cd /training/hadoop-2.7.3/</code></p><p>é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><p><code>vi ~/.bash_profile</code></p><p>æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">export HADOOP_HOME=/training/hadoop-2.7.3<br>export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin<br></code></pre></td></tr></table></figure><p>è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š</p><p><code>source ~/.bash_profile</code></p><p>tree -d -L 3 hadoop-2.7.3/ ä¼šåˆ—å‡ºä¸‰çº§æ ‘å½¢ç»“æ„ç›®å½•</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image027.png" alt="img"></p><h1 id="ä¸‰ã€Hadoopè¿è¡Œæ¨¡å¼"><a href="#ä¸‰ã€Hadoopè¿è¡Œæ¨¡å¼" class="headerlink" title="ä¸‰ã€Hadoopè¿è¡Œæ¨¡å¼"></a>ä¸‰ã€Hadoopè¿è¡Œæ¨¡å¼</h1><h2 id="3-1-å‚è€ƒç½‘å€"><a href="#3-1-å‚è€ƒç½‘å€" class="headerlink" title="3.1 å‚è€ƒç½‘å€"></a>3.1 å‚è€ƒç½‘å€</h2><p>ï¼ˆ1ï¼‰å®˜æ–¹ç½‘ç«™ï¼š</p><p><a href="http://hadoop.apache.org/">http://hadoop.apache.org/</a></p><p>ï¼ˆ2ï¼‰å„ä¸ªç‰ˆæœ¬å½’æ¡£åº“åœ°å€</p><p><a href="https://archive.apache.org/dist/hadoop/common/hadoop-2.7.2/">https://archive.apache.org/dist/hadoop/common/hadoop-2.7.2/</a></p><p>ï¼ˆ3ï¼‰hadoop2.7.2ç‰ˆæœ¬è¯¦æƒ…ä»‹ç»</p><p><a href="http://hadoop.apache.org/docs/r2.7.2/">http://hadoop.apache.org/docs/r2.7.2/</a></p><h2 id="3-2-Hadoopè¿è¡Œæ¨¡å¼"><a href="#3-2-Hadoopè¿è¡Œæ¨¡å¼" class="headerlink" title="3.2 Hadoopè¿è¡Œæ¨¡å¼"></a>3.2 Hadoopè¿è¡Œæ¨¡å¼</h2><ul><li><p>æœ¬åœ°æ¨¡å¼ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰ï¼š</p><ul><li>ä¸éœ€è¦å¯ç”¨å•ç‹¬è¿›ç¨‹ï¼Œç›´æ¥å¯ä»¥è¿è¡Œï¼Œæµ‹è¯•å’Œå¼€å‘æ—¶ä½¿ç”¨ã€‚</li></ul></li><li><p>ä¼ªåˆ†å¸ƒå¼æ¨¡å¼ï¼š</p><ul><li>ç­‰åŒäºå®Œå…¨åˆ†å¸ƒå¼ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li></ul></li><li><p>å®Œå…¨åˆ†å¸ƒå¼æ¨¡å¼ï¼š</p><ul><li>å¤šä¸ªèŠ‚ç‚¹ä¸€èµ·è¿è¡Œã€‚</li></ul></li></ul><h3 id="3-2-1-æœ¬åœ°æ¨¡å¼æµ‹è¯•"><a href="#3-2-1-æœ¬åœ°æ¨¡å¼æµ‹è¯•" class="headerlink" title="3.2.1 æœ¬åœ°æ¨¡å¼æµ‹è¯•"></a>3.2.1 æœ¬åœ°æ¨¡å¼æµ‹è¯•</h3><ul><li>ç‰¹ç‚¹ï¼šæ²¡æœ‰HDFSï¼Œåªèƒ½è¿›è¡ŒMapReduceè®¡ç®—ï¼Œè€Œä¸”åªæ“ä½œLinuxä¸Šçš„æ–‡ä»¶</li></ul><p>éªŒè¯ä¸‹ï¼š</p><p>1ã€æŠŠä¸Šä¼ åˆ°toolsç›®å½•ä¸‹çš„Hadoopè¿›è¡Œè§£å‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf /tools/hadoop-2.7.3.tar.gz -C /training/<br></code></pre></td></tr></table></figure><p>2ã€é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">vi ~<span class="hljs-string">/.bash_profile</span><br></code></pre></td></tr></table></figure><p>â€‹    æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">export HADOOP_HOME=/training/hadoop-2.7.3<br>export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin<br></code></pre></td></tr></table></figure><p> 3ã€ è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/.bash_profile<br></code></pre></td></tr></table></figure><p>â€‹    æµ‹è¯•å‰éœ€è¦åˆ›å»ºæµ‹è¯•ç›®å½•å’Œæµ‹è¯•æ–‡ä»¶ï¼š</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">mkdir ~<span class="hljs-regexp">/demo/i</span>nput<br>mkdir ~<span class="hljs-regexp">/demo/</span>output<br>vi ~<span class="hljs-regexp">/demo/i</span>nput/test.txt<br></code></pre></td></tr></table></figure><p>â€‹       è¾“å…¥å¦‚ä¸‹å†…å®¹:</p><p>â€‹           I love Guiyang</p><p>â€‹           I love Guizhou</p><p>â€‹           Guiyang is the capital of Guizhou</p><p>â€‹       ä¿å­˜é€€å‡º</p><p>â€‹       è¿›å…¥åˆ°ï¼šmapreduce/ç›®å½•ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd /training/hadoop-2.7.3/share/hadoop/mapreduce/<br></code></pre></td></tr></table></figure><p>â€‹       æ‰§è¡Œï¼š~/output ä¸éœ€è¦äº‹å…ˆå­˜åœ¨ï¼Œå­˜åœ¨ä¼šæŠ¥é”™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hadoop jar hadoop-mapreduce-examples-2.7.3.jar wordcount ~/demo/input/test.txt ~/demo/output<br></code></pre></td></tr></table></figure><p>â€‹       æŸ¥çœ‹ç»“æœï¼š</p><p>â€‹           MapReduceç¨‹åºçš„æ‰§è¡Œç»“æœä¼šé»˜è®¤æŒ‰ç…§è‹±æ–‡å•è¯çš„å­—å…¸é¡ºåºè¿›è¡Œäº†æ’åº</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image029.jpg" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image031.jpg" alt="img"></p><h3 id="3-2-2-ä¼ªåˆ†å¸ƒæ¨¡å¼ç¯å¢ƒæ­å»º"><a href="#3-2-2-ä¼ªåˆ†å¸ƒæ¨¡å¼ç¯å¢ƒæ­å»º" class="headerlink" title="3.2.2  ä¼ªåˆ†å¸ƒæ¨¡å¼ç¯å¢ƒæ­å»º"></a><strong>3.2.2  ä¼ªåˆ†å¸ƒæ¨¡å¼ç¯å¢ƒæ­å»º</strong></h3><p>ç‰¹ç‚¹ï¼šå…·å¤‡HDFSå…¨éƒ¨åŠŸèƒ½</p><p>HDFS:NameNode + DataNode</p><p>Yarn:ReourceManager + NodeManager</p><p><strong>1ï¼‰åˆ†æï¼š</strong></p><p>â€‹    ï¼ˆ1ï¼‰å‡†å¤‡1å°å®¢æˆ·æœº</p><p>â€‹    ï¼ˆ2ï¼‰å®‰è£…jdk</p><p>â€‹    ï¼ˆ3ï¼‰é…ç½®ç¯å¢ƒå˜é‡</p><p>â€‹    ï¼ˆ4ï¼‰å®‰è£…hadoop</p><p>â€‹    ï¼ˆ5ï¼‰é…ç½®ç¯å¢ƒå˜é‡</p><p>â€‹    ï¼ˆ6ï¼‰é…ç½®é›†ç¾¤</p><p>â€‹    ï¼ˆ7ï¼‰å¯åŠ¨ã€æµ‹è¯•é›†ç¾¤å¢ã€åˆ ã€æŸ¥</p><p>â€‹    ï¼ˆ8ï¼‰åœ¨HDFSä¸Šæ‰§è¡Œwordcountæ¡ˆä¾‹</p><p><strong>2ï¼‰æ‰§è¡Œæ­¥éª¤</strong></p><p>éœ€è¦é…ç½®hadoopæ–‡ä»¶å¦‚ä¸‹</p><p><strong>1ã€é…ç½®ï¼šhadoop-env.sh</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi hadoop-env.sh<br></code></pre></td></tr></table></figure><p><strong>é…ç½®Javaç¯å¢ƒå˜é‡</strong>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">export JAVA_HOME=/training/jdk1.8.0_171<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image002-1610529336152.png" alt="img"></p><p><strong>2ã€é…ç½®ï¼šhdfs-site.xml</strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /training/hadoop-2.7.3/etc/hadoop/hdfs-site.xml<br></code></pre></td></tr></table></figure><p>hdfs-site.xmlï¼šåŸåˆ™æ˜¯ï¼šä¸€èˆ¬æœ‰å‡ ä¸ªæ•°æ®èŠ‚ç‚¹å°±é…ç½®å‡ ä¸ªï¼Œä½†æ˜¯æœ€å¤šä¸èƒ½è¶…å¤š3</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--è¡¨ç¤ºæ•°æ®å—çš„å†—ä½™åº¦ é»˜è®¤ä¸º3--&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image003-1610529336152.png" alt="img"></p><p><strong>3ã€é…ç½®ï¼šcore-site.xml</strong></p><p>éœ€è¦æå‰æ–°å»ºä¸€ä¸ªtmpæ–‡ä»¶å¤¹</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/image-20210113172925162.png" alt="image-20210113172925162"></p><p><code>vi /training/hadoop-2.7.3/etc/hadoop/core-site.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®NameNodeçš„é€šè®¯åœ°å€ 9000 æ˜¯RPCé»˜è®¤çš„é€šä¿¡ç«¯å£--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://192.168.181.135:9000<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>         <br><span class="hljs-comment">&lt;!--HDFSæ•°æ®ä¿å­˜åœ¨Linuxçš„å“ªä¸ªç›®å½•ï¼Œé»˜è®¤å€¼æ˜¯Linuxçš„tmpç›®å½• å¿…é¡»é…ç½®ï¼Œå¦åˆ™ä¼šæŠ¥é”™/training/hadoop-2.7.3/tmp å¿…é¡»äº‹å…ˆå­˜åœ¨--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hadoop.tmp.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>/training/hadoop-2.7.3/tmp<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span></span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image005.jpg" alt="img"></p><p><strong>4ã€é…ç½®ï¼šmapper-site.xml</strong></p><p>  è¿™ä¸ªæ–‡ä»¶äº‹å…ˆæ˜¯ä¸å­˜åœ¨çš„ï¼Œéœ€è¦å¤åˆ¶ä¸€ä»½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp /training/hadoop-2.7.3/etc/hadoop/mapred-site.xml.template /training/hadoop-2.7.3/etc/hadoop/mapred-site.xml<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">vi /training/hadoop<span class="hljs-literal">-2</span>.<span class="hljs-number">7.3</span>/etc/hadoop/mapper<span class="hljs-literal">-site</span>.xml<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®MRçš„è¿è¡Œæ¡†æ¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.framework.name<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>yarn<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span></span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image007.jpg" alt="img"></p><p><strong>5ã€é…ç½®ï¼šyarn-site.xml</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">vi /training/hadoop<span class="hljs-literal">-2</span>.<span class="hljs-number">7.3</span>/etc/hadoop/mapper<span class="hljs-literal">-site</span>.xml<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--Yarnçš„ä¸»èŠ‚ç‚¹RMçš„ä½ç½®--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>192.130.91.130<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--MapReduceè¿è¡Œæ–¹å¼ï¼šshuffleæ´—ç‰Œ--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>mapreduce_shuffle<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>è®¾ç½®å…å¯†ç ç™»å½•</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh-keygen -t rsa</span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image001.png" alt="img"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">ssh-copy-id <span class="hljs-number">192.168</span><span class="hljs-number">.91</span><span class="hljs-number">.130</span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image003.jpg" alt="img"></p><p><strong>æœ€åéªŒè¯Hadoop</strong></p><p>æ ¼å¼åŒ–ï¼šHDFS(NameNode)</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">hdfs namenode -<span class="hljs-built_in">format</span><br></code></pre></td></tr></table></figure><p>â€‹       å¯åŠ¨hadoopç¯å¢ƒ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">start</span>-<span class="hljs-keyword">all</span>.sh<br></code></pre></td></tr></table></figure><p>â€‹       è®¿é—®ï¼šwebç•Œé¢è¿›è¡ŒéªŒè¯</p><p>â€‹            HDFS:<a href="http://192.168.91.130:50070/">http://192.168.91.130:50070</a></p><p>â€‹            Yran:<a href="http://192.168.91.130:8088/">http://192.168.91.130:8088</a></p><p>â€‹      åœæ­¢ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">stop</span>-<span class="hljs-keyword">all</span>.<span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image002-1610540693507.jpg" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image003.png" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image004.png" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image006-1610540693509.jpg" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image008-1610540693510.jpg" alt="img"></p><h3 id="3-2-3-ä¼ªåˆ†å¸ƒæµ‹è¯•"><a href="#3-2-3-ä¼ªåˆ†å¸ƒæµ‹è¯•" class="headerlink" title="3.2.3 ä¼ªåˆ†å¸ƒæµ‹è¯•"></a><strong>3.2.3 ä¼ªåˆ†å¸ƒæµ‹è¯•</strong></h3><p>ç¼–è¾‘test.txtæ–‡ä»¶ï¼Œå†™å…¥ä¸€ä¸ªå•è¯ã€‚</p><p>I have a dream that one day this nation will rise up and live out the true meaning of its creed: â€œWe hold these truths to be self-evident, that all men are created equal.â€</p><p>I have a dream that one day on the red hills of Georgia, the sons of former slaves and the sons of former slave owners will be able to sit down together at the table of brotherhood.</p><p>I have a dream that one day even the state of Mississippi, a state sweltering with the heat of injustice, sweltering with the heat of oppression, will be transformed into an oasis of freedom and justice.</p><p>I have a dream that my four little children will one day live in a nation where they will not be judged by the color of their skin but by the content of their character.</p><p>I have a dream today!</p><p>I have a dream that one day, down in Alabama, with its vicious racists, with its governor having his lips dripping with the words of â€œinterpositionâ€ and â€œnullificationâ€ â€“ one day right there in Alabama little black boys and black girls will be able to join hands with little white boys and white girls as sisters and brothers.</p><p>I have a dream today!</p><p>I have a dream that one day every valley shall be exalted, and every hill and mountain shall be made low, the rough places will be made plain, and the crooked places will be made straight; â€œand the glory of the Lord shall be revealed and all flesh shall see it together.â€</p><p>æµ‹è¯•éœ€è¦æŠŠæ–‡ä»¶ä¸Šä¼ åˆ°HDFSä¸Šï¼Œåœ¨HDFSä¸Šåˆ›å»ºä¸€ä¸ªç›®å½•</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image048.png" alt="img"></p><p>å°†æœ¬åœ°çš„æ–‡æœ¬ä¸Šä¼ åˆ°HDFSä¸Šåˆ›å»ºçš„ç›®å½•</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image050.jpg" alt="img"></p><p>æœ€åæ‰§è¡Œ</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image051.png" alt="img"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">hadoop jar hadoop-mapreduce-examples-<span class="hljs-number">2.7</span>.<span class="hljs-number">3</span>.jar wordcount <span class="hljs-regexp">/root/i</span>nput<span class="hljs-regexp">/test.txt /</span>root/output<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image053.jpg" alt="img"></p><p>æŸ¥çœ‹ç»“æœ</p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image055.jpg" alt="img"></p><p><img src="/2021/01/13/%E5%88%86%E7%B1%BB-%E5%88%86%E5%B8%83%E5%BC%8F/Hadoop%E5%85%A5%E9%97%A8/clip_image057.jpg" alt="img"></p><h3 id="3-2-4-Hadoopå…¨åˆ†å¸ƒæ¨¡å¼"><a href="#3-2-4-Hadoopå…¨åˆ†å¸ƒæ¨¡å¼" class="headerlink" title="3.2.4 Hadoopå…¨åˆ†å¸ƒæ¨¡å¼"></a><strong>3.2.4 Hadoopå…¨åˆ†å¸ƒæ¨¡å¼</strong></h3><p>åˆ†æï¼š</p><p>â€‹    1ï¼‰å‡†å¤‡3å°å®¢æˆ·æœºï¼ˆå…³é—­é˜²ç«å¢™ã€é™æ€ipã€ä¸»æœºåç§°ï¼‰</p><p>â€‹    2ï¼‰å®‰è£…jdk</p><p>â€‹    3ï¼‰é…ç½®ç¯å¢ƒå˜é‡</p><p>â€‹    4ï¼‰å®‰è£…hadoop</p><p>â€‹    5ï¼‰é…ç½®ç¯å¢ƒå˜é‡</p><p>â€‹    6ï¼‰å®‰è£…ssh</p><p>â€‹    7ï¼‰é…ç½®é›†ç¾¤</p><p>â€‹    8ï¼‰å¯åŠ¨æµ‹è¯•é›†ç¾¤</p><p><strong>1ï¼‰å‡†å¤‡å·¥ä½œ</strong></p><p>â€‹           1ã€æ‰€æœ‰ä¸»æœºå®‰è£…jdk</p><p>â€‹           2ã€æ‰€æœ‰ä¸»æœºéƒ½éœ€è¦å…³é—­é˜²ç«å¢™</p><p>â€‹           3ã€æ‰€æœ‰ä¸»æœºéƒ½éœ€è¦é…ç½®ä¸»æœºå vi /etc/hosts</p><p>â€‹           4ã€é…ç½®å…å¯†ç ç™»å½•ï¼ˆé…ç½®ä¸¤ä¸¤ä¹‹é—´çš„å…å¯†ç ç™»å½•ï¼‰</p><p>â€‹              æ‰€æœ‰çš„æœºå™¨éƒ½éœ€è¦äº§ç”Ÿä¸€å¯¹å¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ssh-keygen -t rsa</span>              <br></code></pre></td></tr></table></figure><p>â€‹              æ‰€æœ‰ä¸»æœºéœ€è¦æ‰§è¡Œ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">ssh-<span class="hljs-keyword">copy</span>-<span class="hljs-built_in">id</span> -i .ssh/id_rsa.pub root@hadoop01<br>ssh-<span class="hljs-keyword">copy</span>-<span class="hljs-built_in">id</span> -i .ssh/id_rsa.pub root@hadoop02<br>ssh-<span class="hljs-keyword">copy</span>-<span class="hljs-built_in">id</span> -i .ssh/id_rsa.pub root@hadoop03<br></code></pre></td></tr></table></figure><p>5ã€ä¿è¯æ¯å°æœºå™¨çš„æ—¶é—´æ˜¯ä¸€æ ·çš„</p><p>â€‹              å¦‚æœä¸ä¸€æ ·çš„è¯ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡ŒMapReduceç¨‹åºçš„æ—¶å€™å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜</p><p>â€‹              è§£å†³æ–¹æ¡ˆï¼š</p><p>â€‹                  1ï¼‰æ­å»ºä¸€ä¸ªæ—¶é—´åŒæ­¥çš„æœåŠ¡å™¨ï¼Œç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹å¯ä»¥ä½¿ç”¨</p><p>â€‹                  2ï¼‰ä½¿ç”¨puttyå·¥å…·ï¼Œå¯ä»¥ç®€å•å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p><p>â€‹                     date -s 2020-09-01 åé¢å¿…é¡»æ•²ä¸€ä¸ªå›è½¦</p><p><strong>2ï¼‰åœ¨ä¸»èŠ‚ç‚¹ä¸Šè¿›è¡Œå®‰è£…é…ç½®ï¼ˆhadoop01ï¼‰</strong></p><p>ï¼ˆ1ï¼‰ä¸Šä¼ hadoopå®‰è£…åŒ…ï¼Œè§£å†³é…ç½®ç¯å¢ƒå˜é‡</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tar</span> -zvxf hadoop-<span class="hljs-number">2</span>.<span class="hljs-number">7</span>.<span class="hljs-number">3</span>.tar.gz -C /training/<br></code></pre></td></tr></table></figure><p>â€‹               åŒæ—¶è®¾ç½®ï¼šhadoop01 hadoop02 hadoop03</p><p>â€‹                   </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">HADOOP_HOME</span>=/training/hadoop-2.7.3<br><span class="hljs-builtin-name">export</span> HADOOP_HOME<br><span class="hljs-attribute">PATH</span>=<span class="hljs-variable">$HADOOP_HOME</span>/bin:$HADOOP_HOME/sbin:$PATH<br>epxort PATH<br></code></pre></td></tr></table></figure><p>ï¼ˆ*ï¼‰ä¿®æ”¹é…ç½®æ–‡ä»¶</p><p>â€‹               vi hadoop-env.sh è®¾ç½®JDKçš„è·¯å¾„</p><p>â€‹               hdfs-site.xml:</p><p>â€‹                  <!--è¡¨ç¤ºæ•°æ®å—çš„å†—ä½™åº¦ é»˜è®¤ä¸º3--></p><p>â€‹                  <property></property></p><p>â€‹                    <name>dfs.replication</name></p><p>â€‹                    <value>2</value></p><p>â€‹                  </p><p>â€‹               core-site.xml:</p><p>â€‹                  <!--é…ç½®NameNodeçš„é€šè®¯åœ°å€ 9000 æ˜¯RPCé»˜è®¤çš„é€šä¿¡ç«¯å£--></p><p>â€‹                  <property></property></p><p>â€‹                      <name>fs.defaultFS</name></p><p>â€‹                     <value>hdfs://hadoop01:9000</value></p><p>â€‹                           </p><p>â€‹                  &lt;!â€“HDFSæ•°æ®ä¿å­˜åœ¨Linuxçš„å“ªä¸ªç›®å½•ï¼Œé»˜è®¤å€¼æ˜¯Linuxçš„tmpç›®å½• å¿…é¡»é…ç½®ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p><p>â€‹                  /training/hadoop-2.7.3/tmp å¿…é¡»äº‹å…ˆå­˜åœ¨â€“&gt;</p><p>â€‹                  <property></property></p><p>â€‹                     <name>hadoop.tmp.dir</name></p><p>â€‹                     <value>/training/hadoop-2.7.3/tmp</value></p><p>â€‹                  </p><p>â€‹               mapper-site.xml:</p><p>â€‹                  <!--é…ç½®MRçš„è¿è¡Œæ¡†æ¶--></p><p>â€‹                  <property></property></p><p>â€‹                     <name>mapreduce.framework.name</name></p><p>â€‹                     <value>yarn</value></p><p>â€‹                  </p><p>â€‹               yarn-site.xml:</p><p>â€‹                     <!--Yarnçš„ä¸»èŠ‚ç‚¹RMçš„ä½ç½®--></p><p>â€‹                     <property></property></p><p>â€‹                       <name>yarn.resourcemanager.hostname</name></p><p>â€‹                       <value>niit01</value></p><p>â€‹                     </p><p>â€‹                     <!--MapReduceè¿è¡Œæ–¹å¼ï¼šshuffleæ´—ç‰Œ--></p><p>â€‹                     <property></property></p><p>â€‹                       <name>yarn.nodemanager.aux-services</name></p><p>â€‹                       <value>mapreduce_shuffle</value></p><p>â€‹                       </p><p>â€‹              savles:</p><p>â€‹                  hadoop02</p><p>â€‹                  hadoop03</p><p>â€‹           ï¼ˆ*ï¼‰æ ¼å¼åŒ–nameNode</p><p>â€‹                  hdfs namenode -format</p><p>â€‹                  æ—¥å¿—ï¼š</p><p>â€‹                  common.Storage: Storage directory /tmp/hadoop-root/dfs/name has been successfully formatted.</p><p>â€‹           ï¼ˆ*ï¼‰å°†hadoop01ä¸Šçš„hadoopç¯å¢ƒå¤åˆ¶åˆ°hadoop02 hadoop03</p><p>â€‹                  scp -r hadoop-2.7.3/ root@hadoop02:/training/</p><p>â€‹                  scp -r hadoop-2.7.3/ root@hadoop03:/training/</p><p>â€‹           ï¼ˆ*ï¼‰åœ¨ä¸»èŠ‚ç‚¹ï¼ˆniit01ï¼‰ä¸Šå¯åŠ¨hdfs</p><p>â€‹              start-all.sh</p>]]></content>
    
    
    <categories>
      
      <category>åˆ†å¸ƒå¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hadoop</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021å¯’å‡å®è®­å¤§æ•°æ®åˆ†æç”µå•†å¹³å°</title>
    <link href="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/"/>
    <url>/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ç¯å¢ƒå®‰è£…"><a href="#ä¸€ã€ç¯å¢ƒå®‰è£…" class="headerlink" title="ä¸€ã€ç¯å¢ƒå®‰è£…"></a><strong>ä¸€ã€ç¯å¢ƒå®‰è£…</strong></h1><h2 id="1-1-æ–°å»ºè™šæ‹Ÿæœº"><a href="#1-1-æ–°å»ºè™šæ‹Ÿæœº" class="headerlink" title="1.1 æ–°å»ºè™šæ‹Ÿæœº"></a><strong>1.1</strong> <strong>æ–°å»ºè™šæ‹Ÿæœº</strong></h2><p>å®è®­çš„é¡¹ç›®ä¸»è¦æ˜¯è¿›è¡Œå¤§æ•°æ®çš„å®è®­ï¼Œæ‰€ä»¥éœ€è¦æŒ‰ç…§Linuxï¼Œä½¿ç”¨VMware Workstationä½œä¸ºè™šæ‹Ÿæœºå®‰è£…Linuxç³»ç»Ÿï¼Œåˆ›å»ºè™šæ‹Ÿæœºï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image002.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image004.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image006.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image008.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image010.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image012.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image014.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image016.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image018.jpg" alt="img"> <img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image020.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image022.jpg" alt="img"><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image024.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image026.jpg" alt="img"><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image028.jpg" alt="img"></p><p>æ¥ä¸‹æ¥ï¼Œç‚¹å‡»ç¼–è¾‘è™šæ‹Ÿæœºï¼Œéœ€è¦æ‰¾åˆ°Linuxçš„IOSæ–‡ä»¶</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image030.jpg" alt="img"> <img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image032.jpg" alt="img"></p><p>æ‰¾åˆ°é•œåƒæ–‡ä»¶ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®‰è£…Linuxç³»ç»Ÿï¼Œé€‰æ‹©å¼€å¯è™šæ‹Ÿæœºï¼Œè™šæ‹Ÿæœºè¿›è¡ŒåŠ è½½Linuxè¿›è¡Œå®‰è£…ã€‚</p><h2 id="1-2-å®‰è£…Linuxçš„é•œåƒ"><a href="#1-2-å®‰è£…Linuxçš„é•œåƒ" class="headerlink" title="1.2 å®‰è£…Linuxçš„é•œåƒ"></a><strong>1.2</strong> <strong>å®‰è£…Linuxçš„é•œåƒ</strong></h2><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image034.jpg" alt="img"></p><p>é€‰æ‹©è¯­è¨€</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image036.jpg" alt="img"></p><p>ä¸‹ä¸€æ­¥</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image038.jpg" alt="img"></p><p>è®¾ç½®å¯†ç </p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image040.jpg" alt="img"></p><p>å®‰è£…å¥½ä¹‹åï¼Œè¿›è¡Œé‡å¯</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image042.jpg" alt="img"></p><p>é‡å¯ä¹‹åï¼Œè¿›è¡Œç™»å½•ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç </p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image044.jpg" alt="img"> <img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image046.jpg" alt="img"></p><h2 id="1-3-è¿œç¨‹ç™»å½•å·¥å…·MobaXterm"><a href="#1-3-è¿œç¨‹ç™»å½•å·¥å…·MobaXterm" class="headerlink" title="1.3 è¿œç¨‹ç™»å½•å·¥å…·MobaXterm"></a><strong>1.3</strong> <strong>è¿œç¨‹ç™»å½•å·¥å…·MobaXterm</strong></h2><p>MobaXterm_Portable_v20.3</p><p>å¯è¿æ¥è™šæ‹Ÿæœºæ“ä½œæ–‡ä»¶ ç¼–å†™å‘½ä»¤</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210113164121117.png" alt="image-20210113164121117"></p><p>è¿æ¥è™šæ‹Ÿæœºéœ€è¦çŸ¥é“è™šæ‹Ÿæœºipåœ°å€</p><p>åœ¨è™šæ‹Ÿæœºä¸­è¾“å…¥<code>ifconfig -a</code>å‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾</p><p>æ‰¾ä¸åˆ°ifconfigå‘½ä»¤ï¼Œé¦–å…ˆæŸ¥æ‰¾<code>yum search ifconfig</code></p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image002-1610527467248.jpg" alt="img"></p><p>ä¹‹åå°±å¯ä»¥ä½¿ç”¨</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image003.png" alt="img"></p><p>è¦è¿›è¡Œåé¢çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹å‡ ä¸ªé…ç½®ï¼Œå…³é—­é˜²ç«å¢™ï¼Œå¹¶ç¦æ­¢å¼€æœºå¯åŠ¨ã€‚</p><p>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ï¼š <code>systemctl status firewalld</code></p><p>æ‰§è¡Œå…³é—­å‘½ä»¤ï¼š <code>systemctl stop firewalld</code></p><p>æ‰§è¡Œå¼€æœºç¦ç”¨é˜²ç«å¢™è‡ªå¯å‘½ä»¤ï¼š<code>systemctl disable firewalld</code></p><p>è¿˜æœ‰è¿›è¡Œä¸»æœºåçš„ä¿®æ”¹ï¼š<code>vi /etc/hosts</code>æˆ–<code>vi /etc/hostname</code></p><h2 id="1-4-å®‰è£…JDKåŠç›¸åº”å‡†å¤‡å·¥ä½œ"><a href="#1-4-å®‰è£…JDKåŠç›¸åº”å‡†å¤‡å·¥ä½œ" class="headerlink" title="1.4 å®‰è£…JDKåŠç›¸åº”å‡†å¤‡å·¥ä½œ"></a><strong>1.4</strong> <strong>å®‰è£…JDKåŠç›¸åº”å‡†å¤‡å·¥ä½œ</strong></h2><p>å› ä¸ºå¼€å‘éœ€è¦JDKï¼Œæ‰€ä»¥è¿›è¡ŒJDKçš„å®‰è£…ï¼Œå…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸¤ä¸ªç›®å½•ï¼Œä½œä¸ºåæœŸç¯å¢ƒçš„ä½¿ç”¨ï¼šmkdir tools å’Œ mkdir trainingï¼Œä¸€ä¸ªæ˜¯ä½œä¸ºä¸Šä¼ å·¥å…·çš„ç›®å½•ï¼Œä¸€ä¸ªæ˜¯ä½œä¸ºå®‰è£…çš„ç›®å½•ã€‚</p><p>ä½¿ç”¨å·¥å…·ä¸Šè¿°å·¥å…·å°†JDKè¿›è¡Œä¸Šä¼ åˆ°toolsç›®å½•ä¸‹ï¼Œç„¶åè¿›è¡Œè§£å‹</p><p><code>tar -zvxf /tools/jdk-7u80-linux-x64.tar.gz -C /tarining/</code></p><p>é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><p><code> vi ~/.bash_profile</code></p><p>â€‹    æ·»åŠ å¦‚ä¸‹ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">export JAVA_HOME=/training/jdk1.8.0_171<br>export JRE_HOME=$JAVA_HOME/jre<br>export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/lib<br>export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image001.png" alt="img"></p><p>è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</p><p><code>source ~/.bash_profile</code></p><p>éªŒè¯jdkæ˜¯å¦å®‰è£…æˆåŠŸ</p><p><code>java -version</code></p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image002.png" alt="img"></p><h1 id="äºŒã€CentOS7ä¸‹MySQL-5-7ä½¿ç”¨yumæ–¹å¼å®‰è£…ï¼š"><a href="#äºŒã€CentOS7ä¸‹MySQL-5-7ä½¿ç”¨yumæ–¹å¼å®‰è£…ï¼š" class="headerlink" title="äºŒã€CentOS7ä¸‹MySQL-5.7ä½¿ç”¨yumæ–¹å¼å®‰è£…ï¼š"></a>äºŒã€CentOS7ä¸‹MySQL-5.7ä½¿ç”¨yumæ–¹å¼å®‰è£…ï¼š</h1><hr><p>1ã€å®‰è£…MySQL YUMæºåˆ°æœ¬åœ°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum localinstall https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm<br></code></pre></td></tr></table></figure><p>2ã€æ£€æŸ¥ mysql æºæ˜¯å¦å®‰è£…æˆåŠŸ</p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum repolist enabled | grep &quot;mysql.*-community.*&quot;<br></code></pre></td></tr></table></figure><pre><code>å®‰è£…æˆåŠŸåä¼šçœ‹åˆ°å¦‚ä¸‹ï¼š!mysql-connectors-community/x86_64       MySQL Connectors Community          153!mysql-tools-community/x86_64            MySQL Tools Community               110!mysql57-community/x86_64                MySQL 5.7 Community Server          424</code></pre><p>3ã€ä½¿ç”¨ yum install å‘½ä»¤å®‰è£…</p>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum -y install mysql-community-server<br></code></pre></td></tr></table></figure><p>4ã€å®‰è£…å®Œæ¯•åï¼Œå¯åŠ¨MySQLæ•°æ®åº“</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl start mysqld<br></code></pre></td></tr></table></figure><p>5ã€æŸ¥çœ‹MySQLçš„å¯åŠ¨çŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl status mysqld<br></code></pre></td></tr></table></figure><p>6ã€è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl enable mysqld<br></code></pre></td></tr></table></figure><p>7ã€é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶   </p> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl daemon-reload<br></code></pre></td></tr></table></figure><p>8ã€ä¿®æ”¹rootè´¦æˆ·é»˜è®¤å¯†ç <br>     mysql å®‰è£…å®Œæˆä¹‹åï¼Œç”Ÿæˆçš„é»˜è®¤å¯†ç åœ¨ /var/log/mysqld.log æ–‡ä»¶ä¸­ã€‚ä½¿ç”¨ grep å‘½ä»¤æ‰¾åˆ°æ—¥å¿—ä¸­çš„å¯†ç ã€‚<br>    æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep &#x27;temporary password&#x27; /var/log/mysqld.log<br></code></pre></td></tr></table></figure><pre><code>æ¯”å¦‚ï¼šA temporary password is generated for root@localhost: WMYu.#o8o#30</code></pre><p>9ã€ä¿®æ”¹å¯†ç <br>    ä½¿ç”¨mysql -uroot -p    å›è½¦ï¼Œ    æ³¨æ„å¯†ç æ”¹ä¸ºï¼šSjm@!_123456 è¾“å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;Sjm@!_123456&#39;; <br></code></pre></td></tr></table></figure><p>10ã€é…ç½®rootç”¨æˆ·è¿œç¨‹ç™»å½•åŠæ·»åŠ è¿œç¨‹ç™»å½•ç”¨æˆ·<br>    é»˜è®¤åªå…è®¸rootå¸æˆ·åœ¨æœ¬åœ°ç™»å½•ï¼Œå¦‚æœè¦åœ¨å…¶å®ƒæœºå™¨ä¸Šè¿æ¥mysqlï¼Œä¸¤ç§æ–¹å¼ï¼š<br>    1ï¼‰è®¾ç½®rootç”¨æˆ·å…è®¸è¿œç¨‹ç™»å½•ï¼š<br>        æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;Sjm@!_123456&#x27; WITH GRANT OPTION;   <br>flush privileges;<br></code></pre></td></tr></table></figure><pre><code>2ï¼‰å¯ä»¥æ·»åŠ ä¸€ä¸ªå…è®¸è¿œç¨‹è¿æ¥çš„æ™®é€šå¸æˆ·     æ‰§è¡Œï¼š</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">GRANT ALL PRIVILEGES ON *.* TO &#x27;suben&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;Sjm@!_123456&#x27; WITH GRANT OPTION;   <br>flush privileges;<br></code></pre></td></tr></table></figure><p>12ã€è®¾ç½®é»˜è®¤ç¼–ç ä¸º utf8</p><p>   mysql å®‰è£…åé»˜è®¤ä¸æ”¯æŒä¸­æ–‡ï¼Œéœ€è¦ä¿®æ”¹ç¼–ç ã€‚<br>   ä¿®æ”¹ /etc/my.cnf é…ç½®æ–‡ä»¶ï¼Œåœ¨ç›¸å…³èŠ‚ç‚¹ï¼ˆæ²¡æœ‰åˆ™è‡ªè¡Œæ·»åŠ ï¼‰ä¸‹æ·»åŠ ç¼–ç é…ç½®ï¼Œå¦‚ä¸‹ï¼š<br>   æ‰§è¡Œï¼švi /etc/my.cnf<br>   åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">[mysqld]<br>character-set-server=utf8<br>[client]<br>default-character-set=utf8<br>[mysql]<br>default-character-set=utf8<br></code></pre></td></tr></table></figure><p> <strong>CentOS7ä¸‹MySQL-5.7ä½¿ç”¨yumæ–¹å¼å¸è½½ï¼š</strong></p><p>1ã€åœæ­¢MySQL<br>   å‘½ä»¤ï¼šsystemctl stop mysqld<br>2ã€æŸ¥çœ‹å·²å®‰è£…çš„mysql<br>   å‘½ä»¤ï¼šrpm -qa | grep -i mysql<br>3ã€å¸è½½mysqlï¼Œä¾æ¬¡å¸è½½ç¬¬2æ­¥éª¤æ‰€åˆ—å‡ºçš„æœ‰å…³MySQLçš„å®‰è£…åŒ…,å¦‚<br>   å‘½ä»¤ï¼šyum remove -y mysql-community-server-5.6.36-2.el7.x86_64<br>4ã€åˆ é™¤mysqlç›¸å…³ç›®å½•<br>    1ï¼‰ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹mysqlç›¸å…³çš„æ–‡ä»¶ç›®å½•ï¼šfind / -name mysql<br>    2ï¼‰ä¾æ¬¡åˆ é™¤æ‰€æŸ¥åˆ°çš„ç›®å½•ï¼Œå‘½ä»¤ï¼šrm -rf /xxx/xxx/mysql</p><h1 id="ä¸‰ã€CentOS7ä¸‹Nginxçš„å®‰è£…ï¼š"><a href="#ä¸‰ã€CentOS7ä¸‹Nginxçš„å®‰è£…ï¼š" class="headerlink" title="ä¸‰ã€CentOS7ä¸‹Nginxçš„å®‰è£…ï¼š"></a>ä¸‰ã€CentOS7ä¸‹Nginxçš„å®‰è£…ï¼š</h1><hr><p>1ã€ç¼–å†™å®‰è£…è„šæœ¬ï¼šnginx_install.shï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>yum install -y gcc<br><span class="hljs-meta">#</span><span class="bash">install pcre</span><br>yum install -y pcre-static.x86_64<br><span class="hljs-meta">#</span><span class="bash">install nginx</span><br>tar -zvxf  /tools/nginx-1.15.12.tar.gz -C /training/<br>cd /training/nginx-1.15.12<br>./configure --prefix=/training/nginx --without-http_gzip_module<br>make &amp;&amp; make install<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-built_in">set</span> .bash_profile</span><br>echo &#x27;#nginx&#x27; &gt;&gt; ~/.bash_profile<br>echo &#x27;export PATH=$PATH:/training/nginx/sbin&#x27; &gt;&gt; ~/.bash_profile<br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">source</span> .bash_profile</span><br>source ~/.bash_profile<br></code></pre></td></tr></table></figure><p>2ã€èµ‹äºˆnginx_intall.shæ‰§è¡Œæƒé™ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">chmod +x nginx_install.sh<br></code></pre></td></tr></table></figure><p>3ã€å®‰è£…nginx,è¿›å…¥åˆ°nginx_intall.shè„šæœ¬æ‰€åœ¨ç›®å½•ï¼Œæ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./nginx_intall.sh<br></code></pre></td></tr></table></figure><p>4ã€ç¼–å†™å¯åŠ¨nginxçš„è„šæœ¬nginx_start.sh,æ‰§è¡Œ vi nginx_start.shæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>cd /training/nginx/sbin<br>./nginx<br></code></pre></td></tr></table></figure><p>5ã€å¯åŠ¨nginxï¼Œæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./nginx_start.sh<br></code></pre></td></tr></table></figure><p>6ã€éªŒè¯nginxæ˜¯å¦å¯åŠ¨æˆåŠŸï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">netstat -anop|grep nginx æˆ–è€… netstat -anop|grep 80<br></code></pre></td></tr></table></figure><p>æˆåŠŸä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      59717/nginx: master  off (0.00/0/0)<br></code></pre></td></tr></table></figure><p>7ã€ç¼–å†™åœæ­¢nginxè„šæœ¬ï¼Œæ‰§è¡Œvi nginx_stop.sh ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>cd /training/nginx/sbin<br>./nginx -s stop<br></code></pre></td></tr></table></figure><p>8ã€åœæ­¢nginxï¼Œæ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./nginx_stop.sh<br></code></pre></td></tr></table></figure><p>9ã€ç¼–å†™çƒ­åŠ è½½nginxè„šæœ¬ï¼Œæ‰§è¡Œvi nginx_reload.sh ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>cd /training/nginx/sbin<br>./nginx -s reload<br></code></pre></td></tr></table></figure><p>10ã€é‡æ–°åŠ è½½nginx,æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./nginx_reload.sh<br></code></pre></td></tr></table></figure><h1 id="å››ã€éƒ¨ç½²å‰ç«¯ç½‘ç«™åˆ°nginxä¸‹"><a href="#å››ã€éƒ¨ç½²å‰ç«¯ç½‘ç«™åˆ°nginxä¸‹" class="headerlink" title="å››ã€éƒ¨ç½²å‰ç«¯ç½‘ç«™åˆ°nginxä¸‹"></a>å››ã€éƒ¨ç½²å‰ç«¯ç½‘ç«™åˆ°nginxä¸‹</h1><hr><p>1ã€ä¸Šä¼ ç”µå•†ç½‘ç«™OnlineShopæ–‡ä»¶å¤¹åˆ°/training/nginx/html/ç›®å½•ä¸‹,</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210113165528735.png" alt="image-20210113165528735"></p><p>â€‹    å°†OnlineShopæ–‡ä»¶å¤¹é‡å‘½åä¸ºshop</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mv OnlineShop shop<br></code></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹nginxé…ç½®æ–‡ä»¶nginx.conf,æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /training/nginx/conf/nginx.conf<br></code></pre></td></tr></table></figure><pre><code>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> add shop</span><br>â€‹location /shop/ &#123;<br>â€‹root   html;<br>â€‹index  index.html index.htm;<br>â€‹&#125;<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/20210108124755794.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>3ã€é‡æ–°è®°è½½nginxï¼Œæ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">./nginx_reload.sh<br></code></pre></td></tr></table></figure><p>4ã€éªŒè¯ï¼šåœ¨æµè§ˆå™¨ä¸­éªŒè¯ä¸‹æ˜¯å¦å¯ä»¥è®¿é—®åˆ°ç½‘ç«™ï¼Œè¾“å…¥ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>è™šæ‹Ÿæœºipåœ°å€<span class="hljs-regexp">/shop/</span><br></code></pre></td></tr></table></figure><p>5ã€æ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/202101081256598.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="äº”ã€Tomcatçš„å®‰è£…"><a href="#äº”ã€Tomcatçš„å®‰è£…" class="headerlink" title="äº”ã€Tomcatçš„å®‰è£…"></a>äº”ã€Tomcatçš„å®‰è£…</h1><hr><p>1ã€ä¸‹è½½tomcat-8.5.40ï¼Œåˆ°å®˜ç½‘ä¸Šä¸‹<br>2ã€å®‰è£…tomcat</p><pre><code>1ï¼‰ä¸Šä¼ tomcatåˆ°/toolsç›®å½•ä¸‹2ï¼‰è§£å‹å®‰è£…ï¼š</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf apache-tomcat-8.5.61.tar.gz -C /training/<br></code></pre></td></tr></table></figure><pre><code>3ï¼‰é…ç½®ç¯å¢ƒå˜é‡ vi ~/.bash_profile</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">tomcat</span><br>export PATH=$PATH:/training/apache-tomcat-8.5.61/bin<br></code></pre></td></tr></table></figure><pre><code>4ï¼‰ç”Ÿæ•ˆï¼š</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/.bash_profile<br></code></pre></td></tr></table></figure><pre><code>5ï¼‰å¯åŠ¨</code></pre><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sh startup.sh<br></code></pre></td></tr></table></figure><pre><code>6ï¼‰éªŒè¯ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥: http://192.168.215.131:8080/          æˆ–è€…åœ¨å‘½ä»¤è¡Œé‡Œé¢è¾“å…¥ï¼šnetstat -anop|grep 8080 </code></pre><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/20210108154505792.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="å…­ã€ç”µå•†åå°ç³»ç»Ÿéƒ¨ç½²åˆ°LinuxæœåŠ¡å™¨ä¸Š"><a href="#å…­ã€ç”µå•†åå°ç³»ç»Ÿéƒ¨ç½²åˆ°LinuxæœåŠ¡å™¨ä¸Š" class="headerlink" title="å…­ã€ç”µå•†åå°ç³»ç»Ÿéƒ¨ç½²åˆ°LinuxæœåŠ¡å™¨ä¸Š"></a>å…­ã€ç”µå•†åå°ç³»ç»Ÿéƒ¨ç½²åˆ°LinuxæœåŠ¡å™¨ä¸Š</h1><hr><ol><li>å°†ä»£ç å¯¼å…¥åˆ°eclipseæˆ–è€…ideaä¸­</li><li>å°†ä»£ç ä¸­çš„æ¥å£åœ°å€ã€æ•°æ®åº“é“¾æ¥åœ°å€ç­‰ä¿®æ”¹æˆæœåŠ¡å™¨åœ°å€ï¼Œå…·ä½“éœ€è¦ä¿®æ”¹çš„ä»£ç å¦‚ä¸‹ï¼š</li></ol><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">GoodsController.java</span>ï¼š<br><br> -  ä¿®æ”¹ä¸Šä¼ å›¾ç‰‡åœ°å€ä¸ºæœåŠ¡å™¨åœ°å€<br> -  å°†ä»£ç ä¸­çš„localhostæˆ–è€…<span class="hljs-built_in">IP</span>åœ°å€æ”¹æˆæœåŠ¡å™¨<span class="hljs-built_in">IP</span>åœ°å€<br><br><span class="hljs-symbol">UploadUtils.java</span>ï¼š<br><br> - å°†ä»£ç ä¸­çš„localhostæˆ–è€…<span class="hljs-built_in">IP</span>åœ°å€æ”¹æˆæœåŠ¡å™¨<span class="hljs-built_in">IP</span>åœ°å€<br><br><span class="hljs-symbol">hibernate.properties</span>ï¼š<br><br> -  ä¿®æ”¹æ•°æ®åº“ååŠåœ°å€ä¸ºæœåŠ¡å™¨çš„æ•°æ®åº“ååŠåœ°å€<br> -  ä¿®æ”¹æ•°æ®åº“ç”¨æˆ·æ˜ã€å¯†ç ä¸ºæœåŠ¡å™¨çš„ç”¨æˆ·å¯†ç <br><br>å·¥ç¨‹ä¸‹ä¿®æ”¹webappç›®å½•ä¸‹çš„æ‰€æœ‰htmlåŠjspé¡µé¢<br><br> - å°†ä»£ç ä¸­çš„localhostæˆ–è€…<span class="hljs-built_in">IP</span>åœ°å€æ”¹æˆæœåŠ¡å™¨<span class="hljs-built_in">IP</span>åœ°å€<br><br><br>å¯¼å…¥æ•°æ®åº“shop.sql<br>å¯åŠ¨mysql<br>åœ¨sqlå‘½ä»¤è¡Œè¾“å…¥source shop.sql<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><ol><li>é€‰æ‹©export-&gt;war</li><li>ä¸Šä¼ warè‡³LinuxæœåŠ¡å™¨çš„Tomcatå®‰è£…ç›®å½•ä¸‹ï¼ˆè§ä¸‹å›¾ï¼‰</li><li>å¯åŠ¨æˆ–é‡å¯Tomcat</li><li>é…ç½®Tomcatæ”¯æŒUTF-8å­—ç¬¦é›†</li></ol><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210113165825139.png" alt="image-20210113165825139"></p><p><strong>ç”±äºåå°é¡¹ç›®é¡µé¢éƒ¨åˆ†é‡‡ç”¨äº†htmlå’Œjspç»“åˆåµŒå¥—çš„æ–¹å¼ï¼Œå³åœ¨jspä¸­åµŒå¥—äº†htmlä»£ç æ®µï¼Œä¼šå­˜åœ¨htmlä»£ç æ®µæ˜¾ç¤ºä¸­æ–‡ä¹±ç çš„é—®é¢˜ï¼Œæ•…éœ€è¦åšé…ç½®</strong><br>1ï¼‰ä¿®æ”¹tomcat/confç›®å½•ä¸‹çš„server.xmlï¼Œæ·»åŠ URIEncoding=â€œUTF-8â€é…ç½®é¡¹ï¼Œé…ç½®ä½ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span> <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;8080&quot;</span> <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;HTTP/1.1&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">&quot;20000&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">&quot;8443&quot;</span> <span class="hljs-attr">URIEncoding</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span> <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;AJP/1.3&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">address</span>=<span class="hljs-string">&quot;::1&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;8009&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">&quot;8443&quot;</span> <span class="hljs-attr">URIEncoding</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><pre><code> 2ï¼‰ä¿®æ”¹tomcat/conf/web.xmlï¼Œåœ¨ &lt;servlet&gt;èŠ‚ç‚¹ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</code></pre><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>fileEncoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br></code></pre></td></tr></table></figure><pre><code> 3ï¼‰å…ˆåˆ é™¤tomcatä¸‹çš„webapp/é¡¹ç›®/æ‰€æœ‰htmlé¡µé¢ï¼Œå†é‡æ–°æ–°å»ºå¹¶æ·»åŠ å¯¹åº”çš„å†…å®¹ 4ï¼‰å¯åŠ¨Tomcat</code></pre><p>6ã€æ‰“å¼€æµè§ˆå™¨è¿›è¡ŒéªŒè¯ï¼š<br>    <img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/20210108165341283.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="ä¸ƒã€ABå‹æµ‹ï¼ˆhttpdï¼‰å®‰è£…"><a href="#ä¸ƒã€ABå‹æµ‹ï¼ˆhttpdï¼‰å®‰è£…" class="headerlink" title="ä¸ƒã€ABå‹æµ‹ï¼ˆhttpdï¼‰å®‰è£…"></a>ä¸ƒã€ABå‹æµ‹ï¼ˆhttpdï¼‰å®‰è£…</h1><hr><pre><code>1. å®‰è£…httpd <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">yum install -y httpd<br></code></pre></td></tr></table></figure></code></pre><ol start="2"><li><p>é…ç½®httpdï¼Œä¿®æ”¹ç«¯å£å·ä¸º81ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /etc/httpd/conf/httpd.conf<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">#Listen 80<br>Listen 81<br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl enable httpd # å¼€æœºè‡ªå¯åŠ¨<br>systemctl start httpd # å¯åŠ¨httpd<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹å¯åŠ¨çŠ¶æ€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl status httpd<br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™å‹æµ‹è„šæœ¬ab_test.shï¼Œå†…å®¹å¯è‡ªè¡Œä¿®æ”¹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>n=`cat url.txt | wc -l`<br><br>for ((i=1;i&lt;=$n;i++))<br>do<br>        echo $i<br>        url=`shuf -n1 url.txt`<br>        r=`shuf -i 6-100 -n 1`<br>        c=`shuf -i 1-5 -n 1`<br>        echo $url<br>        echo $r<br>        echo $c<br>        ##å°†æµ‹è¯•çš„ç»“æœå†™å…¥åˆ°test_ab.log &gt;&gt; results.log &amp;<br>        ab -n $r -c $c $url &gt;&gt; results.log &amp;<br>done<br></code></pre></td></tr></table></figure></li><li><p>æµ‹è¯•ç»“æœè¯´æ˜<br><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/20210108173146898.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p></li></ol><h1 id="å…«ã€Hadoopå®‰è£…ä¸é…ç½®"><a href="#å…«ã€Hadoopå®‰è£…ä¸é…ç½®" class="headerlink" title="å…«ã€Hadoopå®‰è£…ä¸é…ç½®"></a>å…«ã€Hadoopå®‰è£…ä¸é…ç½®</h1><hr><h2 id="8-1-å®‰è£…Hadoop"><a href="#8-1-å®‰è£…Hadoop" class="headerlink" title="8.1 å®‰è£…Hadoop"></a>8.1 å®‰è£…Hadoop</h2><p>1ã€æŠŠä¸Šä¼ åˆ°toolsç›®å½•ä¸‹çš„Hadoopè¿›è¡Œè§£å‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf /tools/hadoop-2.7.3.tar.gz -C /training/<br></code></pre></td></tr></table></figure><p>2ã€é…ç½®ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">vi ~<span class="hljs-string">/.bash_profile</span><br></code></pre></td></tr></table></figure><p>â€‹    æ·»åŠ å¦‚ä¸‹ä¿¡æ¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">export HADOOP_HOME=/training/hadoop-2.7.3<br>export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin<br></code></pre></td></tr></table></figure><p> 3ã€ è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/.bash_profile<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image001-1610529336150.png" alt="img"></p><p>éªŒè¯æ˜¯å¦ç”Ÿæ•ˆï¼š</p><p>æ‰§è¡Œï¼šhdfs æˆ–è€…hadoop æœ‰ç›¸å…³ä¿¡æ¯å‡ºç°å³å¯</p><h2 id="8-2-æ­å»ºHadoopä¼ªåˆ†å¸ƒç¯å¢ƒ"><a href="#8-2-æ­å»ºHadoopä¼ªåˆ†å¸ƒç¯å¢ƒ" class="headerlink" title="8.2  æ­å»ºHadoopä¼ªåˆ†å¸ƒç¯å¢ƒ"></a>8.2  æ­å»ºHadoopä¼ªåˆ†å¸ƒç¯å¢ƒ</h2><p>ç‰¹ç‚¹ï¼šå…·å¤‡HDFSå…¨éƒ¨åŠŸèƒ½</p><p>HDFS:NameNode + DataNode</p><p>Yarn:ReourceManager + NodeManager</p><p><strong>1ã€é…ç½®ï¼šhadoop-env.sh</strong></p><p>â€‹    <code>vi hadoop-env.sh</code></p><p><strong>é…ç½®Javaç¯å¢ƒå˜é‡</strong>ï¼š</p><p>â€‹    <code>export JAVA_HOME=/training/jdk1.8.0_171</code></p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image002-1610529336152.png" alt="img"></p><p><strong>2ã€é…ç½®ï¼šhdfs-site.xml</strong> </p><p><code>vi /training/hadoop-2.7.3/etc/hadoop/hdfs-site.xml</code></p><p>hdfs-site.xmlï¼šåŸåˆ™æ˜¯ï¼šä¸€èˆ¬æœ‰å‡ ä¸ªæ•°æ®èŠ‚ç‚¹å°±é…ç½®å‡ ä¸ªï¼Œä½†æ˜¯æœ€å¤šä¸èƒ½è¶…å¤š3</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--è¡¨ç¤ºæ•°æ®å—çš„å†—ä½™åº¦ é»˜è®¤ä¸º3--&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image003-1610529336152.png" alt="img"></p><p><strong>3ã€é…ç½®ï¼šcore-site.xml</strong></p><p>éœ€è¦æå‰æ–°å»ºä¸€ä¸ªtmpæ–‡ä»¶å¤¹</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210113172925162.png" alt="image-20210113172925162"></p><p><code>vi /training/hadoop-2.7.3/etc/hadoop/core-site.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®NameNodeçš„é€šè®¯åœ°å€ 9000 æ˜¯RPCé»˜è®¤çš„é€šä¿¡ç«¯å£--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://192.168.181.135:9000<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>         <br><span class="hljs-comment">&lt;!--HDFSæ•°æ®ä¿å­˜åœ¨Linuxçš„å“ªä¸ªç›®å½•ï¼Œé»˜è®¤å€¼æ˜¯Linuxçš„tmpç›®å½• å¿…é¡»é…ç½®ï¼Œå¦åˆ™ä¼šæŠ¥é”™/training/hadoop-2.7.3/tmp å¿…é¡»äº‹å…ˆå­˜åœ¨--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hadoop.tmp.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>/training/hadoop-2.7.3/tmp<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span></span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image005.jpg" alt="img"></p><p><strong>4ã€é…ç½®ï¼šmapper-site.xml</strong></p><p>  è¿™ä¸ªæ–‡ä»¶äº‹å…ˆæ˜¯ä¸å­˜åœ¨çš„ï¼Œéœ€è¦å¤åˆ¶ä¸€ä»½</p><p><code>cp /training/hadoop-2.7.3/etc/hadoop/mapred-site.xml.template /training/hadoop-2.7.3/etc/hadoop/mapred-site.xml</code></p><p><code>vi /training/hadoop-2.7.3/etc/hadoop/mapper-site.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®MRçš„è¿è¡Œæ¡†æ¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.framework.name<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>yarn<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span></span><br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image007.jpg" alt="img"></p><p><strong>5ã€é…ç½®ï¼šyarn-site.xml</strong></p><p><code>vi /training/hadoop-2.7.3/etc/hadoop/mapper-site.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--Yarnçš„ä¸»èŠ‚ç‚¹RMçš„ä½ç½®--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>192.130.91.130<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--MapReduceè¿è¡Œæ–¹å¼ï¼šshuffleæ´—ç‰Œ--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>mapreduce_shuffle<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span> <br></code></pre></td></tr></table></figure><p>â€‹          </p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image009.jpg" alt="img"></p><h2 id="8-3-è®¾ç½®å…å¯†ç ç™»å½•"><a href="#8-3-è®¾ç½®å…å¯†ç ç™»å½•" class="headerlink" title="8.3 è®¾ç½®å…å¯†ç ç™»å½•"></a><strong>8.3</strong> <strong>è®¾ç½®å…å¯†ç ç™»å½•</strong></h2><p><code>ssh-keygen -t rsa</code></p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image010.png" alt="img"></p><p><code>ssh-copy-id 192.168.91.130</code></p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image011.png" alt="img"></p><p><strong>8.4 éªŒè¯Hadoop</strong></p><p>æ ¼å¼åŒ–ï¼šHDFS(NameNode)</p><p>â€‹           hdfs namenode -format</p><p>â€‹       å¯åŠ¨hadoopç¯å¢ƒ</p><p>â€‹           start-all.sh</p><p>â€‹       è®¿é—®ï¼šwebç•Œé¢è¿›è¡ŒéªŒè¯</p><p>â€‹            HDFS:<a href="http://192.168.181.135:50070/">http://192.168.181.135:50070</a></p><p>â€‹            Yran:http:// 192.168.181.135:8088</p><p>â€‹      åœæ­¢ï¼š</p><p>â€‹           stop-all.sh</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image013.jpg" alt="img"></p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image015.jpg" alt="img"></p><h1 id="ä¹ã€Flumeçš„å®‰è£…ä¸é…ç½®"><a href="#ä¹ã€Flumeçš„å®‰è£…ä¸é…ç½®" class="headerlink" title="ä¹ã€Flumeçš„å®‰è£…ä¸é…ç½®"></a>ä¹ã€Flumeçš„å®‰è£…ä¸é…ç½®</h1><hr><ol><li><p>ä¸Šä¼ flumeåˆ°/toolsç›®å½•ä¸‹</p></li><li><p>è§£å‹å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf apache-flume-1.9.0-bin.tar.gz -C /training/<br></code></pre></td></tr></table></figure></li><li><p>é…ç½®ç¯å¢ƒå˜é‡ï¼Œå¹¶è®©ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi ~/.bash_profile<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">export FLUME_HOME=/trainin~g/apache-flume-1.9.0-bin<br>export PATH=$PATH:$FLUME_HOME/bin<br></code></pre></td></tr></table></figure></li><li><p>å°†hadoop-2.7.3å®‰è£…è·¯å¾„ä¸‹çš„ä¾èµ–çš„jarå¯¼å…¥åˆ°/apache-flume-1.9.0-bin/libä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml">share/hadoop/common/hadoop-common-2.7.3.jar<br>share/hadoop/common/lib/commons-configuration-1.6.jar<br>share/hadoop/common/lib/hadoop-auth-2.7.3.jar<br>share/hadoop/hdfs/hadoop-hdfs-2.7.3.jar<br>share/hadoop/common/lib/htrace-core-3.1.0-incubating.jar<br>share/hadoop/common/lib/commons-io-2.4.jar<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210114173055653.png" alt="image-20210114173055653"></p></li><li><p>éªŒè¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bin/flume-ng version <br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210114173357502.png" alt="image-20210114173357502"></p></li><li><p>é…ç½®Flume HDFS Sink:<br>åœ¨/training/apache-flume-1.7.0-bin/conf/æ–°å»ºä¸€ä¸ªflume-hdfs.conf<br>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼šï¼ˆæ³¨æ„æ”¹ipåœ°å€ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> define the agent</span><br>a1.sources=r1<br>a1.channels=c1<br>a1.sinks=k1<br><br><span class="hljs-meta">#</span><span class="bash"> define the <span class="hljs-built_in">source</span></span><br><span class="hljs-meta">#</span><span class="bash">ä¸Šä¼ ç›®å½•ç±»å‹</span><br>a1.sources.r1.type=spooldir<br>a1.sources.r1.spoolDir=/training/nginx/logs/flumeLogs<br><span class="hljs-meta">#</span><span class="bash">å®šä¹‰è‡ªæ»šåŠ¨æ—¥å¿—å®Œæˆåçš„åç¼€å</span><br>a1.sources.r1.fileSuffix=.FINISHED<br><span class="hljs-meta">#</span><span class="bash">æ ¹æ®æ¯è¡Œæ–‡æœ¬å†…å®¹çš„å¤§å°è‡ªå®šä¹‰æœ€å¤§é•¿åº¦4096=4k</span><br>a1.sources.r1.deserializer.maxLineLength=4096<br><br><span class="hljs-meta">#</span><span class="bash"> define the sink</span><br>a1.sinks.k1.type = hdfs<br><span class="hljs-meta">#</span><span class="bash">ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨hdfsçš„/flumeLogsç›®å½•ä¸‹</span><br>a1.sinks.k1.hdfs.path = hdfs://192.168.91.130:9000/flumeLogs/%y-%m-%d/%H/%M/%S<br>a1.sinks.k1.hdfs.filePrefix=access_log<br>a1.sinks.k1.hdfs.fileSufix=.log<br>a1.sinks.k1.hdfs.batchSize=1000<br>a1.sinks.k1.hdfs.fileType = DataStream<br>a1.sinks.k1.hdfs.writeFormat= Text <br><span class="hljs-meta">#</span><span class="bash"> roll æ»šåŠ¨è§„åˆ™:æŒ‰ç…§æ•°æ®å—128Må¤§å°æ¥æ§åˆ¶æ–‡ä»¶çš„å†™å…¥ï¼Œä¸æ»šåŠ¨ç›¸å…³å…¶ä»–çš„éƒ½è®¾ç½®æˆ0</span><br><span class="hljs-meta">#</span><span class="bash">ä¸ºäº†æ¼”ç¤ºï¼Œè¿™é‡Œè®¾ç½®æˆ500kå†™å…¥ä¸€æ¬¡</span><br>a1.sinks.k1.hdfs.rollSize= 512000<br>a1.sinks.k1.hdfs.rollCount=0<br>a1.sinks.k1.hdfs.rollInteval=0<br><span class="hljs-meta">#</span><span class="bash">æ§åˆ¶ç”Ÿæˆç›®å½•çš„è§„åˆ™:ä¸€èˆ¬æ˜¯ä¸€å¤©æˆ–è€…ä¸€å‘¨æˆ–è€…ä¸€ä¸ªæœˆä¸€æ¬¡ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºè®¾ç½®10ç§’ </span><br>a1.sinks.k1.hdfs.round=true<br>a1.sinks.k1.hdfs.roundValue=10<br>a1.sinks.k1.hdfs.roundUnit= second    <br><span class="hljs-meta">#</span><span class="bash">æ˜¯å¦ä½¿ç”¨æœ¬åœ°æ—¶é—´</span><br>a1.sinks.k1.hdfs.useLocalTimeStamp=true   <br><br><span class="hljs-meta">#</span><span class="bash">define the channel</span><br>a1.channels.c1.type = memory<br><span class="hljs-meta">#</span><span class="bash">è‡ªå®šä¹‰eventçš„æ¡æ•°</span><br>a1.channels.c1.capacity = 500000<br><span class="hljs-meta">#</span><span class="bash">flumeäº‹åŠ¡æ§åˆ¶æ‰€éœ€è¦çš„ç¼“å­˜å®¹é‡1000æ¡event</span><br>a1.channels.c1.transactionCapacity = 1000<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-built_in">source</span> channel sink cooperation</span><br>a1.sources.r1.channels = c1<br>a1.sinks.k1.channel = c1<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š- éœ€è¦å…ˆåœ¨/training/nginx/logs/åˆ›å»ºflumeLogs</p><pre><code>         - éœ€è¦åœ¨hdfsçš„æ ¹ç›®å½•/ä¸‹åˆ›å»ºflumeLogs</code></pre></li></ol>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir /training/nginx/logs/flumeLogs<br> hadoop fs -mkdir /flumeLogs<br><br><span class="hljs-meta">#</span><span class="bash">å¦‚æœhadoopå‘½ä»¤æ˜¾ç¤ºæ‹’ç»è®¿é—®ï¼Œæ£€æŸ¥hdfsæ˜¯å¦å¼€å¯æœåŠ¡</span><br>start-all.sh<br></code></pre></td></tr></table></figure><p>   åˆ›å»ºå®Œæˆåæµè§ˆå™¨è¾“å…¥ç½‘å€ï¼Œå¯ä»¥çœ‹è§åˆšåˆšåœ¨hdfsä¸­åˆ›å»ºçš„æ–‡ä»¶</p><pre><code>![image-20210115092905289](2021å¯’å‡å®è®­å¤§æ•°æ®åˆ†æç”µå•†å¹³å°/image-20210115092905289.png)</code></pre><ol start="7"><li><p>ä¿®æ”¹conf/flume-env.shï¼ˆè¯¥æ–‡ä»¶äº‹å…ˆæ˜¯ä¸å­˜åœ¨çš„ï¼Œéœ€è¦å¤åˆ¶ä¸€ä»½ï¼‰<br>å¤åˆ¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cp flume-env.template.sh flume-env.sh<br></code></pre></td></tr></table></figure><p>ç¼–è¾‘æ–‡ä»¶ï¼Œå¹¶è®¾ç½®å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">è®¾ç½®JAVA_HOME:</span><br>export JAVA_HOME=/training/jdk1.8.0_171          <br><span class="hljs-meta">#</span><span class="bash">ä¿®æ”¹é»˜è®¤çš„å†…å­˜ï¼š  </span><br>export JAVA_OPTS=&quot;-Xms1024m -Xmx1024m -Xss256k -Xmn2g -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:-UseGCOverheadLimit&quot;   <br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210114174451627.png" alt="image-20210114174451627"></p></li><li><p>å¯åŠ¨flume</p><ul><li><p>æµ‹è¯•æ•°æ®ï¼šæŠŠ /training/nginx/logs/access.log å¤åˆ¶åˆ°<br>/training/nginx/logs/flumeLogs/access_201904251200.log</p></li><li><p>å¯åŠ¨<br>åœ¨/training/apache-flume-1.7.0-binç›®å½•ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå¯åŠ¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">bin/flume-ng agent --conf ./conf/ -f ./conf/flume-hdfs.conf --name a1 -Dflume.root.logger=INFO,console<br></code></pre></td></tr></table></figure></li><li><p>åˆ°Hadoopçš„æ§åˆ¶å°<a href="http://bigdata:50070/flumeLogs">http://bigdata:50070/flumeLogs</a> æŸ¥çœ‹æœ‰æ²¡æœ‰æ•°æ®</p></li></ul></li><li><p>ç¼–å†™Linuxè„šæœ¬rollingLog.shï¼Œå®ç°/training/nginx/logs/access.logæ—¥å¿—çš„è‡ªåŠ¨æ»šåŠ¨åˆ°flumeLogsç›®å½•ä¸‹</p><ul><li><p>åœ¨~ç›®å½•ä¸‹æ–°å»º<strong>rollingLog.sh</strong>ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#å®šä¹‰æ—¥æœŸæ ¼å¼</span><br>dataformat=`date +%Y-%m-%d-%H-%M-%S`<br><br><span class="hljs-comment">#å¤åˆ¶access.logå¹¶é‡å‘½å</span><br>cp /training/nginx/logs/access.log /training/nginx/logs/access_<span class="hljs-variable">$dataformat</span>.<span class="hljs-built_in">log</span><br><br>host=`hostname`<br>sed -i <span class="hljs-string">&#x27;s/^/&#x27;</span><span class="hljs-variable">$&#123;host&#125;</span><span class="hljs-string">&#x27;,&amp;/g&#x27;</span> /training/nginx/logs/access_<span class="hljs-variable">$dataformat</span>.<span class="hljs-built_in">log</span><br><span class="hljs-comment">#ç»Ÿè®¡æ—¥å¿—æ–‡ä»¶è¡Œæ•°</span><br>lines=`wc -l &lt; /training/nginx/logs/access_<span class="hljs-variable">$dataformat</span>.<span class="hljs-built_in">log</span>`<br><br><span class="hljs-comment">#å°†æ ¼å¼åŒ–çš„æ—¥å¿—ç§»åŠ¨åˆ°flumeLogsç›®å½•ä¸‹</span><br>mv /training/nginx/logs/access_<span class="hljs-variable">$dataformat</span>.<span class="hljs-built_in">log</span> /training/nginx/logs/flumeLogs<br><br><span class="hljs-comment">#æ¸…ç©ºaccess.logçš„å†…å®¹</span><br>sed -i <span class="hljs-string">&#x27;1,&#x27;</span><span class="hljs-variable">$&#123;lines&#125;</span><span class="hljs-string">&#x27;d&#x27;</span> /training/nginx/logs/access.log<br><br><span class="hljs-comment">#é‡å¯nginx , å¦åˆ™ log can not roll.</span><br><span class="hljs-built_in">kill</span> -USR1 `cat /training/nginx/logs/nginx.pid`<br><br><span class="hljs-comment">##è¿”å›ç»™æœåŠ¡å™¨ä¿¡æ¯</span><br>ls -al /training/nginx/logs/flumeLogs/<br></code></pre></td></tr></table></figure></li></ul></li><li><p>ç¼–å†™å¯åŠ¨Flumeè„šæœ¬ flume_start.shï¼Œå¯åŠ¨Flume</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>/training/apache-flume-1.9.0-bin/bin/flume-ng agent -c /training/apache-flume-1.9.0-bin/conf/ -f /training/apache-flume-1.9.0-bin/conf/flume-hdfs.conf -n a1 -Dflume.root.logger=INFO,console &amp;<br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™åœæ­¢Flumeè„šæœ¬ flume_stop.shï¼Œåœæ­¢Flume</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><br>JAR=&quot;flume&quot;<br><br><span class="hljs-meta">#</span><span class="bash">åœæ­¢flumeå‡½æ•°</span><br>echo &quot;begin stop flume process..&quot;<br>num=`ps -ef|grep java|grep $JAR|wc -l`<br>echo &quot;å½“å‰å·²ç»å¯åŠ¨çš„flumeè¿›ç¨‹æ•°ï¼š$num&quot;<br>if [ &quot;$num&quot; != &quot;0&quot; ];then<br><span class="hljs-meta">#</span><span class="bash">æ­£å¸¸åœæ­¢flume</span><br>ps -ef|grep java|grep $JAR|awk &#x27;&#123;print $2;&#125;&#x27;|xargs kill<br>echo &quot;è¿›ç¨‹å·²ç»å…³é—­...&quot;<br>else<br>echo &quot;æœåŠ¡æœªå¯åŠ¨ï¼Œæ— é¡»åœæ­¢...&quot;<br>fi<br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™é‡å¯Flumeè„šæœ¬ flume_to_hdfs.shï¼Œç»¼åˆäº†å‰ä¸¤ä¸ªè„šæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><br><span class="hljs-meta">#</span><span class="bash">å…ˆåœæ­¢æ­£åœ¨å¯åŠ¨çš„flume</span><br>./flume_stop.sh<br><br><span class="hljs-meta">#</span><span class="bash">ç”¨æ³•ï¼šnohup ./start-dishi.sh &gt;output 2&gt;&amp;1 &amp;</span><br>nohup ./flume_start.sh &gt; nohup_output.log 2&gt;&amp;1 &amp;<br>echo &quot;å¯åŠ¨flumeæˆåŠŸâ€¦â€¦&quot;<br><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼ˆå¦‚æœæƒé™ä¸å¤Ÿåˆ™åŠ æƒé™ï¼‰</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/image-20210115094657635.png" alt="image-20210115094657635"></p></li></ol><h1 id="åã€MapReduceå·¥ç¨‹"><a href="#åã€MapReduceå·¥ç¨‹" class="headerlink" title="åã€MapReduceå·¥ç¨‹"></a>åã€MapReduceå·¥ç¨‹</h1><p><strong>MapReduceä»£ç ç¼–å†™</strong></p><p>ï¼ˆ1ï¼‰åˆ›å»ºMapReduceå·¥å…·</p><p>ï¼ˆ2ï¼‰å¯¼å…¥Hadoopçš„ä¾èµ–åŒ…</p><p>ï¼ˆ3ï¼‰å†™ä»£ç </p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image001-1610629358970.png" alt="img"></p><p>å¯¼å…¥ä¾èµ–åŒ…</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image003.jpg" alt="img"></p><p>åˆ›å»ºç±»LogMapperç±»</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image005-1610629358974.jpg" alt="img"></p><p>åˆ›å»ºLogReducerç±»</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image007-1610629358974.jpg" alt="img"></p><p>åˆ›å»ºLogJobç±»</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image009-1610629358974.jpg" alt="img"></p><p>æœ¬åœ°è¿è¡Œæµ‹è¯•ç»“æœæ­£ç¡®åï¼Œéœ€è¦å¯¹Driverç±»è¾“å…¥è¾“å‡ºéƒ¨åˆ†ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå…·ä½“ä¿®æ”¹å¦‚ä¸‹</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">FileInputFormat</span>.</span></span>set<span class="hljs-constructor">InputPaths(<span class="hljs-params">job</span>,<span class="hljs-params">new</span> Path(<span class="hljs-params">args</span>[0])</span>);  <br><br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">FileOutputFormat</span>.</span></span>set<span class="hljs-constructor">OutputPath(<span class="hljs-params">job</span>,<span class="hljs-params">new</span> Path(<span class="hljs-params">args</span>[1])</span>);<br></code></pre></td></tr></table></figure><p>æ‰“jaråŒ…ï¼Œæäº¤é›†ç¾¤è¿è¡Œ</p><p>ä¸ºæ–¹ä¾¿æ“ä½œï¼Œç¼–å†™è„šæœ¬exec_mr.shæ¥æ‰§è¡ŒMRç¨‹åº</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-comment">#æ‰§è¡ŒMapReduceç¨‹åº</span><br>dataformat=`date +%Y-%m-%d-%H-%M-%S`<br>/training/hadoop-2.7.3/bin/hadoop jar log.jar $(cat mr_input_path.txt) /output/result/<span class="hljs-variable">$dataformat</span><br>/training/hadoop-2.7.3/bin/hdfs dfs -cat /output/result/<span class="hljs-variable">$dataformat</span>/part-r-00000 &gt; mr_result.txt<br><span class="hljs-built_in">echo</span> $(cat mr_result.txt)<br></code></pre></td></tr></table></figure><p>æ‰“åŒ…å¥½çš„ä¸Šæ¬¡åˆ°HDFSä¸­ï¼Œè¿›å…¥è¿è¡Œ</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image011.jpg" alt="img"></p><h1 id="åä¸€ã€SQOOPå®‰è£…é…ç½®"><a href="#åä¸€ã€SQOOPå®‰è£…é…ç½®" class="headerlink" title="åä¸€ã€SQOOPå®‰è£…é…ç½®"></a>åä¸€ã€SQOOPå®‰è£…é…ç½®</h1><p>Sqoopæ˜¯Apacheæ——ä¸‹ä¸€æ¬¾Hadoopå’Œå…³ç³»æ•°æ®æœåŠ¡ä¹‹é—´ä¼ é€æ•°æ®çš„å·¥å…·</p><p><strong>12.1</strong> <strong>å®‰è£…</strong></p><p>ä¸Šä¼ sqoop-1.4.7.bin__hadoop-2.6.0.tar.gzåˆ°/toolsç›®å½•ä¸‹</p><p>è§£å‹å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zvxf /tools/sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz -C /training/<br></code></pre></td></tr></table></figure><p>æ·»åŠ ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi ~/.bash_prefile<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">export SQOOP_HOME= /training/sqoop-1.4.7.bin__hadoop-2.6.0<br><br>export PATH=$PATH:$SQOOP_HOME/bin<br></code></pre></td></tr></table></figure><p>è®©ç¯å¢ƒç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">source ~/.bash_prefile<br></code></pre></td></tr></table></figure><p><strong>12.2 é…ç½®sqoopæ–‡ä»¶</strong></p><p>ä¿®æ”¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /training/sqoop-1.4.7.bin__hadoop-2.6.0/bin/configure-sqoop<br></code></pre></td></tr></table></figure><p>å°†å‡ºç°HCAT_HOMEå’ŒACCUMULO_HOMEéƒ¨åˆ†å†…å®¹æ³¨é‡Šæ‰.</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image002-1610766455675.jpg" alt="img"></p><p>ä¿®æ”¹sqoop-site.xmlå’Œsqoop-env.sh</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">vi /training/sqoop-1.4.7.bin__hadoop-2.6.0/conf/sqoop-site.xml<br>vi /training/sqoop-1.4.7.bin__hadoop-2.6.0/conf/sqoop-env.sh<br></code></pre></td></tr></table></figure><p>å…·ä½“é…ç½®å¦‚ä¸‹æ–‡ä»¶æ‰€ç¤ºï¼š</p><p>sqoop-site.xml:</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image003-1610766455678.png" alt="img"></p><p>sqoop-env.shï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">Set path to <span class="hljs-built_in">where</span> bin/hadoop is available</span><br>export HADOOP_COMMON_HOME=/training/hadoop-2.7.3<br><br><span class="hljs-meta">#</span><span class="bash">Set path to <span class="hljs-built_in">where</span> hadoop-*-core.jar is available</span><br>export HADOOP_MAPRED_HOME=/training/hadoop-2.7.3<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image004.png" alt="img"></p><p>å°†MySQLæ•°æ®åº“çš„é©±åŠ¨ï¼ˆä½¿ç”¨5.xç‰ˆæœ¬ï¼Œä¸è¦ä½¿ç”¨é«˜ç‰ˆæœ¬çš„ï¼‰ä¸Šä¼ åˆ°sqoopå®‰è£…ç›®å½•ä¸‹çš„libç›®å½•ä¸‹</p><p>ç”±äºsqoopç¼ºå°‘java-json.jaråŒ…è¿›è¡Œè§£æjsonï¼Œä¹Ÿéœ€è¦ä¸Šä¼ åˆ°sqoopå®‰è£…ç›®å½•ä¸‹çš„libç›®å½•ä¸‹</p><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image006-1610766455679.jpg" alt="img"></p><p>éªŒè¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sqoop version<br></code></pre></td></tr></table></figure><p><img src="/2021/01/13/2021%E5%AF%92%E5%81%87%E5%AE%9E%E8%AE%AD%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%94%B5%E5%95%86%E5%B9%B3%E5%8F%B0/clip_image008-1610766455680.jpg" alt="img"></p><p>åˆ›å»ºæ•°æ®åº“è¡¨t_mr_result,åˆ›å»ºè¯­å¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE TABLE &#96;t_mr_result&#96; (<br><br> &#96;goodsId&#96; varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT &#39;å•†å“ID&#39;,<br><br> &#96;goodsViewCount&#96; int(5) DEFAULT NULL COMMENT &#39;å•†å“æµè§ˆæ€»æ•°&#39;,<br><br> PRIMARY KEY (&#96;goodsId&#96;)<br><br>) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8mb4 COLLATE&#x3D;utf8mb4_unicode_ci<br></code></pre></td></tr></table></figure><p>ç¼–å†™sqoopä»hadoopå¯¼å‡ºæ•°æ®åˆ°MySQLçš„è„šæœ¬sqoop_mysql.sh</p><p>ä¿®æ”¹ä¸‹é¢çš„IPåœ°å€å’Œå¯†ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br><br>/training/sqoop-1.4.7.bin__hadoop-2.6.0/bin/sqoop export \<br><br>--connect jdbc:mysql://192.168.112.129:3306/shop \<br><br>--username root \<br><br>--password Sjm@!_123456 \<br><br>--input-fields-terminated-by &#x27;\t&#x27; \<br><br>--table t_mr_result \<br><br>--export-dir $(cat result_path.txt)<br><br>--class-name UpsertMrResult --update-key goodsId --update-mode allowinsert<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æœªå½’æ¡£</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootå­¦ä¹ ç¬”è®°</title>
    <link href="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<p>Springæ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œ2003 å¹´å…´èµ·çš„ä¸€ä¸ªè½»é‡çº§çš„Java å¼€å‘æ¡†æ¶ï¼Œä½œè€…ï¼šRod Johnson  ã€‚</p><p><strong>Springæ˜¯ä¸ºäº†è§£å†³ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œåˆ›å»ºçš„ï¼Œç®€åŒ–å¼€å‘ã€‚</strong></p><h1 id="ä¸€ã€SpringBootç®€ä»‹"><a href="#ä¸€ã€SpringBootç®€ä»‹" class="headerlink" title="ä¸€ã€SpringBootç®€ä»‹"></a>ä¸€ã€SpringBootç®€ä»‹</h1><h2 id="Springæ˜¯å¦‚ä½•ç®€åŒ–Javaå¼€å‘çš„"><a href="#Springæ˜¯å¦‚ä½•ç®€åŒ–Javaå¼€å‘çš„" class="headerlink" title="Springæ˜¯å¦‚ä½•ç®€åŒ–Javaå¼€å‘çš„"></a>Springæ˜¯å¦‚ä½•ç®€åŒ–Javaå¼€å‘çš„</h2><p>ä¸ºäº†é™ä½Javaå¼€å‘çš„å¤æ‚æ€§ï¼ŒSpringé‡‡ç”¨äº†ä»¥ä¸‹4ç§å…³é”®ç­–ç•¥ï¼š</p><p>1ã€åŸºäºPOJOçš„è½»é‡çº§å’Œæœ€å°ä¾µå…¥æ€§ç¼–ç¨‹ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯beanï¼›</p><p>2ã€é€šè¿‡IOCï¼Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å’Œé¢å‘æ¥å£å®ç°æ¾è€¦åˆï¼›</p><p>3ã€åŸºäºåˆ‡é¢ï¼ˆAOPï¼‰å’Œæƒ¯ä¾‹è¿›è¡Œå£°æ˜å¼ç¼–ç¨‹ï¼›</p><p>4ã€é€šè¿‡åˆ‡é¢å’Œæ¨¡ç‰ˆå‡å°‘æ ·å¼ä»£ç ï¼ŒRedisTemplateï¼ŒxxxTemplateï¼›</p><h2 id="ä»€ä¹ˆæ˜¯SpringBoot"><a href="#ä»€ä¹ˆæ˜¯SpringBoot" class="headerlink" title="ä»€ä¹ˆæ˜¯SpringBoot"></a>ä»€ä¹ˆæ˜¯SpringBoot</h2><p>å­¦è¿‡javawebçš„åŒå­¦å°±çŸ¥é“ï¼Œå¼€å‘ä¸€ä¸ªwebåº”ç”¨ï¼Œä»æœ€åˆå¼€å§‹æ¥è§¦Servletç»“åˆTomcat, è·‘å‡ºä¸€ä¸ªHello Wolrldç¨‹åºï¼Œæ˜¯è¦ç»å†ç‰¹åˆ«å¤šçš„æ­¥éª¤ï¼›åæ¥å°±ç”¨äº†æ¡†æ¶Strutsï¼Œå†åæ¥æ˜¯SpringMVCï¼Œåˆ°äº†ç°åœ¨çš„SpringBootï¼Œè¿‡ä¸€ä¸¤å¹´åˆä¼šæœ‰å…¶ä»–webæ¡†æ¶å‡ºç°ï¼›ä½ ä»¬æœ‰ç»å†è¿‡æ¡†æ¶ä¸æ–­çš„æ¼”è¿›ï¼Œç„¶åè‡ªå·±å¼€å‘é¡¹ç›®æ‰€æœ‰çš„æŠ€æœ¯ä¹Ÿåœ¨ä¸æ–­çš„å˜åŒ–ã€æ”¹é€ å—ï¼Ÿå»ºè®®éƒ½å¯ä»¥å»ç»å†ä¸€éï¼›</p><p>è¨€å½’æ­£ä¼ ï¼Œä»€ä¹ˆæ˜¯SpringBootå‘¢ï¼Œå°±æ˜¯ä¸€ä¸ªjavawebçš„å¼€å‘æ¡†æ¶ï¼Œå’ŒSpringMVCç±»ä¼¼ï¼Œå¯¹æ¯”å…¶ä»–javawebæ¡†æ¶çš„å¥½å¤„ï¼Œå®˜æ–¹è¯´æ˜¯ç®€åŒ–å¼€å‘ï¼Œçº¦å®šå¤§äºé…ç½®ï¼Œ  you can â€œjust runâ€ï¼Œèƒ½è¿…é€Ÿçš„å¼€å‘webåº”ç”¨ï¼Œå‡ è¡Œä»£ç å¼€å‘ä¸€ä¸ªhttpæ¥å£ã€‚</p><p>æ‰€æœ‰çš„æŠ€æœ¯æ¡†æ¶çš„å‘å±•ä¼¼ä¹éƒ½éµå¾ªäº†ä¸€æ¡ä¸»çº¿è§„å¾‹ï¼šä»ä¸€ä¸ªå¤æ‚åº”ç”¨åœºæ™¯ è¡ç”Ÿ ä¸€ç§è§„èŒƒæ¡†æ¶ï¼Œäººä»¬åªéœ€è¦è¿›è¡Œå„ç§é…ç½®è€Œä¸éœ€è¦è‡ªå·±å»å®ç°å®ƒï¼Œè¿™æ—¶å€™å¼ºå¤§çš„é…ç½®åŠŸèƒ½æˆäº†ä¼˜ç‚¹ï¼›å‘å±•åˆ°ä¸€å®šç¨‹åº¦ä¹‹åï¼Œäººä»¬æ ¹æ®å®é™…ç”Ÿäº§åº”ç”¨æƒ…å†µï¼Œé€‰å–å…¶ä¸­å®ç”¨åŠŸèƒ½å’Œè®¾è®¡ç²¾åï¼Œé‡æ„å‡ºä¸€äº›è½»é‡çº§çš„æ¡†æ¶ï¼›ä¹‹åä¸ºäº†æé«˜å¼€å‘æ•ˆç‡ï¼Œå«Œå¼ƒåŸå…ˆçš„å„ç±»é…ç½®è¿‡äºéº»çƒ¦ï¼Œäºæ˜¯å¼€å§‹æå€¡â€œçº¦å®šå¤§äºé…ç½®â€ï¼Œè¿›è€Œè¡ç”Ÿå‡ºä¸€äº›ä¸€ç«™å¼çš„è§£å†³æ–¹æ¡ˆã€‚</p><p>æ˜¯çš„è¿™å°±æ˜¯Javaä¼ä¸šçº§åº”ç”¨-&gt;J2EE-&gt;spring-&gt;springbootçš„è¿‡ç¨‹ã€‚</p><p>éšç€ Spring ä¸æ–­çš„å‘å±•ï¼Œæ¶‰åŠçš„é¢†åŸŸè¶Šæ¥è¶Šå¤šï¼Œé¡¹ç›®æ•´åˆå¼€å‘éœ€è¦é…åˆå„ç§å„æ ·çš„æ–‡ä»¶ï¼Œæ…¢æ…¢å˜å¾—ä¸é‚£ä¹ˆæ˜“ç”¨ç®€å•ï¼Œè¿èƒŒäº†æœ€åˆçš„ç†å¿µï¼Œç”šè‡³äººç§°é…ç½®åœ°ç‹±ã€‚Spring Boot æ­£æ˜¯åœ¨è¿™æ ·çš„ä¸€ä¸ªèƒŒæ™¯ä¸‹è¢«æŠ½è±¡å‡ºæ¥çš„å¼€å‘æ¡†æ¶ï¼Œç›®çš„ä¸ºäº†è®©å¤§å®¶æ›´å®¹æ˜“çš„ä½¿ç”¨ Spring ã€æ›´å®¹æ˜“çš„é›†æˆå„ç§å¸¸ç”¨çš„ä¸­é—´ä»¶ã€å¼€æºè½¯ä»¶ï¼›</p><p>Spring Boot åŸºäº Spring å¼€å‘ï¼ŒSpirng Boot æœ¬èº«å¹¶ä¸æä¾› Spring æ¡†æ¶çš„æ ¸å¿ƒç‰¹æ€§ä»¥åŠæ‰©å±•åŠŸèƒ½ï¼Œåªæ˜¯ç”¨äºå¿«é€Ÿã€æ•æ·åœ°å¼€å‘æ–°ä¸€ä»£åŸºäº Spring æ¡†æ¶çš„åº”ç”¨ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸æ˜¯ç”¨æ¥æ›¿ä»£ Spring çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯å’Œ Spring æ¡†æ¶ç´§å¯†ç»“åˆç”¨äºæå‡ Spring å¼€å‘è€…ä½“éªŒçš„å·¥å…·ã€‚Spring Boot ä»¥<strong>çº¦å®šå¤§äºé…ç½®çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼Œé»˜è®¤å¸®æˆ‘ä»¬è¿›è¡Œäº†å¾ˆå¤šè®¾ç½®ï¼Œå¤šæ•° Spring Boot åº”ç”¨åªéœ€è¦å¾ˆå°‘çš„ Spring é…ç½®ã€‚åŒæ—¶å®ƒé›†æˆäº†å¤§é‡å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹åº“é…ç½®ï¼ˆä¾‹å¦‚ Redisã€MongoDBã€Jpaã€RabbitMQã€Quartz ç­‰ç­‰ï¼‰ï¼ŒSpring Boot åº”ç”¨ä¸­è¿™äº›ç¬¬ä¸‰æ–¹åº“å‡ ä¹å¯ä»¥é›¶é…ç½®çš„å¼€ç®±å³ç”¨ã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯SpringBootå…¶å®ä¸æ˜¯ä»€ä¹ˆæ–°çš„æ¡†æ¶ï¼Œå®ƒé»˜è®¤é…ç½®äº†å¾ˆå¤šæ¡†æ¶çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±åƒmavenæ•´åˆäº†æ‰€æœ‰çš„jaråŒ…ï¼Œspring bootæ•´åˆäº†æ‰€æœ‰çš„æ¡†æ¶ ã€‚</p><p>Spring Boot å‡ºç”Ÿåé—¨ï¼Œä»ä¸€å¼€å§‹å°±ç«™åœ¨ä¸€ä¸ªæ¯”è¾ƒé«˜çš„èµ·ç‚¹ï¼Œåˆç»è¿‡è¿™å‡ å¹´çš„å‘å±•ï¼Œç”Ÿæ€è¶³å¤Ÿå®Œå–„ï¼ŒSpring Boot å·²ç»å½“ä¹‹æ— æ„§æˆä¸º Java é¢†åŸŸæœ€çƒ­é—¨çš„æŠ€æœ¯ã€‚</p><p><strong>Spring Bootçš„ä¸»è¦ä¼˜ç‚¹ï¼š</strong></p><ul><li><p>ä¸ºæ‰€æœ‰Springå¼€å‘è€…æ›´å¿«çš„å…¥é—¨</p></li><li><p><strong>å¼€ç®±å³ç”¨</strong>ï¼Œæä¾›å„ç§é»˜è®¤é…ç½®æ¥ç®€åŒ–é¡¹ç›®é…ç½®</p></li><li><p>å†…åµŒå¼å®¹å™¨ç®€åŒ–Webé¡¹ç›®</p></li><li><p>æ²¡æœ‰å†—ä½™ä»£ç ç”Ÿæˆå’ŒXMLé…ç½®çš„è¦æ±‚</p></li></ul><h1 id="äºŒã€åˆ›å»ºé¡¹ç›®"><a href="#äºŒã€åˆ›å»ºé¡¹ç›®" class="headerlink" title="äºŒã€åˆ›å»ºé¡¹ç›®"></a>äºŒã€åˆ›å»ºé¡¹ç›®</h1><h2 id="é¡¹ç›®åˆ›å»ºæ–¹å¼ä¸€ï¼šä½¿ç”¨Spring-Initializr-çš„-Webé¡µé¢åˆ›å»ºé¡¹ç›®"><a href="#é¡¹ç›®åˆ›å»ºæ–¹å¼ä¸€ï¼šä½¿ç”¨Spring-Initializr-çš„-Webé¡µé¢åˆ›å»ºé¡¹ç›®" class="headerlink" title="é¡¹ç›®åˆ›å»ºæ–¹å¼ä¸€ï¼šä½¿ç”¨Spring Initializr çš„ Webé¡µé¢åˆ›å»ºé¡¹ç›®"></a><strong>é¡¹ç›®åˆ›å»ºæ–¹å¼ä¸€ï¼š</strong>ä½¿ç”¨Spring Initializr çš„ Webé¡µé¢åˆ›å»ºé¡¹ç›®</h2><p>å¾ˆå°‘ç”¨è¿™ç§æ–¹å¼</p><p>1ã€æ‰“å¼€  <a href="https://start.spring.io/">https://start.spring.io/</a></p><p>2ã€å¡«å†™é¡¹ç›®ä¿¡æ¯</p><p>3ã€ç‚¹å‡»â€Generate Projectâ€œæŒ‰é’®ç”Ÿæˆé¡¹ç›®ï¼›ä¸‹è½½æ­¤é¡¹ç›®</p><p>4ã€è§£å‹é¡¹ç›®åŒ…ï¼Œå¹¶ç”¨IDEAä»¥Mavené¡¹ç›®å¯¼å…¥ï¼Œä¸€è·¯ä¸‹ä¸€æ­¥å³å¯ï¼Œç›´åˆ°é¡¹ç›®å¯¼å…¥å®Œæ¯•ã€‚</p><p>5ã€å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œå¯èƒ½é€Ÿåº¦ä¼šæ¯”è¾ƒæ…¢ï¼ŒåŒ…æ¯”è¾ƒå¤šã€éœ€è¦è€å¿ƒç­‰å¾…ä¸€åˆ‡å°±ç»ªã€‚</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109160401917.png" alt="image-20210109160401917"></p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109160737554.png" alt="image-20210109160737554"></p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109160857610.png" alt="image-20210109160857610"></p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109160957494.png" alt="image-20210109160957494"></p><p>è§£å‹å</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109161450178.png" alt="image-20210109161450178"></p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109161415660.png" alt="image-20210109161415660"></p><h2 id="é¡¹ç›®åˆ›å»ºæ–¹å¼äºŒï¼šä½¿ç”¨-IDEA-ç›´æ¥åˆ›å»ºé¡¹ç›®"><a href="#é¡¹ç›®åˆ›å»ºæ–¹å¼äºŒï¼šä½¿ç”¨-IDEA-ç›´æ¥åˆ›å»ºé¡¹ç›®" class="headerlink" title="é¡¹ç›®åˆ›å»ºæ–¹å¼äºŒï¼šä½¿ç”¨ IDEA ç›´æ¥åˆ›å»ºé¡¹ç›®"></a><strong>é¡¹ç›®åˆ›å»ºæ–¹å¼äºŒï¼š</strong>ä½¿ç”¨ IDEA ç›´æ¥åˆ›å»ºé¡¹ç›®</h2><p>1ã€åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®</p><p>2ã€é€‰æ‹©spring initalizr ï¼Œ å¯ä»¥çœ‹åˆ°é»˜è®¤å°±æ˜¯å»å®˜ç½‘çš„å¿«é€Ÿæ„å»ºå·¥å…·é‚£é‡Œå®ç°</p><p>3ã€å¡«å†™é¡¹ç›®ä¿¡æ¯</p><p>4ã€é€‰æ‹©åˆå§‹åŒ–çš„ç»„ä»¶ï¼ˆåˆå­¦å‹¾é€‰ Web å³å¯ï¼‰</p><p>5ã€å¡«å†™é¡¹ç›®è·¯å¾„</p><p>6ã€ç­‰å¾…é¡¹ç›®æ„å»ºæˆåŠŸ</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109161717039.png" alt="image-20210109161717039"></p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109161847811.png" alt="image-20210109161847811"></p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210109161911331.png" alt="image-20210109161911331"></p><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">   <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.1.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hello<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hello<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>Demo project for Spring Boot<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- webåœºæ™¯å¯åŠ¨å™¨ tomcat dispatcherservlet xmlä¾èµ–--&gt;</span><br><span class="hljs-comment">&lt;!--      springBootæ‰€æœ‰çš„ä¾èµ–éƒ½æ˜¯ä½¿ç”¨æ˜¯spring-boot-starterå¼€å¤´--&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-comment">&lt;!--å•å…ƒæµ‹è¯•--&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>         <span class="hljs-comment">&lt;!-- å‰”é™¤ä¾èµ– --&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>         <span class="hljs-comment">&lt;!-- æ‰“åŒ…æ’ä»¶ --&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¼–å†™ä¸€ä¸ªHTTPæ¥å£</p><p>1ã€åœ¨ä¸»ç¨‹åºçš„åŒçº§ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªcontrolleråŒ…ï¼Œä¸€å®šè¦åœ¨åŒçº§ç›®å½•ä¸‹ï¼Œå¦åˆ™è¯†åˆ«ä¸åˆ°</p><p>2ã€åœ¨åŒ…ä¸­æ–°å»ºä¸€ä¸ªHelloControllerç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestControllerpublic</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>&#123;<br>    <span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">()</span> </span>&#123;        <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello World&quot;</span>;    <br>    &#125;    <br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€ç¼–å†™å®Œæ¯•åï¼Œä»ä¸»ç¨‹åºå¯åŠ¨é¡¹ç›®ï¼Œæµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼Œçœ‹é¡µé¢è¿”å›ï¼›æ§åˆ¶å°è¾“å‡ºäº† Tomcat è®¿é—®çš„ç«¯å£å·ï¼</p><h1 id="ä¸‰ã€è¿è¡ŒåŸç†"><a href="#ä¸‰ã€è¿è¡ŒåŸç†" class="headerlink" title="ä¸‰ã€è¿è¡ŒåŸç†"></a>ä¸‰ã€è¿è¡ŒåŸç†</h1><h2 id="3-1-pom-xml"><a href="#3-1-pom-xml" class="headerlink" title="3.1 pom.xml"></a>3.1 pom.xml</h2><h3 id="çˆ¶ä¾èµ–"><a href="#çˆ¶ä¾èµ–" class="headerlink" title="çˆ¶ä¾èµ–"></a>çˆ¶ä¾èµ–</h3><p>å…¶ä¸­å®ƒä¸»è¦æ˜¯ä¾èµ–ä¸€ä¸ªçˆ¶é¡¹ç›®ï¼Œä¸»è¦æ˜¯ç®¡ç†é¡¹ç›®çš„èµ„æºè¿‡æ»¤åŠæ’ä»¶ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.5.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç‚¹è¿›å»ï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ªçˆ¶ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.5.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>&gt;</span>../../spring-boot-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">relativePath</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ‰æ˜¯çœŸæ­£ç®¡ç†SpringBootåº”ç”¨é‡Œé¢æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬çš„åœ°æ–¹ï¼ŒSpringBootçš„ç‰ˆæœ¬æ§åˆ¶ä¸­å¿ƒï¼›</p><p><strong>ä»¥åæˆ‘ä»¬å¯¼å…¥ä¾èµ–é»˜è®¤æ˜¯ä¸éœ€è¦å†™ç‰ˆæœ¬ï¼›ä½†æ˜¯å¦‚æœå¯¼å…¥çš„åŒ…æ²¡æœ‰åœ¨ä¾èµ–ä¸­ç®¡ç†ç€å°±éœ€è¦æ‰‹åŠ¨é…ç½®ç‰ˆæœ¬äº†ï¼›</strong></p><h3 id="å¯åŠ¨å™¨-spring-boot-starter"><a href="#å¯åŠ¨å™¨-spring-boot-starter" class="headerlink" title="å¯åŠ¨å™¨ spring-boot-starter"></a>å¯åŠ¨å™¨ spring-boot-starter</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="3-2-ä¸»ç¨‹åº-SpringBootApplication"><a href="#3-2-ä¸»ç¨‹åº-SpringBootApplication" class="headerlink" title="3.2 ä¸»ç¨‹åº@SpringBootApplication"></a>3.2 ä¸»ç¨‹åº@SpringBootApplication</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ‡æ³¨è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªspringbootçš„åº”ç”¨</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloApplication</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(HelloApplication.class, args);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p>springBootApplicationä¸­æœ‰å¦‚ä¸‹å†…å®¹</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118135643257.png" alt="image-20210118135643257"></p><h3 id="3-2-1-SpringBootConfiguration"><a href="#3-2-1-SpringBootConfiguration" class="headerlink" title="3.2.1 @SpringBootConfiguration"></a>3.2.1 @SpringBootConfiguration</h3><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118135745961.png" alt="image-20210118135745961"></p><h4 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h4><p>springé…ç½®ç±»</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118135845071.png" alt="image-20210118135845071"></p><h5 id="Component"><a href="#Component" class="headerlink" title="@Component"></a>@Component</h5><p>è¯´æ˜è¿™ä¹Ÿæ˜¯springçš„ä¸€ä¸ªç»„ä»¶</p><h3 id="3-2-2-EnableAutoConfiguration"><a href="#3-2-2-EnableAutoConfiguration" class="headerlink" title="3.2.2 @EnableAutoConfiguration"></a>3.2.2 @EnableAutoConfiguration</h3><p>è‡ªåŠ¨é…ç½®</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118140122913.png" alt="image-20210118140122913"></p><h4 id="AutoConfigurationPackage"><a href="#AutoConfigurationPackage" class="headerlink" title="@AutoConfigurationPackage"></a>@AutoConfigurationPackage</h4><p>è‡ªåŠ¨é…ç½®åŒ…</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118140211399.png" alt="image-20210118140211399"></p><h5 id="Import"><a href="#Import" class="headerlink" title="@Import"></a>@Import</h5><ul><li><p>å¯¼å…¥äº†é€‰æ‹©å™¨â€˜åŒ…æ³¨å†Œâ€™</p></li><li><p>Registrar.class ä½œç”¨ï¼šå°†ä¸»å¯åŠ¨ç±»çš„æ‰€åœ¨åŒ…åŠåŒ…ä¸‹é¢æ‰€æœ‰å­åŒ…é‡Œé¢çš„æ‰€æœ‰ç»„ä»¶æ‰«æåˆ°Springå®¹å™¨ ï¼›</p></li></ul><h4 id="Import-AutoConfigurationImportSelector-class"><a href="#Import-AutoConfigurationImportSelector-class" class="headerlink" title="@Import({AutoConfigurationImportSelector.class})"></a>@Import({AutoConfigurationImportSelector.class})</h4><p>è‡ªåŠ¨é…ç½®å¯¼å…¥é€‰æ‹©</p><p>AutoConfigurationImportSelector ï¼šè‡ªåŠ¨é…ç½®å¯¼å…¥é€‰æ‹©å™¨ï¼Œé‚£ä¹ˆå®ƒä¼šå¯¼å…¥å“ªäº›ç»„ä»¶çš„é€‰æ‹©å™¨å‘¢ï¼Ÿæˆ‘ä»¬ç‚¹å‡»å»è¿™ä¸ªç±»çœ‹æºç ï¼š</p><p>1ã€è¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªè¿™æ ·çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–å€™é€‰çš„é…ç½® </span><br><span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;String&gt; <span class="hljs-title">getCandidateConfigurations</span><span class="hljs-params">(AnnotationMetadata metadata, AnnotationAttributes attributes)</span> </span>&#123;<br>        List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(<span class="hljs-keyword">this</span>.getSpringFactoriesLoaderFactoryClass(), <span class="hljs-keyword">this</span>.getBeanClassLoader());<br>        Assert.notEmpty(configurations, <span class="hljs-string">&quot;No auto configuration classes found in META-INF/spring.factories. If you are using a custom packaging, make sure that file is correct.&quot;</span>);<br>        <span class="hljs-keyword">return</span> configurations;<br>    &#125;<br></code></pre></td></tr></table></figure><p>2ã€è¿™ä¸ªæ–¹æ³•åˆè°ƒç”¨äº†  SpringFactoriesLoader ç±»çš„é™æ€æ–¹æ³•ï¼æˆ‘ä»¬è¿›å…¥SpringFactoriesLoaderç±»loadFactoryNames() æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;String&gt; <span class="hljs-title">loadFactoryNames</span><span class="hljs-params">(Class&lt;?&gt; factoryClass, <span class="hljs-meta">@Nullable</span> ClassLoader classLoader)</span> </span>&#123;<br>    String factoryClassName = factoryClass.getName();<br>    <span class="hljs-comment">//è¿™é‡Œå®ƒåˆè°ƒç”¨äº† loadSpringFactories æ–¹æ³•</span><br>    <span class="hljs-keyword">return</span> (List)loadSpringFactories(classLoader).getOrDefault(factoryClassName, Collections.emptyList());<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬ç»§ç»­ç‚¹å‡»æŸ¥çœ‹ loadSpringFactories æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String, List&lt;String&gt;&gt; loadSpringFactories(<span class="hljs-meta">@Nullable</span> ClassLoader classLoader) &#123;<br>    <span class="hljs-comment">//è·å¾—classLoader ï¼Œ æˆ‘ä»¬è¿”å›å¯ä»¥çœ‹åˆ°è¿™é‡Œå¾—åˆ°çš„å°±æ˜¯EnableAutoConfigurationæ ‡æ³¨çš„ç±»æœ¬èº«</span><br>    MultiValueMap&lt;String, String&gt; result = (MultiValueMap)cache.get(classLoader);<br>    <span class="hljs-keyword">if</span> (result != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//å»è·å–ä¸€ä¸ªèµ„æº &quot;META-INF/spring.factories&quot;</span><br>            Enumeration&lt;URL&gt; urls = classLoader != <span class="hljs-keyword">null</span> ? classLoader.getResources(<span class="hljs-string">&quot;META-INF/spring.factories&quot;</span>) : ClassLoader.getSystemResources(<span class="hljs-string">&quot;META-INF/spring.factories&quot;</span>);<br>            LinkedMultiValueMap result = <span class="hljs-keyword">new</span> LinkedMultiValueMap();<br><br>            <span class="hljs-comment">//å°†è¯»å–åˆ°çš„èµ„æºéå†ï¼Œå°è£…æˆä¸ºä¸€ä¸ªProperties</span><br>            <span class="hljs-keyword">while</span>(urls.hasMoreElements()) &#123;<br>                URL url = (URL)urls.nextElement();<br>                UrlResource resource = <span class="hljs-keyword">new</span> UrlResource(url);<br>                Properties properties = PropertiesLoaderUtils.loadProperties(resource);<br>                Iterator var6 = properties.entrySet().iterator();<br><br>                <span class="hljs-keyword">while</span>(var6.hasNext()) &#123;<br>                    Entry&lt;?, ?&gt; entry = (Entry)var6.next();<br>                    String factoryClassName = ((String)entry.getKey()).trim();<br>                    String[] var9 = StringUtils.commaDelimitedListToStringArray((String)entry.getValue());<br>                    <span class="hljs-keyword">int</span> var10 = var9.length;<br><br>                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> var11 = <span class="hljs-number">0</span>; var11 &lt; var10; ++var11) &#123;<br>                        String factoryName = var9[var11];<br>                        result.add(factoryClassName, factoryName.trim());<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            cache.put(classLoader, result);<br>            <span class="hljs-keyword">return</span> result;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException var13) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Unable to load factories from location [META-INF/spring.factories]&quot;</span>, var13);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€å‘ç°ä¸€ä¸ªå¤šæ¬¡å‡ºç°çš„æ–‡ä»¶ï¼šspring.factoriesï¼Œå…¨å±€æœç´¢å®ƒ</p><h5 id="spring-factories"><a href="#spring-factories" class="headerlink" title="spring.factories"></a>spring.factories</h5><p>æˆ‘ä»¬æ ¹æ®æºå¤´æ‰“å¼€spring.factories ï¼Œ çœ‹åˆ°äº†å¾ˆå¤šè‡ªåŠ¨é…ç½®çš„æ–‡ä»¶ï¼›è¿™å°±æ˜¯è‡ªåŠ¨é…ç½®æ ¹æºæ‰€åœ¨ï¼</p><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118143915822.png" alt="image-20210118143915822"></p><p>è‡ªåŠ¨é…ç½®çœŸæ­£å®ç°æ˜¯ä»classpathä¸­æœå¯»æ‰€æœ‰çš„META-INF/spring.factoriesé…ç½®æ–‡ä»¶ ï¼Œå¹¶å°†å…¶ä¸­å¯¹åº”çš„ org.springframework.boot.autoconfigure. åŒ…ä¸‹çš„é…ç½®é¡¹ï¼Œé€šè¿‡åå°„å®ä¾‹åŒ–ä¸ºå¯¹åº”æ ‡æ³¨äº† @Configurationçš„JavaConfigå½¢å¼çš„IOCå®¹å™¨é…ç½®ç±» ï¼Œ ç„¶åå°†è¿™äº›éƒ½æ±‡æ€»æˆä¸ºä¸€ä¸ªå®ä¾‹å¹¶åŠ è½½åˆ°IOCå®¹å™¨ä¸­ã€‚</p><h3 id="3-2-3-ComponentScan"><a href="#3-2-3-ComponentScan" class="headerlink" title="3.2.3 @ComponentScan"></a>3.2.3 @ComponentScan</h3><p>æ‰«æå½“å‰ä¸»å¯åŠ¨ç±»åŒçº§çš„åŒ…</p><h3 id="3-2-4-ç»“è®ºï¼š"><a href="#3-2-4-ç»“è®ºï¼š" class="headerlink" title="3.2.4 ç»“è®ºï¼š"></a>3.2.4 ç»“è®ºï¼š</h3><ol><li>SpringBootåœ¨å¯åŠ¨çš„æ—¶å€™ä»ç±»è·¯å¾„ä¸‹çš„META-INF/spring.factoriesä¸­è·å–EnableAutoConfigurationæŒ‡å®šçš„å€¼</li><li>å°†è¿™äº›å€¼ä½œä¸ºè‡ªåŠ¨é…ç½®ç±»å¯¼å…¥å®¹å™¨ ï¼Œ è‡ªåŠ¨é…ç½®ç±»å°±ç”Ÿæ•ˆ ï¼Œ å¸®æˆ‘ä»¬è¿›è¡Œè‡ªåŠ¨é…ç½®å·¥ä½œï¼›</li><li>æ•´ä¸ªJ2EEçš„æ•´ä½“è§£å†³æ–¹æ¡ˆå’Œè‡ªåŠ¨é…ç½®éƒ½åœ¨springboot-autoconfigureçš„jaråŒ…ä¸­ï¼›</li><li>å®ƒä¼šç»™å®¹å™¨ä¸­å¯¼å…¥éå¸¸å¤šçš„è‡ªåŠ¨é…ç½®ç±» ï¼ˆxxxAutoConfigurationï¼‰, å°±æ˜¯ç»™å®¹å™¨ä¸­å¯¼å…¥è¿™ä¸ªåœºæ™¯éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ ï¼Œ å¹¶é…ç½®å¥½è¿™äº›ç»„ä»¶ ï¼›</li><li>æœ‰äº†è‡ªåŠ¨é…ç½®ç±» ï¼Œ å…å»äº†æˆ‘ä»¬æ‰‹åŠ¨ç¼–å†™é…ç½®æ³¨å…¥åŠŸèƒ½ç»„ä»¶ç­‰çš„å·¥ä½œï¼›</li></ol><h2 id="3-3-SpringApplication"><a href="#3-3-SpringApplication" class="headerlink" title="3.3 SpringApplication"></a>3.3 SpringApplication</h2><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210118150455060.png" alt="image-20210118150455060"></p><p><strong>è¿™ä¸ªç±»ä¸»è¦åšäº†ä»¥ä¸‹å››ä»¶äº‹æƒ…ï¼š</strong></p><p>1ã€æ¨æ–­åº”ç”¨çš„ç±»å‹æ˜¯æ™®é€šçš„é¡¹ç›®è¿˜æ˜¯Webé¡¹ç›®</p><p>2ã€æŸ¥æ‰¾å¹¶åŠ è½½æ‰€æœ‰å¯ç”¨åˆå§‹åŒ–å™¨ ï¼Œè®¾ç½®åˆ°initializerså±æ€§ä¸­</p><p>3ã€æ‰¾å‡ºæ‰€æœ‰çš„åº”ç”¨ç¨‹åºç›‘å¬å™¨ï¼Œè®¾ç½®åˆ°listenerså±æ€§ä¸­</p><p>4ã€æ¨æ–­å¹¶è®¾ç½®mainæ–¹æ³•çš„å®šä¹‰ç±»ï¼Œæ‰¾åˆ°è¿è¡Œçš„ä¸»ç±»</p><p>æŸ¥çœ‹æ„é€ å™¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SpringApplication</span><span class="hljs-params">(ResourceLoader resourceLoader, Class... primarySources)</span> </span>&#123;<br>    <span class="hljs-comment">// ......</span><br>    <span class="hljs-keyword">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();<br>    <span class="hljs-keyword">this</span>.setInitializers(<span class="hljs-keyword">this</span>.getSpringFactoriesInstances();<br>    <span class="hljs-keyword">this</span>.setListeners(<span class="hljs-keyword">this</span>.getSpringFactoriesInstances(ApplicationListener.class));<br>    <span class="hljs-keyword">this</span>.mainApplicationClass = <span class="hljs-keyword">this</span>.deduceMainApplicationClass();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="runæ–¹æ³•æµç¨‹åˆ†æ"><a href="#runæ–¹æ³•æµç¨‹åˆ†æ" class="headerlink" title="runæ–¹æ³•æµç¨‹åˆ†æ"></a>runæ–¹æ³•æµç¨‹åˆ†æ</h3><p><img src="/2021/01/08/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringBoot%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.jpg"></p><h1 id="å››ã€yamlé…ç½®æ³¨å…¥ä¸Jsr303æ•°æ®æ ¡éªŒ"><a href="#å››ã€yamlé…ç½®æ³¨å…¥ä¸Jsr303æ•°æ®æ ¡éªŒ" class="headerlink" title="å››ã€yamlé…ç½®æ³¨å…¥ä¸Jsr303æ•°æ®æ ¡éªŒ"></a>å››ã€yamlé…ç½®æ³¨å…¥ä¸Jsr303æ•°æ®æ ¡éªŒ</h1><h2 id="4-1-é…ç½®æ–‡ä»¶"><a href="#4-1-é…ç½®æ–‡ä»¶" class="headerlink" title="4.1 é…ç½®æ–‡ä»¶"></a>4.1 é…ç½®æ–‡ä»¶</h2><p>SpringBootä½¿ç”¨ä¸€ä¸ªå…¨å±€çš„é…ç½®æ–‡ä»¶ ï¼Œ é…ç½®æ–‡ä»¶åç§°æ˜¯å›ºå®šçš„</p><ul><li><p>application.properties</p></li><li><ul><li>è¯­æ³•ç»“æ„ ï¼škey=value</li></ul></li><li><p>application.ymlï¼ˆå®˜æ–¹æ¨èï¼‰</p></li><li><ul><li>è¯­æ³•ç»“æ„ ï¼škeyï¼šç©ºæ ¼ value</li></ul></li></ul><p><strong>é…ç½®æ–‡ä»¶çš„ä½œç”¨ ï¼š</strong>ä¿®æ”¹SpringBootè‡ªåŠ¨é…ç½®çš„é»˜è®¤å€¼ï¼Œå› ä¸ºSpringBootåœ¨åº•å±‚éƒ½ç»™æˆ‘ä»¬è‡ªåŠ¨é…ç½®å¥½äº†ï¼›</p><p>æ¯”å¦‚æˆ‘ä»¬å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹Tomcat é»˜è®¤å¯åŠ¨çš„ç«¯å£å·ï¼æµ‹è¯•ä¸€ä¸‹ï¼</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-meta">server.port</span>=<span class="hljs-string">8081</span><br></code></pre></td></tr></table></figure><p>å…·ä½“è¯­æ³•æŸ¥çœ‹ï¼š<a href="https://mccontinuing.github.io/2021/01/18/yaml%E5%9F%BA%E7%A1%80/">yamlåŸºç¡€ç”¨æ³•</a></p><h2 id="4-2-JSR303æ•°æ®æ ¡éªŒ"><a href="#4-2-JSR303æ•°æ®æ ¡éªŒ" class="headerlink" title="4.2 JSR303æ•°æ®æ ¡éªŒ"></a>4.2 JSR303æ•°æ®æ ¡éªŒ</h2><p>Springbootä¸­å¯ä»¥ç”¨@validatedæ¥æ ¡éªŒæ•°æ®ï¼Œå¦‚æœæ•°æ®å¼‚å¸¸åˆ™ä¼šç»Ÿä¸€æŠ›å‡ºå¼‚å¸¸ï¼Œæ–¹ä¾¿å¼‚å¸¸ä¸­å¿ƒç»Ÿä¸€å¤„ç†ã€‚æˆ‘ä»¬è¿™é‡Œæ¥å†™ä¸ªæ³¨è§£è®©æˆ‘ä»¬çš„nameåªèƒ½æ”¯æŒEmailæ ¼å¼ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span> <span class="hljs-comment">//æ³¨å†Œbean</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;person&quot;)</span><br><span class="hljs-meta">@Validated</span>  <span class="hljs-comment">//æ•°æ®æ ¡éªŒ</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br><br>    <span class="hljs-meta">@Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;)</span> <span class="hljs-comment">//nameå¿…é¡»æ˜¯é‚®ç®±æ ¼å¼</span><br>    <span class="hljs-keyword">private</span> String name;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿è¡Œç»“æœ</strong> ï¼šdefault message [ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„ç”µå­é‚®ä»¶åœ°å€];</p><p><strong>ä½¿ç”¨æ•°æ®æ ¡éªŒï¼Œå¯ä»¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼›</strong> </p><h3 id="å¸¸è§å‚æ•°"><a href="#å¸¸è§å‚æ•°" class="headerlink" title="å¸¸è§å‚æ•°"></a>å¸¸è§å‚æ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@NotNull(message=&quot;åå­—ä¸èƒ½ä¸ºç©º&quot;)</span><br><span class="hljs-keyword">private</span> String userName;<br><span class="hljs-meta">@Max(value=120,message=&quot;å¹´é¾„æœ€å¤§ä¸èƒ½æŸ¥è¿‡120&quot;)</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br><span class="hljs-meta">@Email(message=&quot;é‚®ç®±æ ¼å¼é”™è¯¯&quot;)</span><br><span class="hljs-keyword">private</span> String email;<br><br>ç©ºæ£€æŸ¥<br><span class="hljs-meta">@Null</span>       éªŒè¯å¯¹è±¡æ˜¯å¦ä¸º<span class="hljs-keyword">null</span><br><span class="hljs-meta">@NotNull</span>    éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ä¸º<span class="hljs-keyword">null</span>, æ— æ³•æŸ¥æ£€é•¿åº¦ä¸º<span class="hljs-number">0</span>çš„å­—ç¬¦ä¸²<br><span class="hljs-meta">@NotBlank</span>   æ£€æŸ¥çº¦æŸå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯Nullè¿˜æœ‰è¢«Trimçš„é•¿åº¦æ˜¯å¦å¤§äº<span class="hljs-number">0</span>,åªå¯¹å­—ç¬¦ä¸²,ä¸”ä¼šå»æ‰å‰åç©ºæ ¼.<br><span class="hljs-meta">@NotEmpty</span>   æ£€æŸ¥çº¦æŸå…ƒç´ æ˜¯å¦ä¸ºNULLæˆ–è€…æ˜¯EMPTY.<br>    <br>Booelanæ£€æŸ¥<br><span class="hljs-meta">@AssertTrue</span>     éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º <span class="hljs-keyword">true</span>  <br><span class="hljs-meta">@AssertFalse</span>    éªŒè¯ Boolean å¯¹è±¡æ˜¯å¦ä¸º <span class="hljs-keyword">false</span>  <br>    <br>é•¿åº¦æ£€æŸ¥<br><span class="hljs-meta">@Size(min=, max=)</span> éªŒè¯å¯¹è±¡ï¼ˆArray,Collection,Map,Stringï¼‰é•¿åº¦æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´ä¹‹å†…  <br><span class="hljs-meta">@Length(min=, max=)</span> string is between min and max included.<br><br>æ—¥æœŸæ£€æŸ¥<br><span class="hljs-meta">@Past</span>       éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å‰  <br><span class="hljs-meta">@Future</span>     éªŒè¯ Date å’Œ Calendar å¯¹è±¡æ˜¯å¦åœ¨å½“å‰æ—¶é—´ä¹‹å  <br><span class="hljs-meta">@Pattern</span>    éªŒè¯ String å¯¹è±¡æ˜¯å¦ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™<br><br>.......ç­‰ç­‰<br>é™¤æ­¤ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ä¸€äº›æ•°æ®æ ¡éªŒè§„åˆ™<br></code></pre></td></tr></table></figure><h2 id="4-3-å¤šç¯å¢ƒåˆ‡æ¢"><a href="#4-3-å¤šç¯å¢ƒåˆ‡æ¢" class="headerlink" title="4.3 å¤šç¯å¢ƒåˆ‡æ¢"></a>4.3 å¤šç¯å¢ƒåˆ‡æ¢</h2><h3 id="4-3-1-å¤šé…ç½®æ–‡ä»¶"><a href="#4-3-1-å¤šé…ç½®æ–‡ä»¶" class="headerlink" title="4.3.1 å¤šé…ç½®æ–‡ä»¶"></a>4.3.1 å¤šé…ç½®æ–‡ä»¶</h3><p>æˆ‘ä»¬åœ¨ä¸»é…ç½®æ–‡ä»¶ç¼–å†™çš„æ—¶å€™ï¼Œæ–‡ä»¶åå¯ä»¥æ˜¯ application-{profile}.properties/yml , ç”¨æ¥æŒ‡å®šå¤šä¸ªç¯å¢ƒç‰ˆæœ¬ï¼›</p><p><strong>ä¾‹å¦‚ï¼š</strong></p><p>application-test.properties ä»£è¡¨æµ‹è¯•ç¯å¢ƒé…ç½®</p><p>application-dev.properties ä»£è¡¨å¼€å‘ç¯å¢ƒé…ç½®</p><p>ä½†æ˜¯Springbootå¹¶ä¸ä¼šç›´æ¥å¯åŠ¨è¿™äº›é…ç½®æ–‡ä»¶ï¼Œå®ƒ<strong>é»˜è®¤ä½¿ç”¨application.propertiesä¸»é…ç½®æ–‡ä»¶</strong>ï¼›</p><p>æˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªé…ç½®æ¥é€‰æ‹©éœ€è¦æ¿€æ´»çš„ç¯å¢ƒï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#æ¯”å¦‚åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šä½¿ç”¨devç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„ç«¯å£å·è¿›è¡Œæµ‹è¯•ï¼›</span><br><span class="hljs-comment">#æˆ‘ä»¬å¯åŠ¨SpringBootï¼Œå°±å¯ä»¥çœ‹åˆ°å·²ç»åˆ‡æ¢åˆ°devä¸‹çš„é…ç½®äº†ï¼›</span><br><span class="hljs-meta">spring.profiles.active</span>=<span class="hljs-string">dev</span><br></code></pre></td></tr></table></figure><h3 id="4-3-2-yamlçš„å¤šæ–‡æ¡£å—"><a href="#4-3-2-yamlçš„å¤šæ–‡æ¡£å—" class="headerlink" title="4.3.2 yamlçš„å¤šæ–‡æ¡£å—"></a>4.3.2 yamlçš„å¤šæ–‡æ¡£å—</h3><p>å’Œpropertiesé…ç½®æ–‡ä»¶ä¸­ä¸€æ ·ï¼Œä½†æ˜¯ä½¿ç”¨ymlå»å®ç°ä¸éœ€è¦åˆ›å»ºå¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œæ›´åŠ æ–¹ä¾¿äº† !</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span><br><span class="hljs-comment">#é€‰æ‹©è¦æ¿€æ´»é‚£ä¸ªç¯å¢ƒå—</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">prod</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8083</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">dev</span> <span class="hljs-comment">#é…ç½®ç¯å¢ƒçš„åç§°</span><br><br><br><span class="hljs-meta">---</span><br><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8084</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">prod</span>  <span class="hljs-comment">#é…ç½®ç¯å¢ƒçš„åç§°</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šå¦‚æœymlå’ŒpropertiesåŒæ—¶éƒ½é…ç½®äº†ç«¯å£ï¼Œå¹¶ä¸”æ²¡æœ‰æ¿€æ´»å…¶ä»–ç¯å¢ƒ ï¼Œ é»˜è®¤ä¼šä½¿ç”¨propertiesé…ç½®æ–‡ä»¶çš„ï¼</strong></p><h3 id="4-3-3-é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®"><a href="#4-3-3-é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®" class="headerlink" title="4.3.3 é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®"></a>4.3.3 é…ç½®æ–‡ä»¶åŠ è½½ä½ç½®</h3><p>springboot å¯åŠ¨ä¼šæ‰«æä»¥ä¸‹ä½ç½®çš„application.propertiesæˆ–è€…application.ymlæ–‡ä»¶ä½œä¸ºSpring bootçš„é»˜è®¤é…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">ä¼˜å…ˆçº§1ï¼šé¡¹ç›®è·¯å¾„ä¸‹çš„configæ–‡ä»¶å¤¹é…ç½®æ–‡ä»¶</span><br><span class="hljs-string">ä¼˜å…ˆçº§2ï¼šé¡¹ç›®è·¯å¾„ä¸‹é…ç½®æ–‡ä»¶</span><br><span class="hljs-string">ä¼˜å…ˆçº§3ï¼šèµ„æºè·¯å¾„ä¸‹çš„configæ–‡ä»¶å¤¹é…ç½®æ–‡ä»¶</span><br><span class="hljs-string">ä¼˜å…ˆçº§4ï¼šèµ„æºè·¯å¾„ä¸‹é…ç½®æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><p>ä¼˜å…ˆçº§ç”±é«˜åˆ°åº•ï¼Œé«˜ä¼˜å…ˆçº§çš„é…ç½®ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§çš„é…ç½®ï¼›</p><p><strong>SpringBootä¼šä»è¿™å››ä¸ªä½ç½®å…¨éƒ¨åŠ è½½ä¸»é…ç½®æ–‡ä»¶ï¼›äº’è¡¥é…ç½®ï¼›</strong></p><h3 id="æ‹“å±•ï¼Œè¿ç»´å°æŠ€å·§"><a href="#æ‹“å±•ï¼Œè¿ç»´å°æŠ€å·§" class="headerlink" title="æ‹“å±•ï¼Œè¿ç»´å°æŠ€å·§"></a>æ‹“å±•ï¼Œè¿ç»´å°æŠ€å·§</h3><p>æŒ‡å®šä½ç½®åŠ è½½é…ç½®æ–‡ä»¶</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡spring.config.locationæ¥æ”¹å˜é»˜è®¤çš„é…ç½®æ–‡ä»¶ä½ç½®</p><p>é¡¹ç›®æ‰“åŒ…å¥½ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°çš„å½¢å¼ï¼Œå¯åŠ¨é¡¹ç›®çš„æ—¶å€™æ¥æŒ‡å®šé…ç½®æ–‡ä»¶çš„æ–°ä½ç½®ï¼›è¿™ç§æƒ…å†µï¼Œä¸€èˆ¬æ˜¯åæœŸè¿ç»´åšçš„å¤šï¼Œç›¸åŒé…ç½®ï¼Œå¤–éƒ¨æŒ‡å®šçš„é…ç½®æ–‡ä»¶ä¼˜å…ˆçº§æœ€é«˜</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">java -jar spring-boot-<span class="hljs-built_in">config</span>.jar --spring.<span class="hljs-built_in">config</span>.location=F:/application.properties<br></code></pre></td></tr></table></figure><h1 id="äº”ã€è‡ªåŠ¨é…ç½®åŸç†"><a href="#äº”ã€è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="äº”ã€è‡ªåŠ¨é…ç½®åŸç†"></a>äº”ã€è‡ªåŠ¨é…ç½®åŸç†</h1><p>æœªèƒ½ç†è§£ï¼Œä»¥åè¡¥</p><h1 id="å…­ã€æ•´åˆJDBC"><a href="#å…­ã€æ•´åˆJDBC" class="headerlink" title="å…­ã€æ•´åˆJDBC"></a>å…­ã€æ•´åˆJDBC</h1><h2 id="æ•´åˆæ­¥éª¤"><a href="#æ•´åˆæ­¥éª¤" class="headerlink" title="æ•´åˆæ­¥éª¤"></a>æ•´åˆæ­¥éª¤</h2><p>æ–°å»ºé¡¹ç›®æ—¶ï¼Œå¼•å…¥ç›¸åº”çš„æ¨¡å—ï¼åŸºç¡€æ¨¡å—</p><p>é¡¹ç›®å»ºå¥½ä¹‹åï¼Œå‘ç°è‡ªåŠ¨å¸®æˆ‘ä»¬å¯¼å…¥äº†å¦‚ä¸‹çš„å¯åŠ¨å™¨ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¼–å†™é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span>  <br><span class="hljs-attr">datasource:</span>    <br><span class="hljs-attr">username:</span> <span class="hljs-string">root</span>    <br><span class="hljs-attr">password:</span> <span class="hljs-number">123456</span>    <br><span class="hljs-comment">#?serverTimezone=UTCè§£å†³æ—¶åŒºçš„æŠ¥é”™    </span><br><span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/springboot?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8</span>    <br><span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br></code></pre></td></tr></table></figure><p>é…ç½®å®Œè¿™ä¸€äº›ä¸œè¥¿åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å»ä½¿ç”¨äº†ï¼Œå› ä¸ºSpringBootå·²ç»é»˜è®¤å¸®æˆ‘ä»¬è¿›è¡Œäº†è‡ªåŠ¨é…ç½®</p><p>å»æµ‹è¯•ç±»æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringbootDataJdbcApplicationTests</span> </span>&#123;<br><br>    <span class="hljs-comment">//DIæ³¨å…¥æ•°æ®æº</span><br>    <span class="hljs-meta">@Autowired</span><br>    DataSource dataSource;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">contextLoads</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException </span>&#123;<br>        <span class="hljs-comment">//çœ‹ä¸€ä¸‹é»˜è®¤æ•°æ®æº</span><br>        System.out.println(dataSource.getClass());<br>        <span class="hljs-comment">//è·å¾—è¿æ¥</span><br>        Connection connection =   dataSource.getConnection();<br>        System.out.println(connection);<br>        <span class="hljs-comment">//å…³é—­è¿æ¥</span><br>        connection.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–é»˜è®¤ç»™æˆ‘ä»¬é…ç½®çš„æ•°æ®æºä¸º : class com.zaxxer.hikari.HikariDataSource</p><p><strong>HikariDataSource å·ç§° Java WEB å½“å‰é€Ÿåº¦æœ€å¿«çš„æ•°æ®æºï¼Œç›¸æ¯”äºä¼ ç»Ÿçš„ C3P0 ã€DBCPã€Tomcat jdbc ç­‰è¿æ¥æ± æ›´åŠ ä¼˜ç§€ï¼›</strong></p><p><strong>å¯ä»¥ä½¿ç”¨ spring.datasource.type æŒ‡å®šè‡ªå®šä¹‰çš„æ•°æ®æºç±»å‹ï¼Œå€¼ä¸º è¦ä½¿ç”¨çš„è¿æ¥æ± å®ç°çš„å®Œå…¨é™å®šåã€‚</strong></p><h2 id="JDBCTemplate"><a href="#JDBCTemplate" class="headerlink" title="JDBCTemplate"></a>JDBCTemplate</h2><p>1ã€æœ‰äº†æ•°æ®æº(com.zaxxer.hikari.HikariDataSource)ï¼Œç„¶åå¯ä»¥æ‹¿åˆ°æ•°æ®åº“è¿æ¥(java.sql.Connection)ï¼Œæœ‰äº†è¿æ¥ï¼Œå°±å¯ä»¥ä½¿ç”¨åŸç”Ÿçš„ JDBC è¯­å¥æ¥æ“ä½œæ•°æ®åº“ï¼›</p><p>2ã€å³ä½¿ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹ç¬¬æ•°æ®åº“æ“ä½œæ¡†æ¶ï¼Œå¦‚ MyBatisç­‰ï¼ŒSpring æœ¬èº«ä¹Ÿå¯¹åŸç”Ÿçš„JDBC åšäº†è½»é‡çº§çš„å°è£…ï¼Œå³JdbcTemplateã€‚</p><p>3ã€æ•°æ®åº“æ“ä½œçš„æ‰€æœ‰ CRUD æ–¹æ³•éƒ½åœ¨ JdbcTemplate ä¸­ã€‚</p><p>4ã€Spring Boot ä¸ä»…æä¾›äº†é»˜è®¤çš„æ•°æ®æºï¼ŒåŒæ—¶é»˜è®¤å·²ç»é…ç½®å¥½äº† JdbcTemplate æ”¾åœ¨äº†å®¹å™¨ä¸­ï¼Œç¨‹åºå‘˜åªéœ€è‡ªå·±æ³¨å…¥å³å¯ä½¿ç”¨</p><p>5ã€JdbcTemplate çš„è‡ªåŠ¨é…ç½®æ˜¯ä¾èµ– org.springframework.boot.autoconfigure.jdbc åŒ…ä¸‹çš„ JdbcTemplateConfiguration ç±»</p><p><strong>JdbcTemplateä¸»è¦æä¾›ä»¥ä¸‹å‡ ç±»æ–¹æ³•ï¼š</strong></p><ul><li>executeæ–¹æ³•ï¼šå¯ä»¥ç”¨äºæ‰§è¡Œä»»ä½•SQLè¯­å¥ï¼Œä¸€èˆ¬ç”¨äºæ‰§è¡ŒDDLè¯­å¥ï¼›</li><li>updateæ–¹æ³•åŠbatchUpdateæ–¹æ³•ï¼šupdateæ–¹æ³•ç”¨äºæ‰§è¡Œæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ç­‰è¯­å¥ï¼›batchUpdateæ–¹æ³•ç”¨äºæ‰§è¡Œæ‰¹å¤„ç†ç›¸å…³è¯­å¥ï¼›</li><li>queryæ–¹æ³•åŠqueryForXXXæ–¹æ³•ï¼šç”¨äºæ‰§è¡ŒæŸ¥è¯¢ç›¸å…³è¯­å¥ï¼›</li><li>callæ–¹æ³•ï¼šç”¨äºæ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ã€å‡½æ•°ç›¸å…³è¯­å¥ã€‚</li></ul><p>å‚è€ƒåŸæ–‡è¿æ¥ <a href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg2NTAzMTExNg==&hid=1&sn=3247dca1433a891523d9e4176c90c499">æ–‡ç« ç¬”è®°æ•´åˆã€ç‹‚ç¥è¯´ã€‘</a></p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
      <tag>å¾®æœåŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSMæ•´åˆ</title>
    <link href="/2021/01/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SSM%E6%95%B4%E5%90%88/"/>
    <url>/2021/01/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SSM%E6%95%B4%E5%90%88/</url>
    
    <content type="html"><![CDATA[<p>ç¯å¢ƒï¼š</p><ul><li><p>IDEA</p></li><li><p>MySQL 5.7.19</p></li><li><p>Tomcat 9</p></li><li><p>Maven 3.6</p><p>è¦æ±‚ï¼š</p></li><li><p>éœ€è¦ç†Ÿç»ƒæŒæ¡MySQLæ•°æ®åº“ï¼ŒSpringï¼ŒJavaWebåŠMyBatisçŸ¥è¯†ï¼Œç®€å•çš„å‰ç«¯çŸ¥è¯†ï¼›</p></li></ul><h1 id="ç¬¬ä¸€ä¸ªSSMæ•´åˆé¡¹ç›®"><a href="#ç¬¬ä¸€ä¸ªSSMæ•´åˆé¡¹ç›®" class="headerlink" title="ç¬¬ä¸€ä¸ªSSMæ•´åˆé¡¹ç›®"></a>ç¬¬ä¸€ä¸ªSSMæ•´åˆé¡¹ç›®</h1><p>å·²ä¸Šä¼ GitHubï¼š<a href="https://github.com/MCContinuing/SSMBuild">https://github.com/MCContinuing/SSMBuild</a></p><h2 id="æ•°æ®åº“è®¾è®¡"><a href="#æ•°æ®åº“è®¾è®¡" class="headerlink" title="æ•°æ®åº“è®¾è®¡"></a>æ•°æ®åº“è®¾è®¡</h2><p>åˆ›å»ºä¸€ä¸ªå­˜æ”¾ä¹¦ç±æ•°æ®çš„æ•°æ®åº“è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> <span class="hljs-string">`ssmbuild`</span>;<br><br><span class="hljs-keyword">USE</span> <span class="hljs-string">`ssmbuild`</span>;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`books`</span>;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`books`</span> (<br><span class="hljs-string">`bookID`</span> <span class="hljs-built_in">INT</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> AUTO_INCREMENT <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;ä¹¦id&#x27;</span>,<br><span class="hljs-string">`bookName`</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;ä¹¦å&#x27;</span>,<br><span class="hljs-string">`bookCounts`</span> <span class="hljs-built_in">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;æ•°é‡&#x27;</span>,<br><span class="hljs-string">`detail`</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;æè¿°&#x27;</span>,<br><span class="hljs-keyword">KEY</span> <span class="hljs-string">`bookID`</span> (<span class="hljs-string">`bookID`</span>)<br>) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">INNODB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8<br><br><span class="hljs-keyword">INSERT</span>  <span class="hljs-keyword">INTO</span> <span class="hljs-string">`books`</span>(<span class="hljs-string">`bookID`</span>,<span class="hljs-string">`bookName`</span>,<span class="hljs-string">`bookCounts`</span>,<span class="hljs-string">`detail`</span>)<span class="hljs-keyword">VALUES</span><br>(<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;Java&#x27;</span>,<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;ä»å…¥é—¨åˆ°æ”¾å¼ƒ&#x27;</span>),<br>(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;MySQL&#x27;</span>,<span class="hljs-number">10</span>,<span class="hljs-string">&#x27;ä»åˆ åº“åˆ°è·‘è·¯&#x27;</span>),<br>(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;Linux&#x27;</span>,<span class="hljs-number">5</span>,<span class="hljs-string">&#x27;ä»è¿›é—¨åˆ°è¿›ç‰¢&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="åŸºæœ¬ç¯å¢ƒæ­å»º"><a href="#åŸºæœ¬ç¯å¢ƒæ­å»º" class="headerlink" title="åŸºæœ¬ç¯å¢ƒæ­å»º"></a>åŸºæœ¬ç¯å¢ƒæ­å»º</h2><h3 id="é¡¹ç›®ä¾èµ–é…ç½®"><a href="#é¡¹ç›®ä¾èµ–é…ç½®" class="headerlink" title="é¡¹ç›®ä¾èµ–é…ç½®"></a>é¡¹ç›®ä¾èµ–é…ç½®</h3><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>SSMBuild<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--Junit--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--æ•°æ®åº“é©±åŠ¨--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><br>        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt;</span><br><span class="hljs-comment">&lt;!--        &lt;dependency&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--            &lt;groupId&gt;c3p0&lt;/groupId&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--            &lt;artifactId&gt;c3p0&lt;/artifactId&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--            &lt;version&gt;0.9.5.2&lt;/version&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--        &lt;/dependency&gt;--&gt;</span><br><br>        <span class="hljs-comment">&lt;!--Servlet - JSP --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.servlet<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>servlet-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.servlet<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jsp-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.servlet<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jstl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--Mybatis--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--Spring--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--    Mavenèµ„æºè¿‡æ»¤è®¾ç½®--&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å»ºç«‹åŸºæœ¬ç»“æ„å’Œé…ç½®æ¡†æ¶ï¼</p><ul><li><p>com.kuang.pojo</p></li><li><p>com.kuang.dao</p></li><li><p>com.kuang.service</p></li><li><p>com.kuang.controller</p></li><li><p>mybatis-config.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>applicationContext.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="æ•´åˆMybatiså±‚"><a href="#æ•´åˆMybatiså±‚" class="headerlink" title="æ•´åˆMybatiså±‚"></a>æ•´åˆMybatiså±‚</h3><p><img src="/2021/01/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SSM%E6%95%B4%E5%90%88/image-20210104173644472.png" alt="image-20210104173644472"></p><p>1ã€æ•°æ®åº“é…ç½®æ–‡ä»¶ <strong>database.properties</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">jdbc.driver=com.mysql.jdbc.Driver<br>jdbc.url=jdbc:mysql://localhost:3306/ssmbuild?useSSL=true&amp;useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai<br>jdbc.username=root<br>jdbc.password=admin<br></code></pre></td></tr></table></figure><p>2ã€IDEAå…³è”æ•°æ®åº“</p><p>3ã€ç¼–å†™MyBatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>   <br>   <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.kuang.pojo&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/mc/dao/BookMapper.xml&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€ç¼–å†™æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±» com.kuang.pojo.Books</p><p>ä½¿ç”¨lombokæ’ä»¶ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.pojo;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Books</span> </span>&#123;<br>   <br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> bookID;<br>   <span class="hljs-keyword">private</span> String bookName;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> bookCounts;<br>   <span class="hljs-keyword">private</span> String detail;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€ç¼–å†™Daoå±‚çš„ Mapperæ¥å£ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.Books;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookMapper</span> </span>&#123;<br><br>   <span class="hljs-comment">//å¢åŠ ä¸€ä¸ªBook</span><br>   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addBook</span><span class="hljs-params">(Books book)</span></span>;<br><br>   <span class="hljs-comment">//æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook</span><br>   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteBookById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br><br>   <span class="hljs-comment">//æ›´æ–°Book</span><br>   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateBook</span><span class="hljs-params">(Books books)</span></span>;<br><br>   <span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook</span><br>   <span class="hljs-function">Books <span class="hljs-title">queryBookById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br><br>   <span class="hljs-comment">//æŸ¥è¯¢å…¨éƒ¨Book,è¿”å›listé›†åˆ</span><br>   <span class="hljs-function">List&lt;Books&gt; <span class="hljs-title">queryAllBook</span><span class="hljs-params">()</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>6ã€ç¼–å†™æ¥å£å¯¹åº”çš„ Mapper.xml æ–‡ä»¶ã€‚éœ€è¦å¯¼å…¥MyBatisçš„åŒ…ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.mc.dao.BookMapper&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--å¢åŠ ä¸€ä¸ªBook--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addBook&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;Books&quot;</span>&gt;</span><br>      insert into ssmbuild.books(bookName,bookCounts,detail)<br>      values (#&#123;bookName&#125;, #&#123;bookCounts&#125;, #&#123;detail&#125;)<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteBookById&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span>&gt;</span><br>      delete from ssmbuild.books where bookID=#&#123;bookID&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--æ›´æ–°Book--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateBook&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;Books&quot;</span>&gt;</span><br>      update ssmbuild.books<br>      set bookName = #&#123;bookName&#125;,bookCounts = #&#123;bookCounts&#125;,detail = #&#123;detail&#125;<br>      where bookID = #&#123;bookID&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBookById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Books&quot;</span>&gt;</span><br>      select * from ssmbuild.books<br>      where bookID = #&#123;bookID&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--æŸ¥è¯¢å…¨éƒ¨Book--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryAllBook&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Books&quot;</span>&gt;</span><br>      SELECT * from ssmbuild.books<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>7ã€ç¼–å†™Serviceå±‚çš„æ¥å£å’Œå®ç°ç±»</p><p>æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.service;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.Books;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">//BookService:åº•ä¸‹éœ€è¦å»å®ç°,è°ƒç”¨daoå±‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookService</span> </span>&#123;<br>   <span class="hljs-comment">//å¢åŠ ä¸€ä¸ªBook</span><br>   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addBook</span><span class="hljs-params">(Books book)</span></span>;<br>   <span class="hljs-comment">//æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook</span><br>   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteBookById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br>   <span class="hljs-comment">//æ›´æ–°Book</span><br>   <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateBook</span><span class="hljs-params">(Books books)</span></span>;<br>   <span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook</span><br>   <span class="hljs-function">Books <span class="hljs-title">queryBookById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br>   <span class="hljs-comment">//æŸ¥è¯¢å…¨éƒ¨Book,è¿”å›listé›†åˆ</span><br>   <span class="hljs-function">List&lt;Books&gt; <span class="hljs-title">queryAllBook</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ç°ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.service;<br><br><span class="hljs-keyword">import</span> com.mc.dao.BookMapper;<br><span class="hljs-keyword">import</span> com.mc.pojo.Books;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">BookService</span> </span>&#123;<br><br>   <span class="hljs-comment">//è°ƒç”¨daoå±‚çš„æ“ä½œï¼Œè®¾ç½®ä¸€ä¸ªsetæ¥å£ï¼Œæ–¹ä¾¿Springç®¡ç†</span><br>   <span class="hljs-keyword">private</span> BookMapper bookMapper;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBookMapper</span><span class="hljs-params">(BookMapper bookMapper)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.bookMapper = bookMapper;<br>  &#125;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">addBook</span><span class="hljs-params">(Books book)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> bookMapper.addBook(book);<br>  &#125;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteBookById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> bookMapper.deleteBookById(id);<br>  &#125;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">updateBook</span><span class="hljs-params">(Books books)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> bookMapper.updateBook(books);<br>  &#125;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Books <span class="hljs-title">queryBookById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> bookMapper.queryBookById(id);<br>  &#125;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Books&gt; <span class="hljs-title">queryAllBook</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> bookMapper.queryAllBook();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>OKï¼Œåˆ°æ­¤ï¼Œåº•å±‚éœ€æ±‚æ“ä½œç¼–å†™å®Œæ¯•ï¼</strong></p><h3 id="æ•´åˆSpringå±‚"><a href="#æ•´åˆSpringå±‚" class="headerlink" title="æ•´åˆSpringå±‚"></a>æ•´åˆSpringå±‚</h3><p><img src="/2021/01/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SSM%E6%95%B4%E5%90%88/image-20210104180133489.png" alt="image-20210104180133489"></p><p>1ã€é…ç½®<strong>Springæ•´åˆMyBatis</strong>ï¼Œæˆ‘ä»¬è¿™é‡Œæ•°æ®æºä½¿ç”¨c3p0è¿æ¥æ± ï¼›</p><p>2ã€æˆ‘ä»¬å»ç¼–å†™Springæ•´åˆMybatisçš„ç›¸å…³çš„é…ç½®æ–‡ä»¶ï¼›spring-dao.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- é…ç½®æ•´åˆmybatis --&gt;</span><br>    <span class="hljs-comment">&lt;!-- 1.å…³è”æ•°æ®åº“æ–‡ä»¶ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;classpath:database.properties&quot;</span>/&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 2.æ•°æ®åº“è¿æ¥æ±  --&gt;</span><br>    <span class="hljs-comment">&lt;!--æ•°æ®åº“è¿æ¥æ± </span><br><span class="hljs-comment">        dbcp åŠè‡ªåŠ¨åŒ–æ“ä½œ ä¸èƒ½è‡ªåŠ¨è¿æ¥</span><br><span class="hljs-comment">        c3p0 è‡ªåŠ¨åŒ–æ“ä½œï¼ˆè‡ªåŠ¨çš„åŠ è½½é…ç½®æ–‡ä»¶ å¹¶ä¸”è®¾ç½®åˆ°å¯¹è±¡é‡Œé¢ï¼‰</span><br><span class="hljs-comment">        æ­¤å¤„ä½¿ç”¨c3p0</span><br><span class="hljs-comment">&lt;bean id=&quot;dataSource&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt;</span><br><span class="hljs-comment">        &lt;property name=&quot;driverClass&quot; value=&quot;$&#123;jdbc.driver&#125;&quot;/&gt;</span><br><span class="hljs-comment">        &lt;property name=&quot;jdbcUrl&quot; value=&quot;$&#123;jdbc.url&#125;&quot;/&gt;</span><br><span class="hljs-comment">        &lt;property name=&quot;user&quot; value=&quot;$&#123;jdbc.username&#125;&quot;/&gt;</span><br><span class="hljs-comment">        &lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc.password&#125;&quot;/&gt;</span><br><span class="hljs-comment">    &lt;/bean&gt;</span><br><span class="hljs-comment">    --&gt;</span><br><br>     <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;admin&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 3.é…ç½®SqlSessionFactoryå¯¹è±¡ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- æ³¨å…¥æ•°æ®åº“è¿æ¥æ±  --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!-- é…ç½®MyBatieså…¨å±€é…ç½®æ–‡ä»¶:mybatis-config.xml --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;configLocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 4.é…ç½®æ‰«æDaoæ¥å£åŒ…ï¼ŒåŠ¨æ€å®ç°Daoæ¥å£æ³¨å…¥åˆ°springå®¹å™¨ä¸­ --&gt;</span><br>    <span class="hljs-comment">&lt;!--è§£é‡Š ï¼šhttps://www.cnblogs.com/jpfss/p/7799806.html--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- æ³¨å…¥sqlSessionFactory --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!-- ç»™å‡ºéœ€è¦æ‰«æDaoæ¥å£åŒ… --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;basePackage&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mc.dao&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€<strong>Springæ•´åˆserviceå±‚</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 1ã€æ‰«æserviceç›¸å…³çš„bean --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.mc.service&quot;</span> /&gt;</span><br><br>    <span class="hljs-comment">&lt;!--2ã€BookServiceImplæ³¨å…¥åˆ°IOCå®¹å™¨ä¸­--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;BookServiceImpl&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mc.service.BookServiceImpl&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bookMapper&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;bookMapper&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!-- 3ã€é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- æ³¨å…¥æ•°æ®åº“è¿æ¥æ±  --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>Springå±‚æå®šï¼å†æ¬¡ç†è§£ä¸€ä¸‹ï¼ŒSpringå°±æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ï¼Œä¸€ä¸ªå®¹å™¨ï¼å¯¹å§ï¼</p><h3 id="æ•´åˆSpringMVC"><a href="#æ•´åˆSpringMVC" class="headerlink" title="æ•´åˆSpringMVC"></a>æ•´åˆSpringMVC</h3><p><img src="/2021/01/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SSM%E6%95%B4%E5%90%88/image-20210104181252316.png" alt="image-20210104181252316"></p><p>é¦–å…ˆè®©é¡¹ç›®æ”¯æŒWeb</p><p>1ã€<strong>web.xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--DispatcherServlet--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>           <span class="hljs-comment">&lt;!--ä¸€å®šè¦æ³¨æ„:æˆ‘ä»¬è¿™é‡ŒåŠ è½½çš„æ˜¯æ€»çš„é…ç½®æ–‡ä»¶ï¼Œä¹‹å‰è¢«è¿™é‡Œå‘äº†ï¼--&gt;</span>  <br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--encodingFilter--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span><br>          org.springframework.web.filter.CharacterEncodingFilter<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br>   <br>   <span class="hljs-comment">&lt;!--Sessionè¿‡æœŸæ—¶é—´--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">session-config</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">session-timeout</span>&gt;</span>15<span class="hljs-tag">&lt;/<span class="hljs-name">session-timeout</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">session-config</span>&gt;</span><br>   <br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€<strong>spring-mvc.xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:mvc</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">   http://www.springframework.org/schema/mvc</span></span><br><span class="hljs-tag"><span class="hljs-string">   https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!-- é…ç½®SpringMVC --&gt;</span><br>   <span class="hljs-comment">&lt;!-- 1.å¼€å¯SpringMVCæ³¨è§£é©±åŠ¨ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span> /&gt;</span><br>   <span class="hljs-comment">&lt;!-- 2.é™æ€èµ„æºé»˜è®¤servleté…ç½®--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mvc:default-servlet-handler</span>/&gt;</span><br><br>   <span class="hljs-comment">&lt;!-- 3.é…ç½®jsp æ˜¾ç¤ºViewResolverè§†å›¾è§£æå™¨ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewClass&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.JstlView&quot;</span> /&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span> /&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!-- 4.æ‰«æwebç›¸å…³çš„bean --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.kuang.controller&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€<strong>Springé…ç½®æ•´åˆæ–‡ä»¶ï¼ŒapplicationContext.xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;spring-dao.xml&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;spring-service.xml&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;spring-mvc.xml&quot;</span>/&gt;</span><br>   <br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®ç»“æŸï¼ï¼</p><h3 id="ä¸šåŠ¡åŠŸèƒ½ç¼–å†™"><a href="#ä¸šåŠ¡åŠŸèƒ½ç¼–å†™" class="headerlink" title="ä¸šåŠ¡åŠŸèƒ½ç¼–å†™"></a>ä¸šåŠ¡åŠŸèƒ½ç¼–å†™</h3><p><img src="/2021/01/04/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SSM%E6%95%B4%E5%90%88/image-20210108183836218.png" alt="image-20210108183836218"></p><p>1ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸€ï¼šæŸ¥è¯¢å…¨éƒ¨ä¹¦ç±</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/book&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookController</span> </span>&#123;<br><br>   <span class="hljs-meta">@Autowired</span><br>   <span class="hljs-meta">@Qualifier(&quot;BookServiceImpl&quot;)</span><br>   <span class="hljs-keyword">private</span> BookService bookService;<br><br>   <span class="hljs-meta">@RequestMapping(&quot;/allBook&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">list</span><span class="hljs-params">(Model model)</span> </span>&#123;<br>       List&lt;Books&gt; list = bookService.queryAllBook();<br>       model.addAttribute(<span class="hljs-string">&quot;list&quot;</span>, list);<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;allBook&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™é¦–é¡µ <strong>index.jsp</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">page</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;java&quot;</span> <span class="hljs-attr">contentType</span>=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span> <span class="hljs-attr">pageEncoding</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> %&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">HTML</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;</span><br>       a &#123;<br>           text-decoration: none;<br>           color: black;<br>           font-size: 18px;<br>      &#125;<br>       h3 &#123;<br>           width: 180px;<br>           height: 38px;<br>           margin: 100px auto;<br>           text-align: center;<br>           line-height: 38px;<br>           background: deepskyblue;<br>           border-radius: 4px;<br>      &#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/book/allBook&quot;</span>&gt;</span>ç‚¹å‡»è¿›å…¥åˆ—è¡¨é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€ä¹¦ç±åˆ—è¡¨é¡µé¢ <strong>allbook.jsp</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">taglib</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;c&quot;</span> <span class="hljs-attr">uri</span>=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">page</span> <span class="hljs-attr">contentType</span>=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;java&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ä¹¦ç±åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- å¼•å…¥ Bootstrap --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row clearfix&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-md-12 column&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-header&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>ä¹¦ç±åˆ—è¡¨ â€”â€” æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-md-4 column&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn btn-primary&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/book/toAddBook&quot;</span>&gt;</span>æ–°å¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row clearfix&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-md-12 column&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;table table-hover table-striped&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä¹¦ç±ç¼–å·<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä¹¦ç±åå­—<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä¹¦ç±æ•°é‡<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä¹¦ç±è¯¦æƒ…<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>æ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span><br><br>               <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">c:forEach</span> <span class="hljs-attr">var</span>=<span class="hljs-string">&quot;book&quot;</span> <span class="hljs-attr">items</span>=<span class="hljs-string">&quot;$&#123;requestScope.get(&#x27;list&#x27;)&#125;&quot;</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;book.getBookID()&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;book.getBookName()&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;book.getBookCounts()&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>$&#123;book.getDetail()&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                       <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><br>                           <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/book/toUpdateBook?id=$&#123;book.getBookID()&#125;&quot;</span>&gt;</span>æ›´æ”¹<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> |<br>                           <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/book/del/$&#123;book.getBookID()&#125;&quot;</span>&gt;</span>åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>                       <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                   <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">c:forEach</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•äºŒï¼šæ·»åŠ ä¹¦ç±</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/toAddBook&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toAddPaper</span><span class="hljs-params">()</span> </span>&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;addBook&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;/addBook&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">addPaper</span><span class="hljs-params">(Books books)</span> </span>&#123;<br>   System.out.println(books);<br>   bookService.addBook(books);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/book/allBook&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€æ·»åŠ ä¹¦ç±é¡µé¢ï¼š<strong>addBook.jsp</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;%@ taglib prefix=<span class="hljs-string">&quot;c&quot;</span> uri=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;<br>&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br><br>&lt;html&gt;<br>&lt;head&gt;<br>   &lt;title&gt;æ–°å¢ä¹¦ç±&lt;/title&gt;<br>   &lt;meta name=<span class="hljs-string">&quot;viewport&quot;</span> content=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;<br>   &lt;!-- å¼•å…¥ Bootstrap --&gt;<br>   &lt;link href=<span class="hljs-string">&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;container&quot;</span>&gt;<br><br>   &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;row clearfix&quot;</span>&gt;<br>       &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;col-md-12 column&quot;</span>&gt;<br>           &lt;div <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;page-header&quot;</span>&gt;<br>               &lt;h1&gt;<br>                   &lt;small&gt;æ–°å¢ä¹¦ç±&lt;/small&gt;<br>               &lt;/h1&gt;<br>           &lt;/div&gt;<br>       &lt;/div&gt;<br>   &lt;/div&gt;<br>   &lt;form action=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/book/addBook&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>      ä¹¦ç±åç§°ï¼š&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;bookName&quot;</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>      ä¹¦ç±æ•°é‡ï¼š&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;bookCounts&quot;</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>      ä¹¦ç±è¯¦æƒ…ï¼š&lt;input type=<span class="hljs-string">&quot;text&quot;</span> name=<span class="hljs-string">&quot;detail&quot;</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>       &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;æ·»åŠ &quot;</span>&gt;<br>   &lt;/form&gt;<br><br>&lt;/div&gt;<br></code></pre></td></tr></table></figure><p>6ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ä¹¦ç±</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/toUpdateBook&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toUpdateBook</span><span class="hljs-params">(Model model, <span class="hljs-keyword">int</span> id)</span> </span>&#123;<br>   Books books = bookService.queryBookById(id);<br>   System.out.println(books);<br>   model.addAttribute(<span class="hljs-string">&quot;book&quot;</span>,books );<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;updateBook&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">@RequestMapping(&quot;/updateBook&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">updateBook</span><span class="hljs-params">(Model model, Books book)</span> </span>&#123;<br>   System.out.println(book);<br>   bookService.updateBook(book);<br>   Books books = bookService.queryBookById(book.getBookID());<br>   model.addAttribute(<span class="hljs-string">&quot;books&quot;</span>, books);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/book/allBook&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>7ã€ä¿®æ”¹ä¹¦ç±é¡µé¢  <strong>updateBook.jsp</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">taglib</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">&quot;c&quot;</span> <span class="hljs-attr">uri</span>=<span class="hljs-string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">page</span> <span class="hljs-attr">contentType</span>=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;java&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ä¿®æ”¹ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- å¼•å…¥ Bootstrap --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row clearfix&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-md-12 column&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-header&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>ä¿®æ”¹ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/book/updateBook&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bookID&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;book.getBookID()&#125;&quot;</span>/&gt;</span><br>      ä¹¦ç±åç§°ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bookName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;book.getBookName()&#125;&quot;</span>/&gt;</span><br>      ä¹¦ç±æ•°é‡ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bookCounts&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;book.getBookCounts()&#125;&quot;</span>/&gt;</span><br>      ä¹¦ç±è¯¦æƒ…ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;detail&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;book.getDetail() &#125;&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æäº¤&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>8ã€BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•å››ï¼šåˆ é™¤ä¹¦ç±</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/del/&#123;bookId&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">deleteBook</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable(&quot;bookId&quot;)</span> <span class="hljs-keyword">int</span> id)</span> </span>&#123;<br>   bookService.deleteBookById(id);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/book/allBook&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="MVCæ‹¦æˆªå™¨"><a href="#MVCæ‹¦æˆªå™¨" class="headerlink" title="MVCæ‹¦æˆªå™¨"></a>MVCæ‹¦æˆªå™¨</h1><p>SpringMVCçš„å¤„ç†å™¨æ‹¦æˆªå™¨ç±»ä¼¼äºServletå¼€å‘ä¸­çš„è¿‡æ»¤å™¨Filter,ç”¨äºå¯¹å¤„ç†å™¨è¿›è¡Œé¢„å¤„ç†å’Œåå¤„ç†ã€‚å¼€å‘è€…å¯ä»¥è‡ªå·±å®šä¹‰ä¸€äº›æ‹¦æˆªå™¨æ¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p><strong>è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„åŒºåˆ«ï¼š</strong>æ‹¦æˆªå™¨æ˜¯AOPæ€æƒ³çš„å…·ä½“åº”ç”¨ã€‚</p><p><strong>è¿‡æ»¤å™¨</strong></p><ul><li>servletè§„èŒƒä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä»»ä½•java webå·¥ç¨‹éƒ½å¯ä»¥ä½¿ç”¨</li><li>åœ¨url-patternä¸­é…ç½®äº†/*ä¹‹åï¼Œå¯ä»¥å¯¹æ‰€æœ‰è¦è®¿é—®çš„èµ„æºè¿›è¡Œæ‹¦æˆª</li></ul><p><strong>æ‹¦æˆªå™¨</strong> </p><ul><li>æ‹¦æˆªå™¨æ˜¯SpringMVCæ¡†æ¶è‡ªå·±çš„ï¼Œåªæœ‰ä½¿ç”¨äº†SpringMVCæ¡†æ¶çš„å·¥ç¨‹æ‰èƒ½ä½¿ç”¨</li><li>æ‹¦æˆªå™¨åªä¼šæ‹¦æˆªè®¿é—®çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œ å¦‚æœè®¿é—®çš„æ˜¯jsp/html/css/image/jsæ˜¯ä¸ä¼šè¿›è¡Œæ‹¦æˆªçš„</li></ul><h2 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨</h2><p>é‚£å¦‚ä½•å®ç°æ‹¦æˆªå™¨å‘¢ï¼Ÿ</p><p>æƒ³è¦è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œå¿…é¡»å®ç° HandlerInterceptor æ¥å£ã€‚</p><p>1ã€æ–°å»ºä¸€ä¸ªMoudule ï¼Œ springmvc-07-Interceptor  ï¼Œ æ·»åŠ webæ”¯æŒ</p><p>2ã€é…ç½®web.xml å’Œ springmvc-servlet.xml æ–‡ä»¶</p><p>3ã€ç¼–å†™ä¸€ä¸ªæ‹¦æˆªå™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.interceptor;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br><br>   <span class="hljs-comment">//åœ¨è¯·æ±‚å¤„ç†çš„æ–¹æ³•ä¹‹å‰æ‰§è¡Œ</span><br>   <span class="hljs-comment">//å¦‚æœè¿”å›trueæ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨</span><br>   <span class="hljs-comment">//å¦‚æœè¿”å›falseå°±ä¸æ‰§è¡Œä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;------------å¤„ç†å‰------------&quot;</span>);<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>  &#125;<br><br>   <span class="hljs-comment">//åœ¨è¯·æ±‚å¤„ç†æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œ</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;------------å¤„ç†å------------&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-comment">//åœ¨dispatcherServletå¤„ç†åæ‰§è¡Œ,åšæ¸…ç†å·¥ä½œ.</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;------------æ¸…ç†------------&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€åœ¨springmvcçš„é…ç½®æ–‡ä»¶ä¸­é…ç½®æ‹¦æˆªå™¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å…³äºæ‹¦æˆªå™¨çš„é…ç½®--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--/** åŒ…æ‹¬è·¯å¾„åŠå…¶å­è·¯å¾„--&gt;</span><br>       <span class="hljs-comment">&lt;!--/admin/* æ‹¦æˆªçš„æ˜¯/admin/addç­‰ç­‰è¿™ç§ , /admin/add/userä¸ä¼šè¢«æ‹¦æˆª--&gt;</span><br>       <span class="hljs-comment">&lt;!--/admin/** æ‹¦æˆªçš„æ˜¯/admin/ä¸‹çš„æ‰€æœ‰--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/**&quot;</span>/&gt;</span><br>       <span class="hljs-comment">&lt;!--beané…ç½®çš„å°±æ˜¯æ‹¦æˆªå™¨--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.interceptor.MyInterceptor&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span><br></code></pre></td></tr></table></figure><p>5ã€ç¼–å†™ä¸€ä¸ªControllerï¼Œæ¥æ”¶è¯·æ±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;<br><br><span class="hljs-comment">//æµ‹è¯•æ‹¦æˆªå™¨çš„æ§åˆ¶å™¨</span><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InterceptorController</span> </span>&#123;<br><br>   <span class="hljs-meta">@RequestMapping(&quot;/interceptor&quot;)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">testFunction</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æ§åˆ¶å™¨ä¸­çš„æ–¹æ³•æ‰§è¡Œäº†&quot;</span>);<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>6ã€å‰ç«¯ index.jsp</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/interceptor&quot;</span>&gt;</span>æ‹¦æˆªå™¨æµ‹è¯•<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>7ã€å¯åŠ¨tomcat æµ‹è¯•ä¸€ä¸‹ï¼</p><h2 id="éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•-è®¤è¯ç”¨æˆ·"><a href="#éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½•-è®¤è¯ç”¨æˆ·" class="headerlink" title="éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• (è®¤è¯ç”¨æˆ·)"></a>éªŒè¯ç”¨æˆ·æ˜¯å¦ç™»å½• (è®¤è¯ç”¨æˆ·)</h2><p><strong>å®ç°æ€è·¯</strong></p><p>1ã€æœ‰ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œéœ€è¦å†™ä¸€ä¸ªcontrollerè®¿é—®é¡µé¢ã€‚</p><p>2ã€ç™»é™†é¡µé¢æœ‰ä¸€æäº¤è¡¨å•çš„åŠ¨ä½œã€‚éœ€è¦åœ¨controllerä¸­å¤„ç†ã€‚åˆ¤æ–­ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœæ­£ç¡®ï¼Œå‘sessionä¸­å†™å…¥ç”¨æˆ·ä¿¡æ¯ã€‚<em>è¿”å›ç™»é™†æˆåŠŸã€‚</em></p><p>3ã€æ‹¦æˆªç”¨æˆ·è¯·æ±‚ï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†ã€‚å¦‚æœç”¨æˆ·å·²ç»ç™»é™†ã€‚æ”¾è¡Œï¼Œ å¦‚æœç”¨æˆ·æœªç™»é™†ï¼Œè·³è½¬åˆ°ç™»é™†é¡µé¢</p><p><strong>æµ‹è¯•ï¼š</strong></p><p>1ã€ç¼–å†™ä¸€ä¸ªç™»é™†é¡µé¢  login.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">page</span> <span class="hljs-attr">contentType</span>=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;java&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/user/login&quot;</span>&gt;</span><br>  ç”¨æˆ·åï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>  å¯†ç ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pwd&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æäº¤&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™ä¸€ä¸ªControllerå¤„ç†è¯·æ±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> </span>&#123;<br><br>   <span class="hljs-comment">//è·³è½¬åˆ°ç™»é™†é¡µé¢</span><br>   <span class="hljs-meta">@RequestMapping(&quot;/jumplogin&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">jumpLogin</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;login&quot;</span>;<br>  &#125;<br><br>   <span class="hljs-comment">//è·³è½¬åˆ°æˆåŠŸé¡µé¢</span><br>   <span class="hljs-meta">@RequestMapping(&quot;/jumpSuccess&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">jumpSuccess</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>  &#125;<br><br>   <span class="hljs-comment">//ç™»é™†æäº¤</span><br>   <span class="hljs-meta">@RequestMapping(&quot;/login&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">login</span><span class="hljs-params">(HttpSession session, String username, String pwd)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">// å‘sessionè®°å½•ç”¨æˆ·èº«ä»½ä¿¡æ¯</span><br>       System.out.println(<span class="hljs-string">&quot;æ¥æ”¶å‰ç«¯===&quot;</span>+username);<br>       session.setAttribute(<span class="hljs-string">&quot;user&quot;</span>, username);<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;success&quot;</span>;<br>  &#125;<br><br>   <span class="hljs-comment">//é€€å‡ºç™»é™†</span><br>   <span class="hljs-meta">@RequestMapping(&quot;logout&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">logout</span><span class="hljs-params">(HttpSession session)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">// session è¿‡æœŸ</span><br>       session.invalidate();<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;login&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€ç¼–å†™ä¸€ä¸ªç™»é™†æˆåŠŸçš„é¡µé¢ success.jsp</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">page</span> <span class="hljs-attr">contentType</span>=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;java&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•æˆåŠŸé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><br>$&#123;user&#125;<br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/user/logout&quot;</span>&gt;</span>æ³¨é”€<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€åœ¨ index é¡µé¢ä¸Šæµ‹è¯•è·³è½¬ï¼å¯åŠ¨Tomcat æµ‹è¯•ï¼Œæœªç™»å½•ä¹Ÿå¯ä»¥è¿›å…¥ä¸»é¡µï¼</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">%@</span> <span class="hljs-attr">page</span> <span class="hljs-attr">contentType</span>=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;java&quot;</span> %&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>$Title$<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">%--ç™»å½•--%</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/user/jumplogin&quot;</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;$&#123;pageContext.request.contextPath&#125;/user/jumpSuccess&quot;</span>&gt;</span>æˆåŠŸé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>5ã€ç¼–å†™ç”¨æˆ·ç™»å½•æ‹¦æˆªå™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.interceptor;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> ServletException, IOException </span>&#123;<br>       <span class="hljs-comment">// å¦‚æœæ˜¯ç™»é™†é¡µé¢åˆ™æ”¾è¡Œ</span><br>       System.out.println(<span class="hljs-string">&quot;uri: &quot;</span> + request.getRequestURI());<br>       <span class="hljs-keyword">if</span> (request.getRequestURI().contains(<span class="hljs-string">&quot;login&quot;</span>)) &#123;<br>           <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>      &#125;<br><br>       HttpSession session = request.getSession();<br><br>       <span class="hljs-comment">// å¦‚æœç”¨æˆ·å·²ç™»é™†ä¹Ÿæ”¾è¡Œ</span><br>       <span class="hljs-keyword">if</span>(session.getAttribute(<span class="hljs-string">&quot;user&quot;</span>) != <span class="hljs-keyword">null</span>) &#123;<br>           <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>      &#125;<br><br>       <span class="hljs-comment">// ç”¨æˆ·æ²¡æœ‰ç™»é™†è·³è½¬åˆ°ç™»é™†é¡µé¢</span><br>       request.getRequestDispatcher(<span class="hljs-string">&quot;/WEB-INF/jsp/login.jsp&quot;</span>).forward(request, response);<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postHandle</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>  &#125;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterCompletion</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>6ã€åœ¨Springmvcçš„é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œæ‹¦æˆªå™¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å…³äºæ‹¦æˆªå™¨çš„é…ç½®--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/**&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;loginInterceptor&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.interceptor.LoginInterceptor&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span><br></code></pre></td></tr></table></figure><p>7ã€å†æ¬¡é‡å¯Tomcatæµ‹è¯•ï¼</p><p><strong>OKï¼Œæµ‹è¯•ç™»å½•æ‹¦æˆªåŠŸèƒ½æ— è¯¯.</strong></p><h1 id="æ–‡ä»¶ä¸Šä¼ ä¸‹è½½"><a href="#æ–‡ä»¶ä¸Šä¼ ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¸‹è½½"></a>æ–‡ä»¶ä¸Šä¼ ä¸‹è½½</h1><p>æ–‡ä»¶ä¸Šä¼ æ˜¯é¡¹ç›®å¼€å‘ä¸­æœ€å¸¸è§çš„åŠŸèƒ½ä¹‹ä¸€ ,springMVC å¯ä»¥å¾ˆå¥½çš„æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯SpringMVCä¸Šä¸‹æ–‡ä¸­é»˜è®¤æ²¡æœ‰è£…é…MultipartResolverï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹å…¶ä¸èƒ½å¤„ç†æ–‡ä»¶ä¸Šä¼ å·¥ä½œã€‚å¦‚æœæƒ³ä½¿ç”¨Springçš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­é…ç½®MultipartResolverã€‚</p><p>å‰ç«¯è¡¨å•è¦æ±‚ï¼šä¸ºäº†èƒ½ä¸Šä¼ æ–‡ä»¶ï¼Œå¿…é¡»å°†è¡¨å•çš„methodè®¾ç½®ä¸ºPOSTï¼Œå¹¶å°†enctypeè®¾ç½®ä¸ºmultipart/form-dataã€‚åªæœ‰åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ‰ä¼šæŠŠç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶ä»¥äºŒè¿›åˆ¶æ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼›</p><p><strong>å¯¹è¡¨å•ä¸­çš„ enctype å±æ€§åšä¸ªè¯¦ç»†çš„è¯´æ˜ï¼š</strong></p><ul><li>application/x-www=form-urlencodedï¼šé»˜è®¤æ–¹å¼ï¼Œåªå¤„ç†è¡¨å•åŸŸä¸­çš„ value å±æ€§å€¼ï¼Œé‡‡ç”¨è¿™ç§ç¼–ç æ–¹å¼çš„è¡¨å•ä¼šå°†è¡¨å•åŸŸä¸­çš„å€¼å¤„ç†æˆ URL ç¼–ç æ–¹å¼ã€‚</li><li>multipart/form-dataï¼šè¿™ç§ç¼–ç æ–¹å¼ä¼šä»¥äºŒè¿›åˆ¶æµçš„æ–¹å¼æ¥å¤„ç†è¡¨å•æ•°æ®ï¼Œè¿™ç§ç¼–ç æ–¹å¼ä¼šæŠŠæ–‡ä»¶åŸŸæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ä¹Ÿå°è£…åˆ°è¯·æ±‚å‚æ•°ä¸­ï¼Œä¸ä¼šå¯¹å­—ç¬¦ç¼–ç ã€‚</li><li>text/plainï¼šé™¤äº†æŠŠç©ºæ ¼è½¬æ¢ä¸º â€œ+â€ å·å¤–ï¼Œå…¶ä»–å­—ç¬¦éƒ½ä¸åšç¼–ç å¤„ç†ï¼Œè¿™ç§æ–¹å¼é€‚ç”¨ç›´æ¥é€šè¿‡è¡¨å•å‘é€é‚®ä»¶ã€‚</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸€æ—¦è®¾ç½®äº†enctypeä¸ºmultipart/form-dataï¼Œæµè§ˆå™¨å³ä¼šé‡‡ç”¨äºŒè¿›åˆ¶æµçš„æ–¹å¼æ¥å¤„ç†è¡¨å•æ•°æ®ï¼Œè€Œå¯¹äºæ–‡ä»¶ä¸Šä¼ çš„å¤„ç†åˆ™æ¶‰åŠåœ¨æœåŠ¡å™¨ç«¯è§£æåŸå§‹çš„HTTPå“åº”ã€‚åœ¨2003å¹´ï¼ŒApache Software Foundationå‘å¸ƒäº†å¼€æºçš„Commons FileUploadç»„ä»¶ï¼Œå…¶å¾ˆå¿«æˆä¸ºServlet/JSPç¨‹åºå‘˜ä¸Šä¼ æ–‡ä»¶çš„æœ€ä½³é€‰æ‹©ã€‚</p><ul><li>Servlet3.0è§„èŒƒå·²ç»æä¾›æ–¹æ³•æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œä½†è¿™ç§ä¸Šä¼ éœ€è¦åœ¨Servletä¸­å®Œæˆã€‚</li><li>è€ŒSpring MVCåˆ™æä¾›äº†æ›´ç®€å•çš„å°è£…ã€‚</li><li>Spring MVCä¸ºæ–‡ä»¶ä¸Šä¼ æä¾›äº†ç›´æ¥çš„æ”¯æŒï¼Œè¿™ç§æ”¯æŒæ˜¯ç”¨å³æ’å³ç”¨çš„MultipartResolverå®ç°çš„ã€‚</li><li>Spring MVCä½¿ç”¨Apache Commons FileUploadæŠ€æœ¯å®ç°äº†ä¸€ä¸ªMultipartResolverå®ç°ç±»ï¼š</li><li>CommonsMultipartResolverã€‚å› æ­¤ï¼ŒSpringMVCçš„æ–‡ä»¶ä¸Šä¼ è¿˜éœ€è¦ä¾èµ–Apache Commons FileUploadçš„ç»„ä»¶ã€‚</li></ul><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p>1ã€å¯¼å…¥æ–‡ä»¶ä¸Šä¼ çš„jaråŒ…ï¼Œcommons-fileupload ï¼Œ Mavenä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¯¼å…¥ä»–çš„ä¾èµ–åŒ… commons-ioåŒ…ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æ–‡ä»¶ä¸Šä¼ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-fileupload<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--servlet-apiå¯¼å…¥é«˜ç‰ˆæœ¬çš„--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.servlet<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.servlet-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€é…ç½®beanï¼šmultipartResolver</p><p>ã€<strong>æ³¨æ„ï¼ï¼ï¼è¿™ä¸ªbenaçš„idå¿…é¡»ä¸ºï¼šmultipartResolver ï¼Œ å¦åˆ™ä¸Šä¼ æ–‡ä»¶ä¼šæŠ¥400çš„é”™è¯¯ï¼åœ¨è¿™é‡Œæ ½è¿‡å‘,æ•™è®­ï¼</strong>ã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æ–‡ä»¶ä¸Šä¼ é…ç½®--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;multipartResolver&quot;</span>  <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- è¯·æ±‚çš„ç¼–ç æ ¼å¼ï¼Œå¿…é¡»å’ŒjSPçš„pageEncodingå±æ€§ä¸€è‡´ï¼Œä»¥ä¾¿æ­£ç¡®è¯»å–è¡¨å•çš„å†…å®¹ï¼Œé»˜è®¤ä¸ºISO-8859-1 --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultEncoding&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;utf-8&quot;</span>/&gt;</span><br>   <span class="hljs-comment">&lt;!-- ä¸Šä¼ æ–‡ä»¶å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼ˆ10485760=10Mï¼‰ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxUploadSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10485760&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxInMemorySize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;40960&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>CommonsMultipartFile çš„ å¸¸ç”¨æ–¹æ³•ï¼š</p><ul><li><p><strong>String getOriginalFilename()ï¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„åŸå</strong></p></li><li><p><strong>InputStream getInputStream()ï¼šè·å–æ–‡ä»¶æµ</strong></p></li><li><p><strong>void transferTo(File dest)ï¼šå°†ä¸Šä¼ æ–‡ä»¶ä¿å­˜åˆ°ä¸€ä¸ªç›®å½•æ–‡ä»¶ä¸­</strong></p><p>æˆ‘ä»¬å»å®é™…æµ‹è¯•ä¸€ä¸‹</p></li></ul><p>3ã€ç¼–å†™å‰ç«¯é¡µé¢</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/upload&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;upload&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€<strong>Controller</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><span class="hljs-keyword">import</span> org.springframework.web.multipart.commons.CommonsMultipartFile;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileController</span> </span>&#123;<br>   <span class="hljs-comment">//@RequestParam(&quot;file&quot;) å°†name=fileæ§ä»¶å¾—åˆ°çš„æ–‡ä»¶å°è£…æˆCommonsMultipartFile å¯¹è±¡</span><br>   <span class="hljs-comment">//æ‰¹é‡ä¸Šä¼ CommonsMultipartFileåˆ™ä¸ºæ•°ç»„å³å¯</span><br>   <span class="hljs-meta">@RequestMapping(&quot;/upload&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">fileUpload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> CommonsMultipartFile file , HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br><br>       <span class="hljs-comment">//è·å–æ–‡ä»¶å : file.getOriginalFilename();</span><br>       String uploadFileName = file.getOriginalFilename();<br><br>       <span class="hljs-comment">//å¦‚æœæ–‡ä»¶åä¸ºç©ºï¼Œç›´æ¥å›åˆ°é¦–é¡µï¼</span><br>       <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;&quot;</span>.equals(uploadFileName))&#123;<br>           <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/index.jsp&quot;</span>;<br>      &#125;<br>       System.out.println(<span class="hljs-string">&quot;ä¸Šä¼ æ–‡ä»¶å : &quot;</span>+uploadFileName);<br><br>       <span class="hljs-comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span><br>       String path = request.getServletContext().getRealPath(<span class="hljs-string">&quot;/upload&quot;</span>);<br>       <span class="hljs-comment">//å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ª</span><br>       File realPath = <span class="hljs-keyword">new</span> File(path);<br>       <span class="hljs-keyword">if</span> (!realPath.exists())&#123;<br>           realPath.mkdir();<br>      &#125;<br>       System.out.println(<span class="hljs-string">&quot;ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š&quot;</span>+realPath);<br><br>       InputStream is = file.getInputStream(); <span class="hljs-comment">//æ–‡ä»¶è¾“å…¥æµ</span><br>       OutputStream os = <span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-keyword">new</span> File(realPath,uploadFileName)); <span class="hljs-comment">//æ–‡ä»¶è¾“å‡ºæµ</span><br><br>       <span class="hljs-comment">//è¯»å–å†™å‡º</span><br>       <span class="hljs-keyword">int</span> len=<span class="hljs-number">0</span>;<br>       <span class="hljs-keyword">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];<br>       <span class="hljs-keyword">while</span> ((len=is.read(buffer))!=-<span class="hljs-number">1</span>)&#123;<br>           os.write(buffer,<span class="hljs-number">0</span>,len);<br>           os.flush();<br>      &#125;<br>       os.close();<br>       is.close();<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/index.jsp&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ä¸Šä¼ æ–‡ä»¶ï¼ŒOKï¼</p><p><strong>é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</strong></p><p>1ã€ç¼–å†™Controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">* é‡‡ç”¨file.Transto æ¥ä¿å­˜ä¸Šä¼ çš„æ–‡ä»¶</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@RequestMapping(&quot;/upload2&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String  <span class="hljs-title">fileUpload2</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> CommonsMultipartFile file, HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br><br>   <span class="hljs-comment">//ä¸Šä¼ è·¯å¾„ä¿å­˜è®¾ç½®</span><br>   String path = request.getServletContext().getRealPath(<span class="hljs-string">&quot;/upload&quot;</span>);<br>   File realPath = <span class="hljs-keyword">new</span> File(path);<br>   <span class="hljs-keyword">if</span> (!realPath.exists())&#123;<br>       realPath.mkdir();<br>  &#125;<br>   <span class="hljs-comment">//ä¸Šä¼ æ–‡ä»¶åœ°å€</span><br>   System.out.println(<span class="hljs-string">&quot;ä¸Šä¼ æ–‡ä»¶ä¿å­˜åœ°å€ï¼š&quot;</span>+realPath);<br><br>   <span class="hljs-comment">//é€šè¿‡CommonsMultipartFileçš„æ–¹æ³•ç›´æ¥å†™æ–‡ä»¶ï¼ˆæ³¨æ„è¿™ä¸ªæ—¶å€™ï¼‰</span><br>   file.transferTo(<span class="hljs-keyword">new</span> File(realPath +<span class="hljs-string">&quot;/&quot;</span>+ file.getOriginalFilename()));<br><br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/index.jsp&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€å‰ç«¯è¡¨å•æäº¤åœ°å€ä¿®æ”¹</p><p>3ã€è®¿é—®æäº¤æµ‹è¯•ï¼ŒOKï¼</p><h2 id="æ–‡ä»¶ä¸‹è½½"><a href="#æ–‡ä»¶ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸‹è½½"></a>æ–‡ä»¶ä¸‹è½½</h2><p><strong>æ–‡ä»¶ä¸‹è½½æ­¥éª¤ï¼š</strong></p><p>1ã€è®¾ç½® response å“åº”å¤´</p><p>2ã€è¯»å–æ–‡ä»¶ â€“ InputStream</p><p>3ã€å†™å‡ºæ–‡ä»¶ â€“ OutputStream</p><p>4ã€æ‰§è¡Œæ“ä½œ</p><p>5ã€å…³é—­æµ ï¼ˆå…ˆå¼€åå…³ï¼‰</p><p><strong>ä»£ç å®ç°ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value=&quot;/download&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">downloads</span><span class="hljs-params">(HttpServletResponse response ,HttpServletRequest request)</span> <span class="hljs-keyword">throws</span> Exception</span>&#123;<br>   <span class="hljs-comment">//è¦ä¸‹è½½çš„å›¾ç‰‡åœ°å€</span><br>   String  path = request.getServletContext().getRealPath(<span class="hljs-string">&quot;/upload&quot;</span>);<br>   String  fileName = <span class="hljs-string">&quot;åŸºç¡€è¯­æ³•.jpg&quot;</span>;<br><br>   <span class="hljs-comment">//1ã€è®¾ç½®response å“åº”å¤´</span><br>   response.reset(); <span class="hljs-comment">//è®¾ç½®é¡µé¢ä¸ç¼“å­˜,æ¸…ç©ºbuffer</span><br>   response.setCharacterEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>); <span class="hljs-comment">//å­—ç¬¦ç¼–ç </span><br>   response.setContentType(<span class="hljs-string">&quot;multipart/form-data&quot;</span>); <span class="hljs-comment">//äºŒè¿›åˆ¶ä¼ è¾“æ•°æ®</span><br>   <span class="hljs-comment">//è®¾ç½®å“åº”å¤´</span><br>   response.setHeader(<span class="hljs-string">&quot;Content-Disposition&quot;</span>,<br>           <span class="hljs-string">&quot;attachment;fileName=&quot;</span>+URLEncoder.encode(fileName, <span class="hljs-string">&quot;UTF-8&quot;</span>));<br><br>   File file = <span class="hljs-keyword">new</span> File(path,fileName);<br>   <span class="hljs-comment">//2ã€ è¯»å–æ–‡ä»¶--è¾“å…¥æµ</span><br>   InputStream input=<span class="hljs-keyword">new</span> FileInputStream(file);<br>   <span class="hljs-comment">//3ã€ å†™å‡ºæ–‡ä»¶--è¾“å‡ºæµ</span><br>   OutputStream out = response.getOutputStream();<br><br>   <span class="hljs-keyword">byte</span>[] buff =<span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];<br>   <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>   <span class="hljs-comment">//4ã€æ‰§è¡Œ å†™å‡ºæ“ä½œ</span><br>   <span class="hljs-keyword">while</span>((index= input.read(buff))!= -<span class="hljs-number">1</span>)&#123;<br>       out.write(buff, <span class="hljs-number">0</span>, index);<br>       out.flush();<br>  &#125;<br>   out.close();<br>   input.close();<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‰ç«¯</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/download&quot;</span>&gt;</span>ç‚¹å‡»ä¸‹è½½<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼Œæ–‡ä»¶ä¸‹è½½OKï¼Œå¤§å®¶å¯ä»¥å’Œæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„JavaWebåŸç”Ÿçš„æ–¹å¼å¯¹æ¯”ä¸€ä¸‹ï¼Œå°±å¯ä»¥çŸ¥é“è¿™ä¸ªä¾¿æ·å¤šäº†!</p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringMVCé‡åˆ°çš„é—®é¢˜</title>
    <link href="/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <url>/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="ã€ideaé—®é¢˜-è¿æ¥Tomcatã€‘"><a href="#ã€ideaé—®é¢˜-è¿æ¥Tomcatã€‘" class="headerlink" title="ã€ideaé—®é¢˜-è¿æ¥Tomcatã€‘"></a>ã€ideaé—®é¢˜-è¿æ¥Tomcatã€‘</h2><p><img src="/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201228101621847.png" alt="image-20201228101621847"></p><p>è‹¥application serveä¸­æ²¡æœ‰Tomcatç‚¹å‡»Configureè‡ªè¡Œå¯»æ‰¾æ–‡ä»¶å¤¹</p><p><img src="/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201228101745465.png" alt="image-20201228101745465"></p><p>ã€ideaé—®é¢˜-å‡ºç°404é—®é¢˜ã€‘</p><ol><li><p>æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼Œçœ‹ä¸€ä¸‹æ˜¯ä¸æ˜¯ç¼ºå°‘äº†ä»€ä¹ˆjaråŒ…ã€‚</p></li><li><p>å¦‚æœjaråŒ…å­˜åœ¨ï¼Œæ˜¾ç¤ºæ— æ³•è¾“å‡ºï¼Œå°±åœ¨IDEAçš„é¡¹ç›®å‘å¸ƒä¸­ï¼Œæ·»åŠ libä¾èµ–ï¼</p></li><li><p>é‡å¯Tomcat å³å¯è§£å†³ï¼</p><p><img src="/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201228102702913.png" alt="image-20201228102702913"></p><p>æ·»åŠ jaråŒ…</p><p><img src="/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201228102457438.png" alt="image-20201228102457438"></p></li></ol><p>æ·»åŠ æ‰€æœ‰çš„åŒ…</p><p><img src="/2020/12/28/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201228102824206.png" alt="image-20201228102824206"></p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é—®é¢˜è®°å½•</tag>
      
      <tag>SSM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringMVCå­¦ä¹ ç¬”è®°</title>
    <link href="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/"/>
    <url>/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/</url>
    
    <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg2NTAzMTExNg==&hid=3&sn=456dc4d66f0726730757e319ffdaa23e&scene=1&devicetype=android-28&version=27001135&lang=zh_CN&nettype=cmnet&ascene=7&session_us=gh_1dd456f1d44d&wx_header=1">æ–‡ç« ç¬”è®°æ•´åˆã€ç‹‚ç¥è¯´ã€‘</a></p><h1 id="ä¸€ã€ç¬¬ä¸€ä¸ªspringMVCé¡¹ç›®"><a href="#ä¸€ã€ç¬¬ä¸€ä¸ªspringMVCé¡¹ç›®" class="headerlink" title="ä¸€ã€ç¬¬ä¸€ä¸ªspringMVCé¡¹ç›®"></a>ä¸€ã€ç¬¬ä¸€ä¸ªspringMVCé¡¹ç›®</h1><h2 id="1-1-ç†è§£åŸç†ç‰ˆé¡¹ç›®"><a href="#1-1-ç†è§£åŸç†ç‰ˆé¡¹ç›®" class="headerlink" title="1.1 ç†è§£åŸç†ç‰ˆé¡¹ç›®"></a>1.1 ç†è§£åŸç†ç‰ˆé¡¹ç›®</h2><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/image-20201228103653694.png" alt="image-20201228103653694"></p><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>moc.mc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>SpringMVC<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modules</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>mvc01<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        junit--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        mybatis--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        mysql-connector-java--&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        springç›¸å…³--&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        aspectJ AOP ç»‡å…¥å™¨--&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--        mybatis-springæ•´åˆåŒ… ã€é‡ç‚¹ã€‘--&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--    é…ç½®Mavené™æ€èµ„æºè¿‡æ»¤é—®é¢˜ï¼--&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>web/WEB-INF/web.xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--1.æ³¨å†ŒDispatcherServlet--&gt;</span><br>     <span class="hljs-comment">&lt;!--1.è¿™ä¸ªæ˜¯Servletçš„æ ¸å¿ƒ,è¯·æ±‚åˆ†å‘å™¨ï¼Œå‰ç«¯æ§åˆ¶å™¨ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šèµ°Servlet--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--DispatcherServletè¦ç»‘å®šé…ç½®æ–‡ä»¶--&gt;</span><br>        <span class="hljs-comment">&lt;!--å…³è”ä¸€ä¸ªspringmvcçš„é…ç½®æ–‡ä»¶:ã€servlet-nameã€‘-servlet.xml--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--classpathå½“å‰ç±»æ‰€æœ‰è·¯å¾„ï¼Œclasspath*æ‰€æœ‰åŒ…ä¸‹æ‰¾--&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--å¯åŠ¨çº§åˆ«-1ï¼šä¸æœåŠ¡å™¨ä¸€å—å¯åŠ¨--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--/ åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆä¸åŒ…æ‹¬.jspï¼‰--&gt;</span><br>    <span class="hljs-comment">&lt;!--/* åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆåŒ…æ‹¬.jspï¼‰--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>com/mc/controller/HelloController.java</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">package</span> com.mc.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ModelAndView;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.mvc.Controller;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-comment">//æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬å…ˆå¯¼å…¥Controlleræ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Controller</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">handleRequest</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-comment">//ModelAndView æ¨¡å‹å’Œè§†å›¾</span><br>        <span class="hljs-comment">//è¿”å›ModelAndViewäº¤ç»™è§†å›¾è§£æå™¨å¤„ç†</span><br>        ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br><br>        <span class="hljs-comment">//å°è£…å¯¹è±¡ï¼Œæ”¾åœ¨ModelAndViewä¸­ã€‚Model</span><br>        mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;HelloSpringMVC!&quot;</span>);<br>        <span class="hljs-comment">//å°è£…è¦è·³è½¬çš„è§†å›¾ï¼Œæ”¾åœ¨ModelAndViewä¸­</span><br>        mv.setViewName(<span class="hljs-string">&quot;hello&quot;</span>); <span class="hljs-comment">//: /WEB-INF/jsp/hello.jsp</span><br>        <span class="hljs-keyword">return</span> mv;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>springmvc-servlet.xml</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br>    <br><span class="hljs-comment">&lt;!--å¤„ç†å™¨æ˜ å°„å™¨,æ˜ å°„åˆ°ä¸‹é¢çš„Handler--&gt;</span><br>    <span class="hljs-comment">&lt;!--è¿™ä¸ªå¤„ç†å™¨ä¼šæ ¹æ®Beançš„åå­—æ¥æ‰¾--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping&quot;</span>/&gt;</span><br>    <br><span class="hljs-comment">&lt;!--å¤„ç†å™¨é€‚é…å™¨--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter&quot;</span>/&gt;</span><br>    <br>    <span class="hljs-comment">&lt;!--è§†å›¾è§£æå™¨:DispatcherServletç»™ä»–çš„ModelAndView--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;InternalResourceViewResolver&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--å‰ç¼€--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/jsp/&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--åç¼€--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><br>    <span class="hljs-comment">&lt;!--Handler--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;/hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mc.controller.HelloController&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>hello.jsp</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%--<br>  Created by IntelliJ IDEA.<br>  User: wenjing<br>  Date: <span class="hljs-number">2020</span>/<span class="hljs-number">12</span>/<span class="hljs-number">27</span><br>  Time: <span class="hljs-number">21</span>:<span class="hljs-number">57</span><br>  To change <span class="hljs-keyword">this</span> template use File | Settings | File Templates.<br>--%&gt;<br>&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;title&gt;Kuangshen&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>$&#123;msg&#125;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>å¯åŠ¨</p><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/image-20201228103139328.png" alt="image-20201228103139328"></p><h2 id="1-2-æ³¨è§£ç‰ˆé¡¹ç›®"><a href="#1-2-æ³¨è§£ç‰ˆé¡¹ç›®" class="headerlink" title="1.2 æ³¨è§£ç‰ˆé¡¹ç›®"></a>1.2 æ³¨è§£ç‰ˆé¡¹ç›®</h2><p><strong>1ã€æ–°å»ºä¸€ä¸ªMoudleï¼Œspringmvc-03-hello-annotation ã€‚æ·»åŠ webæ”¯æŒï¼</strong></p><p>2ã€ç”±äºMavenå¯èƒ½å­˜åœ¨èµ„æºè¿‡æ»¤çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°†é…ç½®å®Œå–„</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€åœ¨pom.xmlæ–‡ä»¶å¼•å…¥ç›¸å…³çš„ä¾èµ–ï¼šä¸»è¦æœ‰Springæ¡†æ¶æ ¸å¿ƒåº“ã€Spring MVCã€servlet , JSTLç­‰ã€‚æˆ‘ä»¬åœ¨çˆ¶ä¾èµ–ä¸­å·²ç»å¼•å…¥äº†ï¼</p><p><strong>4ã€é…ç½®web.xml</strong></p><p>æ³¨æ„ç‚¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--1.æ³¨å†ŒDispatcherServlet--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--å…³è”ä¸€ä¸ªspringmvcçš„é…ç½®æ–‡ä»¶:ã€servlet-nameã€‘-servlet.xml--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>          <span class="hljs-comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›è¡Œå…³è”--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«springmvcæ‹¦æˆª --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>/ å’Œ /* çš„åŒºåˆ«ï¼š</strong>&lt; url-pattern &gt; / &lt;/ url-pattern &gt; ä¸ä¼šåŒ¹é…åˆ°.jspï¼Œ åªé’ˆå¯¹æˆ‘ä»¬ç¼–å†™çš„è¯·æ±‚ï¼›å³ï¼š.jsp ä¸ä¼šè¿›å…¥springçš„ DispatcherServletç±» ã€‚&lt; url-pattern &gt; /* &lt;/ url-pattern &gt; ä¼šåŒ¹é… *.jspï¼Œä¼šå‡ºç°è¿”å› jspè§†å›¾ æ—¶å†æ¬¡è¿›å…¥springçš„DispatcherServlet ç±»ï¼Œå¯¼è‡´æ‰¾ä¸åˆ°å¯¹åº”çš„controlleræ‰€ä»¥æŠ¥404é”™ã€‚</p><ol><li><ul><li><p>æ³¨æ„web.xmlç‰ˆæœ¬é—®é¢˜ï¼Œè¦æœ€æ–°ç‰ˆï¼</p></li><li><p>æ³¨å†ŒDispatcherServlet</p></li><li><p>å…³è”SpringMVCçš„é…ç½®æ–‡ä»¶</p></li><li><p>å¯åŠ¨çº§åˆ«ä¸º1</p></li><li><p>æ˜ å°„è·¯å¾„ä¸º / ã€ä¸è¦ç”¨/*ï¼Œä¼š404ã€‘</p></li></ul></li></ol><ol start="2"><li><p><strong>5ã€æ·»åŠ Spring MVCé…ç½®æ–‡ä»¶</strong></p></li><li><p>åœ¨resourceç›®å½•ä¸‹æ·»åŠ springmvc-servlet.xmlé…ç½®æ–‡ä»¶ï¼Œé…ç½®çš„å½¢å¼ä¸Springå®¹å™¨é…ç½®åŸºæœ¬ç±»ä¼¼ï¼Œä¸ºäº†æ”¯æŒåŸºäºæ³¨è§£çš„IOCï¼Œè®¾ç½®äº†è‡ªåŠ¨æ‰«æåŒ…çš„åŠŸèƒ½ï¼Œå…·ä½“é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š</p></li><li><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;      xmlns:context=&quot;http://www.springframework.org/schema/context&quot;      xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;      xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans           http://www.springframework.org/schema/beans/spring-beans.xsd               http://www.springframework.org/schema/context           https://www.springframework.org/schema/context/spring-context.xsd           http://www.springframework.org/schema/mvc           https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt;   &lt;!-- è‡ªåŠ¨æ‰«æåŒ…ï¼Œè®©æŒ‡å®šåŒ…ä¸‹çš„æ³¨è§£ç”Ÿæ•ˆ,ç”±IOCå®¹å™¨ç»Ÿä¸€ç®¡ç† --&gt;       &lt;context:component-scan base-package=&quot;com.kuang.controller&quot;/&gt;       &lt;!-- è®©Spring MVCä¸å¤„ç†é™æ€èµ„æº --&gt;       &lt;mvc:default-servlet-handler /&gt;       &lt;!--   æ”¯æŒmvcæ³¨è§£é©±åŠ¨       åœ¨springä¸­ä¸€èˆ¬é‡‡ç”¨@RequestMappingæ³¨è§£æ¥å®Œæˆæ˜ å°„å…³ç³»       è¦æƒ³ä½¿@RequestMappingæ³¨è§£ç”Ÿæ•ˆ       å¿…é¡»å‘ä¸Šä¸‹æ–‡ä¸­æ³¨å†ŒDefaultAnnotationHandlerMapping       å’Œä¸€ä¸ªAnnotationMethodHandlerAdapterå®ä¾‹       è¿™ä¸¤ä¸ªå®ä¾‹åˆ†åˆ«åœ¨ç±»çº§åˆ«å’Œæ–¹æ³•çº§åˆ«å¤„ç†ã€‚       è€Œannotation-drivené…ç½®å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨å®Œæˆä¸Šè¿°ä¸¤ä¸ªå®ä¾‹çš„æ³¨å…¥ã€‚    --&gt;   &lt;mvc:annotation-driven /&gt;   &lt;!-- è§†å›¾è§£æå™¨ --&gt;       &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;         id=&quot;internalResourceViewResolver&quot;&gt;               &lt;!-- å‰ç¼€ --&gt;               &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/jsp/&quot; /&gt;               &lt;!-- åç¼€ --&gt;               &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot; /&gt;       &lt;/bean&gt;&lt;/beans&gt;<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><br><span class="hljs-number">5</span>. åœ¨è§†å›¾è§£æå™¨ä¸­æˆ‘ä»¬æŠŠæ‰€æœ‰çš„è§†å›¾éƒ½å­˜æ”¾åœ¨/WEB-INF/ç›®å½•ä¸‹ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è§†å›¾å®‰å…¨ï¼Œå› ä¸ºè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯ä¸èƒ½ç›´æ¥è®¿é—®ã€‚<br><br><span class="hljs-number">6</span>. - è®©IOCçš„æ³¨è§£ç”Ÿæ•ˆ<br>   - é™æ€èµ„æºè¿‡æ»¤ ï¼šHTML . JS . CSS . å›¾ç‰‡ ï¼Œ è§†é¢‘ .....<br>   - MVCçš„æ³¨è§£é©±åŠ¨<br>   - é…ç½®è§†å›¾è§£æå™¨<br><br><span class="hljs-number">7</span>. **<span class="hljs-number">6</span>ã€åˆ›å»ºController**<br><br><span class="hljs-number">8</span>. ç¼–å†™ä¸€ä¸ªJavaæ§åˆ¶ç±»ï¼šcom.kuang.controller.HelloController , æ³¨æ„ç¼–ç è§„èŒƒ<br><br><span class="hljs-number">9</span>. ```java<br>   <span class="hljs-keyword">package</span> com.kuang.controller;<br>   <span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br>   <span class="hljs-keyword">import</span> org.springframework.ui.Model;<br>   <span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RequestMapping;<br>   <span class="hljs-meta">@Controller</span><span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">&quot;/HelloController&quot;</span>)</span><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>&#123;<br>      <span class="hljs-comment">//çœŸå®è®¿é—®åœ°å€ : é¡¹ç›®å/HelloController/hello   </span><br>       <span class="hljs-meta">@RequestMapping(<span class="hljs-meta-string">&quot;/hello&quot;</span>)</span>   <br>       <span class="hljs-keyword">public</span> String sayHello(Model model)&#123;       <span class="hljs-comment">//å‘æ¨¡å‹ä¸­æ·»åŠ å±æ€§msgä¸å€¼ï¼Œå¯ä»¥åœ¨JSPé¡µé¢ä¸­å–å‡ºå¹¶æ¸²æŸ“       </span><br>           model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;hello,SpringMVC&quot;</span>);       <span class="hljs-comment">//web-inf/jsp/hello.jsp       </span><br>           <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;  <br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><ul><li>@Controlleræ˜¯ä¸ºäº†è®©Spring IOCå®¹å™¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨æ‰«æåˆ°ï¼›</li><li>@RequestMappingæ˜¯ä¸ºäº†æ˜ å°„è¯·æ±‚è·¯å¾„ï¼Œè¿™é‡Œå› ä¸ºç±»ä¸æ–¹æ³•ä¸Šéƒ½æœ‰æ˜ å°„æ‰€ä»¥è®¿é—®æ—¶åº”è¯¥æ˜¯/HelloController/helloï¼›</li><li>æ–¹æ³•ä¸­å£°æ˜Modelç±»å‹çš„å‚æ•°æ˜¯ä¸ºäº†æŠŠActionä¸­çš„æ•°æ®å¸¦åˆ°è§†å›¾ä¸­ï¼›</li><li>æ–¹æ³•è¿”å›çš„ç»“æœæ˜¯è§†å›¾çš„åç§°helloï¼ŒåŠ ä¸Šé…ç½®æ–‡ä»¶ä¸­çš„å‰åç¼€å˜æˆWEB-INF/jsp/<strong>hello</strong>.jspã€‚</li></ul></li><li><p>7ã€<strong>åˆ›å»ºè§†å›¾å±‚</strong></p></li><li><p>åœ¨WEB-INF/ jspç›®å½•ä¸­åˆ›å»ºhello.jsp ï¼Œ è§†å›¾å¯ä»¥ç›´æ¥å–å‡ºå¹¶å±•ç¤ºä»Controllerå¸¦å›çš„ä¿¡æ¯ï¼›</p></li><li><p>å¯ä»¥é€šè¿‡ELè¡¨ç¤ºå–å‡ºModelä¸­å­˜æ”¾çš„å€¼ï¼Œæˆ–è€…å¯¹è±¡ï¼›</p></li><li><pre><code class="jsp">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;&lt;html&gt;    &lt;head&gt;           &lt;title&gt;SpringMVC&lt;/title&gt;    &lt;/head&gt;    &lt;body&gt;$&#123;msg&#125;&lt;/body&gt;&lt;/html&gt;<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><br><span class="hljs-strong">**8ã€é…ç½®Tomcatè¿è¡Œ**</span><br><br>é…ç½®Tomcat ï¼Œ  å¼€å¯æœåŠ¡å™¨ ï¼Œ è®¿é—® å¯¹åº”çš„è¯·æ±‚è·¯å¾„ï¼<br><br><span class="hljs-section">## å°ç»“</span><br><br>å®ç°æ­¥éª¤å…¶å®éå¸¸çš„ç®€å•ï¼š<br><br><span class="hljs-bullet">1.</span> æ–°å»ºä¸€ä¸ªwebé¡¹ç›®<br><span class="hljs-bullet">2.</span> å¯¼å…¥ç›¸å…³jaråŒ…<br><span class="hljs-bullet">3.</span> ç¼–å†™web.xml , æ³¨å†ŒDispatcherServlet<br><span class="hljs-bullet">4.</span> ç¼–å†™springmvcé…ç½®æ–‡ä»¶<br><span class="hljs-bullet">5.</span> æ¥ä¸‹æ¥å°±æ˜¯å»åˆ›å»ºå¯¹åº”çš„æ§åˆ¶ç±» , controller<br><span class="hljs-bullet">6.</span> æœ€åå®Œå–„å‰ç«¯è§†å›¾å’Œcontrollerä¹‹é—´çš„å¯¹åº”<br><span class="hljs-bullet">7.</span> æµ‹è¯•è¿è¡Œè°ƒè¯•.<br><br>ä½¿ç”¨springMVCå¿…é¡»é…ç½®çš„ä¸‰å¤§ä»¶ï¼š<br><br><span class="hljs-strong">**å¤„ç†å™¨æ˜ å°„å™¨ã€å¤„ç†å™¨é€‚é…å™¨ã€è§†å›¾è§£æå™¨**</span>ï¼ˆæ³¨è§£ç‰ˆåªéœ€è‡ªè¡Œé…ç½®<span class="hljs-strong">**è§†å›¾è§£æå™¨**</span>ï¼‰<br><br>é€šå¸¸ï¼Œæˆ‘ä»¬åªéœ€è¦<span class="hljs-strong">**æ‰‹åŠ¨é…ç½®è§†å›¾è§£æå™¨**</span>ï¼Œè€Œ<span class="hljs-strong">**å¤„ç†å™¨æ˜ å°„å™¨**</span>å’Œ<span class="hljs-strong">**å¤„ç†å™¨é€‚é…å™¨**</span>åªéœ€è¦å¼€å¯<span class="hljs-strong">**æ³¨è§£é©±åŠ¨**</span>å³å¯ï¼Œè€Œçœå»äº†å¤§æ®µçš„xmlé…ç½®<br><br><span class="hljs-section">## 1.3 SpringMVCåŸç†</span><br><br><span class="hljs-section">### 1.3.1 MVCæ¶æ„æ€æƒ³</span><br><br><span class="hljs-bullet">-</span> MVCæ˜¯æ¨¡å‹(Model)ã€è§†å›¾(View)ã€æ§åˆ¶å™¨(Controller)çš„ç®€å†™ï¼Œæ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡è§„èŒƒã€‚<br><span class="hljs-bullet">-</span> æ˜¯å°†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ã€æ˜¾ç¤ºåˆ†ç¦»çš„æ–¹æ³•æ¥ç»„ç»‡ä»£ç ã€‚<br><span class="hljs-bullet">-</span> MVCä¸»è¦ä½œç”¨æ˜¯<span class="hljs-strong">**é™ä½äº†è§†å›¾ä¸ä¸šåŠ¡é€»è¾‘é—´çš„åŒå‘å¶åˆ**</span>ã€‚<br><span class="hljs-bullet">-</span> MVCä¸æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œ<span class="hljs-strong">**MVCæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼**</span>ã€‚å½“ç„¶ä¸åŒçš„MVCå­˜åœ¨å·®å¼‚ã€‚<br><br><span class="hljs-strong">**Modelï¼ˆæ¨¡å‹ï¼‰ï¼š**</span>æ•°æ®æ¨¡å‹ï¼Œæä¾›è¦å±•ç¤ºçš„æ•°æ®ï¼Œå› æ­¤åŒ…å«æ•°æ®å’Œè¡Œä¸ºï¼Œå¯ä»¥è®¤ä¸ºæ˜¯é¢†åŸŸæ¨¡å‹æˆ–JavaBeanç»„ä»¶ï¼ˆåŒ…å«æ•°æ®å’Œè¡Œä¸ºï¼‰ï¼Œä¸è¿‡ç°åœ¨ä¸€èˆ¬éƒ½åˆ†ç¦»å¼€æ¥ï¼šValue Objectï¼ˆæ•°æ®Daoï¼‰ å’Œ æœåŠ¡å±‚ï¼ˆè¡Œä¸ºServiceï¼‰ã€‚ä¹Ÿå°±æ˜¯æ¨¡å‹æä¾›äº†æ¨¡å‹æ•°æ®æŸ¥è¯¢å’Œæ¨¡å‹æ•°æ®çš„çŠ¶æ€æ›´æ–°ç­‰åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®å’Œä¸šåŠ¡ã€‚<br><br><span class="hljs-strong">**Viewï¼ˆè§†å›¾ï¼‰ï¼š**</span>è´Ÿè´£è¿›è¡Œæ¨¡å‹çš„å±•ç¤ºï¼Œä¸€èˆ¬å°±æ˜¯æˆ‘ä»¬è§åˆ°çš„ç”¨æˆ·ç•Œé¢ï¼Œå®¢æˆ·æƒ³çœ‹åˆ°çš„ä¸œè¥¿ã€‚<br><br><span class="hljs-strong">**Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼š**</span>æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œå§”æ‰˜ç»™æ¨¡å‹è¿›è¡Œå¤„ç†ï¼ˆçŠ¶æ€æ”¹å˜ï¼‰ï¼Œå¤„ç†å®Œæ¯•åæŠŠè¿”å›çš„æ¨¡å‹æ•°æ®è¿”å›ç»™è§†å›¾ï¼Œç”±è§†å›¾è´Ÿè´£å±•ç¤ºã€‚ä¹Ÿå°±æ˜¯è¯´æ§åˆ¶å™¨åšäº†ä¸ªè°ƒåº¦å‘˜çš„å·¥ä½œã€‚<br><br><span class="hljs-strong">**èŒè´£åˆ†æï¼š**</span><br><br><span class="hljs-strong">**Modelï¼šæ¨¡å‹**</span><br><br><span class="hljs-bullet">1.</span> ä¸šåŠ¡é€»è¾‘<br><span class="hljs-bullet">2.</span> ä¿å­˜æ•°æ®çš„çŠ¶æ€<br><br><span class="hljs-strong">**Viewï¼šè§†å›¾**</span><br><br><span class="hljs-bullet">1.</span> æ˜¾ç¤ºé¡µé¢<br><br><span class="hljs-strong">**Controllerï¼šæ§åˆ¶å™¨**</span><br><br><span class="hljs-bullet">1.</span> å–å¾—è¡¨å•æ•°æ®<br><span class="hljs-bullet">2.</span> è°ƒç”¨ä¸šåŠ¡é€»è¾‘<br><span class="hljs-bullet">3.</span> è½¬å‘æŒ‡å®šçš„é¡µé¢<br><br><span class="hljs-section">### 1.3.2 ä¸­å¿ƒæ§åˆ¶å™¨</span><br><br>â€‹Springçš„webæ¡†æ¶å›´ç»•DispatcherServletè®¾è®¡ã€‚DispatcherServletçš„ä½œç”¨æ˜¯å°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„å¤„ç†å™¨ã€‚ä»Spring 2.5å¼€å§‹ï¼Œä½¿ç”¨Java 5æˆ–è€…ä»¥ä¸Šç‰ˆæœ¬çš„ç”¨æˆ·å¯ä»¥é‡‡ç”¨åŸºäºæ³¨è§£çš„controllerå£°æ˜æ–¹å¼ã€‚<br><br>â€‹Spring MVCæ¡†æ¶åƒè®¸å¤šå…¶ä»–MVCæ¡†æ¶ä¸€æ ·, <span class="hljs-strong">**ä»¥è¯·æ±‚ä¸ºé©±åŠ¨**</span> , <span class="hljs-strong">**å›´ç»•ä¸€ä¸ªä¸­å¿ƒServletåˆ†æ´¾è¯·æ±‚åŠæä¾›å…¶ä»–åŠŸèƒ½**</span>ï¼Œ<span class="hljs-strong">**DispatcherServletæ˜¯ä¸€ä¸ªå®é™…çš„Servlet (å®ƒç»§æ‰¿è‡ªHttpServlet åŸºç±»)**</span>ã€‚<br><br>![](SpringMVC/1.png)<br><br>SpringMVCçš„åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><br>â€‹å½“å‘èµ·è¯·æ±‚æ—¶è¢«å‰ç½®çš„æ§åˆ¶å™¨æ‹¦æˆªåˆ°è¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚å‚æ•°ç”Ÿæˆä»£ç†è¯·æ±‚ï¼Œæ‰¾åˆ°è¯·æ±‚å¯¹åº”çš„å®é™…æ§åˆ¶å™¨ï¼Œæ§åˆ¶å™¨å¤„ç†è¯·æ±‚ï¼Œåˆ›å»ºæ•°æ®æ¨¡å‹ï¼Œè®¿é—®æ•°æ®åº“ï¼Œå°†æ¨¡å‹å“åº”ç»™ä¸­å¿ƒæ§åˆ¶å™¨ï¼Œæ§åˆ¶å™¨ä½¿ç”¨æ¨¡å‹ä¸è§†å›¾æ¸²æŸ“è§†å›¾ç»“æœï¼Œå°†ç»“æœè¿”å›ç»™ä¸­å¿ƒæ§åˆ¶å™¨ï¼Œå†å°†ç»“æœè¿”å›ç»™è¯·æ±‚è€…ã€‚<br><br>![](SpringMVC/2.png)<br><br><span class="hljs-section">## 1.4 SpringMVCæ‰§è¡ŒåŸç†</span><br><br>![](SpringMVC/3.png)<br><br>å›¾ä¸ºSpringMVCçš„ä¸€ä¸ªè¾ƒå®Œæ•´çš„æµç¨‹å›¾ï¼Œå®çº¿è¡¨ç¤ºSpringMVCæ¡†æ¶æä¾›çš„æŠ€æœ¯ï¼Œä¸éœ€è¦å¼€å‘è€…å®ç°ï¼Œè™šçº¿è¡¨ç¤ºéœ€è¦å¼€å‘è€…å®ç°ã€‚<br><br><span class="hljs-strong">**ç®€è¦åˆ†ææ‰§è¡Œæµç¨‹**</span><br><br><span class="hljs-bullet">1.</span> DispatcherServletè¡¨ç¤ºå‰ç½®æ§åˆ¶å™¨ï¼Œæ˜¯æ•´ä¸ªSpringMVCçš„æ§åˆ¶ä¸­å¿ƒã€‚ç”¨æˆ·å‘å‡ºè¯·æ±‚ï¼ŒDispatcherServletæ¥æ”¶è¯·æ±‚å¹¶æ‹¦æˆªè¯·æ±‚ã€‚<br><br>   æˆ‘ä»¬å‡è®¾è¯·æ±‚çš„urlä¸º : http://localhost:8080/SpringMVC/hello<br><br>   <br><br>   <span class="hljs-strong">**å¦‚ä¸Šurlæ‹†åˆ†æˆä¸‰éƒ¨åˆ†ï¼š**</span><br><br>   http://localhost:8080æœåŠ¡å™¨åŸŸå<br><br>   SpringMVCéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„webç«™ç‚¹<br><br>   helloè¡¨ç¤ºæ§åˆ¶å™¨<br><br>   é€šè¿‡åˆ†æï¼Œå¦‚ä¸Šurlè¡¨ç¤ºä¸ºï¼šè¯·æ±‚ä½äºæœåŠ¡å™¨localhost:8080ä¸Šçš„SpringMVCç«™ç‚¹çš„helloæ§åˆ¶å™¨ã€‚<br><br><span class="hljs-bullet">2.</span> HandlerMappingä¸ºå¤„ç†å™¨æ˜ å°„ã€‚DispatcherServletè°ƒç”¨HandlerMapping,HandlerMappingæ ¹æ®è¯·æ±‚urlæŸ¥æ‰¾Handlerã€‚<br><br><span class="hljs-bullet">3.</span> HandlerExecutionè¡¨ç¤ºå…·ä½“çš„Handler,å…¶ä¸»è¦ä½œç”¨æ˜¯æ ¹æ®urlæŸ¥æ‰¾æ§åˆ¶å™¨ï¼Œå¦‚ä¸Šurlè¢«æŸ¥æ‰¾æ§åˆ¶å™¨ä¸ºï¼šhelloã€‚<br><br><span class="hljs-bullet">4.</span> HandlerExecutionå°†è§£æåçš„ä¿¡æ¯ä¼ é€’ç»™DispatcherServlet,å¦‚è§£ææ§åˆ¶å™¨æ˜ å°„ç­‰ã€‚<br><br><span class="hljs-bullet">5.</span> HandlerAdapterè¡¨ç¤ºå¤„ç†å™¨é€‚é…å™¨ï¼Œå…¶æŒ‰ç…§ç‰¹å®šçš„è§„åˆ™å»æ‰§è¡ŒHandlerã€‚<br><br><span class="hljs-bullet">6.</span> Handlerè®©å…·ä½“çš„Controlleræ‰§è¡Œã€‚<br><br><span class="hljs-bullet">7.</span> Controllerå°†å…·ä½“çš„æ‰§è¡Œä¿¡æ¯è¿”å›ç»™HandlerAdapter,å¦‚ModelAndViewã€‚<br><br><span class="hljs-bullet">8.</span> HandlerAdapterå°†è§†å›¾é€»è¾‘åæˆ–æ¨¡å‹ä¼ é€’ç»™DispatcherServletã€‚<br><br><span class="hljs-bullet">9.</span> DispatcherServletè°ƒç”¨è§†å›¾è§£æå™¨(ViewResolver)æ¥è§£æHandlerAdapterä¼ é€’çš„é€»è¾‘è§†å›¾åã€‚<br><br><span class="hljs-bullet">10.</span> è§†å›¾è§£æå™¨å°†è§£æçš„é€»è¾‘è§†å›¾åä¼ ç»™DispatcherServletã€‚<br><br><span class="hljs-bullet">11.</span> DispatcherServletæ ¹æ®è§†å›¾è§£æå™¨è§£æçš„è§†å›¾ç»“æœï¼Œè°ƒç”¨å…·ä½“çš„è§†å›¾ã€‚<br><br><span class="hljs-bullet">12.</span> æœ€ç»ˆè§†å›¾å‘ˆç°ç»™ç”¨æˆ·ã€‚<br><br><span class="hljs-section"># äºŒã€æ§åˆ¶å™¨å’ŒRestfulé£æ ¼</span><br><br><span class="hljs-section">## 2.1 æ§åˆ¶å™¨Controller</span><br><br><span class="hljs-bullet">-</span> æ§åˆ¶å™¨å¤æ‚æä¾›è®¿é—®åº”ç”¨ç¨‹åºçš„è¡Œä¸ºï¼Œé€šå¸¸é€šè¿‡æ¥å£å®šä¹‰æˆ–æ³¨è§£å®šä¹‰ä¸¤ç§æ–¹æ³•å®ç°ã€‚<br><span class="hljs-bullet">-</span> æ§åˆ¶å™¨è´Ÿè´£è§£æç”¨æˆ·çš„è¯·æ±‚å¹¶å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªæ¨¡å‹ã€‚<br><span class="hljs-bullet">-</span> åœ¨Spring MVCä¸­ä¸€ä¸ªæ§åˆ¶å™¨ç±»å¯ä»¥åŒ…å«å¤šä¸ªæ–¹æ³•<br><span class="hljs-bullet">-</span> åœ¨Spring MVCä¸­ï¼Œå¯¹äºControllerçš„é…ç½®æ–¹å¼æœ‰å¾ˆå¤šç§<br><br><span class="hljs-section">### å®ç°Controlleræ¥å£</span><br><br>Controlleræ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨org.springframework.web.servlet.mvcåŒ…ä¸‹ï¼Œæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼›<br><br><span class="hljs-code">```java</span><br><span class="hljs-code">//å®ç°è¯¥æ¥å£çš„ç±»è·å¾—æ§åˆ¶å™¨åŠŸèƒ½</span><br><span class="hljs-code">public interface Controller &#123;</span><br><span class="hljs-code">   //å¤„ç†è¯·æ±‚ä¸”è¿”å›ä¸€ä¸ªæ¨¡å‹ä¸è§†å›¾å¯¹è±¡</span><br><span class="hljs-code">   ModelAndView handleRequest(HttpServletRequest var1, HttpServletResponse var2) throws Exception;</span><br><span class="hljs-code">&#125;</span><br></code></pre></td></tr></table></figure></code></pre></li></ol><p><strong>æµ‹è¯•</strong></p><ol><li><p>æ–°å»ºä¸€ä¸ªMoudleï¼Œspringmvc-04-controller ã€‚å°†åˆšæ‰çš„03 æ‹·è´ä¸€ä»½, æˆ‘ä»¬è¿›è¡Œæ“ä½œï¼</p></li><li><ul><li>åˆ æ‰HelloController</li><li>mvcçš„é…ç½®æ–‡ä»¶åªç•™ä¸‹ è§†å›¾è§£æå™¨ï¼</li></ul></li><li><p>ç¼–å†™ä¸€ä¸ªControllerç±»ï¼ŒControllerTest1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å®šä¹‰æ§åˆ¶å™¨</span><br><span class="hljs-comment">//æ³¨æ„ç‚¹ï¼šä¸è¦å¯¼é”™åŒ…ï¼Œå®ç°Controlleræ¥å£ï¼Œé‡å†™æ–¹æ³•ï¼›</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ControllerTest1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Controller</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">handleRequest</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span><br>       ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>       mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;Test1Controller&quot;</span>);<br>       mv.setViewName(<span class="hljs-string">&quot;test&quot;</span>);<br>       <span class="hljs-keyword">return</span> mv;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™å®Œæ¯•åï¼Œå»Springé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œè¯·æ±‚çš„beanï¼›nameå¯¹åº”è¯·æ±‚è·¯å¾„ï¼Œclasså¯¹åº”å¤„ç†è¯·æ±‚çš„ç±»</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;/t1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.controller.ControllerTest1&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™å‰ç«¯test.jspï¼Œæ³¨æ„åœ¨WEB-INF/jspç›®å½•ä¸‹ç¼–å†™ï¼Œå¯¹åº”æˆ‘ä»¬çš„è§†å›¾è§£æå™¨</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page contentType=<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="hljs-string">&quot;java&quot;</span> %&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>   &lt;title&gt;Kuangshen&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>$&#123;msg&#125;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure></li><li><p>é…ç½®Tomcatè¿è¡Œæµ‹è¯•ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰é¡¹ç›®å‘å¸ƒåé…ç½®çš„å°±æ˜¯ä¸€ä¸ª / ï¼Œæ‰€ä»¥è¯·æ±‚ä¸ç”¨åŠ é¡¹ç›®åï¼ŒOKï¼</p></li></ol><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/4.png"></p><p><strong>è¯´æ˜ï¼š</strong></p><ul><li><p>å®ç°æ¥å£Controllerå®šä¹‰æ§åˆ¶å™¨æ˜¯è¾ƒè€çš„åŠæ³•</p></li><li><p>ç¼ºç‚¹æ˜¯ï¼šä¸€ä¸ªæ§åˆ¶å™¨ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœè¦å¤šä¸ªæ–¹æ³•åˆ™éœ€è¦å®šä¹‰å¤šä¸ªControllerï¼›å®šä¹‰çš„æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼›</p></li></ul><h3 id="ä½¿ç”¨æ³¨è§£-Controller"><a href="#ä½¿ç”¨æ³¨è§£-Controller" class="headerlink" title="ä½¿ç”¨æ³¨è§£@Controller"></a>ä½¿ç”¨æ³¨è§£@Controller</h3><ul><li><p>@Controlleræ³¨è§£ç±»å‹ç”¨äºå£°æ˜Springç±»çš„å®ä¾‹æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆåœ¨è®²IOCæ—¶è¿˜æåˆ°äº†å¦å¤–3ä¸ªæ³¨è§£ï¼‰ï¼›</p></li><li><p>Springå¯ä»¥ä½¿ç”¨æ‰«ææœºåˆ¶æ¥æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­æ‰€æœ‰åŸºäºæ³¨è§£çš„æ§åˆ¶å™¨ç±»ï¼Œä¸ºäº†ä¿è¯Springèƒ½æ‰¾åˆ°ä½ çš„æ§åˆ¶å™¨ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å£°æ˜ç»„ä»¶æ‰«æã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.kuang.controller&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>å¢åŠ ä¸€ä¸ªControllerTest2ç±»ï¼Œä½¿ç”¨æ³¨è§£å®ç°ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//@Controlleræ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨æ·»åŠ åˆ°Springä¸Šä¸‹æ–‡ä¸­</span><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ControllerTest2</span></span>&#123;<br><br>   <span class="hljs-comment">//æ˜ å°„è®¿é—®è·¯å¾„</span><br>   <span class="hljs-meta">@RequestMapping(&quot;/t2&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(Model model)</span></span>&#123;<br>       <span class="hljs-comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span><br>       model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;ControllerTest2&quot;</span>);<br>       <span class="hljs-comment">//è¿”å›è§†å›¾ä½ç½®</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="2-2-RequestMapping"><a href="#2-2-RequestMapping" class="headerlink" title="2.2 @RequestMapping"></a>2.2 @RequestMapping</h2><p><strong>@RequestMapping</strong></p><ul><li><p>@RequestMappingæ³¨è§£ç”¨äºæ˜ å°„urlåˆ°æ§åˆ¶å™¨ç±»æˆ–ä¸€ä¸ªç‰¹å®šçš„å¤„ç†ç¨‹åºæ–¹æ³•ã€‚å¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ã€‚</p></li><li><p>ä¸ºäº†æµ‹è¯•ç»“è®ºæ›´åŠ å‡†ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥åŠ ä¸Šä¸€ä¸ªé¡¹ç›®åæµ‹è¯• myweb</p></li><li><p>åªæ³¨è§£åœ¨æ–¹æ³•ä¸Šé¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span> </span>&#123;<br>   <span class="hljs-meta">@RequestMapping(&quot;/h1&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/">http://localhost:8080</a> / é¡¹ç›®å / h1</p></li><li><p>åŒæ—¶æ³¨è§£ç±»ä¸æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(&quot;/admin&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span> </span>&#123;<br>   <span class="hljs-meta">@RequestMapping(&quot;/h1&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è®¿é—®è·¯å¾„ï¼š<a href="http://localhost:8080/">http://localhost:8080</a> / é¡¹ç›®å/ admin /h1  , éœ€è¦å…ˆæŒ‡å®šç±»çš„è·¯å¾„å†æŒ‡å®šæ–¹æ³•çš„è·¯å¾„ï¼›</p></li></ul><h2 id="2-3-RestFul-é£æ ¼"><a href="#2-3-RestFul-é£æ ¼" class="headerlink" title="2.3 RestFul é£æ ¼"></a>2.3 RestFul é£æ ¼</h2><p><strong>æ¦‚å¿µ</strong></p><p>Restfulå°±æ˜¯ä¸€ä¸ªèµ„æºå®šä½åŠèµ„æºæ“ä½œçš„é£æ ¼ã€‚ä¸æ˜¯æ ‡å‡†ä¹Ÿä¸æ˜¯åè®®ï¼Œåªæ˜¯ä¸€ç§é£æ ¼ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶å¯ä»¥æ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚</p><p><strong>åŠŸèƒ½</strong></p><p>èµ„æºï¼šäº’è”ç½‘æ‰€æœ‰çš„äº‹ç‰©éƒ½å¯ä»¥è¢«æŠ½è±¡ä¸ºèµ„æº</p><p>èµ„æºæ“ä½œï¼šä½¿ç”¨POSTã€DELETEã€PUTã€GETï¼Œä½¿ç”¨ä¸åŒæ–¹æ³•å¯¹èµ„æºè¿›è¡Œæ“ä½œã€‚</p><p>åˆ†åˆ«å¯¹åº” æ·»åŠ ã€ åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥è¯¢ã€‚</p><p><strong>ä¼ ç»Ÿæ–¹å¼æ“ä½œèµ„æº</strong>  ï¼šé€šè¿‡ä¸åŒçš„å‚æ•°æ¥å®ç°ä¸åŒçš„æ•ˆæœï¼æ–¹æ³•å•ä¸€ï¼Œpost å’Œ get</p><p>â€‹    <a href="http://127.0.0.1/item/queryItem.action?id=1">http://127.0.0.1/item/queryItem.action?id=1</a> æŸ¥è¯¢,GET</p><p>â€‹    <a href="http://127.0.0.1/item/saveItem.action">http://127.0.0.1/item/saveItem.action</a> æ–°å¢,POST</p><p>â€‹    <a href="http://127.0.0.1/item/updateItem.action">http://127.0.0.1/item/updateItem.action</a> æ›´æ–°,POST</p><p>â€‹    <a href="http://127.0.0.1/item/deleteItem.action?id=1">http://127.0.0.1/item/deleteItem.action?id=1</a> åˆ é™¤,GETæˆ–POST</p><p><strong>ä½¿ç”¨RESTfulæ“ä½œèµ„æº</strong> ï¼šå¯ä»¥é€šè¿‡ä¸åŒçš„è¯·æ±‚æ–¹å¼æ¥å®ç°ä¸åŒçš„æ•ˆæœï¼å¦‚ä¸‹ï¼šè¯·æ±‚åœ°å€ä¸€æ ·ï¼Œä½†æ˜¯åŠŸèƒ½å¯ä»¥ä¸åŒï¼</p><p>â€‹    <a href="http://127.0.0.1/item/1">http://127.0.0.1/item/1</a> æŸ¥è¯¢,GET</p><p>â€‹    <a href="http://127.0.0.1/item">http://127.0.0.1/item</a> æ–°å¢,POST</p><p>â€‹    <a href="http://127.0.0.1/item">http://127.0.0.1/item</a> æ›´æ–°,PUT</p><p>â€‹    <a href="http://127.0.0.1/item/1">http://127.0.0.1/item/1</a> åˆ é™¤,DELETE</p><p><strong>å­¦ä¹ æµ‹è¯•</strong></p><ol><li><p>åœ¨æ–°å»ºä¸€ä¸ªç±» RestFulController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestFulController</span> </span>&#123;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>åœ¨Spring MVCä¸­å¯ä»¥ä½¿ç”¨  @PathVariable æ³¨è§£ï¼Œè®©æ–¹æ³•å‚æ•°çš„å€¼å¯¹åº”ç»‘å®šåˆ°ä¸€ä¸ªURIæ¨¡æ¿å˜é‡ä¸Šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RestFulController</span> </span>&#123;<br><br>   <span class="hljs-comment">//æ˜ å°„è®¿é—®è·¯å¾„</span><br>   <span class="hljs-meta">@RequestMapping(&quot;/commit/&#123;p1&#125;/&#123;p2&#125;&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-keyword">int</span> p1, <span class="hljs-meta">@PathVariable</span> <span class="hljs-keyword">int</span> p2, Model model)</span></span>&#123;<br>       <br>       <span class="hljs-keyword">int</span> result = p1+p2;<br>       <span class="hljs-comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span><br>       model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;ç»“æœï¼š&quot;</span>+result);<br>       <span class="hljs-comment">//è¿”å›è§†å›¾ä½ç½®</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>       <br>  &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æˆ‘ä»¬æ¥æµ‹è¯•è¯·æ±‚æŸ¥çœ‹ä¸‹</p></li></ol><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/6.png"></p><ol start="4"><li><p>æ€è€ƒï¼šä½¿ç”¨è·¯å¾„å˜é‡çš„å¥½å¤„ï¼Ÿ</p></li><li><ul><li>ä½¿è·¯å¾„å˜å¾—æ›´åŠ ç®€æ´ï¼›</li><li>è·å¾—å‚æ•°æ›´åŠ æ–¹ä¾¿ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ã€‚</li><li>é€šè¿‡è·¯å¾„å˜é‡çš„ç±»å‹å¯ä»¥çº¦æŸè®¿é—®å‚æ•°ï¼Œå¦‚æœç±»å‹ä¸ä¸€æ ·ï¼Œåˆ™è®¿é—®ä¸åˆ°å¯¹åº”çš„è¯·æ±‚æ–¹æ³•ï¼Œå¦‚è¿™é‡Œè®¿é—®æ˜¯çš„è·¯å¾„æ˜¯/commit/1/aï¼Œåˆ™è·¯å¾„ä¸æ–¹æ³•ä¸åŒ¹é…ï¼Œè€Œä¸ä¼šæ˜¯å‚æ•°è½¬æ¢å¤±è´¥ã€‚</li></ul></li></ol><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/7.png"></p><p>æˆ‘ä»¬æ¥ä¿®æ”¹ä¸‹å¯¹åº”çš„å‚æ•°ç±»å‹ï¼Œå†æ¬¡æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ˜ å°„è®¿é—®è·¯å¾„</span><br><span class="hljs-meta">@RequestMapping(&quot;/commit/&#123;p1&#125;/&#123;p2&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-keyword">int</span> p1, <span class="hljs-meta">@PathVariable</span> String p2, Model model)</span></span>&#123;<br><br>   String result = p1+p2;<br>   <span class="hljs-comment">//Spring MVCä¼šè‡ªåŠ¨å®ä¾‹åŒ–ä¸€ä¸ªModelå¯¹è±¡ç”¨äºå‘è§†å›¾ä¸­ä¼ å€¼</span><br>   model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;ç»“æœï¼š&quot;</span>+result);<br>   <span class="hljs-comment">//è¿”å›è§†å›¾ä½ç½®</span><br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/8.png"></p><p><strong>ä½¿ç”¨methodå±æ€§æŒ‡å®šè¯·æ±‚ç±»å‹</strong></p><p>ç”¨äºçº¦æŸè¯·æ±‚çš„ç±»å‹ï¼Œå¯ä»¥æ”¶çª„è¯·æ±‚èŒƒå›´ã€‚æŒ‡å®šè¯·æ±‚è°“è¯çš„ç±»å‹å¦‚GET, POST, HEAD, OPTIONS, PUT, PATCH, DELETE, TRACEç­‰</p><p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p><ul><li><p>å¢åŠ ä¸€ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ˜ å°„è®¿é—®è·¯å¾„,å¿…é¡»æ˜¯POSTè¯·æ±‚</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/hello&quot;,method = &#123;RequestMethod.POST&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index2</span><span class="hljs-params">(Model model)</span></span>&#123;<br>   model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;hello!&quot;</span>);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>æˆ‘ä»¬ä½¿ç”¨æµè§ˆå™¨åœ°å€æ è¿›è¡Œè®¿é—®é»˜è®¤æ˜¯Getè¯·æ±‚ï¼Œä¼šæŠ¥é”™405ï¼š</p></li></ul><p>å¦‚æœå°†POSTä¿®æ”¹ä¸ºGETåˆ™æ­£å¸¸äº†ï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ˜ å°„è®¿é—®è·¯å¾„,å¿…é¡»æ˜¯Getè¯·æ±‚</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/hello&quot;,method = &#123;RequestMethod.GET&#125;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index2</span><span class="hljs-params">(Model model)</span></span>&#123;<br>   model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>, <span class="hljs-string">&quot;hello!&quot;</span>);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/9.png"></p><p><strong>å°ç»“ï¼š</strong></p><p>Spring MVC çš„ @RequestMapping æ³¨è§£èƒ½å¤Ÿå¤„ç† HTTP è¯·æ±‚çš„æ–¹æ³•, æ¯”å¦‚ GET, PUT, POST, DELETE ä»¥åŠ PATCHã€‚</p><p><strong>æ‰€æœ‰çš„åœ°å€æ è¯·æ±‚é»˜è®¤éƒ½ä¼šæ˜¯ HTTP GET ç±»å‹çš„ã€‚</strong></p><p>æ–¹æ³•çº§åˆ«çš„æ³¨è§£å˜ä½“æœ‰å¦‚ä¸‹å‡ ä¸ªï¼šç»„åˆæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping</span><br><span class="hljs-meta">@PostMapping</span><br><span class="hljs-meta">@PutMapping</span><br><span class="hljs-meta">@DeleteMapping</span><br><span class="hljs-meta">@PatchMapping</span><br></code></pre></td></tr></table></figure><p>@GetMapping æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œå¹³æ—¶ä½¿ç”¨çš„ä¼šæ¯”è¾ƒå¤šï¼</p><p>å®ƒæ‰€æ‰®æ¼”çš„æ˜¯ @RequestMapping(method =RequestMethod.GET) çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚</p><h1 id="ä¸‰ã€ç»“æœè·³è½¬æ–¹å¼"><a href="#ä¸‰ã€ç»“æœè·³è½¬æ–¹å¼" class="headerlink" title="ä¸‰ã€ç»“æœè·³è½¬æ–¹å¼"></a>ä¸‰ã€ç»“æœè·³è½¬æ–¹å¼</h1><h2 id="3-1-ModelAndView"><a href="#3-1-ModelAndView" class="headerlink" title="3.1 ModelAndView"></a>3.1 ModelAndView</h2><p>è®¾ç½®ModelAndViewå¯¹è±¡ , æ ¹æ®viewçš„åç§° , å’Œè§†å›¾è§£æå™¨è·³åˆ°æŒ‡å®šçš„é¡µé¢ .</p><p>é¡µé¢ : {è§†å›¾è§£æå™¨å‰ç¼€} + viewName +{è§†å›¾è§£æå™¨åç¼€}</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span></span><br><span class="hljs-tag">     <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;internalResourceViewResolver&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- å‰ç¼€ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span><br>   <span class="hljs-comment">&lt;!-- åç¼€ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„controllerç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ControllerTest1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Controller</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">handleRequest</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span><br>       ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>       mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;ControllerTest1&quot;</span>);<br>       mv.setViewName(<span class="hljs-string">&quot;test&quot;</span>);<br>       <span class="hljs-keyword">return</span> mv;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-2-ServletAPI"><a href="#3-2-ServletAPI" class="headerlink" title="3.2 ServletAPI"></a>3.2 ServletAPI</h2><p>é€šè¿‡è®¾ç½®ServletAPI , ä¸éœ€è¦è§†å›¾è§£æå™¨ .</p><p>1ã€é€šè¿‡HttpServletResponseè¿›è¡Œè¾“å‡º</p><p>2ã€é€šè¿‡HttpServletResponseå®ç°é‡å®šå‘</p><p>3ã€é€šè¿‡HttpServletResponseå®ç°è½¬å‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResultGo</span> </span>&#123;<br><br>   <span class="hljs-meta">@RequestMapping(&quot;/result/t1&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test1</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>       rsp.getWriter().println(<span class="hljs-string">&quot;Hello,Spring BY servlet API&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@RequestMapping(&quot;/result/t2&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>       rsp.sendRedirect(<span class="hljs-string">&quot;/index.jsp&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@RequestMapping(&quot;/result/t3&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test3</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse rsp)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">//è½¬å‘</span><br>       req.setAttribute(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;/result/t3&quot;</span>);<br>       req.getRequestDispatcher(<span class="hljs-string">&quot;/WEB-INF/jsp/test.jsp&quot;</span>).forward(req,rsp);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-3-SpringMVC"><a href="#3-3-SpringMVC" class="headerlink" title="3.3 SpringMVC"></a>3.3 SpringMVC</h2><p><strong>é€šè¿‡SpringMVCæ¥å®ç°è½¬å‘å’Œé‡å®šå‘ - æ— éœ€è§†å›¾è§£æå™¨ï¼›</strong></p><p>æµ‹è¯•å‰ï¼Œéœ€è¦å°†è§†å›¾è§£æå™¨æ³¨é‡Šæ‰</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResultSpringMVC</span> </span>&#123;<br>   <span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/rsm/t1&quot;</span>)<br>   <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">test1</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <span class="hljs-comment">//è½¬å‘</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;/index.jsp&quot;</span>;<br>  &#125;<br><br>   <span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/rsm/t2&quot;</span>)<br>   <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">test2</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <span class="hljs-comment">//è½¬å‘äºŒ</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;forward:/index.jsp&quot;</span>;<br>  &#125;<br><br>   <span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/rsm/t3&quot;</span>)<br>   <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">test3</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <span class="hljs-comment">//é‡å®šå‘</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/index.jsp&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>é€šè¿‡SpringMVCæ¥å®ç°è½¬å‘å’Œé‡å®šå‘ - æœ‰è§†å›¾è§£æå™¨ï¼›</strong></p><p>é‡å®šå‘ , ä¸éœ€è¦è§†å›¾è§£æå™¨ , æœ¬è´¨å°±æ˜¯é‡æ–°è¯·æ±‚ä¸€ä¸ªæ–°åœ°æ–¹å˜› , æ‰€ä»¥æ³¨æ„è·¯å¾„é—®é¢˜.</p><p>å¯ä»¥é‡å®šå‘åˆ°å¦å¤–ä¸€ä¸ªè¯·æ±‚å®ç° .</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResultSpringMVC2</span> </span>&#123;<br>   <span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/rsm2/t1&quot;</span>)<br>   <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">test1</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <span class="hljs-comment">//è½¬å‘</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>  &#125;<br><br>   <span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/rsm2/t2&quot;</span>)<br>   <span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">test2</span>(<span class="hljs-params"></span>)</span>&#123;<br>       <span class="hljs-comment">//é‡å®šå‘</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:/index.jsp&quot;</span>;<br>       <span class="hljs-comment">//return &quot;redirect:hello.do&quot;; //hello.doä¸ºå¦ä¸€ä¸ªè¯·æ±‚/</span><br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å››ã€æ•°æ®å¤„ç†"><a href="#å››ã€æ•°æ®å¤„ç†" class="headerlink" title="å››ã€æ•°æ®å¤„ç†"></a>å››ã€æ•°æ®å¤„ç†</h1><h2 id="4-1-å¤„ç†æäº¤æ•°æ®"><a href="#4-1-å¤„ç†æäº¤æ•°æ®" class="headerlink" title="4.1 å¤„ç†æäº¤æ•°æ®"></a>4.1 å¤„ç†æäº¤æ•°æ®</h2><p><strong>1ã€æäº¤çš„åŸŸåç§°å’Œå¤„ç†æ–¹æ³•çš„å‚æ•°åä¸€è‡´</strong></p><p>æäº¤æ•°æ® : <a href="http://localhost:8080/hello?name=kuangshen">http://localhost:8080/hello?name=kuangshen</a></p><p>å¤„ç†æ–¹æ³• :</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/hello&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">hello</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>)</span>&#123;<br>   System.out.println(name);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åå°è¾“å‡º : kuangshen</p><p><strong>2ã€æäº¤çš„åŸŸåç§°å’Œå¤„ç†æ–¹æ³•çš„å‚æ•°åä¸ä¸€è‡´</strong></p><p>æäº¤æ•°æ® : <a href="http://localhost:8080/hello?username=kuangshen">http://localhost:8080/hello?username=kuangshen</a></p><p>å¤„ç†æ–¹æ³• :</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//@RequestParam(&quot;username&quot;) : usernameæäº¤çš„åŸŸçš„åç§° .</span><br><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/hello&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">hello</span>(<span class="hljs-params"><span class="hljs-meta">@RequestParam</span>(<span class="hljs-string">&quot;username&quot;</span>) <span class="hljs-built_in">String</span> name</span>)</span>&#123;<br>   System.out.println(name);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>åå°è¾“å‡º : kuangshen</p><p><strong>3ã€æäº¤çš„æ˜¯ä¸€ä¸ªå¯¹è±¡</strong></p><p>è¦æ±‚æäº¤çš„è¡¨å•åŸŸå’Œå¯¹è±¡çš„å±æ€§åä¸€è‡´  , å‚æ•°ä½¿ç”¨å¯¹è±¡å³å¯</p><p>1ã€å®ä½“ç±»</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">User</span> &#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> id;<br>   <span class="hljs-keyword">private</span> String name;<br>   <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> age;<br>   <span class="hljs-comment">//æ„é€ </span><br>   <span class="hljs-comment">//get/set</span><br>   <span class="hljs-comment">//tostring()</span><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æäº¤æ•°æ® : <a href="http://localhost:8080/mvc04/user?name=kuangshen&amp;id=1&amp;age=15">http://localhost:8080/mvc04/user?name=kuangshen&amp;id=1&amp;age=15</a></p><p>3ã€å¤„ç†æ–¹æ³• :</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">@RequestMapping(&quot;/user&quot;)<br><span class="hljs-built_in">public</span> String <span class="hljs-keyword">user</span>(<span class="hljs-keyword">User</span> <span class="hljs-keyword">user</span>)&#123;<br>   <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(<span class="hljs-keyword">user</span>);<br>   <span class="hljs-keyword">return</span> &quot;hello&quot;;<br>&#125;<br></code></pre></td></tr></table></figure><p>åå°è¾“å‡º : User { id=1, name=â€™kuangshenâ€™, age=15 }</p><p>è¯´æ˜ï¼šå¦‚æœä½¿ç”¨å¯¹è±¡çš„è¯ï¼Œå‰ç«¯ä¼ é€’çš„å‚æ•°åå’Œå¯¹è±¡åå¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™å°±æ˜¯nullã€‚</p><h2 id="4-2-æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯"><a href="#4-2-æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯" class="headerlink" title="4.2 æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯"></a>4.2 æ•°æ®æ˜¾ç¤ºåˆ°å‰ç«¯</h2><p><strong>ç¬¬ä¸€ç§ : é€šè¿‡ModelAndView</strong></p><p>æˆ‘ä»¬å‰é¢ä¸€ç›´éƒ½æ˜¯å¦‚æ­¤ . å°±ä¸è¿‡å¤šè§£é‡Š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ControllerTest1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Controller</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">handleRequest</span><span class="hljs-params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>       <span class="hljs-comment">//è¿”å›ä¸€ä¸ªæ¨¡å‹è§†å›¾å¯¹è±¡</span><br>       ModelAndView mv = <span class="hljs-keyword">new</span> ModelAndView();<br>       mv.addObject(<span class="hljs-string">&quot;msg&quot;</span>,<span class="hljs-string">&quot;ControllerTest1&quot;</span>);<br>       mv.setViewName(<span class="hljs-string">&quot;test&quot;</span>);<br>       <span class="hljs-keyword">return</span> mv;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç¬¬äºŒç§ : é€šè¿‡ModelMap</strong></p><p>ModelMap</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/hello&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">hello</span>(<span class="hljs-params"><span class="hljs-meta">@RequestParam</span>(<span class="hljs-string">&quot;username&quot;</span>) <span class="hljs-built_in">String</span> name, ModelMap model</span>)</span>&#123;<br>   <span class="hljs-comment">//å°è£…è¦æ˜¾ç¤ºåˆ°è§†å›¾ä¸­çš„æ•°æ®</span><br>   <span class="hljs-comment">//ç›¸å½“äºreq.setAttribute(&quot;name&quot;,name);</span><br>   model.addAttribute(<span class="hljs-string">&quot;name&quot;</span>,name);<br>   System.out.println(name);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰ç§ : é€šè¿‡Model</strong></p><p>Model</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/ct2/hello&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-function"><span class="hljs-title">hello</span>(<span class="hljs-params"><span class="hljs-meta">@RequestParam</span>(<span class="hljs-string">&quot;username&quot;</span>) <span class="hljs-built_in">String</span> name, Model model</span>)</span>&#123;<br>   <span class="hljs-comment">//å°è£…è¦æ˜¾ç¤ºåˆ°è§†å›¾ä¸­çš„æ•°æ®</span><br>   <span class="hljs-comment">//ç›¸å½“äºreq.setAttribute(&quot;name&quot;,name);</span><br>   model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>,name);<br>   System.out.println(name);<br>   <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-3-å¯¹æ¯”"><a href="#4-3-å¯¹æ¯”" class="headerlink" title="4.3 å¯¹æ¯”"></a>4.3 å¯¹æ¯”</h2><p>å°±å¯¹äºæ–°æ‰‹è€Œè¨€ç®€å•æ¥è¯´ä½¿ç”¨åŒºåˆ«å°±æ˜¯ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">Model</span> <span class="hljs-string">åªæœ‰å¯¥å¯¥å‡ ä¸ªæ–¹æ³•åªé€‚åˆç”¨äºå‚¨å­˜æ•°æ®ï¼Œç®€åŒ–äº†æ–°æ‰‹å¯¹äºModelå¯¹è±¡çš„æ“ä½œå’Œç†è§£ï¼›</span><br><br><span class="hljs-attr">ModelMap</span> <span class="hljs-string">ç»§æ‰¿äº† LinkedMap ï¼Œé™¤äº†å®ç°äº†è‡ªèº«çš„ä¸€äº›æ–¹æ³•ï¼ŒåŒæ ·çš„ç»§æ‰¿ LinkedMap çš„æ–¹æ³•å’Œç‰¹æ€§ï¼›</span><br><br><span class="hljs-attr">ModelAndView</span> <span class="hljs-string">å¯ä»¥åœ¨å‚¨å­˜æ•°æ®çš„åŒæ—¶ï¼Œå¯ä»¥è¿›è¡Œè®¾ç½®è¿”å›çš„é€»è¾‘è§†å›¾ï¼Œè¿›è¡Œæ§åˆ¶å±•ç¤ºå±‚çš„è·³è½¬ã€‚</span><br></code></pre></td></tr></table></figure><p>å½“ç„¶æ›´å¤šçš„ä»¥åå¼€å‘è€ƒè™‘çš„æ›´å¤šçš„æ˜¯æ€§èƒ½å’Œä¼˜åŒ–ï¼Œå°±ä¸èƒ½å•å•ä»…é™äºæ­¤çš„äº†è§£ã€‚</p><p><strong>è¯·ä½¿ç”¨80%çš„æ—¶é—´æ‰“å¥½æ‰å®çš„åŸºç¡€ï¼Œå‰©ä¸‹18%çš„æ—¶é—´ç ”ç©¶æ¡†æ¶ï¼Œ2%çš„æ—¶é—´å»å­¦ç‚¹è‹±æ–‡ï¼Œæ¡†æ¶çš„å®˜æ–¹æ–‡æ¡£æ°¸è¿œæ˜¯æœ€å¥½çš„æ•™ç¨‹ã€‚</strong></p><h2 id="4-4-ä¹±ç é—®é¢˜"><a href="#4-4-ä¹±ç é—®é¢˜" class="headerlink" title="4.4 ä¹±ç é—®é¢˜"></a>4.4 ä¹±ç é—®é¢˜</h2><p>æµ‹è¯•æ­¥éª¤ï¼š</p><p>1ã€æˆ‘ä»¬å¯ä»¥åœ¨é¦–é¡µç¼–å†™ä¸€ä¸ªæäº¤çš„è¡¨å•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/e/t&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€åå°ç¼–å†™å¯¹åº”çš„å¤„ç†ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Encoding</span> </span>&#123;<br>   <span class="hljs-meta">@RequestMapping(&quot;/e/t&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test</span><span class="hljs-params">(Model model,String name)</span></span>&#123;<br>       model.addAttribute(<span class="hljs-string">&quot;msg&quot;</span>,name); <span class="hljs-comment">//è·å–è¡¨å•æäº¤çš„å€¼</span><br>       <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;test&quot;</span>; <span class="hljs-comment">//è·³è½¬åˆ°testé¡µé¢æ˜¾ç¤ºè¾“å…¥çš„å€¼</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€è¾“å…¥ä¸­æ–‡æµ‹è¯•ï¼Œå‘ç°ä¹±ç </p><p>ä¸å¾—ä¸è¯´ï¼Œä¹±ç é—®é¢˜æ˜¯åœ¨æˆ‘ä»¬å¼€å‘ä¸­ååˆ†å¸¸è§çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯è®©æˆ‘ä»¬ç¨‹åºçŒ¿æ¯”è¾ƒå¤´å¤§çš„é—®é¢˜ï¼</p><p>ä»¥å‰ä¹±ç é—®é¢˜é€šè¿‡è¿‡æ»¤å™¨è§£å†³ , è€ŒSpringMVCç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¿‡æ»¤å™¨ , å¯ä»¥åœ¨web.xmlä¸­é…ç½® .</p><p>ä¿®æ”¹äº†xmlæ–‡ä»¶éœ€è¦é‡å¯æœåŠ¡å™¨ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬å‘ç° , æœ‰äº›æç«¯æƒ…å†µä¸‹.è¿™ä¸ªè¿‡æ»¤å™¨å¯¹getçš„æ”¯æŒä¸å¥½ .</p><p>å¤„ç†æ–¹æ³• :</p><p>1ã€ä¿®æ”¹tomcaté…ç½®æ–‡ä»¶ ï¼šè®¾ç½®ç¼–ç ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Connector</span> <span class="hljs-attr">URIEncoding</span>=<span class="hljs-string">&quot;utf-8&quot;</span> <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;8080&quot;</span> <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;HTTP/1.1&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">&quot;20000&quot;</span></span><br><span class="hljs-tag">          <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">&quot;8443&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€è‡ªå®šä¹‰è¿‡æ»¤å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.filter;<br><br><span class="hljs-keyword">import</span> javax.servlet.*;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequestWrapper;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.UnsupportedEncodingException;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">* è§£å†³getå’Œpostè¯·æ±‚ å…¨éƒ¨ä¹±ç çš„è¿‡æ»¤å™¨</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GenericEncodingFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Filter</span> </span>&#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span><span class="hljs-params">()</span> </span>&#123;<br>  &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException </span>&#123;<br>       <span class="hljs-comment">//å¤„ç†responseçš„å­—ç¬¦ç¼–ç </span><br>       HttpServletResponse myResponse=(HttpServletResponse) response;<br>       myResponse.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br><br>       <span class="hljs-comment">// è½¬å‹ä¸ºä¸åè®®ç›¸å…³å¯¹è±¡</span><br>       HttpServletRequest httpServletRequest = (HttpServletRequest) request;<br>       <span class="hljs-comment">// å¯¹requeståŒ…è£…å¢å¼º</span><br>       HttpServletRequest myrequest = <span class="hljs-keyword">new</span> MyRequest(httpServletRequest);<br>       chain.doFilter(myrequest, response);<br>  &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException </span>&#123;<br>  &#125;<br><br>&#125;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰requestå¯¹è±¡ï¼ŒHttpServletRequestçš„åŒ…è£…ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRequest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServletRequestWrapper</span> </span>&#123;<br><br>   <span class="hljs-keyword">private</span> HttpServletRequest request;<br>   <span class="hljs-comment">//æ˜¯å¦ç¼–ç çš„æ ‡è®°</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> hasEncode;<br>   <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå¯ä»¥ä¼ å…¥HttpServletRequestå¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œè£…é¥°</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyRequest</span><span class="hljs-params">(HttpServletRequest request)</span> </span>&#123;<br>       <span class="hljs-keyword">super</span>(request);<span class="hljs-comment">// superå¿…é¡»å†™</span><br>       <span class="hljs-keyword">this</span>.request = request;<br>  &#125;<br><br>   <span class="hljs-comment">// å¯¹éœ€è¦å¢å¼ºæ–¹æ³• è¿›è¡Œè¦†ç›–</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Map <span class="hljs-title">getParameterMap</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-comment">// å…ˆè·å¾—è¯·æ±‚æ–¹å¼</span><br>       String method = request.getMethod();<br>       <span class="hljs-keyword">if</span> (method.equalsIgnoreCase(<span class="hljs-string">&quot;post&quot;</span>)) &#123;<br>           <span class="hljs-comment">// postè¯·æ±‚</span><br>           <span class="hljs-keyword">try</span> &#123;<br>               <span class="hljs-comment">// å¤„ç†postä¹±ç </span><br>               request.setCharacterEncoding(<span class="hljs-string">&quot;utf-8&quot;</span>);<br>               <span class="hljs-keyword">return</span> request.getParameterMap();<br>          &#125; <span class="hljs-keyword">catch</span> (UnsupportedEncodingException e) &#123;<br>               e.printStackTrace();<br>          &#125;<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equalsIgnoreCase(<span class="hljs-string">&quot;get&quot;</span>)) &#123;<br>           <span class="hljs-comment">// getè¯·æ±‚</span><br>           Map&lt;String, String[]&gt; parameterMap = request.getParameterMap();<br>           <span class="hljs-keyword">if</span> (!hasEncode) &#123; <span class="hljs-comment">// ç¡®ä¿getæ‰‹åŠ¨ç¼–ç é€»è¾‘åªè¿è¡Œä¸€æ¬¡</span><br>               <span class="hljs-keyword">for</span> (String parameterName : parameterMap.keySet()) &#123;<br>                   String[] values = parameterMap.get(parameterName);<br>                   <span class="hljs-keyword">if</span> (values != <span class="hljs-keyword">null</span>) &#123;<br>                       <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; values.length; i++) &#123;<br>                           <span class="hljs-keyword">try</span> &#123;<br>                               <span class="hljs-comment">// å¤„ç†getä¹±ç </span><br>                               values[i] = <span class="hljs-keyword">new</span> String(values[i]<br>                                      .getBytes(<span class="hljs-string">&quot;ISO-8859-1&quot;</span>), <span class="hljs-string">&quot;utf-8&quot;</span>);<br>                          &#125; <span class="hljs-keyword">catch</span> (UnsupportedEncodingException e) &#123;<br>                               e.printStackTrace();<br>                          &#125;<br>                      &#125;<br>                  &#125;<br>              &#125;<br>               hasEncode = <span class="hljs-keyword">true</span>;<br>          &#125;<br>           <span class="hljs-keyword">return</span> parameterMap;<br>      &#125;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.getParameterMap();<br>  &#125;<br><br>   <span class="hljs-comment">//å–ä¸€ä¸ªå€¼</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getParameter</span><span class="hljs-params">(String name)</span> </span>&#123;<br>       Map&lt;String, String[]&gt; parameterMap = getParameterMap();<br>       String[] values = parameterMap.get(name);<br>       <span class="hljs-keyword">if</span> (values == <span class="hljs-keyword">null</span>) &#123;<br>           <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>      &#125;<br>       <span class="hljs-keyword">return</span> values[<span class="hljs-number">0</span>]; <span class="hljs-comment">// å–å›å‚æ•°çš„ç¬¬ä¸€ä¸ªå€¼</span><br>  &#125;<br><br>   <span class="hljs-comment">//å–æ‰€æœ‰å€¼</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> String[] getParameterValues(String name) &#123;<br>       Map&lt;String, String[]&gt; parameterMap = getParameterMap();<br>       String[] values = parameterMap.get(name);<br>       <span class="hljs-keyword">return</span> values;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä¹Ÿæ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„ä¸€äº›å¤§ç¥å†™çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSpringMVCé»˜è®¤çš„ä¹±ç å¤„ç†å°±å·²ç»èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³äº†ï¼</p><p><strong>ç„¶ååœ¨web.xmlä¸­é…ç½®è¿™ä¸ªè¿‡æ»¤å™¨å³å¯ï¼</strong></p><p>ä¹±ç é—®é¢˜ï¼Œéœ€è¦å¹³æ—¶å¤šæ³¨æ„ï¼Œåœ¨å°½å¯èƒ½èƒ½è®¾ç½®ç¼–ç çš„åœ°æ–¹ï¼Œéƒ½è®¾ç½®ä¸ºç»Ÿä¸€ç¼–ç  UTF-8ï¼</p><h1 id="äº”ã€jsonäº¤äº’å¤„ç†"><a href="#äº”ã€jsonäº¤äº’å¤„ç†" class="headerlink" title="äº”ã€jsonäº¤äº’å¤„ç†"></a>äº”ã€jsonäº¤äº’å¤„ç†</h1><ul><li>JSON(JavaScript Object Notation, JS å¯¹è±¡æ ‡è®°) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œç›®å‰ä½¿ç”¨ç‰¹åˆ«å¹¿æ³›ã€‚</li><li>é‡‡ç”¨å®Œå…¨ç‹¬ç«‹äºç¼–ç¨‹è¯­è¨€çš„<strong>æ–‡æœ¬æ ¼å¼</strong>æ¥å­˜å‚¨å’Œè¡¨ç¤ºæ•°æ®ã€‚</li><li>ç®€æ´å’Œæ¸…æ™°çš„å±‚æ¬¡ç»“æ„ä½¿å¾— JSON æˆä¸ºç†æƒ³çš„æ•°æ®äº¤æ¢è¯­è¨€ã€‚</li><li>æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¶æœ‰æ•ˆåœ°æå‡ç½‘ç»œä¼ è¾“æ•ˆç‡ã€‚</li></ul><p>åœ¨ JavaScript è¯­è¨€ä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ã€‚å› æ­¤ï¼Œä»»ä½•JavaScript æ”¯æŒçš„ç±»å‹éƒ½å¯ä»¥é€šè¿‡ JSON æ¥è¡¨ç¤ºï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€æ•°ç»„ç­‰ã€‚çœ‹çœ‹ä»–çš„è¦æ±‚å’Œè¯­æ³•æ ¼å¼ï¼š</p><ul><li>å¯¹è±¡è¡¨ç¤ºä¸ºé”®å€¼å¯¹ï¼Œæ•°æ®ç”±é€—å·åˆ†éš”</li><li>èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡</li><li>æ–¹æ‹¬å·ä¿å­˜æ•°ç»„</li></ul><p><strong>JSON é”®å€¼å¯¹</strong>æ˜¯ç”¨æ¥ä¿å­˜ JavaScript å¯¹è±¡çš„ä¸€ç§æ–¹å¼ï¼Œå’Œ JavaScript å¯¹è±¡çš„å†™æ³•ä¹Ÿå¤§åŒå°å¼‚ï¼Œé”®/å€¼å¯¹ç»„åˆä¸­çš„é”®åå†™åœ¨å‰é¢å¹¶ç”¨åŒå¼•å· â€œâ€ åŒ…è£¹ï¼Œä½¿ç”¨å†’å· : åˆ†éš”ï¼Œç„¶åç´§æ¥ç€å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;QinJiang&quot;</span>&#125;<br>&#123;<span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>&#125;<br>&#123;<span class="hljs-string">&quot;sex&quot;</span>: <span class="hljs-string">&quot;ç”·&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>å¾ˆå¤šäººæä¸æ¸…æ¥š JSON å’Œ JavaScript å¯¹è±¡çš„å…³ç³»ï¼Œç”šè‡³è¿è°æ˜¯è°éƒ½ä¸æ¸…æ¥šã€‚å…¶å®ï¼Œå¯ä»¥è¿™ä¹ˆç†è§£ï¼š</p><p>JSON æ˜¯ JavaScript å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºæ³•ï¼Œå®ƒä½¿ç”¨æ–‡æœ¬è¡¨ç¤ºä¸€ä¸ª JS å¯¹è±¡çš„ä¿¡æ¯ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">var</span> obj = &#123;a: <span class="hljs-string">&#x27;Hello&#x27;</span>, b: <span class="hljs-string">&#x27;World&#x27;</span>&#125;; <span class="hljs-comment">//è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ³¨æ„é”®åä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨å¼•å·åŒ…è£¹çš„</span><br><span class="hljs-keyword">var</span> json = <span class="hljs-string">&#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span>; <span class="hljs-comment">//è¿™æ˜¯ä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure><p><strong>JSON å’Œ JavaScript å¯¹è±¡äº’è½¬</strong></p><p>è¦å®ç°ä»JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJavaScript å¯¹è±¡ï¼Œä½¿ç”¨ JSON.parse() æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">var</span> obj = JSON.parse(<span class="hljs-string">&#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span>);<br><span class="hljs-comment">//ç»“æœæ˜¯ &#123;a: &#x27;Hello&#x27;, b: &#x27;World&#x27;&#125;</span><br></code></pre></td></tr></table></figure><p>è¦å®ç°ä»JavaScript å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ JSON.stringify() æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">var</span> json = JSON.stringify(&#123;a: <span class="hljs-string">&#x27;Hello&#x27;</span>, b: <span class="hljs-string">&#x27;World&#x27;</span>&#125;);<br><span class="hljs-comment">//ç»“æœæ˜¯ &#x27;&#123;&quot;a&quot;: &quot;Hello&quot;, &quot;b&quot;: &quot;World&quot;&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p><strong>ä»£ç æµ‹è¯•</strong></p><p>1ã€æ–°å»ºä¸€ä¸ªmodule ï¼Œspringmvc-05-json ï¼Œ æ·»åŠ webçš„æ”¯æŒ</p><p>2ã€åœ¨webç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª json-1.html ï¼Œ ç¼–å†™æµ‹è¯•å†…å®¹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JSON_ç§¦ç–†<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="javascript">   <span class="hljs-comment">//ç¼–å†™ä¸€ä¸ªjsçš„å¯¹è±¡</span></span><br><span class="javascript">   <span class="hljs-keyword">var</span> user = &#123;</span><br><span class="javascript">       name:<span class="hljs-string">&quot;ç§¦ç–†&quot;</span>,</span><br>       age:3,<br><span class="javascript">       sex:<span class="hljs-string">&quot;ç”·&quot;</span></span><br>  &#125;;<br><span class="javascript">   <span class="hljs-comment">//å°†jså¯¹è±¡è½¬æ¢æˆjsonå­—ç¬¦ä¸²</span></span><br><span class="javascript">   <span class="hljs-keyword">var</span> str = <span class="hljs-built_in">JSON</span>.stringify(user);</span><br><span class="javascript">   <span class="hljs-built_in">console</span>.log(str);</span><br>   <br><span class="javascript">   <span class="hljs-comment">//å°†jsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºjså¯¹è±¡</span></span><br><span class="javascript">   <span class="hljs-keyword">var</span> user2 = <span class="hljs-built_in">JSON</span>.parse(str);</span><br><span class="javascript">   <span class="hljs-built_in">console</span>.log(user2.age,user2.name,user2.sex);</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€åœ¨IDEAä¸­ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼</p><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/10.png"></p><h2 id="5-1-Controllerè¿”å›JSONæ•°æ®"><a href="#5-1-Controllerè¿”å›JSONæ•°æ®" class="headerlink" title="5.1 Controllerè¿”å›JSONæ•°æ®"></a>5.1 Controllerè¿”å›JSONæ•°æ®</h2><p>Jacksonåº”è¯¥æ˜¯ç›®å‰æ¯”è¾ƒå¥½çš„jsonè§£æå·¥å…·äº†</p><p>å½“ç„¶å·¥å…·ä¸æ­¢è¿™ä¸€ä¸ªï¼Œæ¯”å¦‚è¿˜æœ‰é˜¿é‡Œå·´å·´çš„ fastjson ç­‰ç­‰ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨Jacksonï¼Œä½¿ç”¨å®ƒéœ€è¦å¯¼å…¥å®ƒçš„jaråŒ…ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®SpringMVCéœ€è¦çš„é…ç½®</p><p>web.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">web-app</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;4.0&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--1.æ³¨å†Œservlet--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>SpringMVC<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œè¿›è¡Œå…³è”--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- å¯åŠ¨é¡ºåºï¼Œæ•°å­—è¶Šå°ï¼Œå¯åŠ¨è¶Šæ—© --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«springmvcæ‹¦æˆª --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>SpringMVC<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">web-app</span>&gt;</span><br></code></pre></td></tr></table></figure><p>springmvc-servlet.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:mvc</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/context/spring-context.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/mvc</span></span><br><span class="hljs-tag"><span class="hljs-string">       https://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!-- è‡ªåŠ¨æ‰«ææŒ‡å®šçš„åŒ…ï¼Œä¸‹é¢æ‰€æœ‰æ³¨è§£ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç† --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.kuang.controller&quot;</span>/&gt;</span><br><br>   <span class="hljs-comment">&lt;!-- è§†å›¾è§£æå™¨ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;internalResourceViewResolver&quot;</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- å‰ç¼€ --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span><br>       <span class="hljs-comment">&lt;!-- åç¼€ --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span> /&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éšä¾¿ç¼–å†™ä¸€ä¸ªUserçš„å®ä½“ç±»ï¼Œç„¶åæˆ‘ä»¬å»ç¼–å†™æˆ‘ä»¬çš„æµ‹è¯•Controllerï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.pojo;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-comment">//éœ€è¦å¯¼å…¥lombok</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br><br>   <span class="hljs-keyword">private</span> String name;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br>   <span class="hljs-keyword">private</span> String sex;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ–°ä¸œè¥¿ï¼Œä¸€ä¸ªæ˜¯@ResponseBodyï¼Œä¸€ä¸ªæ˜¯ObjectMapperå¯¹è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸‹å…·ä½“çš„ç”¨æ³•</p><p>ç¼–å†™ä¸€ä¸ªControllerï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> </span>&#123;<br><br>   <span class="hljs-meta">@RequestMapping(&quot;/json1&quot;)</span><br>   <span class="hljs-meta">@ResponseBody</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">json1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException </span>&#123;<br>       <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span><br>       ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>       <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br>       User user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†1å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>       <span class="hljs-comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span><br>       String str = mapper.writeValueAsString(user);<br>       <span class="hljs-comment">//ç”±äº@ResponseBodyæ³¨è§£ï¼Œè¿™é‡Œä¼šå°†strè½¬æˆjsonæ ¼å¼è¿”å›ï¼›ååˆ†æ–¹ä¾¿</span><br>       <span class="hljs-keyword">return</span> str;<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>é…ç½®Tomcat ï¼Œ å¯åŠ¨æµ‹è¯•ä¸€ä¸‹ï¼</p><p>ã€æ³¨æ„ï¼šä½¿ç”¨jsonè®°å¾—å¤„ç†ä¹±ç é—®é¢˜ã€‘</p><h2 id="5-2-ä»£ç ä¼˜åŒ–"><a href="#5-2-ä»£ç ä¼˜åŒ–" class="headerlink" title="5.2 ä»£ç ä¼˜åŒ–"></a>5.2 ä»£ç ä¼˜åŒ–</h2><p><strong>ä¹±ç ç»Ÿä¸€è§£å†³</strong></p><p>ä¸Šä¸€ç§æ–¹æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœé¡¹ç›®ä¸­æœ‰è®¸å¤šè¯·æ±‚åˆ™æ¯ä¸€ä¸ªéƒ½è¦æ·»åŠ ï¼Œå¯ä»¥é€šè¿‡Springé…ç½®ç»Ÿä¸€æŒ‡å®šï¼Œè¿™æ ·å°±ä¸ç”¨æ¯æ¬¡éƒ½å»å¤„ç†äº†ï¼</p><p>æˆ‘ä»¬å¯ä»¥åœ¨springmvcçš„é…ç½®æ–‡ä»¶ä¸Šæ·»åŠ ä¸€æ®µæ¶ˆæ¯StringHttpMessageConverterè½¬æ¢é…ç½®ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mvc:message-converters</span> <span class="hljs-attr">register-defaults</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;objectMapper&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean&quot;</span>&gt;</span><br>                   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;failOnEmptyBeans&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:message-converters</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:annotation-driven</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>è¿”å›jsonå­—ç¬¦ä¸²ç»Ÿä¸€è§£å†³</strong></p><p>åœ¨ç±»ä¸Šç›´æ¥ä½¿ç”¨ <strong>@RestController</strong> ï¼Œè¿™æ ·å­ï¼Œé‡Œé¢æ‰€æœ‰çš„æ–¹æ³•éƒ½åªä¼šè¿”å› json å­—ç¬¦ä¸²äº†ï¼Œä¸ç”¨å†æ¯ä¸€ä¸ªéƒ½æ·»åŠ @ResponseBody ï¼æˆ‘ä»¬åœ¨å‰åç«¯åˆ†ç¦»å¼€å‘ä¸­ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨ @RestController ï¼Œååˆ†ä¾¿æ·ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserController</span> </span>&#123;<br><br>   <span class="hljs-comment">//produces:æŒ‡å®šå“åº”ä½“è¿”å›ç±»å‹å’Œç¼–ç </span><br>   <span class="hljs-meta">@RequestMapping(value = &quot;/json1&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">json1</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException </span>&#123;<br>       <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span><br>       ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>       <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br>       User user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†1å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>       <span class="hljs-comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span><br>       String str = mapper.writeValueAsString(user);<br>       <span class="hljs-comment">//ç”±äº@ResponseBodyæ³¨è§£ï¼Œè¿™é‡Œä¼šå°†strè½¬æˆjsonæ ¼å¼è¿”å›ï¼›ååˆ†æ–¹ä¾¿</span><br>       <span class="hljs-keyword">return</span> str;<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å¯åŠ¨tomcatæµ‹è¯•ï¼Œç»“æœéƒ½æ­£å¸¸è¾“å‡ºï¼</p><h2 id="5-3-æµ‹è¯•é›†åˆè¾“å‡º"><a href="#5-3-æµ‹è¯•é›†åˆè¾“å‡º" class="headerlink" title="5.3 æµ‹è¯•é›†åˆè¾“å‡º"></a>5.3 æµ‹è¯•é›†åˆè¾“å‡º</h2><p>å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/json2&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">json2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException </span>&#123;<br><br>   <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªjacksonçš„å¯¹è±¡æ˜ å°„å™¨ï¼Œç”¨æ¥è§£ææ•°æ®</span><br>   ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>   <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br>   User user1 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†1å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>   User user2 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†2å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>   User user3 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†3å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>   User user4 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†4å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>   List&lt;User&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;User&gt;();<br>   list.add(user1);<br>   list.add(user2);<br>   list.add(user3);<br>   list.add(user4);<br><br>   <span class="hljs-comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span><br>   String str = mapper.writeValueAsString(list);<br>   <span class="hljs-keyword">return</span> str;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ : ååˆ†å®Œç¾ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼</p><h2 id="5-4-è¾“å‡ºæ—¶é—´å¯¹è±¡"><a href="#5-4-è¾“å‡ºæ—¶é—´å¯¹è±¡" class="headerlink" title="5.4 è¾“å‡ºæ—¶é—´å¯¹è±¡"></a>5.4 è¾“å‡ºæ—¶é—´å¯¹è±¡</h2><p>å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/json3&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">json3</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException </span>&#123;<br><br>   ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br><br>   <span class="hljs-comment">//åˆ›å»ºæ—¶é—´ä¸€ä¸ªå¯¹è±¡ï¼Œjava.util.Date</span><br>   Date date = <span class="hljs-keyword">new</span> Date();<br>   <span class="hljs-comment">//å°†æˆ‘ä»¬çš„å¯¹è±¡è§£ææˆä¸ºjsonæ ¼å¼</span><br>   String str = mapper.writeValueAsString(date);<br>   <span class="hljs-keyword">return</span> str;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ :</p><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/12.png"></p><ul><li>é»˜è®¤æ—¥æœŸæ ¼å¼ä¼šå˜æˆä¸€ä¸ªæ•°å­—ï¼Œæ˜¯1970å¹´1æœˆ1æ—¥åˆ°å½“å‰æ—¥æœŸçš„æ¯«ç§’æ•°ï¼</li><li>Jackson é»˜è®¤æ˜¯ä¼šæŠŠæ—¶é—´è½¬æˆtimestampså½¢å¼</li></ul><p><strong>è§£å†³æ–¹æ¡ˆï¼šå–æ¶ˆtimestampså½¢å¼ ï¼Œ è‡ªå®šä¹‰æ—¶é—´æ ¼å¼</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/json4&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">json4</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException </span>&#123;<br><br>   ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br><br>   <span class="hljs-comment">//ä¸ä½¿ç”¨æ—¶é—´æˆ³çš„æ–¹å¼</span><br>   mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="hljs-keyword">false</span>);<br>   <span class="hljs-comment">//è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼å¯¹è±¡</span><br>   SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>   <span class="hljs-comment">//æŒ‡å®šæ—¥æœŸæ ¼å¼</span><br>   mapper.setDateFormat(sdf);<br><br>   Date date = <span class="hljs-keyword">new</span> Date();<br>   String str = mapper.writeValueAsString(date);<br><br>   <span class="hljs-keyword">return</span> str;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ : æˆåŠŸçš„è¾“å‡ºäº†æ—¶é—´ï¼</p><p><img src="/2020/12/27/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/SpringMVC/13.png"></p><h2 id="5-5-æŠ½å–ä¸ºå·¥å…·ç±»"><a href="#5-5-æŠ½å–ä¸ºå·¥å…·ç±»" class="headerlink" title="5.5 æŠ½å–ä¸ºå·¥å…·ç±»"></a>5.5 æŠ½å–ä¸ºå·¥å…·ç±»</h2><p><strong>å¦‚æœè¦ç»å¸¸ä½¿ç”¨çš„è¯ï¼Œè¿™æ ·æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä»£ç å°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»ä¸­ï¼›æˆ‘ä»¬å»ç¼–å†™ä¸‹</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.utils;<br><br><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;<br><br><span class="hljs-keyword">import</span> java.text.SimpleDateFormat;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JsonUtils</span> </span>&#123;<br>   <br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getJson</span><span class="hljs-params">(Object object)</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> getJson(object,<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getJson</span><span class="hljs-params">(Object object,String dateFormat)</span> </span>&#123;<br>       ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();<br>       <span class="hljs-comment">//ä¸ä½¿ç”¨æ—¶é—´å·®çš„æ–¹å¼</span><br>       mapper.configure(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS, <span class="hljs-keyword">false</span>);<br>       <span class="hljs-comment">//è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼å¯¹è±¡</span><br>       SimpleDateFormat sdf = <span class="hljs-keyword">new</span> SimpleDateFormat(dateFormat);<br>       <span class="hljs-comment">//æŒ‡å®šæ—¥æœŸæ ¼å¼</span><br>       mapper.setDateFormat(sdf);<br>       <span class="hljs-keyword">try</span> &#123;<br>           <span class="hljs-keyword">return</span> mapper.writeValueAsString(object);<br>      &#125; <span class="hljs-keyword">catch</span> (JsonProcessingException e) &#123;<br>           e.printStackTrace();<br>      &#125;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨å·¥å…·ç±»ï¼Œä»£ç å°±æ›´åŠ ç®€æ´äº†ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/json5&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">json5</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException </span>&#123;<br>   Date date = <span class="hljs-keyword">new</span> Date();<br>   String json = JsonUtils.getJson(date);<br>   <span class="hljs-keyword">return</span> json;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤§åŠŸå‘Šæˆï¼å®Œç¾ï¼</p><h2 id="5-6-FastJson"><a href="#5-6-FastJson" class="headerlink" title="5.6 FastJson"></a>5.6 FastJson</h2><p>fastjson.jaræ˜¯é˜¿é‡Œå¼€å‘çš„ä¸€æ¬¾ä¸“é—¨ç”¨äºJavaå¼€å‘çš„åŒ…ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°jsonå¯¹è±¡ä¸JavaBeanå¯¹è±¡çš„è½¬æ¢ï¼Œå®ç°JavaBeanå¯¹è±¡ä¸jsonå­—ç¬¦ä¸²çš„è½¬æ¢ï¼Œå®ç°jsonå¯¹è±¡ä¸jsonå­—ç¬¦ä¸²çš„è½¬æ¢ã€‚å®ç°jsonçš„è½¬æ¢æ–¹æ³•å¾ˆå¤šï¼Œæœ€åçš„å®ç°ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>fastjson çš„ pomä¾èµ–ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.60<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>fastjson ä¸‰ä¸ªä¸»è¦çš„ç±»ï¼š</p><p><strong>JSONObject  ä»£è¡¨ json å¯¹è±¡</strong> </p><ul><li>JSONObjectå®ç°äº†Mapæ¥å£, çŒœæƒ³ JSONObjectåº•å±‚æ“ä½œæ˜¯ç”±Mapå®ç°çš„ã€‚</li><li>JSONObjectå¯¹åº”jsonå¯¹è±¡ï¼Œé€šè¿‡å„ç§å½¢å¼çš„get()æ–¹æ³•å¯ä»¥è·å–jsonå¯¹è±¡ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯åˆ©ç”¨è¯¸å¦‚size()ï¼ŒisEmpty()ç­‰æ–¹æ³•è·å–â€é”®ï¼šå€¼â€å¯¹çš„ä¸ªæ•°å’Œåˆ¤æ–­æ˜¯å¦ä¸ºç©ºã€‚å…¶æœ¬è´¨æ˜¯é€šè¿‡å®ç°Mapæ¥å£å¹¶è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•å®Œæˆçš„ã€‚</li></ul><p><strong>JSONArray  ä»£è¡¨ json å¯¹è±¡æ•°ç»„</strong></p><ul><li>å†…éƒ¨æ˜¯æœ‰Listæ¥å£ä¸­çš„æ–¹æ³•æ¥å®Œæˆæ“ä½œçš„ã€‚</li></ul><p><strong>JSONä»£è¡¨ JSONObjectå’ŒJSONArrayçš„è½¬åŒ–</strong></p><ul><li>JSONç±»æºç åˆ†æä¸ä½¿ç”¨</li><li>ä»”ç»†è§‚å¯Ÿè¿™äº›æ–¹æ³•ï¼Œä¸»è¦æ˜¯å®ç°jsonå¯¹è±¡ï¼Œjsonå¯¹è±¡æ•°ç»„ï¼Œjavabeanå¯¹è±¡ï¼Œjsonå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬åŒ–ã€‚</li></ul><p><strong>ä»£ç æµ‹è¯•ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªFastJsonDemo ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.controller;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;<br><span class="hljs-keyword">import</span> com.kuang.pojo.User;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FastJsonDemo</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>       <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span><br>       User user1 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†1å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>       User user2 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†2å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>       User user3 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†3å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>       User user4 = <span class="hljs-keyword">new</span> User(<span class="hljs-string">&quot;ç§¦ç–†4å·&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-string">&quot;ç”·&quot;</span>);<br>       List&lt;User&gt; list = <span class="hljs-keyword">new</span> ArrayList&lt;User&gt;();<br>       list.add(user1);<br>       list.add(user2);<br>       list.add(user3);<br>       list.add(user4);<br><br>       System.out.println(<span class="hljs-string">&quot;*******Javaå¯¹è±¡ è½¬ JSONå­—ç¬¦ä¸²*******&quot;</span>);<br>       String str1 = JSON.toJSONString(list);<br>       System.out.println(<span class="hljs-string">&quot;JSON.toJSONString(list)==&gt;&quot;</span>+str1);<br>       String str2 = JSON.toJSONString(user1);<br>       System.out.println(<span class="hljs-string">&quot;JSON.toJSONString(user1)==&gt;&quot;</span>+str2);<br><br>       System.out.println(<span class="hljs-string">&quot;\n****** JSONå­—ç¬¦ä¸² è½¬ Javaå¯¹è±¡*******&quot;</span>);<br>       User jp_user1=JSON.parseObject(str2,User.class);<br>       System.out.println(<span class="hljs-string">&quot;JSON.parseObject(str2,User.class)==&gt;&quot;</span>+jp_user1);<br><br>       System.out.println(<span class="hljs-string">&quot;\n****** Javaå¯¹è±¡ è½¬ JSONå¯¹è±¡ ******&quot;</span>);<br>       JSONObject jsonObject1 = (JSONObject) JSON.toJSON(user2);<br>       System.out.println(<span class="hljs-string">&quot;(JSONObject) JSON.toJSON(user2)==&gt;&quot;</span>+jsonObject1.getString(<span class="hljs-string">&quot;name&quot;</span>));<br><br>       System.out.println(<span class="hljs-string">&quot;\n****** JSONå¯¹è±¡ è½¬ Javaå¯¹è±¡ ******&quot;</span>);<br>       User to_java_user = JSON.toJavaObject(jsonObject1, User.class);<br>       System.out.println(<span class="hljs-string">&quot;JSON.toJavaObject(jsonObject1, User.class)==&gt;&quot;</span>+to_java_user);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§å·¥å…·ç±»ï¼Œæˆ‘ä»¬åªéœ€è¦æŒæ¡ä½¿ç”¨å°±å¥½äº†ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™åœ¨æ ¹æ®å…·ä½“çš„ä¸šåŠ¡å»æ‰¾å¯¹åº”çš„å®ç°ã€‚å’Œä»¥å‰çš„commons-ioé‚£ç§å·¥å…·åŒ…ä¸€æ ·ï¼Œæ‹¿æ¥ç”¨å°±å¥½äº†ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ ç¬”è®°</title>
    <link href="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/"/>
    <url>/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/</url>
    
    <content type="html"><![CDATA[<p><strong>Springæ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬(IOC)å’Œé¢å‘åˆ‡é¢(AOP)çš„å®¹å™¨ï¼ˆæ¡†æ¶ï¼‰ã€‚</strong></p><p><a href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg2NTAzMTExNg==&hid=3&sn=456dc4d66f0726730757e319ffdaa23e&scene=1&devicetype=android-28&version=27001135&lang=zh_CN&nettype=cmnet&ascene=7&session_us=gh_1dd456f1d44d&wx_header=1">Springæ–‡ç« ç¬”è®°æ•´åˆã€ç‹‚ç¥è¯´ã€‘</a></p><p><a href="http://spring.io/">å®˜ç½‘ </a> </p><p><a href="https://repo.spring.io/libs-release-local/org/springframework/spring/">å®˜æ–¹ä¸‹è½½åœ°å€</a></p><p><a href="https://github.com/spring-projects">GitHub</a></p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201226195929528.png" alt="image-20201226195929528"></p><p><a href="https://docs.spring.io/spring-framework/docs/4.3.9.RELEASE/spring-framework-reference/html/overview.html#overview-distribution-zip">https://docs.spring.io/spring-framework/docs/4.3.9.RELEASE/spring-framework-reference/html/overview.html#overview-distribution-zip</a></p><p>åœ¨æ­¤é¡µé¢ä¸­æ‰¾åˆ°å¯ä»¥ä¸‹è½½çš„æ‰€æœ‰ç‰ˆæœ¬ä¿¡æ¯</p><p><a href="https://repo.spring.io/release/org/springframework/spring/">https://repo.spring.io/release/org/springframework/spring/</a></p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201226201133175.png" alt="image-20201226201133175"></p><p>[toc]</p><h1 id="ä¸€ã€Springç®€ä»‹"><a href="#ä¸€ã€Springç®€ä»‹" class="headerlink" title="ä¸€ã€Springç®€ä»‹"></a>ä¸€ã€Springç®€ä»‹</h1><h2 id="1-1-Springç»„æˆ"><a href="#1-1-Springç»„æˆ" class="headerlink" title="1.1 Springç»„æˆ"></a>1.1 Springç»„æˆ</h2><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/2.png" alt="å›¾ç‰‡"></p><p>Spring æ¡†æ¶æ˜¯ä¸€ä¸ªåˆ†å±‚æ¶æ„ï¼Œç”± 7 ä¸ªå®šä¹‰è‰¯å¥½çš„æ¨¡å—ç»„æˆã€‚Spring æ¨¡å—æ„å»ºåœ¨æ ¸å¿ƒå®¹å™¨ä¹‹ä¸Šï¼Œæ ¸å¿ƒå®¹å™¨å®šä¹‰äº†åˆ›å»ºã€é…ç½®å’Œç®¡ç† bean çš„æ–¹å¼ .</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/1.png" alt="å›¾ç‰‡"></p><p>ç»„æˆ Spring æ¡†æ¶çš„æ¯ä¸ªæ¨¡å—ï¼ˆæˆ–ç»„ä»¶ï¼‰éƒ½å¯ä»¥å•ç‹¬å­˜åœ¨ï¼Œæˆ–è€…ä¸å…¶ä»–ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—è”åˆå®ç°ã€‚æ¯ä¸ªæ¨¡å—çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li><strong>æ ¸å¿ƒå®¹å™¨</strong>ï¼šæ ¸å¿ƒå®¹å™¨æä¾› Spring æ¡†æ¶çš„åŸºæœ¬åŠŸèƒ½ã€‚æ ¸å¿ƒå®¹å™¨çš„ä¸»è¦ç»„ä»¶æ˜¯ BeanFactoryï¼Œå®ƒæ˜¯å·¥å‚æ¨¡å¼çš„å®ç°ã€‚BeanFactory ä½¿ç”¨<em>æ§åˆ¶åè½¬</em>ï¼ˆIOCï¼‰ æ¨¡å¼å°†åº”ç”¨ç¨‹åºçš„é…ç½®å’Œä¾èµ–æ€§è§„èŒƒä¸å®é™…çš„åº”ç”¨ç¨‹åºä»£ç åˆ†å¼€ã€‚</li><li><strong>Spring ä¸Šä¸‹æ–‡</strong>ï¼šSpring ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘ Spring æ¡†æ¶æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚Spring ä¸Šä¸‹æ–‡åŒ…æ‹¬ä¼ä¸šæœåŠ¡ï¼Œä¾‹å¦‚ JNDIã€EJBã€ç”µå­é‚®ä»¶ã€å›½é™…åŒ–ã€æ ¡éªŒå’Œè°ƒåº¦åŠŸèƒ½ã€‚</li><li><strong>Spring AOP</strong>ï¼šé€šè¿‡é…ç½®ç®¡ç†ç‰¹æ€§ï¼ŒSpring AOP æ¨¡å—ç›´æ¥å°†é¢å‘åˆ‡é¢çš„ç¼–ç¨‹åŠŸèƒ½ , é›†æˆåˆ°äº† Spring æ¡†æ¶ä¸­ã€‚æ‰€ä»¥ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ Spring æ¡†æ¶ç®¡ç†ä»»ä½•æ”¯æŒ AOPçš„å¯¹è±¡ã€‚Spring AOP æ¨¡å—ä¸ºåŸºäº Spring çš„åº”ç”¨ç¨‹åºä¸­çš„å¯¹è±¡æä¾›äº†äº‹åŠ¡ç®¡ç†æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨ Spring AOPï¼Œä¸ç”¨ä¾èµ–ç»„ä»¶ï¼Œå°±å¯ä»¥å°†å£°æ˜æ€§äº‹åŠ¡ç®¡ç†é›†æˆåˆ°åº”ç”¨ç¨‹åºä¸­ã€‚</li><li><strong>Spring DAO</strong>ï¼šJDBC DAO æŠ½è±¡å±‚æä¾›äº†æœ‰æ„ä¹‰çš„å¼‚å¸¸å±‚æ¬¡ç»“æ„ï¼Œå¯ç”¨è¯¥ç»“æ„æ¥ç®¡ç†å¼‚å¸¸å¤„ç†å’Œä¸åŒæ•°æ®åº“ä¾›åº”å•†æŠ›å‡ºçš„é”™è¯¯æ¶ˆæ¯ã€‚å¼‚å¸¸å±‚æ¬¡ç»“æ„ç®€åŒ–äº†é”™è¯¯å¤„ç†ï¼Œå¹¶ä¸”æå¤§åœ°é™ä½äº†éœ€è¦ç¼–å†™çš„å¼‚å¸¸ä»£ç æ•°é‡ï¼ˆä¾‹å¦‚æ‰“å¼€å’Œå…³é—­è¿æ¥ï¼‰ã€‚Spring DAO çš„é¢å‘ JDBC çš„å¼‚å¸¸éµä»é€šç”¨çš„ DAO å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚</li><li><strong>Spring ORM</strong>ï¼šSpring æ¡†æ¶æ’å…¥äº†è‹¥å¹²ä¸ª ORM æ¡†æ¶ï¼Œä»è€Œæä¾›äº† ORM çš„å¯¹è±¡å…³ç³»å·¥å…·ï¼Œå…¶ä¸­åŒ…æ‹¬ JDOã€Hibernate å’Œ iBatis SQL Mapã€‚æ‰€æœ‰è¿™äº›éƒ½éµä» Spring çš„é€šç”¨äº‹åŠ¡å’Œ DAO å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚</li><li><strong>Spring Web æ¨¡å—</strong>ï¼šWeb ä¸Šä¸‹æ–‡æ¨¡å—å»ºç«‹åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æ¨¡å—ä¹‹ä¸Šï¼Œä¸ºåŸºäº Web çš„åº”ç”¨ç¨‹åºæä¾›äº†ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥ï¼ŒSpring æ¡†æ¶æ”¯æŒä¸ Jakarta Struts çš„é›†æˆã€‚Web æ¨¡å—è¿˜ç®€åŒ–äº†å¤„ç†å¤šéƒ¨åˆ†è¯·æ±‚ä»¥åŠå°†è¯·æ±‚å‚æ•°ç»‘å®šåˆ°åŸŸå¯¹è±¡çš„å·¥ä½œã€‚</li><li><strong>Spring MVC æ¡†æ¶</strong>ï¼šMVC æ¡†æ¶æ˜¯ä¸€ä¸ªå…¨åŠŸèƒ½çš„æ„å»º Web åº”ç”¨ç¨‹åºçš„ MVC å®ç°ã€‚é€šè¿‡ç­–ç•¥æ¥å£ï¼ŒMVC æ¡†æ¶å˜æˆä¸ºé«˜åº¦å¯é…ç½®çš„ï¼ŒMVC å®¹çº³äº†å¤§é‡è§†å›¾æŠ€æœ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ JSPã€Velocityã€Tilesã€iText å’Œ POIã€‚</li></ul><h2 id="1-2-Spring-Bootä¸Spring-Cloud"><a href="#1-2-Spring-Bootä¸Spring-Cloud" class="headerlink" title="1.2 Spring Bootä¸Spring Cloud"></a>1.2 <strong>Spring Bootä¸Spring Cloud</strong></h2><blockquote><p>Spring Boot:æ„å»ºä¸€åˆ‡</p><p>Spring Cloud:åè°ƒä¸€åˆ‡</p><p>Spring MVC:è¿æ¥ä¸€åˆ‡</p></blockquote><ul><li>Spring Boot æ˜¯ Spring çš„ä¸€å¥—å¿«é€Ÿé…ç½®è„šæ‰‹æ¶ï¼Œå¯ä»¥åŸºäºSpring Boot å¿«é€Ÿå¼€å‘å•ä¸ªå¾®æœåŠ¡;</li><li>Spring Cloudæ˜¯åŸºäºSpring Bootå®ç°çš„ï¼›</li><li>Spring Bootä¸“æ³¨äºå¿«é€Ÿã€æ–¹ä¾¿é›†æˆçš„å•ä¸ªå¾®æœåŠ¡ä¸ªä½“ï¼ŒSpring Cloudå…³æ³¨å…¨å±€çš„æœåŠ¡æ²»ç†æ¡†æ¶ï¼›</li><li>Spring Bootä½¿ç”¨äº†çº¦æŸä¼˜äºé…ç½®çš„ç†å¿µï¼Œå¾ˆå¤šé›†æˆæ–¹æ¡ˆå·²ç»å¸®ä½ é€‰æ‹©å¥½äº†ï¼Œèƒ½ä¸é…ç½®å°±ä¸é…ç½® , Spring Cloudå¾ˆå¤§çš„ä¸€éƒ¨åˆ†æ˜¯åŸºäºSpring Bootæ¥å®ç°ï¼ŒSpring Bootå¯ä»¥ç¦»å¼€Spring Cloudç‹¬ç«‹ä½¿ç”¨å¼€å‘é¡¹ç›®ï¼Œä½†æ˜¯Spring Cloudç¦»ä¸å¼€Spring Bootï¼Œå±äºä¾èµ–çš„å…³ç³»ã€‚</li><li>SpringBootåœ¨SpringCloundä¸­èµ·åˆ°äº†æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼Œå¦‚æœä½ è¦å­¦ä¹ SpringCloudå¿…é¡»è¦å­¦ä¹ SpringBootã€‚</li></ul><h2 id="1-3-IOCåŸºç¡€"><a href="#1-3-IOCåŸºç¡€" class="headerlink" title="1.3 IOCåŸºç¡€"></a>1.3 IOCåŸºç¡€</h2><p>æ–°å»ºä¸€ä¸ªç©ºç™½çš„mavené¡¹ç›®</p><h3 id="1-3-1-åˆ†æå®ç°"><a href="#1-3-1-åˆ†æå®ç°" class="headerlink" title="1.3.1 åˆ†æå®ç°"></a>1.3.1 åˆ†æå®ç°</h3><p>æˆ‘ä»¬å…ˆç”¨æˆ‘ä»¬åŸæ¥çš„æ–¹å¼å†™ä¸€æ®µä»£ç  .</p><p>1ã€å…ˆå†™ä¸€ä¸ªUserDaoæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserDao</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span></span>;<br>&#125;java<br></code></pre></td></tr></table></figure><p>2ã€å†å»å†™Daoçš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDao</span> </span>&#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;è·å–ç”¨æˆ·æ•°æ®&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€ç„¶åå»å†™UserServiceçš„æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€æœ€åå†™Serviceçš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> UserDao userDao = <span class="hljs-keyword">new</span> UserDaoImpl();<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;<br>       userDao.getUser();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>   UserService service = <span class="hljs-keyword">new</span> UserServiceImpl();<br>   service.getUser();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯æˆ‘ä»¬åŸæ¥çš„æ–¹å¼ , å¼€å§‹å¤§å®¶ä¹Ÿéƒ½æ˜¯è¿™ä¹ˆå»å†™çš„å¯¹å§ . é‚£æˆ‘ä»¬ç°åœ¨ä¿®æ”¹ä¸€ä¸‹ .</p><p>æŠŠUserdaoçš„å®ç°ç±»å¢åŠ ä¸€ä¸ª .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoMySqlImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDao</span> </span>&#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;MySqlè·å–ç”¨æˆ·æ•°æ®&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç´§æ¥ç€æˆ‘ä»¬è¦å»ä½¿ç”¨MySqlçš„è¯ , æˆ‘ä»¬å°±éœ€è¦å»serviceå®ç°ç±»é‡Œé¢ä¿®æ”¹å¯¹åº”çš„å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> UserDao userDao = <span class="hljs-keyword">new</span> UserDaoMySqlImpl();<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;<br>       userDao.getUser();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å‡è®¾, æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªUserdaoçš„å®ç°ç±» .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoOracleImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDao</span> </span>&#123;<br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;Oracleè·å–ç”¨æˆ·æ•°æ®&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨Oracle , åˆéœ€è¦å»serviceå®ç°ç±»é‡Œé¢ä¿®æ”¹å¯¹åº”çš„å®ç° . å‡è®¾æˆ‘ä»¬çš„è¿™ç§éœ€æ±‚éå¸¸å¤§ , è¿™ç§æ–¹å¼å°±æ ¹æœ¬ä¸é€‚ç”¨äº†, ç”šè‡³åäººç±»å¯¹å§ , æ¯æ¬¡å˜åŠ¨ , éƒ½éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç  . è¿™ç§è®¾è®¡çš„è€¦åˆæ€§å¤ªé«˜äº†, ç‰µä¸€å‘è€ŒåŠ¨å…¨èº« .</p><p><strong>é‚£æˆ‘ä»¬å¦‚ä½•å»è§£å†³å‘¢ ?</strong> </p><p>æˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦ç”¨åˆ°ä»–çš„åœ°æ–¹ , ä¸å»å®ç°å®ƒ , è€Œæ˜¯ç•™å‡ºä¸€ä¸ªæ¥å£ , åˆ©ç”¨set , æˆ‘ä»¬å»ä»£ç é‡Œä¿®æ”¹ä¸‹ .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> UserDao userDao;<br><span class="hljs-comment">// åˆ©ç”¨setå®ç°</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserDao</span><span class="hljs-params">(UserDao userDao)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.userDao = userDao;<br>  &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUser</span><span class="hljs-params">()</span> </span>&#123;<br>       userDao.getUser();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨å»æˆ‘ä»¬çš„æµ‹è¯•ç±»é‡Œ , è¿›è¡Œæµ‹è¯• ;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>   UserServiceImpl service = <span class="hljs-keyword">new</span> UserServiceImpl();<br>   service.setUserDao( <span class="hljs-keyword">new</span> UserDaoMySqlImpl() );<br>   service.getUser();<br>   <span class="hljs-comment">//é‚£æˆ‘ä»¬ç°åœ¨åˆæƒ³ç”¨Oracleå»å®ç°å‘¢</span><br>   service.setUserDao( <span class="hljs-keyword">new</span> UserDaoOracleImpl() );<br>   service.getUser();<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤§å®¶å‘ç°äº†åŒºåˆ«æ²¡æœ‰ ? å¯èƒ½å¾ˆå¤šäººè¯´æ²¡å•¥åŒºåˆ« . ä½†æ˜¯åŒå­¦ä»¬ , ä»–ä»¬å·²ç»å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„å˜åŒ– , å¾ˆå¤šåœ°æ–¹éƒ½ä¸ä¸€æ ·äº† . ä»”ç»†å»æ€è€ƒä¸€ä¸‹ , ä»¥å‰æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯ç”±ç¨‹åºå»è¿›è¡Œæ§åˆ¶åˆ›å»º , è€Œç°åœ¨æ˜¯ç”±æˆ‘ä»¬è‡ªè¡Œæ§åˆ¶åˆ›å»ºå¯¹è±¡ , æŠŠä¸»åŠ¨æƒäº¤ç»™äº†è°ƒç”¨è€… . ç¨‹åºä¸ç”¨å»ç®¡æ€ä¹ˆåˆ›å»º,æ€ä¹ˆå®ç°äº† . å®ƒåªè´Ÿè´£æä¾›ä¸€ä¸ªæ¥å£ .</p><p>è¿™ç§æ€æƒ³ , ä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ , æˆ‘ä»¬ç¨‹åºå‘˜ä¸å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºäº† , æ›´å¤šçš„å»å…³æ³¨ä¸šåŠ¡çš„å®ç° . è€¦åˆæ€§å¤§å¤§é™ä½ . è¿™ä¹Ÿå°±æ˜¯IOCçš„åŸå‹ !</p><h3 id="1-3-2-IOCæœ¬è´¨"><a href="#1-3-2-IOCæœ¬è´¨" class="headerlink" title="1.3.2 IOCæœ¬è´¨"></a>1.3.2 IOCæœ¬è´¨</h3><p><strong>æ§åˆ¶åè½¬IoC(Inversion of Control)ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDI(ä¾èµ–æ³¨å…¥)æ˜¯å®ç°IoCçš„ä¸€ç§æ–¹æ³•</strong>ï¼Œä¹Ÿæœ‰äººè®¤ä¸ºDIåªæ˜¯IoCçš„å¦ä¸€ç§è¯´æ³•ã€‚æ²¡æœ‰IoCçš„ç¨‹åºä¸­ , æˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ , å¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶åè½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯ï¼šè·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/3.png" alt="å›¾ç‰‡"></p><p><strong>IoCæ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒå†…å®¹</strong>ï¼Œä½¿ç”¨å¤šç§æ–¹å¼å®Œç¾çš„å®ç°äº†IoCï¼Œå¯ä»¥ä½¿ç”¨XMLé…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£ï¼Œæ–°ç‰ˆæœ¬çš„Springä¹Ÿå¯ä»¥é›¶é…ç½®å®ç°IoCã€‚</p><p>Springå®¹å™¨åœ¨åˆå§‹åŒ–æ—¶å…ˆè¯»å–é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æˆ–å…ƒæ•°æ®åˆ›å»ºä¸ç»„ç»‡å¯¹è±¡å­˜å…¥å®¹å™¨ä¸­ï¼Œç¨‹åºä½¿ç”¨æ—¶å†ä»Iocå®¹å™¨ä¸­å–å‡ºéœ€è¦çš„å¯¹è±¡ã€‚</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/4.png" alt="å›¾ç‰‡"></p><p>é‡‡ç”¨XMLæ–¹å¼é…ç½®Beançš„æ—¶å€™ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯æ˜¯å’Œå®ç°åˆ†ç¦»çš„ï¼Œè€Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼å¯ä»¥æŠŠä¸¤è€…åˆä¸ºä¸€ä½“ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯ç›´æ¥ä»¥æ³¨è§£çš„å½¢å¼å®šä¹‰åœ¨å®ç°ç±»ä¸­ï¼Œä»è€Œè¾¾åˆ°äº†é›¶é…ç½®çš„ç›®çš„ã€‚</p><p><strong>æ§åˆ¶åè½¬æ˜¯ä¸€ç§é€šè¿‡æè¿°ï¼ˆXMLæˆ–æ³¨è§£ï¼‰å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹å»ç”Ÿäº§æˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚åœ¨Springä¸­å®ç°æ§åˆ¶åè½¬çš„æ˜¯IoCå®¹å™¨ï¼Œå…¶å®ç°æ–¹æ³•æ˜¯ä¾èµ–æ³¨å…¥ï¼ˆDependency Injection,DIï¼‰ã€‚</strong></p><h1 id="äºŒã€åˆ›å»ºSpringç¨‹åº"><a href="#äºŒã€åˆ›å»ºSpringç¨‹åº" class="headerlink" title="äºŒã€åˆ›å»ºSpringç¨‹åº"></a>äºŒã€åˆ›å»ºSpringç¨‹åº</h1><h2 id="2-1-åˆ›å»ºè¿‡ç¨‹"><a href="#2-1-åˆ›å»ºè¿‡ç¨‹" class="headerlink" title="2.1 åˆ›å»ºè¿‡ç¨‹"></a>2.1 åˆ›å»ºè¿‡ç¨‹</h2><h3 id="2-1-1-å¯¼å…¥JaråŒ…"><a href="#2-1-1-å¯¼å…¥JaråŒ…" class="headerlink" title="2.1.1 å¯¼å…¥JaråŒ…"></a>2.1.1 å¯¼å…¥JaråŒ…</h3><p>æ³¨ : spring éœ€è¦å¯¼å…¥commons-loggingè¿›è¡Œæ—¥å¿—è®°å½• . æˆ‘ä»¬åˆ©ç”¨maven , ä»–ä¼šè‡ªåŠ¨ä¸‹è½½å¯¹åº”çš„ä¾èµ–é¡¹ .</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2-1-2-ç¼–å†™ä»£ç "><a href="#2-1-2-ç¼–å†™ä»£ç " class="headerlink" title="2.1.2 ç¼–å†™ä»£ç "></a>2.1.2 ç¼–å†™ä»£ç </h3><p>1ã€ç¼–å†™ä¸€ä¸ªHelloå®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hello</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> String name;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> name;<br>  &#125;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.name = name;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;Hello,&quot;</span>+ name );<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™æˆ‘ä»¬çš„springæ–‡ä»¶ , è¿™é‡Œæˆ‘ä»¬å‘½åä¸ºbeans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--beanå°±æ˜¯javaå¯¹è±¡ , ç”±Springåˆ›å»ºå’Œç®¡ç†--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Hello&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬å¯ä»¥å»è¿›è¡Œæµ‹è¯•äº† .</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-comment">//è§£æbeans.xmlæ–‡ä»¶ , ç”Ÿæˆç®¡ç†ç›¸åº”çš„Beanå¯¹è±¡</span><br>   ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>   <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span><br>   Hello hello = (Hello) context.getBean(<span class="hljs-string">&quot;hello&quot;</span>);<br>   hello.show();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-1-3-æ€è€ƒ"><a href="#2-1-3-æ€è€ƒ" class="headerlink" title="2.1.3 æ€è€ƒ"></a>2.1.3 æ€è€ƒ</h3><ul><li>Hello å¯¹è±¡æ˜¯è°åˆ›å»ºçš„ ?  ã€hello å¯¹è±¡æ˜¯ç”±Springåˆ›å»ºçš„ã€‘</li><li>Hello å¯¹è±¡çš„å±æ€§æ˜¯æ€ä¹ˆè®¾ç½®çš„ ?  ã€hello å¯¹è±¡çš„å±æ€§æ˜¯ç”±Springå®¹å™¨è®¾ç½®çš„ã€‘</li></ul><p>è¿™ä¸ªè¿‡ç¨‹å°±å«æ§åˆ¶åè½¬ :</p><ul><li>æ§åˆ¶ : è°æ¥æ§åˆ¶å¯¹è±¡çš„åˆ›å»º , ä¼ ç»Ÿåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ˜¯ç”±ç¨‹åºæœ¬èº«æ§åˆ¶åˆ›å»ºçš„ , ä½¿ç”¨Springå , å¯¹è±¡æ˜¯ç”±Springæ¥åˆ›å»ºçš„</li><li>åè½¬ : ç¨‹åºæœ¬èº«ä¸åˆ›å»ºå¯¹è±¡ , è€Œå˜æˆè¢«åŠ¨çš„æ¥æ”¶å¯¹è±¡ .</li></ul><p>ä¾èµ–æ³¨å…¥ : å°±æ˜¯åˆ©ç”¨setæ–¹æ³•æ¥è¿›è¡Œæ³¨å…¥çš„.</p><p> IOCæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œç”±ä¸»åŠ¨çš„ç¼–ç¨‹å˜æˆè¢«åŠ¨çš„æ¥æ”¶</p><p>å¯ä»¥é€šè¿‡newClassPathXmlApplicationContextå»æµè§ˆä¸€ä¸‹åº•å±‚æºç  .</p><blockquote><p>ä¿®æ”¹æ¡ˆä¾‹ä¸€</p></blockquote><p>æˆ‘ä»¬åœ¨æ¡ˆä¾‹ä¸€ä¸­ï¼Œ æ–°å¢ä¸€ä¸ªSpringé…ç½®æ–‡ä»¶beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;MysqlImpl&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.dao.impl.UserDaoMySqlImpl&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;OracleImpl&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.dao.impl.UserDaoOracleImpl&quot;</span>/&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;ServiceImpl&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.service.impl.UserServiceImpl&quot;</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--æ³¨æ„: è¿™é‡Œçš„nameå¹¶ä¸æ˜¯å±æ€§ , è€Œæ˜¯setæ–¹æ³•åé¢çš„é‚£éƒ¨åˆ† , é¦–å­—æ¯å°å†™--&gt;</span><br>       <span class="hljs-comment">&lt;!--å¼•ç”¨å¦å¤–ä¸€ä¸ªbean , ä¸æ˜¯ç”¨value è€Œæ˜¯ç”¨ ref--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;OracleImpl&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span></span>&#123;<br>   ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>   UserServiceImpl serviceImpl = (UserServiceImpl) context.getBean(<span class="hljs-string">&quot;ServiceImpl&quot;</span>);<br>   serviceImpl.getUser();<br>&#125;<br></code></pre></td></tr></table></figure><p>OK , åˆ°äº†ç°åœ¨ , æˆ‘ä»¬å½»åº•ä¸ç”¨å†ç¨‹åºä¸­å»æ”¹åŠ¨äº† , è¦å®ç°ä¸åŒçš„æ“ä½œ , åªéœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ , æ‰€è°“çš„IoC,ä¸€å¥è¯æå®š : å¯¹è±¡ç”±Spring æ¥åˆ›å»º , ç®¡ç† , è£…é… ! </p><h2 id="2-2-IOCåˆ›å»ºå¯¹è±¡æ–¹å¼"><a href="#2-2-IOCåˆ›å»ºå¯¹è±¡æ–¹å¼" class="headerlink" title="2.2 IOCåˆ›å»ºå¯¹è±¡æ–¹å¼"></a>2.2 IOCåˆ›å»ºå¯¹è±¡æ–¹å¼</h2><h3 id="2-2-1-é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"><a href="#2-2-1-é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º" class="headerlink" title="2.2.1 é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"></a>2.2.1 é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</h3><p>1ã€User.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br><br>   <span class="hljs-keyword">private</span> String name;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;useræ— å‚æ„é€ æ–¹æ³•&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.name = name;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;name=&quot;</span>+ name );<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;kuangshen&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>   ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>   <span class="hljs-comment">//åœ¨æ‰§è¡ŒgetBeançš„æ—¶å€™, userå·²ç»åˆ›å»ºå¥½äº† , é€šè¿‡æ— å‚æ„é€ </span><br>   User user = (User) context.getBean(<span class="hljs-string">&quot;user&quot;</span>);<br>   <span class="hljs-comment">//è°ƒç”¨å¯¹è±¡çš„æ–¹æ³• .</span><br>   user.show();<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœå¯ä»¥å‘ç°ï¼Œåœ¨è°ƒç”¨showæ–¹æ³•ä¹‹å‰ï¼ŒUserå¯¹è±¡å·²ç»é€šè¿‡æ— å‚æ„é€ åˆå§‹åŒ–äº†ï¼</p><h3 id="2-2-2-é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"><a href="#2-2-2-é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º" class="headerlink" title="2.2.2 é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"></a>2.2.2 é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</h3><p>1ã€UserT . java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserT</span> </span>&#123;<br><br>   <span class="hljs-keyword">private</span> String name;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UserT</span><span class="hljs-params">(String name)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.name = name;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.name = name;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;name=&quot;</span>+ name );<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€beans.xml æœ‰ä¸‰ç§æ–¹å¼ç¼–å†™</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- ç¬¬ä¸€ç§æ ¹æ®indexå‚æ•°ä¸‹æ ‡è®¾ç½® --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userT&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.UserT&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- indexæŒ‡æ„é€ æ–¹æ³• , ä¸‹æ ‡ä»0å¼€å§‹ --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;kuangshen2&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!-- ç¬¬äºŒç§æ ¹æ®å‚æ•°åå­—è®¾ç½® --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userT&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.UserT&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- nameæŒ‡å‚æ•°å --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;kuangshen2&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!-- ç¬¬ä¸‰ç§æ ¹æ®å‚æ•°ç±»å‹è®¾ç½® --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userT&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.UserT&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;kuangshen2&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testT</span><span class="hljs-params">()</span></span>&#123;<br>   ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>   UserT user = (UserT) context.getBean(<span class="hljs-string">&quot;userT&quot;</span>);<br>   user.show();<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“è®ºï¼šåœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ã€‚å…¶ä¸­ç®¡ç†çš„å¯¹è±¡éƒ½å·²ç»åˆå§‹åŒ–äº†ï¼</p><h1 id="ä¸‰ã€Springé…ç½®"><a href="#ä¸‰ã€Springé…ç½®" class="headerlink" title="ä¸‰ã€Springé…ç½®"></a>ä¸‰ã€Springé…ç½®</h1><h2 id="3-1-Aliasåˆ«å"><a href="#3-1-Aliasåˆ«å" class="headerlink" title="3.1 Aliasåˆ«å"></a>3.1 Aliasåˆ«å</h2><p>alias è®¾ç½®åˆ«å , ä¸ºbeanè®¾ç½®åˆ«å , å¯ä»¥è®¾ç½®å¤šä¸ªåˆ«å</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--è®¾ç½®åˆ«åï¼šåœ¨è·å–Beançš„æ—¶å€™å¯ä»¥ä½¿ç”¨åˆ«åè·å–--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">alias</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userT&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;userNew&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><h2 id="3-2-Beançš„é…ç½®"><a href="#3-2-Beançš„é…ç½®" class="headerlink" title="3.2 Beançš„é…ç½®"></a>3.2 Beançš„é…ç½®</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--beanå°±æ˜¯javaå¯¹è±¡,ç”±Springåˆ›å»ºå’Œç®¡ç†--&gt;</span><br><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">   id æ˜¯beançš„æ ‡è¯†ç¬¦,è¦å”¯ä¸€,å¦‚æœæ²¡æœ‰é…ç½®id,nameå°±æ˜¯é»˜è®¤æ ‡è¯†ç¬¦</span><br><span class="hljs-comment">   å¦‚æœé…ç½®id,åˆé…ç½®äº†name,é‚£ä¹ˆnameæ˜¯åˆ«å</span><br><span class="hljs-comment">   nameå¯ä»¥è®¾ç½®å¤šä¸ªåˆ«å,å¯ä»¥ç”¨é€—å·,åˆ†å·,ç©ºæ ¼éš”å¼€</span><br><span class="hljs-comment">   å¦‚æœä¸é…ç½®idå’Œname,å¯ä»¥æ ¹æ®applicationContext.getBean(.class)è·å–å¯¹è±¡;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">classæ˜¯beançš„å…¨é™å®šå=åŒ…å+ç±»å</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hello2 h2,h3;h4&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Hello&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="3-3-importå¯¼å…¥æ–‡ä»¶"><a href="#3-3-importå¯¼å…¥æ–‡ä»¶" class="headerlink" title="3.3 importå¯¼å…¥æ–‡ä»¶"></a>3.3 importå¯¼å…¥æ–‡ä»¶</h2><p>å›¢é˜Ÿçš„åˆä½œé€šè¿‡importæ¥å®ç° .</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;path&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">/beans.xml&quot;</span>/&gt;</span></span><br></code></pre></td></tr></table></figure><h1 id="å››ã€ä¾èµ–æ³¨å…¥"><a href="#å››ã€ä¾èµ–æ³¨å…¥" class="headerlink" title="å››ã€ä¾èµ–æ³¨å…¥"></a>å››ã€ä¾èµ–æ³¨å…¥</h1><ul><li>ä¾èµ–æ³¨å…¥ï¼ˆDependency Injection,DIï¼‰ã€‚</li><li>ä¾èµ– : æŒ‡Beanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ . Beanå¯¹è±¡çš„ä¾èµ–èµ„æº .</li><li>æ³¨å…¥ : æŒ‡Beanå¯¹è±¡æ‰€ä¾èµ–çš„èµ„æº , ç”±å®¹å™¨æ¥è®¾ç½®å’Œè£…é… .</li></ul><h2 id="4-1-æ„é€ å™¨æ³¨å…¥"><a href="#4-1-æ„é€ å™¨æ³¨å…¥" class="headerlink" title="4.1 æ„é€ å™¨æ³¨å…¥"></a>4.1 æ„é€ å™¨æ³¨å…¥</h2><p>æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ¡ˆä¾‹å·²ç»è®²è¿‡äº†</p><h2 id="4-2-Set-æ³¨å…¥-ï¼ˆé‡ç‚¹ï¼‰"><a href="#4-2-Set-æ³¨å…¥-ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="4.2 Set æ³¨å…¥ ï¼ˆé‡ç‚¹ï¼‰"></a>4.2 Set æ³¨å…¥ ï¼ˆé‡ç‚¹ï¼‰</h2><p>è¦æ±‚è¢«æ³¨å…¥çš„å±æ€§ , å¿…é¡»æœ‰setæ–¹æ³• , setæ–¹æ³•çš„æ–¹æ³•åç”±set + å±æ€§é¦–å­—æ¯å¤§å†™ , å¦‚æœå±æ€§æ˜¯booleanç±»å‹ , æ²¡æœ‰setæ–¹æ³• , æ˜¯ is .</p><p>æµ‹è¯•pojoç±» :</p><p>Address.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> String address;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAddress</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> address;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAddress</span><span class="hljs-params">(String address)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.address = address;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Student.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.pojo;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><span class="hljs-keyword">import</span> java.util.Set;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Address address;<br>    <span class="hljs-keyword">private</span> String[] books;<br>    <span class="hljs-keyword">private</span> List&lt;String&gt; hobbys;<br>    <span class="hljs-keyword">private</span> Map&lt;String,String&gt; card;<br>    <span class="hljs-keyword">private</span> Set&lt;String&gt; games;<br>    <span class="hljs-keyword">private</span> String wife;<br>    <span class="hljs-keyword">private</span> Properties info;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAddress</span><span class="hljs-params">(Address address)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.address = address;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBooks</span><span class="hljs-params">(String[] books)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.books = books;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHobbys</span><span class="hljs-params">(List&lt;String&gt; hobbys)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.hobbys = hobbys;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setCard</span><span class="hljs-params">(Map&lt;String, String&gt; card)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.card = card;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setGames</span><span class="hljs-params">(Set&lt;String&gt; games)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.games = games;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setWife</span><span class="hljs-params">(String wife)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.wife = wife;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setInfo</span><span class="hljs-params">(Properties info)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.info = info;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;name=&quot;</span>+ name<br>                + <span class="hljs-string">&quot;,address=&quot;</span>+ address.getAddress()<br>                + <span class="hljs-string">&quot;,books=&quot;</span><br>       );<br>        <span class="hljs-keyword">for</span> (String book:books)&#123;<br>            System.out.print(<span class="hljs-string">&quot;&lt;&lt;&quot;</span>+book+<span class="hljs-string">&quot;&gt;&gt;\t&quot;</span>);<br>       &#125;<br>        System.out.println(<span class="hljs-string">&quot;\nçˆ±å¥½:&quot;</span>+hobbys);<br><br>        System.out.println(<span class="hljs-string">&quot;card:&quot;</span>+card);<br><br>        System.out.println(<span class="hljs-string">&quot;games:&quot;</span>+games);<br><br>        System.out.println(<span class="hljs-string">&quot;wife:&quot;</span>+wife);<br><br>        System.out.println(<span class="hljs-string">&quot;info:&quot;</span>+info);<br><br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-2-1-å¸¸é‡æ³¨å…¥"><a href="#4-2-1-å¸¸é‡æ³¨å…¥" class="headerlink" title="4.2.1 å¸¸é‡æ³¨å…¥"></a>4.2.1 <strong>å¸¸é‡æ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;å°æ˜&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test01</span><span class="hljs-params">()</span></span>&#123;<br>    ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<br><br>    Student student = (Student) context.getBean(<span class="hljs-string">&quot;student&quot;</span>);<br><br>    System.out.println(student.getName());<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-2-2-Beanæ³¨å…¥"><a href="#4-2-2-Beanæ³¨å…¥" class="headerlink" title="4.2.2 Beanæ³¨å…¥"></a>4.2.2 Beanæ³¨å…¥</h3><p>æ³¨æ„ç‚¹ï¼šè¿™é‡Œçš„å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œref</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addr&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Address&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;é‡åº†&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;å°æ˜&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;addr&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-3-æ•°ç»„æ³¨å…¥"><a href="#4-2-3-æ•°ç»„æ³¨å…¥" class="headerlink" title="4.2.3 æ•°ç»„æ³¨å…¥"></a>4.2.3 <strong>æ•°ç»„æ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Student&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;å°æ˜&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;addr&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;books&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>è¥¿æ¸¸è®°<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>çº¢æ¥¼æ¢¦<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>æ°´æµ’ä¼ <span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-4-Listæ³¨å…¥"><a href="#4-2-4-Listæ³¨å…¥" class="headerlink" title="4.2.4 Listæ³¨å…¥"></a>4.2.4 <strong>Listæ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobbys&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">list</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>å¬æ­Œ<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>çœ‹ç”µå½±<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>çˆ¬å±±<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">list</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-5-Mapæ³¨å…¥"><a href="#4-2-5-Mapæ³¨å…¥" class="headerlink" title="4.2.5 Mapæ³¨å…¥"></a>4.2.5 <strong>Mapæ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;card&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">map</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;ä¸­å›½é‚®æ”¿&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;456456456465456&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;å»ºè®¾&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1456682255511&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">map</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-6-setæ³¨å…¥"><a href="#4-2-6-setæ³¨å…¥" class="headerlink" title="4.2.6 setæ³¨å…¥"></a>4.2.6 <strong>setæ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;games&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>LOL<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>BOB<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>COC<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-7-Nullæ³¨å…¥"><a href="#4-2-7-Nullæ³¨å…¥" class="headerlink" title="4.2.7 Nullæ³¨å…¥"></a>4.2.7 <strong>Nullæ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;wife&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">null</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-8-Propertiesæ³¨å…¥"><a href="#4-2-8-Propertiesæ³¨å…¥" class="headerlink" title="4.2.8 Propertiesæ³¨å…¥"></a>4.2.8 <strong>Propertiesæ³¨å…¥</strong></h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;info&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">props</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;å­¦å·&quot;</span>&gt;</span>20190604<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;æ€§åˆ«&quot;</span>&gt;</span>ç”·<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;å§“å&quot;</span>&gt;</span>å°æ˜<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">props</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-2-9-æµ‹è¯•ç»“æœï¼š"><a href="#4-2-9-æµ‹è¯•ç»“æœï¼š" class="headerlink" title="4.2.9 æµ‹è¯•ç»“æœï¼š"></a>4.2.9 æµ‹è¯•ç»“æœï¼š</h3><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/5.png" alt="å›¾ç‰‡"></p><h2 id="4-3-på‘½åå’Œcå‘½åæ³¨å…¥"><a href="#4-3-på‘½åå’Œcå‘½åæ³¨å…¥" class="headerlink" title="4.3 på‘½åå’Œcå‘½åæ³¨å…¥"></a>4.3 på‘½åå’Œcå‘½åæ³¨å…¥</h2><p>User.java ï¼šã€æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰æœ‰å‚æ„é€ å™¨ï¼ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>   &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.age = age;<br>   &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;java<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>1ã€På‘½åç©ºé—´æ³¨å…¥ : éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">å¯¼å…¥çº¦æŸ : xmlns:p=&quot;http://www.springframework.org/schema/p&quot;<br><br><span class="hljs-comment">&lt;!--P(å±æ€§: properties)å‘½åç©ºé—´ , å±æ€§ä¾ç„¶è¦è®¾ç½®setæ–¹æ³•--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span> <span class="hljs-attr">p:name</span>=<span class="hljs-string">&quot;ç‹‚ç¥&quot;</span> <span class="hljs-attr">p:age</span>=<span class="hljs-string">&quot;18&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€c å‘½åç©ºé—´æ³¨å…¥ : éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">å¯¼å…¥çº¦æŸ : xmlns:c=&quot;http://www.springframework.org/schema/c&quot;<br><span class="hljs-comment">&lt;!--C(æ„é€ : Constructor)å‘½åç©ºé—´ , å±æ€§ä¾ç„¶è¦è®¾ç½®setæ–¹æ³•--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span> <span class="hljs-attr">c:name</span>=<span class="hljs-string">&quot;ç‹‚ç¥&quot;</span> <span class="hljs-attr">c:age</span>=<span class="hljs-string">&quot;18&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>å‘ç°é—®é¢˜ï¼šçˆ†çº¢äº†ï¼Œåˆšæ‰æˆ‘ä»¬æ²¡æœ‰å†™æœ‰å‚æ„é€ ï¼</p><p>è§£å†³ï¼šåœ¨å®ä½“ç±»ä¸­æŠŠæœ‰å‚æ„é€ å™¨åŠ ä¸Šï¼Œè¿™é‡Œä¹Ÿèƒ½çŸ¥é“ï¼Œc å°±æ˜¯æ‰€è°“çš„æ„é€ å™¨æ³¨å…¥ï¼</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test02</span><span class="hljs-params">()</span></span>&#123;<br>    ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<br>    User user = (User) context.getBean(<span class="hljs-string">&quot;user&quot;</span>);<br>    System.out.println(user);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-4-Beançš„ä½œç”¨åŸŸ"><a href="#4-4-Beançš„ä½œç”¨åŸŸ" class="headerlink" title="4.4 Beançš„ä½œç”¨åŸŸ"></a>4.4 Beançš„ä½œç”¨åŸŸ</h2><p>åœ¨Springä¸­ï¼Œé‚£äº›ç»„æˆåº”ç”¨ç¨‹åºçš„ä¸»ä½“åŠç”±Spring IoCå®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡ï¼Œè¢«ç§°ä¹‹ä¸ºbeanã€‚ç®€å•åœ°è®²ï¼Œbeanå°±æ˜¯ç”±IoCå®¹å™¨åˆå§‹åŒ–ã€è£…é…åŠç®¡ç†çš„å¯¹è±¡ .</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/6.png" alt="å›¾ç‰‡"></p><p>å‡ ç§ä½œç”¨åŸŸä¸­ï¼Œrequestã€sessionä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„åº”ç”¨ä¸­ä½¿ç”¨ï¼ˆä¸å¿…å…³å¿ƒä½ æ‰€é‡‡ç”¨çš„æ˜¯ä»€ä¹ˆwebåº”ç”¨æ¡†æ¶ï¼‰ï¼Œåªèƒ½ç”¨åœ¨åŸºäºwebçš„Spring ApplicationContextç¯å¢ƒã€‚</p><h4 id="Singleton"><a href="#Singleton" class="headerlink" title="Singleton"></a>Singleton</h4><p>ä¹Ÿæ˜¯Springé»˜è®¤æœºåˆ¶</p><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSingletonï¼Œé‚£ä¹ˆSpring IoCå®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº«çš„beanå®ä¾‹ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹beançš„è¯·æ±‚ï¼Œåªè¦idä¸è¯¥beanå®šä¹‰ç›¸åŒ¹é…ï¼Œåˆ™åªä¼šè¿”å›beançš„åŒä¸€å®ä¾‹ã€‚Singletonæ˜¯å•ä¾‹ç±»å‹ï¼Œå°±æ˜¯åœ¨åˆ›å»ºèµ·å®¹å™¨æ—¶å°±åŒæ—¶è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªbeançš„å¯¹è±¡ï¼Œä¸ç®¡ä½ æ˜¯å¦ä½¿ç”¨ï¼Œä»–éƒ½å­˜åœ¨äº†ï¼Œæ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ³¨æ„ï¼ŒSingletonä½œç”¨åŸŸæ˜¯Springä¸­çš„ç¼ºçœä½œç”¨åŸŸã€‚è¦åœ¨XMLä¸­å°†beanå®šä¹‰æˆsingletonï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;ServiceImpl&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cn.csdn.service.ServiceImpl&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;singleton&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test03</span><span class="hljs-params">()</span></span>&#123;<br>    ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<br>    User user = (User) context.getBean(<span class="hljs-string">&quot;user&quot;</span>);<br>    User user2 = (User) context.getBean(<span class="hljs-string">&quot;user&quot;</span>);<br>    System.out.println(user==user2);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="Prototype"><a href="#Prototype" class="headerlink" title="Prototype"></a>Prototype</h4><p>æ¯æ¬¡ä»å®¹å™¨ä¸­getæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</p><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºPrototypeï¼Œè¡¨ç¤ºä¸€ä¸ªbeanå®šä¹‰å¯¹åº”å¤šä¸ªå¯¹è±¡å®ä¾‹ã€‚Prototypeä½œç”¨åŸŸçš„beanä¼šå¯¼è‡´åœ¨æ¯æ¬¡å¯¹è¯¥beanè¯·æ±‚ï¼ˆå°†å…¶æ³¨å…¥åˆ°å¦ä¸€ä¸ªbeanä¸­ï¼Œæˆ–è€…ä»¥ç¨‹åºçš„æ–¹å¼è°ƒç”¨å®¹å™¨çš„getBean()æ–¹æ³•ï¼‰æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanå®ä¾‹ã€‚Prototypeæ˜¯åŸå‹ç±»å‹ï¼Œå®ƒåœ¨æˆ‘ä»¬åˆ›å»ºå®¹å™¨çš„æ—¶å€™å¹¶æ²¡æœ‰å®ä¾‹åŒ–ï¼Œè€Œæ˜¯å½“æˆ‘ä»¬è·å–beançš„æ—¶å€™æ‰ä¼šå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”æˆ‘ä»¬æ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ ¹æ®ç»éªŒï¼Œå¯¹æœ‰çŠ¶æ€çš„beanåº”è¯¥ä½¿ç”¨prototypeä½œç”¨åŸŸï¼Œè€Œå¯¹æ— çŠ¶æ€çš„beanåˆ™åº”è¯¥ä½¿ç”¨singletonä½œç”¨åŸŸã€‚åœ¨XMLä¸­å°†beanå®šä¹‰æˆprototypeï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;account&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.foo.DefaultAccount&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;prototype&quot;</span>/&gt;</span>  <br> æˆ–è€…<br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;account&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.foo.DefaultAccount&quot;</span> <span class="hljs-attr">singleton</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><h4 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h4><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºRequestï¼Œè¡¨ç¤ºåœ¨ä¸€æ¬¡HTTPè¯·æ±‚ä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼›å³æ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šæœ‰å„è‡ªçš„beanå®ä¾‹ï¼Œå®ƒä»¬ä¾æ®æŸä¸ªbeanå®šä¹‰åˆ›å»ºè€Œæˆã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;loginAction&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">cn.csdn.LoginAction</span>&quot; <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;request&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>é’ˆå¯¹æ¯æ¬¡HTTPè¯·æ±‚ï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®loginAction beançš„å®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„LoginAction beanå®ä¾‹ï¼Œä¸”è¯¥loginAction beanå®ä¾‹ä»…åœ¨å½“å‰HTTP requestå†…æœ‰æ•ˆï¼Œå› æ­¤å¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œå…¶ä»–è¯·æ±‚ä¸­æ ¹æ®loginAction beanå®šä¹‰åˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªè¯·æ±‚çš„çŠ¶æ€å˜åŒ–ã€‚å½“å¤„ç†è¯·æ±‚ç»“æŸï¼Œrequestä½œç”¨åŸŸçš„beanå®ä¾‹å°†è¢«é”€æ¯ã€‚</p><h4 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h4><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSessionï¼Œè¡¨ç¤ºåœ¨ä¸€ä¸ªHTTP Sessionä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userPreferences&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.foo.UserPreferences&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;session&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>é’ˆå¯¹æŸä¸ªHTTP Sessionï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®userPreferences beanå®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„userPreferences beanå®ä¾‹ï¼Œä¸”è¯¥userPreferences beanä»…åœ¨å½“å‰HTTP Sessionå†…æœ‰æ•ˆã€‚ä¸requestä½œç”¨åŸŸä¸€æ ·ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€åˆ›å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œåˆ«çš„HTTP Sessionä¸­æ ¹æ®userPreferencesåˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªHTTP Sessionçš„çŠ¶æ€å˜åŒ–ã€‚å½“HTTP Sessionæœ€ç»ˆè¢«åºŸå¼ƒçš„æ—¶å€™ï¼Œåœ¨è¯¥HTTP Sessionä½œç”¨åŸŸå†…çš„beanä¹Ÿä¼šè¢«åºŸå¼ƒæ‰ã€‚</p><h1 id="äº”ã€Beançš„è‡ªåŠ¨è£…é…"><a href="#äº”ã€Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="äº”ã€Beançš„è‡ªåŠ¨è£…é…"></a>äº”ã€Beançš„è‡ªåŠ¨è£…é…</h1><ul><li>è‡ªåŠ¨è£…é…æ˜¯ä½¿ç”¨springæ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹æ³•</li><li>springä¼šåœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ä¸ºæŸä¸ªbeanå¯»æ‰¾å…¶ä¾èµ–çš„beanã€‚</li></ul><p>Springä¸­beanæœ‰ä¸‰ç§è£…é…æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ol><li>åœ¨xmlä¸­æ˜¾å¼é…ç½®ï¼›</li><li>åœ¨javaä¸­æ˜¾å¼é…ç½®ï¼›</li><li>éšå¼çš„beanå‘ç°æœºåˆ¶å’Œè‡ªåŠ¨è£…é…ã€‚</li></ol><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®²ç¬¬ä¸‰ç§ï¼šè‡ªåŠ¨åŒ–çš„è£…é…beanã€‚</p><p>Springçš„è‡ªåŠ¨è£…é…éœ€è¦ä»ä¸¤ä¸ªè§’åº¦æ¥å®ç°ï¼Œæˆ–è€…è¯´æ˜¯ä¸¤ä¸ªæ“ä½œï¼š</p><ol><li>ç»„ä»¶æ‰«æ(component scanning)ï¼šspringä¼šè‡ªåŠ¨å‘ç°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­æ‰€åˆ›å»ºçš„beanï¼›</li><li>è‡ªåŠ¨è£…é…(autowiring)ï¼šspringè‡ªåŠ¨æ»¡è¶³beanä¹‹é—´çš„ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„IoC/DIï¼›</li></ol><p>ç»„ä»¶æ‰«æå’Œè‡ªåŠ¨è£…é…ç»„åˆå‘æŒ¥å·¨å¤§å¨åŠ›ï¼Œä½¿å¾—æ˜¾ç¤ºçš„é…ç½®é™ä½åˆ°æœ€å°‘ã€‚</p><p><strong>æ¨èä¸ä½¿ç”¨è‡ªåŠ¨è£…é…xmlé…ç½® , è€Œä½¿ç”¨æ³¨è§£ .</strong></p><h2 id="5-1-æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#5-1-æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="5.1 æµ‹è¯•ç¯å¢ƒæ­å»º"></a>5.1 æµ‹è¯•ç¯å¢ƒæ­å»º</h2><p>1ã€æ–°å»ºä¸€ä¸ªé¡¹ç›®</p><p>2ã€æ–°å»ºä¸¤ä¸ªå®ä½“ç±»ï¼ŒCat  Dog  éƒ½æœ‰ä¸€ä¸ªå«çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;miao~&quot;</span>);<br>  &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;wang~&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€æ–°å»ºä¸€ä¸ªç”¨æˆ·ç±» User</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> Cat cat;<br>   <span class="hljs-keyword">private</span> Dog dog;<br>   <span class="hljs-keyword">private</span> String str;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€ç¼–å†™Springé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;cat&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dog&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;str&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;qinjiang&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;<br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testMethodAutowire</span><span class="hljs-params">()</span> </span>&#123;<br>       ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>       User user = (User) context.getBean(<span class="hljs-string">&quot;user&quot;</span>);<br>       user.getCat().shout();<br>       user.getDog().shout();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœæ­£å¸¸è¾“å‡ºï¼Œç¯å¢ƒOK</p><h2 id="5-2-byName"><a href="#5-2-byName" class="headerlink" title="5.2 byName"></a>5.2 byName</h2><p><strong>autowire byName (æŒ‰åç§°è‡ªåŠ¨è£…é…)</strong></p><p>ç”±äºåœ¨æ‰‹åŠ¨é…ç½®xmlè¿‡ç¨‹ä¸­ï¼Œå¸¸å¸¸å‘ç”Ÿå­—æ¯ç¼ºæ¼å’Œå¤§å°å†™ç­‰é”™è¯¯ï¼Œè€Œæ— æ³•å¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œä½¿å¾—å¼€å‘æ•ˆç‡é™ä½ã€‚</p><p>é‡‡ç”¨è‡ªåŠ¨è£…é…å°†é¿å…è¿™äº›é”™è¯¯ï¼Œå¹¶ä¸”ä½¿é…ç½®ç®€å•åŒ–ã€‚</p><p>æµ‹è¯•ï¼š</p><p>1ã€ä¿®æ”¹beané…ç½®ï¼Œå¢åŠ ä¸€ä¸ªå±æ€§  autowire=â€byNameâ€</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span> <span class="hljs-attr">autowire</span>=<span class="hljs-string">&quot;byName&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;str&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;qinjiang&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€å†æ¬¡æµ‹è¯•ï¼Œç»“æœä¾æ—§æˆåŠŸè¾“å‡ºï¼</p><p>3ã€æˆ‘ä»¬å°† cat çš„bean idä¿®æ”¹ä¸º catXXX</p><p>4ã€å†æ¬¡æµ‹è¯•ï¼Œ æ‰§è¡Œæ—¶æŠ¥ç©ºæŒ‡é’ˆjava.lang.NullPointerExceptionã€‚å› ä¸ºæŒ‰byNameè§„åˆ™æ‰¾ä¸å¯¹åº”setæ–¹æ³•ï¼ŒçœŸæ­£çš„setCatå°±æ²¡æ‰§è¡Œï¼Œå¯¹è±¡å°±æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶å°±ä¼šæŠ¥ç©ºæŒ‡é’ˆé”™è¯¯ã€‚</p><p><strong>å°ç»“ï¼š</strong></p><p>å½“ä¸€ä¸ªbeanèŠ‚ç‚¹å¸¦æœ‰ autowire byNameçš„å±æ€§æ—¶ã€‚</p><ol><li><p>å°†æŸ¥æ‰¾å…¶ç±»ä¸­æ‰€æœ‰çš„setæ–¹æ³•åï¼Œä¾‹å¦‚setCatï¼Œè·å¾—å°†setå»æ‰å¹¶ä¸”é¦–å­—æ¯å°å†™çš„å­—ç¬¦ä¸²ï¼Œå³catã€‚</p></li><li><p>å»springå®¹å™¨ä¸­å¯»æ‰¾æ˜¯å¦æœ‰æ­¤å­—ç¬¦ä¸²åç§°idçš„å¯¹è±¡ã€‚</p></li><li><p>å¦‚æœæœ‰ï¼Œå°±å–å‡ºæ³¨å…¥ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p></li></ol><h2 id="5-3-byType"><a href="#5-3-byType" class="headerlink" title="5.3 byType"></a>5.3 byType</h2><p><strong>autowire byType (æŒ‰ç±»å‹è‡ªåŠ¨è£…é…)</strong></p><p>ä½¿ç”¨autowire byTypeé¦–å…ˆéœ€è¦ä¿è¯ï¼šåŒä¸€ç±»å‹çš„å¯¹è±¡ï¼Œåœ¨springå®¹å™¨ä¸­å”¯ä¸€ã€‚å¦‚æœä¸å”¯ä¸€ï¼Œä¼šæŠ¥ä¸å”¯ä¸€çš„å¼‚å¸¸ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">NoUniqueBeanDefinitionException<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p>1ã€å°†userçš„beané…ç½®ä¿®æ”¹ä¸€ä¸‹ ï¼š autowire=â€byTypeâ€</p><p>2ã€æµ‹è¯•ï¼Œæ­£å¸¸è¾“å‡º</p><p>3ã€åœ¨æ³¨å†Œä¸€ä¸ªcat çš„beanå¯¹è±¡ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span> <span class="hljs-attr">autowire</span>=<span class="hljs-string">&quot;byType&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;str&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;qinjiang&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€æµ‹è¯•ï¼ŒæŠ¥é”™ï¼šNoUniqueBeanDefinitionException</p><p>5ã€åˆ æ‰cat2ï¼Œå°†catçš„beanåç§°æ”¹æ‰ï¼æµ‹è¯•ï¼å› ä¸ºæ˜¯æŒ‰ç±»å‹è£…é…ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šæŠ¥å¼‚å¸¸ï¼Œä¹Ÿä¸å½±å“æœ€åçš„ç»“æœã€‚ç”šè‡³å°†idå±æ€§å»æ‰ï¼Œä¹Ÿä¸å½±å“ç»“æœã€‚</p><p>è¿™å°±æ˜¯æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…ï¼</p><h2 id="5-4-ä½¿ç”¨æ³¨è§£"><a href="#5-4-ä½¿ç”¨æ³¨è§£" class="headerlink" title="5.4 ä½¿ç”¨æ³¨è§£"></a>5.4 ä½¿ç”¨æ³¨è§£</h2><p>jdk1.5å¼€å§‹æ”¯æŒæ³¨è§£ï¼Œspring2.5å¼€å§‹å…¨é¢æ”¯æŒæ³¨è§£ã€‚</p><p>å‡†å¤‡å·¥ä½œï¼šåˆ©ç”¨æ³¨è§£çš„æ–¹å¼æ³¨å…¥å±æ€§ã€‚</p><p>1ã€åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼•å…¥contextæ–‡ä»¶å¤´</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">xmlns:context=&quot;http://www.springframework.org/schema/context&quot;<br><br>http://www.springframework.org/schema/context<br>http://www.springframework.org/schema/context/spring-context.xsd<br></code></pre></td></tr></table></figure><p>2ã€==åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯å±æ€§æ³¨è§£æ”¯æŒ!==</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal">&lt;<span class="hljs-symbol">context:</span><span class="hljs-keyword">annotation</span>-<span class="hljs-title">config</span>/&gt;<br></code></pre></td></tr></table></figure><h4 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h4><ul><li>@Autowiredæ˜¯æŒ‰ç±»å‹è‡ªåŠ¨è½¬é…çš„ï¼Œä¸æ”¯æŒidåŒ¹é…ã€‚</li><li>éœ€è¦å¯¼å…¥ spring-aopçš„åŒ…ï¼</li></ul><p>æµ‹è¯•ï¼š</p><p>1ã€å°†Userç±»ä¸­çš„setæ–¹æ³•å»æ‰ï¼Œä½¿ç”¨@Autowiredæ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-meta">@Autowired</span><br>   <span class="hljs-keyword">private</span> Cat cat;<br>   <span class="hljs-meta">@Autowired</span><br>   <span class="hljs-keyword">private</span> Dog dog;<br>   <span class="hljs-keyword">private</span> String str;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Cat <span class="hljs-title">getCat</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> cat;<br>  &#125;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Dog <span class="hljs-title">getDog</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> dog;<br>  &#125;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getStr</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">return</span> str;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ­¤æ—¶é…ç½®æ–‡ä»¶å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ï¼ŒæˆåŠŸè¾“å‡ºç»“æœï¼</p><p><strong>@Autowired(required=false)</strong>  </p><p>è¯´æ˜ï¼šfalseï¼Œå¯¹è±¡å¯ä»¥ä¸ºnullï¼›trueï¼Œå¯¹è±¡å¿…é¡»å­˜å¯¹è±¡ï¼Œä¸èƒ½ä¸ºnullã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å¦‚æœå…è®¸å¯¹è±¡ä¸ºnullï¼Œè®¾ç½®required = false,é»˜è®¤ä¸ºtrue</span><br><span class="hljs-meta">@Autowired(required = false)</span><br><span class="hljs-keyword">private</span> Cat cat;<br></code></pre></td></tr></table></figure><h4 id="Qualifier"><a href="#Qualifier" class="headerlink" title="@Qualifier"></a>@Qualifier</h4><ul><li>@Autowiredæ˜¯æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…çš„ï¼ŒåŠ ä¸Š@Qualifieråˆ™å¯ä»¥æ ¹æ®byNameçš„æ–¹å¼è‡ªåŠ¨è£…é…</li><li>@Qualifierä¸èƒ½å•ç‹¬ä½¿ç”¨ã€‚</li></ul><p>æµ‹è¯•å®éªŒæ­¥éª¤ï¼š</p><p>1ã€é…ç½®æ–‡ä»¶ä¿®æ”¹å†…å®¹ï¼Œä¿è¯ç±»å‹å­˜åœ¨å¯¹è±¡ã€‚ä¸”åå­—ä¸ä¸ºç±»çš„é»˜è®¤åå­—ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€æ²¡æœ‰åŠ Qualifieræµ‹è¯•ï¼Œç›´æ¥æŠ¥é”™</p><p>3ã€åœ¨å±æ€§ä¸Šæ·»åŠ Qualifieræ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-meta">@Qualifier(value = &quot;cat2&quot;)</span><br><span class="hljs-keyword">private</span> Cat cat;<br><span class="hljs-meta">@Autowired</span><br><span class="hljs-meta">@Qualifier(value = &quot;dog2&quot;)</span><br><span class="hljs-keyword">private</span> Dog dog;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼ŒæˆåŠŸè¾“å‡ºï¼</p><h4 id="Resource"><a href="#Resource" class="headerlink" title="@Resource"></a>@Resource</h4><ul><li>@Resourceå¦‚æœ‰æŒ‡å®šçš„nameå±æ€§ï¼Œå…ˆæŒ‰è¯¥å±æ€§è¿›è¡ŒbyNameæ–¹å¼æŸ¥æ‰¾è£…é…ï¼›</li><li>å…¶æ¬¡å†è¿›è¡Œé»˜è®¤çš„byNameæ–¹å¼è¿›è¡Œè£…é…ï¼›</li><li>å¦‚æœä»¥ä¸Šéƒ½ä¸æˆåŠŸï¼Œåˆ™æŒ‰byTypeçš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚</li><li>éƒ½ä¸æˆåŠŸï¼Œåˆ™æŠ¥å¼‚å¸¸ã€‚</li></ul><p>å®ä½“ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-comment">//å¦‚æœå…è®¸å¯¹è±¡ä¸ºnullï¼Œè®¾ç½®required = false,é»˜è®¤ä¸ºtrue</span><br>   <span class="hljs-meta">@Resource(name = &quot;cat2&quot;)</span><br>   <span class="hljs-keyword">private</span> Cat cat;<br>   <span class="hljs-meta">@Resource</span><br>   <span class="hljs-keyword">private</span> Dog dog;<br>   <span class="hljs-keyword">private</span> String str;<br>&#125;<br></code></pre></td></tr></table></figure><p>beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼šç»“æœOK</p><p>é…ç½®æ–‡ä»¶2ï¼šbeans.xml ï¼Œ åˆ æ‰cat2</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Dog&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.pojo.Cat&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>å®ä½“ç±»ä¸Šåªä¿ç•™æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> Cat cat;<br><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> Dog dog;<br></code></pre></td></tr></table></figure><p>ç»“æœï¼šOK</p><p>ç»“è®ºï¼šå…ˆè¿›è¡ŒbyNameæŸ¥æ‰¾ï¼Œå¤±è´¥ï¼›å†è¿›è¡ŒbyTypeæŸ¥æ‰¾ï¼ŒæˆåŠŸã€‚</p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>@Autowiredä¸@Resourceå¼‚åŒï¼š</p><p>1ã€@Autowiredä¸@Resourceéƒ½å¯ä»¥ç”¨æ¥è£…é…beanã€‚éƒ½å¯ä»¥å†™åœ¨å­—æ®µä¸Šï¼Œæˆ–å†™åœ¨setteræ–¹æ³•ä¸Šã€‚</p><p>2ã€@Autowiredé»˜è®¤æŒ‰ç±»å‹è£…é…ï¼ˆå±äºspringè§„èŒƒï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹å¿…é¡»è¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼Œå¦‚æœè¦å…è®¸null å€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseï¼Œå¦‚ï¼š@Autowired(required=false) ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨åç§°è£…é…å¯ä»¥ç»“åˆ@Qualifieræ³¨è§£è¿›è¡Œä½¿ç”¨</p><p>3ã€@Resourceï¼ˆå±äºJ2EEå¤è¿”ï¼‰ï¼Œé»˜è®¤æŒ‰ç…§åç§°è¿›è¡Œè£…é…ï¼Œåç§°å¯ä»¥é€šè¿‡nameå±æ€§è¿›è¡ŒæŒ‡å®šã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå½“æ³¨è§£å†™åœ¨å­—æ®µä¸Šæ—¶ï¼Œé»˜è®¤å–å­—æ®µåè¿›è¡ŒæŒ‰ç…§åç§°æŸ¥æ‰¾ï¼Œå¦‚æœæ³¨è§£å†™åœ¨setteræ–¹æ³•ä¸Šé»˜è®¤å–å±æ€§åè¿›è¡Œè£…é…ã€‚å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„beanæ—¶æ‰æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœnameå±æ€§ä¸€æ—¦æŒ‡å®šï¼Œå°±åªä¼šæŒ‰ç…§åç§°è¿›è¡Œè£…é…ã€‚</p><p>å®ƒä»¬çš„ä½œç”¨ç›¸åŒéƒ½æ˜¯ç”¨æ³¨è§£æ–¹å¼æ³¨å…¥å¯¹è±¡ï¼Œä½†æ‰§è¡Œé¡ºåºä¸åŒã€‚@Autowiredå…ˆbyTypeï¼Œ@Resourceå…ˆbyNameã€‚</p><h1 id="å…­ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#å…­ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="å…­ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>å…­ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h1><p>åœ¨spring4ä¹‹åï¼Œæƒ³è¦ä½¿ç”¨æ³¨è§£å½¢å¼ï¼Œå¿…é¡»å¾—è¦å¼•å…¥aopçš„åŒ…</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227110312247.png" alt="image-20201227110312247"></p><p>åœ¨é…ç½®æ–‡ä»¶å½“ä¸­ï¼Œè¿˜å¾—è¦å¼•å…¥ä¸€ä¸ªcontextçº¦æŸ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="6-1-Beançš„å®ç°-Component"><a href="#6-1-Beançš„å®ç°-Component" class="headerlink" title="6.1 Beançš„å®ç°@Component"></a>6.1 Beançš„å®ç°@Component</h2><p>æˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯ä½¿ç”¨ bean çš„æ ‡ç­¾è¿›è¡Œbeanæ³¨å…¥ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨æ³¨è§£ï¼</p><p>1ã€é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æŒ‡å®šæ³¨è§£æ‰«æåŒ…--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.kuang.pojo&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€åœ¨æŒ‡å®šåŒ…ä¸‹ç¼–å†™ç±»ï¼Œå¢åŠ æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span><br><span class="hljs-comment">// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;bean id=&quot;user&quot; class=&quot;å½“å‰æ³¨è§£çš„ç±»&quot;/&gt;</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-keyword">public</span> String name = <span class="hljs-string">&quot;ç§¦ç–†&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>   ApplicationContext applicationContext =<br>       <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>   User user = (User) applicationContext.getBean(<span class="hljs-string">&quot;user&quot;</span>);<br>   System.out.println(user.name);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="6-2-å±æ€§æ³¨å…¥-Value"><a href="#6-2-å±æ€§æ³¨å…¥-Value" class="headerlink" title="6.2 å±æ€§æ³¨å…¥@Value"></a>6.2 å±æ€§æ³¨å…¥@Value</h2><p>ä½¿ç”¨æ³¨è§£æ³¨å…¥å±æ€§</p><p>1ã€å¯ä»¥ä¸ç”¨æä¾›setæ–¹æ³•ï¼Œç›´æ¥åœ¨ç›´æ¥åä¸Šæ·»åŠ @value(â€œå€¼â€)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span><br><span class="hljs-comment">// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;bean id=&quot;user&quot; class=&quot;å½“å‰æ³¨è§£çš„ç±»&quot;/&gt;</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-meta">@Value(&quot;ç§¦ç–†&quot;)</span><br>   <span class="hljs-comment">// ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;property name=&quot;name&quot; value=&quot;ç§¦ç–†&quot;/&gt;</span><br>   <span class="hljs-keyword">public</span> String name;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€å¦‚æœæä¾›äº†setæ–¹æ³•ï¼Œåœ¨setæ–¹æ³•ä¸Šæ·»åŠ @value(â€œå€¼â€);</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br><br>   <span class="hljs-keyword">public</span> String name;<br><br>   <span class="hljs-meta">@Value(&quot;ç§¦ç–†&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.name = name;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="6-3-è¡ç”Ÿæ³¨è§£-Controller-Service-Repository"><a href="#6-3-è¡ç”Ÿæ³¨è§£-Controller-Service-Repository" class="headerlink" title="6.3 è¡ç”Ÿæ³¨è§£@Controller@Service@Repository"></a>6.3 è¡ç”Ÿæ³¨è§£@Controller@Service@Repository</h2><p>æˆ‘ä»¬è¿™äº›æ³¨è§£ï¼Œå°±æ˜¯æ›¿ä»£äº†åœ¨é…ç½®æ–‡ä»¶å½“ä¸­é…ç½®æ­¥éª¤è€Œå·²ï¼æ›´åŠ çš„æ–¹ä¾¿å¿«æ·ï¼</p><p><strong>@Componentä¸‰ä¸ªè¡ç”Ÿæ³¨è§£</strong></p><p>ä¸ºäº†æ›´å¥½çš„è¿›è¡Œåˆ†å±‚ï¼ŒSpringå¯ä»¥ä½¿ç”¨å…¶å®ƒä¸‰ä¸ªæ³¨è§£ï¼ŒåŠŸèƒ½ä¸€æ ·ï¼Œç›®å‰ä½¿ç”¨å“ªä¸€ä¸ªåŠŸèƒ½éƒ½ä¸€æ ·ã€‚</p><ul><li>@Controllerï¼šwebå±‚</li><li>@Serviceï¼šserviceå±‚</li><li>@Repositoryï¼šdaoå±‚</li></ul><p>å†™ä¸Šè¿™äº›æ³¨è§£ï¼Œå°±ç›¸å½“äºå°†è¿™ä¸ªç±»äº¤ç»™Springç®¡ç†è£…é…äº†ï¼</p><h2 id="6-4-ä½œç”¨åŸŸ-scope"><a href="#6-4-ä½œç”¨åŸŸ-scope" class="headerlink" title="6.4 ä½œç”¨åŸŸ@scope"></a>6.4 ä½œç”¨åŸŸ@scope</h2><ul><li>singletonï¼šé»˜è®¤çš„ï¼ŒSpringä¼šé‡‡ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šé”€æ¯ã€‚</li><li>prototypeï¼šå¤šä¾‹æ¨¡å¼ã€‚å…³é—­å·¥å‚ ï¼Œæ‰€æœ‰çš„å¯¹è±¡ä¸ä¼šé”€æ¯ã€‚å†…éƒ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šå›æ”¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Controller(&quot;user&quot;)</span><br><span class="hljs-meta">@Scope(&quot;prototype&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-meta">@Value(&quot;ç§¦ç–†&quot;)</span><br>   <span class="hljs-keyword">public</span> String name;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="6-5-å°ç»“"><a href="#6-5-å°ç»“" class="headerlink" title="6.5 å°ç»“"></a>6.5 å°ç»“</h2><p><strong>XMLä¸æ³¨è§£æ¯”è¾ƒ</strong></p><ul><li>XMLå¯ä»¥é€‚ç”¨ä»»ä½•åœºæ™¯ ï¼Œç»“æ„æ¸…æ™°ï¼Œç»´æŠ¤æ–¹ä¾¿</li><li>æ³¨è§£ä¸æ˜¯è‡ªå·±æä¾›çš„ç±»ä½¿ç”¨ä¸äº†ï¼Œå¼€å‘ç®€å•æ–¹ä¾¿</li></ul><p><strong>xmlä¸æ³¨è§£æ•´åˆå¼€å‘</strong> ï¼šæ¨èæœ€ä½³å®è·µ</p><ul><li>xmlç®¡ç†Bean</li><li>æ³¨è§£å®Œæˆå±æ€§æ³¨å…¥</li><li>ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œ å¯ä»¥ä¸ç”¨æ‰«æï¼Œæ‰«ææ˜¯ä¸ºäº†ç±»ä¸Šçš„æ³¨è§£</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>  <br></code></pre></td></tr></table></figure><p>ä½œç”¨ï¼š</p><ul><li>è¿›è¡Œæ³¨è§£é©±åŠ¨æ³¨å†Œï¼Œä»è€Œä½¿æ³¨è§£ç”Ÿæ•ˆ</li><li>ç”¨äºæ¿€æ´»é‚£äº›å·²ç»åœ¨springå®¹å™¨é‡Œæ³¨å†Œè¿‡çš„beanä¸Šé¢çš„æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºçš„å‘Springæ³¨å†Œ</li><li>å¦‚æœä¸æ‰«æåŒ…ï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ç½®bean</li><li>å¦‚æœä¸åŠ æ³¨è§£é©±åŠ¨ï¼Œåˆ™æ³¨å…¥çš„å€¼ä¸ºnullï¼</li></ul><h1 id="ä¸ƒã€åŸºäºJavaç±»è¿›è¡Œé…ç½®"><a href="#ä¸ƒã€åŸºäºJavaç±»è¿›è¡Œé…ç½®" class="headerlink" title="ä¸ƒã€åŸºäºJavaç±»è¿›è¡Œé…ç½®"></a>ä¸ƒã€åŸºäºJavaç±»è¿›è¡Œé…ç½®</h1><p>JavaConfig åŸæ¥æ˜¯ Spring çš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒé€šè¿‡ Java ç±»çš„æ–¹å¼æä¾› Bean çš„å®šä¹‰ä¿¡æ¯ï¼Œåœ¨ Spring4 çš„ç‰ˆæœ¬ï¼Œ JavaConfig å·²æ­£å¼æˆä¸º Spring4 çš„æ ¸å¿ƒåŠŸèƒ½ ã€‚</p><p>æµ‹è¯•ï¼š</p><p>1ã€ç¼–å†™ä¸€ä¸ªå®ä½“ç±»ï¼ŒDog</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span>  <span class="hljs-comment">//å°†è¿™ä¸ªç±»æ ‡æ³¨ä¸ºSpringçš„ä¸€ä¸ªç»„ä»¶ï¼Œæ”¾åˆ°å®¹å™¨ä¸­ï¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;<br>   <span class="hljs-keyword">public</span> String name = <span class="hljs-string">&quot;dog&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æ–°å»ºä¸€ä¸ªconfigé…ç½®åŒ…ï¼Œç¼–å†™ä¸€ä¸ªMyConfigé…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>  <span class="hljs-comment">//ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»,å’Œæˆ‘ä»¬ä¹‹å‰çš„Bean.xml</span><br>@<span class="hljs-meta">@ComponentScan(&quot;com.mc.pojo&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyConfig</span> </span>&#123;<br><span class="hljs-comment">//ç›¸å½“äºä¸€ä¸ªBeanæ ‡ç­¾</span><br>   <span class="hljs-meta">@Bean</span> <span class="hljs-comment">//é€šè¿‡æ–¹æ³•æ³¨å†Œä¸€ä¸ªbeanï¼Œè¿™é‡Œçš„è¿”å›å€¼å°±Beançš„ç±»å‹ï¼Œæ–¹æ³•åå°±æ˜¯beançš„idï¼</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Dog <span class="hljs-title">dog</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Dog();<br>  &#125;<br><br>&#125;<br><span class="hljs-comment">//è¦ä¹ˆä½¿ç”¨@Beanè¦ä¹ˆä½¿ç”¨@Componentå’Œ@ComponentScanï¼Œä¸¤ç§æ•ˆæœä¸€æ ·ï¼Œéƒ½ç”¨ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œåªæ˜¯å¯¹è±¡ä¼šå®ä¾‹åŒ–ä¸¤æ¬¡</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span></span>&#123;<br>   ApplicationContext applicationContext =<br>           <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(MyConfig.class);<br>   Dog dog = (Dog) applicationContext.getBean(<span class="hljs-string">&quot;dog&quot;</span>);<br>   System.out.println(dog.name);<br>&#125;<br><span class="hljs-comment">//å¦‚æœå®Œå…¨ä½¿ç”¨äº†é…ç½®ç±»çš„æ–¹å¼åšå°±å¿…é¡»ä½¿ç”¨AnnotationConfigApplicationContextä¸Šä¸‹æ–‡æ¥è·å–å®¹å™¨</span><br><span class="hljs-comment">//é€šè¿‡é…ç½®ç±»çš„classåŠ è½½</span><br></code></pre></td></tr></table></figure><p>4ã€æˆåŠŸè¾“å‡ºç»“æœï¼</p><p><strong>å¯¼å…¥å…¶ä»–é…ç½®å¦‚ä½•åšå‘¢ï¼Ÿ</strong></p><p>1ã€æˆ‘ä»¬å†ç¼–å†™ä¸€ä¸ªé…ç½®ç±»ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>  <span class="hljs-comment">//ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyConfig2</span> </span>&#123;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨ä¹‹å‰çš„é…ç½®ç±»ä¸­æˆ‘ä»¬æ¥é€‰æ‹©å¯¼å…¥è¿™ä¸ªé…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@Import(MyConfig2.class)</span>  <span class="hljs-comment">//å¯¼å…¥åˆå¹¶å…¶ä»–é…ç½®ç±»ï¼Œç±»ä¼¼äºé…ç½®æ–‡ä»¶ä¸­çš„ inculde æ ‡ç­¾</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyConfig</span> </span>&#123;<br><br>   <span class="hljs-meta">@Bean</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Dog <span class="hljs-title">dog</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Dog();<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å…³äºè¿™ç§Javaç±»çš„é…ç½®æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ä¹‹åçš„SpringBoot å’Œ SpringCloudä¸­è¿˜ä¼šå¤§é‡çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™äº›æ³¨è§£çš„ä½œç”¨å³å¯ï¼</p><h1 id="å…«ã€ä»£ç†æ¨¡å¼"><a href="#å…«ã€ä»£ç†æ¨¡å¼" class="headerlink" title="å…«ã€ä»£ç†æ¨¡å¼"></a>å…«ã€ä»£ç†æ¨¡å¼</h1><p>ä¸ºä»€ä¹ˆè¦å­¦ä¹ ä»£ç†æ¨¡å¼ï¼Œå› ä¸ºAOPçš„åº•å±‚æœºåˆ¶å°±æ˜¯åŠ¨æ€ä»£ç†ï¼</p><p>ä»£ç†æ¨¡å¼ï¼š</p><ul><li>é™æ€ä»£ç†</li><li>åŠ¨æ€ä»£ç†</li></ul><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/7.png"></p><h2 id="8-1-é™æ€ä»£ç†"><a href="#8-1-é™æ€ä»£ç†" class="headerlink" title="8.1 é™æ€ä»£ç†"></a>8.1 é™æ€ä»£ç†</h2><p><strong>é™æ€ä»£ç†è§’è‰²åˆ†æ</strong></p><ul><li><p>æŠ½è±¡è§’è‰² : ä¸€èˆ¬ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°</p></li><li><p>çœŸå®è§’è‰² : è¢«ä»£ç†çš„è§’è‰²</p></li><li><p>ä»£ç†è§’è‰² : ä»£ç†çœŸå®è§’è‰² ; ä»£ç†çœŸå®è§’è‰²å , ä¸€èˆ¬ä¼šåšä¸€äº›é™„å±çš„æ“ä½œ .</p></li><li><p>å®¢æˆ·  :  ä½¿ç”¨ä»£ç†è§’è‰²æ¥è¿›è¡Œä¸€äº›æ“ä½œ .</p></li></ul><p><strong>ä»£ç å®ç°</strong></p><p>Rent . java å³æŠ½è±¡è§’è‰²</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//æŠ½è±¡è§’è‰²ï¼šç§Ÿæˆ¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">Rent</span> &#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span>(<span class="hljs-params"></span>)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>Host . java å³çœŸå®è§’è‰²</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-comment">//çœŸå®è§’è‰²: æˆ¿ä¸œï¼Œæˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">Host</span> <span class="hljs-symbol">implements</span> <span class="hljs-symbol">Rent</span>&#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> rent() &#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;æˆ¿å±‹å‡ºç§Ÿ&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Proxy . java å³ä»£ç†è§’è‰²</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//ä»£ç†è§’è‰²ï¼šä¸­ä»‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Proxy</span> <span class="hljs-title">implements</span> <span class="hljs-title">Rent</span> &#123;<br><br>   <span class="hljs-keyword">private</span> Host host;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Proxy</span>(<span class="hljs-params"></span>)</span> &#123; &#125;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Proxy</span>(<span class="hljs-params">Host host</span>)</span> &#123;<br>       <span class="hljs-keyword">this</span>.host = host;<br>  &#125;<br><br>   <span class="hljs-comment">//ç§Ÿæˆ¿</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span>(<span class="hljs-params"></span>)</span>&#123;<br>       seeHouse();<br>       host.rent();<br>       fare();<br>  &#125;<br>   <span class="hljs-comment">//çœ‹æˆ¿</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">seeHouse</span>(<span class="hljs-params"></span>)</span>&#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;å¸¦æˆ¿å®¢çœ‹æˆ¿&quot;</span>);<br>  &#125;<br>   <span class="hljs-comment">//æ”¶ä¸­ä»‹è´¹</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fare</span>(<span class="hljs-params"></span>)</span>&#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;æ”¶ä¸­ä»‹è´¹&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Client . java å³å®¢æˆ·</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//å®¢æˆ·ç±»ï¼Œä¸€èˆ¬å®¢æˆ·éƒ½ä¼šå»æ‰¾ä»£ç†ï¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-function"><span class="hljs-title">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>)</span> &#123;<br>       <span class="hljs-comment">//æˆ¿ä¸œè¦ç§Ÿæˆ¿</span><br>       Host host = <span class="hljs-keyword">new</span> Host();<br>       <span class="hljs-comment">//ä¸­ä»‹å¸®åŠ©æˆ¿ä¸œ</span><br>       <span class="hljs-built_in">Proxy</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(host);<br><br>       <span class="hljs-comment">//ä½ å»æ‰¾ä¸­ä»‹ï¼</span><br>       proxy.rent();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ†æï¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ ç›´æ¥æ¥è§¦çš„å°±æ˜¯ä¸­ä»‹ï¼Œå°±å¦‚åŒç°å®ç”Ÿæ´»ä¸­çš„æ ·å­ï¼Œä½ çœ‹ä¸åˆ°æˆ¿ä¸œï¼Œä½†æ˜¯ä½ ä¾æ—§ç§Ÿåˆ°äº†æˆ¿ä¸œçš„æˆ¿å­é€šè¿‡ä»£ç†ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ä»£ç†æ¨¡å¼ï¼Œç¨‹åºæºè‡ªäºç”Ÿæ´»ï¼Œæ‰€ä»¥å­¦ç¼–ç¨‹çš„äººï¼Œä¸€èˆ¬èƒ½å¤Ÿæ›´åŠ æŠ½è±¡çš„çœ‹å¾…ç”Ÿæ´»ä¸­å‘ç”Ÿçš„äº‹æƒ…ã€‚</p><p><strong>é™æ€ä»£ç†çš„å¥½å¤„:</strong></p><ul><li>å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„çœŸå®è§’è‰²æ›´åŠ çº¯ç²¹ . ä¸å†å»å…³æ³¨ä¸€äº›å…¬å…±çš„äº‹æƒ… .</li><li>å…¬å…±çš„ä¸šåŠ¡ç”±ä»£ç†æ¥å®Œæˆ . å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ ,</li><li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•æ—¶å˜å¾—æ›´åŠ é›†ä¸­å’Œæ–¹ä¾¿ .</li></ul><p>ç¼ºç‚¹ :</p><ul><li>ç±»å¤šäº† , å¤šäº†ä»£ç†ç±» , å·¥ä½œé‡å˜å¤§äº† . å¼€å‘æ•ˆç‡é™ä½ .</li></ul><p>æˆ‘ä»¬æƒ³è¦é™æ€ä»£ç†çš„å¥½å¤„ï¼Œåˆä¸æƒ³è¦é™æ€ä»£ç†çš„ç¼ºç‚¹ï¼Œæ‰€ä»¥ , å°±æœ‰äº†åŠ¨æ€ä»£ç† !</p><blockquote><h4 id="é™æ€ä»£ç†å†ç†è§£"><a href="#é™æ€ä»£ç†å†ç†è§£" class="headerlink" title="é™æ€ä»£ç†å†ç†è§£"></a>é™æ€ä»£ç†å†ç†è§£</h4></blockquote><p>åŒå­¦ä»¬ç»ƒä¹ å®Œæ¯•åï¼Œæˆ‘ä»¬å†æ¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå·©å›ºå¤§å®¶çš„å­¦ä¹ ï¼</p><p>ç»ƒä¹ æ­¥éª¤ï¼š</p><p>1ã€åˆ›å»ºä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œæ¯”å¦‚å’‹ä»¬å¹³æ—¶åšçš„ç”¨æˆ·ä¸šåŠ¡ï¼ŒæŠ½è±¡èµ·æ¥å°±æ˜¯å¢åˆ æ”¹æŸ¥ï¼</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//æŠ½è±¡è§’è‰²ï¼šå¢åˆ æ”¹æŸ¥ä¸šåŠ¡</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> &#123;<br>   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>)</span>;<br>   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">delete</span>(<span class="hljs-params"></span>)</span>;<br>   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>)</span>;<br>   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">query</span>(<span class="hljs-params"></span>)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªçœŸå®å¯¹è±¡æ¥å®Œæˆè¿™äº›å¢åˆ æ”¹æŸ¥æ“ä½œ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//çœŸå®å¯¹è±¡ï¼Œå®Œæˆå¢åˆ æ”¹æŸ¥æ“ä½œçš„äºº</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-title">implements</span> <span class="hljs-title">UserService</span> &#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>)</span> &#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span>(<span class="hljs-params"></span>)</span> &#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>)</span> &#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query</span>(<span class="hljs-params"></span>)</span> &#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€éœ€æ±‚æ¥äº†ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæ—¥å¿—åŠŸèƒ½ï¼Œæ€ä¹ˆå®ç°ï¼</p><ul><li>æ€è·¯1 ï¼šåœ¨å®ç°ç±»ä¸Šå¢åŠ ä»£ç  ã€éº»çƒ¦ï¼ã€‘</li><li>æ€è·¯2ï¼šä½¿ç”¨ä»£ç†æ¥åšï¼Œèƒ½å¤Ÿä¸æ”¹å˜åŸæ¥çš„ä¸šåŠ¡æƒ…å†µä¸‹ï¼Œå®ç°æ­¤åŠŸèƒ½å°±æ˜¯æœ€å¥½çš„äº†ï¼</li></ul><p>4ã€è®¾ç½®ä¸€ä¸ªä»£ç†ç±»æ¥å¤„ç†æ—¥å¿—ï¼ä»£ç†è§’è‰²</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">//ä»£ç†è§’è‰²ï¼Œåœ¨è¿™é‡Œé¢å¢åŠ æ—¥å¿—çš„å®ç°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceProxy</span> <span class="hljs-title">implements</span> <span class="hljs-title">UserService</span> &#123;<br>   <span class="hljs-keyword">private</span> UserServiceImpl userService;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserService</span>(<span class="hljs-params">UserServiceImpl userService</span>)</span> &#123;<br>       <span class="hljs-keyword">this</span>.userService = userService;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>)</span> &#123;<br>       log(<span class="hljs-string">&quot;add&quot;</span>);<br>       userService.<span class="hljs-keyword">add</span>();<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span>(<span class="hljs-params"></span>)</span> &#123;<br>       log(<span class="hljs-string">&quot;delete&quot;</span>);<br>       userService.delete();<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>)</span> &#123;<br>       log(<span class="hljs-string">&quot;update&quot;</span>);<br>       userService.update();<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query</span>(<span class="hljs-params"></span>)</span> &#123;<br>       log(<span class="hljs-string">&quot;query&quot;</span>);<br>       userService.query();<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span>(<span class="hljs-params">String msg</span>)</span>&#123;<br>       System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;æ‰§è¡Œäº†&quot;</span>+msg+<span class="hljs-string">&quot;æ–¹æ³•&quot;</span>);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•è®¿é—®ç±»ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> &#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> &#123;<br>       <span class="hljs-comment">//çœŸå®ä¸šåŠ¡</span><br>       UserServiceImpl userService = <span class="hljs-keyword">new</span> UserServiceImpl();<br>       <span class="hljs-comment">//ä»£ç†ç±»</span><br>       UserServiceProxy proxy = <span class="hljs-keyword">new</span> UserServiceProxy();<br>       <span class="hljs-comment">//ä½¿ç”¨ä»£ç†ç±»å®ç°æ—¥å¿—åŠŸèƒ½ï¼</span><br>       proxy.setUserService(userService);<br><br>       proxy.<span class="hljs-keyword">add</span>();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>OKï¼Œåˆ°äº†ç°åœ¨ä»£ç†æ¨¡å¼å¤§å®¶åº”è¯¥éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†ï¼Œé‡ç‚¹å¤§å®¶éœ€è¦ç†è§£å…¶ä¸­çš„æ€æƒ³ï¼›</p><p>æˆ‘ä»¬åœ¨ä¸æ”¹å˜åŸæ¥çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†å¯¹åŸæœ‰åŠŸèƒ½çš„å¢å¼ºï¼Œè¿™æ˜¯AOPä¸­æœ€æ ¸å¿ƒçš„æ€æƒ³</p><p>èŠèŠAOPï¼šçºµå‘å¼€å‘ï¼Œæ¨ªå‘å¼€å‘</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/8.png"></p><h2 id="8-2-åŠ¨æ€ä»£ç†"><a href="#8-2-åŠ¨æ€ä»£ç†" class="headerlink" title="8.2 åŠ¨æ€ä»£ç†"></a>8.2 åŠ¨æ€ä»£ç†</h2><ul><li><p>åŠ¨æ€ä»£ç†çš„è§’è‰²å’Œé™æ€ä»£ç†çš„ä¸€æ · .</p></li><li><p>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ . é™æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯æˆ‘ä»¬æå‰å†™å¥½çš„</p></li><li><p>åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸¤ç±» : ä¸€ç±»æ˜¯åŸºäºæ¥å£åŠ¨æ€ä»£ç† , ä¸€ç±»æ˜¯åŸºäºç±»çš„åŠ¨æ€ä»£ç†</p></li><li><ul><li>åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†â€”-JDKåŠ¨æ€ä»£ç†</li><li>åŸºäºç±»çš„åŠ¨æ€ä»£ç†â€“cglib</li><li>ç°åœ¨ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯ javasist æ¥ç”ŸæˆåŠ¨æ€ä»£ç† . ç™¾åº¦ä¸€ä¸‹javasist</li><li>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨JDKçš„åŸç”Ÿä»£ç æ¥å®ç°ï¼Œå…¶ä½™çš„é“ç†éƒ½æ˜¯ä¸€æ ·çš„ï¼ã€</li></ul></li></ul><p><strong>JDKçš„åŠ¨æ€ä»£ç†éœ€è¦äº†è§£ä¸¤ä¸ªç±»</strong></p><p>æ ¸å¿ƒ : InvocationHandler   å’Œ   Proxy  ï¼Œ æ‰“å¼€JDKå¸®åŠ©æ–‡æ¡£çœ‹çœ‹</p><p>ã€InvocationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åºã€‘</p><p>InvocationHandleræ˜¯ç”±ä»£ç†å®åˆ—çš„è°ƒç”¨å¤„ç†ç¨‹åºå®ç°çš„æ¥å£ï¼›æ¯ä¸€ä¸ªå®åˆ—éƒ½æœ‰ä¸€ä¸ªç›¸å…³è”çš„ä»£ç†å¤„ç†ç¨‹åº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, æ–¹æ³• method, Object[] args)</span>ï¼›</span><br><span class="hljs-function"><span class="hljs-comment">//å‚æ•°</span></span><br><span class="hljs-function"><span class="hljs-comment">//proxy - è°ƒç”¨è¯¥æ–¹æ³•çš„ä»£ç†å®ä¾‹</span></span><br><span class="hljs-function"><span class="hljs-comment">//method -æ‰€è¿°æ–¹æ³•å¯¹åº”äºè°ƒç”¨ä»£ç†å®ä¾‹ä¸Šçš„æ¥å£æ–¹æ³•çš„å®ä¾‹ã€‚æ–¹æ³•å¯¹è±¡çš„å£°æ˜ç±»å°†æ˜¯è¯¥æ–¹æ³•å£°æ˜çš„æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯ä»£ç†ç±»ç»§æ‰¿è¯¥æ–¹æ³•çš„ä»£ç†æ¥å£çš„è¶…çº§æ¥å£ã€‚</span></span><br><span class="hljs-function"><span class="hljs-comment">//args -åŒ…å«çš„æ–¹æ³•è°ƒç”¨ä¼ é€’ä»£ç†å®ä¾‹çš„å‚æ•°å€¼çš„å¯¹è±¡çš„é˜µåˆ—ï¼Œæˆ–nullå¦‚æœæ¥å£æ–¹æ³•æ²¡æœ‰å‚æ•°ã€‚åŸå§‹ç±»å‹çš„å‚æ•°åŒ…å«åœ¨é€‚å½“çš„åŸå§‹åŒ…è£…å™¨ç±»çš„å®ä¾‹ä¸­ï¼Œä¾‹å¦‚java.lang.Integeræˆ–java.lang.Boolean ã€‚java</span></span><br></code></pre></td></tr></table></figure><p>ã€Proxy  : ä»£ç†ã€‘</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227150516595.png" alt="image-20201227150516595"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç”Ÿæˆä»£ç†ç±»</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getProxy</span><span class="hljs-params">()</span></span>&#123;<br>   <span class="hljs-keyword">return</span> Proxy.newProxyInstance(<span class="hljs-keyword">this</span>.getClass().getClassLoader(),<br>                                 rent.getClass().getInterfaces(),<span class="hljs-keyword">this</span>);java<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ä»£ç å®ç°</strong> </p><p>æŠ½è±¡è§’è‰²å’ŒçœŸå®è§’è‰²å’Œä¹‹å‰çš„ä¸€æ ·ï¼</p><p>Rent . java å³æŠ½è±¡è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æŠ½è±¡è§’è‰²ï¼šç§Ÿæˆ¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Rent</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>Host . java å³çœŸå®è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//çœŸå®è§’è‰²: æˆ¿ä¸œï¼Œæˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Host</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Rent</span></span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æˆ¿å±‹å‡ºç§Ÿ&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ProxyInvocationHandler. java å³ä»£ç†è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProxyInvocationHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> Rent rent;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setRent</span><span class="hljs-params">(Rent rent)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.rent = rent;<br>  &#125;<br><br>   <span class="hljs-comment">//ç”Ÿæˆä»£ç†ç±»ï¼Œé‡ç‚¹æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œè·å–è¦ä»£ç†çš„æŠ½è±¡è§’è‰²ï¼ä¹‹å‰éƒ½æ˜¯ä¸€ä¸ªè§’è‰²ï¼Œç°åœ¨å¯ä»¥ä»£ç†ä¸€ç±»è§’è‰²</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getProxy</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> Proxy.newProxyInstance(<span class="hljs-keyword">this</span>.getClass().getClassLoader(),<br>               rent.getClass().getInterfaces(),<span class="hljs-keyword">this</span>);<br>  &#125;<br><br>   <span class="hljs-comment">// proxy : ä»£ç†ç±» method : ä»£ç†ç±»çš„è°ƒç”¨å¤„ç†ç¨‹åºçš„æ–¹æ³•å¯¹è±¡.</span><br>   <span class="hljs-comment">// å¤„ç†ä»£ç†å®ä¾‹ä¸Šçš„æ–¹æ³•è°ƒç”¨å¹¶è¿”å›ç»“æœ</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>       seeHouse();<br>       <span class="hljs-comment">//æ ¸å¿ƒï¼šæœ¬è´¨åˆ©ç”¨åå°„å®ç°ï¼</span><br>       Object result = method.invoke(rent, args);<br>       fare();<br>       <span class="hljs-keyword">return</span> result;<br>  &#125;<br><br>   <span class="hljs-comment">//çœ‹æˆ¿</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">seeHouse</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;å¸¦æˆ¿å®¢çœ‹æˆ¿&quot;</span>);<br>  &#125;<br>   <span class="hljs-comment">//æ”¶ä¸­ä»‹è´¹</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fare</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æ”¶ä¸­ä»‹è´¹&quot;</span>);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>Client . java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç§Ÿå®¢</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>       <span class="hljs-comment">//çœŸå®è§’è‰²</span><br>       Host host = <span class="hljs-keyword">new</span> Host();<br>       <span class="hljs-comment">//ä»£ç†å®ä¾‹çš„è°ƒç”¨å¤„ç†ç¨‹åº</span><br>       ProxyInvocationHandler pih = <span class="hljs-keyword">new</span> ProxyInvocationHandler();<br>       pih.setRent(host); <span class="hljs-comment">//å°†çœŸå®è§’è‰²æ”¾ç½®è¿›å»ï¼</span><br>       Rent proxy = (Rent)pih.getProxy(); <span class="hljs-comment">//åŠ¨æ€ç”Ÿæˆå¯¹åº”çš„ä»£ç†ç±»ï¼</span><br>       proxy.rent();<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¸å¿ƒï¼š<strong>ä¸€ä¸ªåŠ¨æ€ä»£ç† , ä¸€èˆ¬ä»£ç†æŸä¸€ç±»ä¸šåŠ¡ , ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ï¼ã€</strong></p><blockquote><h4 id="æ·±åŒ–ç†è§£"><a href="#æ·±åŒ–ç†è§£" class="headerlink" title="æ·±åŒ–ç†è§£"></a>æ·±åŒ–ç†è§£</h4></blockquote><p>æˆ‘ä»¬æ¥ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°ä»£ç†æˆ‘ä»¬åé¢å†™çš„UserServiceï¼</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™ä¸€ä¸ªé€šç”¨çš„åŠ¨æ€ä»£ç†å®ç°çš„ç±»ï¼æ‰€æœ‰çš„ä»£ç†å¯¹è±¡è®¾ç½®ä¸ºObjectå³å¯ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProxyInvocationHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> Object target;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setTarget</span><span class="hljs-params">(Object target)</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.target = target;<br>  &#125;<br><br>   <span class="hljs-comment">//ç”Ÿæˆä»£ç†ç±»</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getProxy</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> Proxy.newProxyInstance(<span class="hljs-keyword">this</span>.getClass().getClassLoader(),<br>               target.getClass().getInterfaces(),<span class="hljs-keyword">this</span>);<br>  &#125;<br><br>   <span class="hljs-comment">// proxy : ä»£ç†ç±»</span><br>   <span class="hljs-comment">// method : ä»£ç†ç±»çš„è°ƒç”¨å¤„ç†ç¨‹åºçš„æ–¹æ³•å¯¹è±¡.</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>       log(method.getName());<br>       Object result = method.invoke(target, args);<br>       <span class="hljs-keyword">return</span> result;<br>  &#125;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String methodName)</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œäº†&quot;</span>+methodName+<span class="hljs-string">&quot;æ–¹æ³•&quot;</span>);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>       <span class="hljs-comment">//çœŸå®å¯¹è±¡</span><br>       UserServiceImpl userService = <span class="hljs-keyword">new</span> UserServiceImpl();<br>       <span class="hljs-comment">//ä»£ç†å¯¹è±¡çš„è°ƒç”¨å¤„ç†ç¨‹åº</span><br>       ProxyInvocationHandler pih = <span class="hljs-keyword">new</span> ProxyInvocationHandler();<br>       pih.setTarget(userService); <span class="hljs-comment">//è®¾ç½®è¦ä»£ç†çš„å¯¹è±¡</span><br>       UserService proxy = (UserService)pih.getProxy(); <span class="hljs-comment">//åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼</span><br>       proxy.delete();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼Œå¢åˆ æ”¹æŸ¥ï¼ŒæŸ¥çœ‹ç»“æœï¼</p><blockquote><h5 id="åŠ¨æ€ä»£ç†çš„å¥½å¤„"><a href="#åŠ¨æ€ä»£ç†çš„å¥½å¤„" class="headerlink" title="åŠ¨æ€ä»£ç†çš„å¥½å¤„"></a>åŠ¨æ€ä»£ç†çš„å¥½å¤„</h5></blockquote><p>é™æ€ä»£ç†æœ‰çš„å®ƒéƒ½æœ‰ï¼Œé™æ€ä»£ç†æ²¡æœ‰çš„ï¼Œå®ƒä¹Ÿæœ‰ï¼</p><ul><li>å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„çœŸå®è§’è‰²æ›´åŠ çº¯ç²¹ . ä¸å†å»å…³æ³¨ä¸€äº›å…¬å…±çš„äº‹æƒ… .</li><li>å…¬å…±çš„ä¸šåŠ¡ç”±ä»£ç†æ¥å®Œæˆ . å®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ ,</li><li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‰©å±•æ—¶å˜å¾—æ›´åŠ é›†ä¸­å’Œæ–¹ä¾¿ .</li><li>ä¸€ä¸ªåŠ¨æ€ä»£ç† , ä¸€èˆ¬ä»£ç†æŸä¸€ç±»ä¸šåŠ¡</li><li>ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ï¼</li></ul><h1 id="ä¹ã€AOPé¢å‘åˆ‡é¢ç¼–ç¨‹"><a href="#ä¹ã€AOPé¢å‘åˆ‡é¢ç¼–ç¨‹" class="headerlink" title="ä¹ã€AOPé¢å‘åˆ‡é¢ç¼–ç¨‹"></a>ä¹ã€AOPé¢å‘åˆ‡é¢ç¼–ç¨‹</h1><p>AOPï¼ˆAspect Oriented Programmingï¼‰æ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPæ˜¯OOPçš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒå‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</p><h2 id="9-1-Aopåœ¨Springä¸­çš„ä½œç”¨"><a href="#9-1-Aopåœ¨Springä¸­çš„ä½œç”¨" class="headerlink" title="9.1 Aopåœ¨Springä¸­çš„ä½œç”¨"></a>9.1 Aopåœ¨Springä¸­çš„ä½œç”¨</h2><p>æä¾›å£°æ˜å¼äº‹åŠ¡ï¼›å…è®¸ç”¨æˆ·è‡ªå®šä¹‰åˆ‡é¢</p><p>ä»¥ä¸‹åè¯éœ€è¦äº†è§£ä¸‹ï¼š</p><ul><li>æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼šè·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„æ–¹æ³•æˆ–åŠŸèƒ½ã€‚å³æ˜¯ï¼Œä¸æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘æ— å…³çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚æ—¥å¿— , å®‰å…¨ , ç¼“å­˜ , äº‹åŠ¡ç­‰ç­‰ â€¦.</li><li>åˆ‡é¢ï¼ˆASPECTï¼‰ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹ è¢«æ¨¡å—åŒ– çš„ç‰¹æ®Šå¯¹è±¡ã€‚å³ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»ã€‚</li><li>é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œã€‚å³ï¼Œå®ƒæ˜¯ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚</li><li>ç›®æ ‡ï¼ˆTargetï¼‰ï¼šè¢«é€šçŸ¥å¯¹è±¡ã€‚</li><li>ä»£ç†ï¼ˆProxyï¼‰ï¼šå‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡ã€‚</li><li>åˆ‡å…¥ç‚¹ï¼ˆPointCutï¼‰ï¼šåˆ‡é¢é€šçŸ¥ æ‰§è¡Œçš„ â€œåœ°ç‚¹â€çš„å®šä¹‰ã€‚</li><li>è¿æ¥ç‚¹ï¼ˆJointPointï¼‰ï¼šä¸åˆ‡å…¥ç‚¹åŒ¹é…çš„æ‰§è¡Œç‚¹ã€‚</li></ul><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/10.png"></p><p>SpringAOPä¸­ï¼Œé€šè¿‡Adviceå®šä¹‰æ¨ªåˆ‡é€»è¾‘ï¼ŒSpringä¸­æ”¯æŒ5ç§ç±»å‹çš„Advice:</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/11.png"></p><p>å³ Aop åœ¨ ä¸æ”¹å˜åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹ , å»å¢åŠ æ–°çš„åŠŸèƒ½ .</p><h2 id="9-2-ä½¿ç”¨Springå®ç°Aop"><a href="#9-2-ä½¿ç”¨Springå®ç°Aop" class="headerlink" title="9.2 ä½¿ç”¨Springå®ç°Aop"></a>9.2 ä½¿ç”¨Springå®ç°Aop</h2><p>ã€é‡ç‚¹ã€‘ä½¿ç”¨AOPç»‡å…¥ï¼Œéœ€è¦å¯¼å…¥ä¸€ä¸ªä¾èµ–åŒ…ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="9-2-1-é€šè¿‡-Spring-API-å®ç°AOP"><a href="#9-2-1-é€šè¿‡-Spring-API-å®ç°AOP" class="headerlink" title="9.2.1 é€šè¿‡ Spring API å®ç°AOP"></a>9.2.1 é€šè¿‡ Spring API å®ç°AOP</h3><p>é¦–å…ˆç¼–å†™æˆ‘ä»¬çš„ä¸šåŠ¡æ¥å£å’Œå®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span></span>;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span></span>;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">search</span><span class="hljs-params">()</span></span>;<br><br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span></span>&#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;å¢åŠ ç”¨æˆ·&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;åˆ é™¤ç”¨æˆ·&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æ›´æ–°ç”¨æˆ·&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">search</span><span class="hljs-params">()</span> </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æŸ¥è¯¢ç”¨æˆ·&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åå»å†™æˆ‘ä»¬çš„å¢å¼ºç±» , æˆ‘ä»¬ç¼–å†™ä¸¤ä¸ª , ä¸€ä¸ªå‰ç½®å¢å¼º ä¸€ä¸ªåç½®å¢å¼º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Log</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MethodBeforeAdvice</span> </span>&#123;<br><br>   <span class="hljs-comment">//method : è¦æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span><br>   <span class="hljs-comment">//objects : è¢«è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•°</span><br>   <span class="hljs-comment">//Object : ç›®æ ‡å¯¹è±¡</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">(Method method, Object[] objects, Object o)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>       System.out.println( o.getClass().getName() + <span class="hljs-string">&quot;çš„&quot;</span> + method.getName() + <span class="hljs-string">&quot;æ–¹æ³•è¢«æ‰§è¡Œäº†&quot;</span>);<br>  &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AfterLog</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AfterReturningAdvice</span> </span>&#123;<br>   <span class="hljs-comment">//returnValue è¿”å›å€¼</span><br>   <span class="hljs-comment">//methodè¢«è°ƒç”¨çš„æ–¹æ³•</span><br>   <span class="hljs-comment">//args è¢«è°ƒç”¨çš„æ–¹æ³•çš„å¯¹è±¡çš„å‚æ•°</span><br>   <span class="hljs-comment">//target è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterReturning</span><span class="hljs-params">(Object returnValue, Method method, Object[] args, Object target)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œäº†&quot;</span> + target.getClass().getName()<br>       +<span class="hljs-string">&quot;çš„&quot;</span>+method.getName()+<span class="hljs-string">&quot;æ–¹æ³•,&quot;</span><br>       +<span class="hljs-string">&quot;è¿”å›å€¼ï¼š&quot;</span>+returnValue);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åå»springçš„æ–‡ä»¶ä¸­æ³¨å†Œ , å¹¶å®ç°aopåˆ‡å…¥å®ç° , æ³¨æ„å¯¼å…¥çº¦æŸ .</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/aop</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--æ³¨å†Œbean--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.service.UserServiceImpl&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;log&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.log.Log&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;afterLog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.log.AfterLog&quot;</span>/&gt;</span><br><br>   <span class="hljs-comment">&lt;!--aopçš„é…ç½®--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--åˆ‡å…¥ç‚¹ expression:è¡¨è¾¾å¼åŒ¹é…è¦æ‰§è¡Œçš„æ–¹æ³•--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pointcut&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;</span>/&gt;</span><br>       <span class="hljs-comment">&lt;!--æ‰§è¡Œç¯ç»•; advice-refæ‰§è¡Œæ–¹æ³• . pointcut-refåˆ‡å…¥ç‚¹--&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;log&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pointcut&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;afterLog&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pointcut&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;<br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>       ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>       UserService userService = (UserService) context.getBean(<span class="hljs-string">&quot;userService&quot;</span>);<br>       userService.search();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Aopçš„é‡è¦æ€§ : å¾ˆé‡è¦ . ä¸€å®šè¦ç†è§£å…¶ä¸­çš„æ€è·¯ , ä¸»è¦æ˜¯æ€æƒ³çš„ç†è§£è¿™ä¸€å— .</p><p>Springçš„Aopå°±æ˜¯å°†å…¬å…±çš„ä¸šåŠ¡ (æ—¥å¿— , å®‰å…¨ç­‰) å’Œé¢†åŸŸä¸šåŠ¡ç»“åˆèµ·æ¥ , å½“æ‰§è¡Œé¢†åŸŸä¸šåŠ¡æ—¶ , å°†ä¼šæŠŠå…¬å…±ä¸šåŠ¡åŠ è¿›æ¥ . å®ç°å…¬å…±ä¸šåŠ¡çš„é‡å¤åˆ©ç”¨ . é¢†åŸŸä¸šåŠ¡æ›´çº¯ç²¹ , ç¨‹åºçŒ¿ä¸“æ³¨é¢†åŸŸä¸šåŠ¡ , å…¶æœ¬è´¨è¿˜æ˜¯åŠ¨æ€ä»£ç† . </p><h3 id="9-2-2-è‡ªå®šä¹‰ç±»æ¥å®ç°AOP"><a href="#9-2-2-è‡ªå®šä¹‰ç±»æ¥å®ç°AOP" class="headerlink" title="9.2.2 è‡ªå®šä¹‰ç±»æ¥å®ç°AOP"></a>9.2.2 è‡ªå®šä¹‰ç±»æ¥å®ç°AOP</h3><p>ç›®æ ‡ä¸šåŠ¡ç±»ä¸å˜ä¾æ—§æ˜¯userServiceImpl</p><p>ç¬¬ä¸€æ­¥ : å†™æˆ‘ä»¬è‡ªå·±çš„ä¸€ä¸ªåˆ‡å…¥ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DiyPointcut</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;---------æ–¹æ³•æ‰§è¡Œå‰---------&quot;</span>);<br>  &#125;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">after</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;---------æ–¹æ³•æ‰§è¡Œå---------&quot;</span>);<br>  &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><p>å»springä¸­é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ç¬¬äºŒç§æ–¹å¼è‡ªå®šä¹‰å®ç°--&gt;</span><br><span class="hljs-comment">&lt;!--æ³¨å†Œbean--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;diy&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.config.DiyPointcut&quot;</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!--aopçš„é…ç½®--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨AOPçš„æ ‡ç­¾å®ç°--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspect</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;diy&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;diyPonitcut&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">aop:before</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;diyPonitcut&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;before&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">aop:after</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;diyPonitcut&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;after&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">aop:aspect</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;<br>   <span class="hljs-meta">@Test</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>       ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>       UserService userService = (UserService) context.getBean(<span class="hljs-string">&quot;userService&quot;</span>);<br>       userService.add();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="9-2-3-ä½¿ç”¨æ³¨è§£å®ç°AOP"><a href="#9-2-3-ä½¿ç”¨æ³¨è§£å®ç°AOP" class="headerlink" title="9.2.3 ä½¿ç”¨æ³¨è§£å®ç°AOP"></a>9.2.3 <strong>ä½¿ç”¨æ³¨è§£å®ç°AOP</strong></h3><p>ç¬¬ä¸€æ­¥ï¼šç¼–å†™ä¸€ä¸ªæ³¨è§£å®ç°çš„å¢å¼ºç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.config;<br><br><span class="hljs-keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.After;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Around;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Aspect;<br><span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Before;<br><br><span class="hljs-meta">@Aspect</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnnotationPointcut</span> </span>&#123;<br>   <span class="hljs-meta">@Before(&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;---------æ–¹æ³•æ‰§è¡Œå‰---------&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@After(&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">after</span><span class="hljs-params">()</span></span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;---------æ–¹æ³•æ‰§è¡Œå---------&quot;</span>);<br>  &#125;<br><br>   <span class="hljs-meta">@Around(&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;)</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint jp)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;<br>       System.out.println(<span class="hljs-string">&quot;ç¯ç»•å‰&quot;</span>);<br>       System.out.println(<span class="hljs-string">&quot;ç­¾å:&quot;</span>+jp.getSignature());<br>       <span class="hljs-comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•proceed</span><br>       Object proceed = jp.proceed();<br>       System.out.println(<span class="hljs-string">&quot;ç¯ç»•å&quot;</span>);<br>       System.out.println(proceed);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šåœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼Œæ³¨å†Œbeanï¼Œå¹¶å¢åŠ æ”¯æŒæ³¨è§£çš„é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ç¬¬ä¸‰ç§æ–¹å¼:æ³¨è§£å®ç°--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;annotationPointcut&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.config.AnnotationPointcut&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>aop:aspectj-autoproxyï¼šè¯´æ˜</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml">é€šè¿‡aopå‘½åç©ºé—´çš„<span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span> /&gt;</span>å£°æ˜è‡ªåŠ¨ä¸ºspringå®¹å™¨ä¸­é‚£äº›é…ç½®@aspectJåˆ‡é¢çš„beanåˆ›å»ºä»£ç†ï¼Œç»‡å…¥åˆ‡é¢ã€‚å½“ç„¶ï¼Œspring åœ¨å†…éƒ¨ä¾æ—§é‡‡ç”¨AnnotationAwareAspectJAutoProxyCreatorè¿›è¡Œè‡ªåŠ¨ä»£ç†çš„åˆ›å»ºå·¥ä½œï¼Œä½†å…·ä½“å®ç°çš„ç»†èŠ‚å·²ç»è¢«<span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span> /&gt;</span>éšè—èµ·æ¥äº†<br><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span> /&gt;</span>æœ‰ä¸€ä¸ªproxy-target-classå±æ€§ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºä½¿ç”¨jdkåŠ¨æ€ä»£ç†ç»‡å…¥å¢å¼ºï¼Œå½“é…ä¸º<span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span>  <span class="hljs-attr">poxy-target-class</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span>æ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨CGLibåŠ¨æ€ä»£ç†æŠ€æœ¯ç»‡å…¥å¢å¼ºã€‚ä¸è¿‡å³ä½¿proxy-target-classè®¾ç½®ä¸ºfalseï¼Œå¦‚æœç›®æ ‡ç±»æ²¡æœ‰å£°æ˜æ¥å£ï¼Œåˆ™springå°†è‡ªåŠ¨ä½¿ç”¨CGLibåŠ¨æ€ä»£ç†ã€‚<br></code></pre></td></tr></table></figure><h1 id="åã€Spirngæ•´åˆMybatis"><a href="#åã€Spirngæ•´åˆMybatis" class="headerlink" title="åã€Spirngæ•´åˆMybatis"></a>åã€Spirngæ•´åˆMybatis</h1><h2 id="10-1-MyBatis-Springå­¦ä¹ "><a href="#10-1-MyBatis-Springå­¦ä¹ " class="headerlink" title="10.1 MyBatis-Springå­¦ä¹ "></a>10.1 MyBatis-Springå­¦ä¹ </h2><p>å¼•å…¥Springä¹‹å‰éœ€è¦äº†è§£mybatis-springåŒ…ä¸­çš„ä¸€äº›é‡è¦ç±»ï¼›</p><p><a href="http://www.mybatis.org/spring/zh/index.html">http://www.mybatis.org/spring/zh/index.html</a></p><p>MyBatis-Spring ä¼šå¸®åŠ©ä½ å°† MyBatis ä»£ç æ— ç¼åœ°æ•´åˆåˆ° Spring ä¸­ã€‚</p><p><strong>çŸ¥è¯†åŸºç¡€</strong></p><p>åœ¨å¼€å§‹ä½¿ç”¨ MyBatis-Spring ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆç†Ÿæ‚‰ Spring å’Œ MyBatis è¿™ä¸¤ä¸ªæ¡†æ¶å’Œæœ‰å…³å®ƒä»¬çš„æœ¯è¯­ã€‚è¿™å¾ˆé‡è¦</p><p>MyBatis-Spring éœ€è¦ä»¥ä¸‹ç‰ˆæœ¬ï¼š</p><table><thead><tr><th align="left">MyBatis-Spring</th><th align="left">MyBatis</th><th align="left">Spring æ¡†æ¶</th><th align="left">Spring Batch</th><th align="left">Java</th></tr></thead><tbody><tr><td align="left">2.0</td><td align="left">3.5+</td><td align="left">5.0+</td><td align="left">4.0+</td><td align="left">Java 8+</td></tr><tr><td align="left">1.3</td><td align="left">3.4+</td><td align="left">3.2.2+</td><td align="left">2.1+</td><td align="left">Java 6+</td></tr></tbody></table><p>å¦‚æœä½¿ç”¨ Maven ä½œä¸ºæ„å»ºå·¥å…·ï¼Œä»…éœ€è¦åœ¨ pom.xml ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç å³å¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¦å’Œ Spring ä¸€èµ·ä½¿ç”¨ MyBatisï¼Œéœ€è¦åœ¨ Spring åº”ç”¨ä¸Šä¸‹æ–‡ä¸­å®šä¹‰è‡³å°‘ä¸¤æ ·ä¸œè¥¿ï¼šä¸€ä¸ª SqlSessionFactory å’Œè‡³å°‘ä¸€ä¸ªæ•°æ®æ˜ å°„å™¨ç±»ã€‚</p><p>åœ¨ MyBatis-Spring ä¸­ï¼Œå¯ä½¿ç”¨SqlSessionFactoryBeanæ¥åˆ›å»º SqlSessionFactoryã€‚è¦é…ç½®è¿™ä¸ªå·¥å‚ beanï¼Œåªéœ€è¦æŠŠä¸‹é¢ä»£ç æ”¾åœ¨ Spring çš„ XML é…ç½®æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;bean <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-built_in">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;<br> &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-keyword">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span> /&gt;<br>&lt;/bean&gt;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šSqlSessionFactoryéœ€è¦ä¸€ä¸ª DataSourceï¼ˆæ•°æ®æºï¼‰ã€‚è¿™å¯ä»¥æ˜¯ä»»æ„çš„ DataSourceï¼Œåªéœ€è¦å’Œé…ç½®å…¶å®ƒ Spring æ•°æ®åº“è¿æ¥ä¸€æ ·é…ç½®å®ƒå°±å¯ä»¥äº†ã€‚</p><p>åœ¨åŸºç¡€çš„ MyBatis ç”¨æ³•ä¸­ï¼Œæ˜¯é€šè¿‡ SqlSessionFactoryBuilder æ¥åˆ›å»º SqlSessionFactory çš„ã€‚è€Œåœ¨ MyBatis-Spring ä¸­ï¼Œåˆ™ä½¿ç”¨ SqlSessionFactoryBean æ¥åˆ›å»ºã€‚</p><p>åœ¨ MyBatis ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ SqlSessionFactory æ¥åˆ›å»º SqlSessionã€‚ä¸€æ—¦ä½ è·å¾—ä¸€ä¸ª session ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ‰§è¡Œæ˜ å°„äº†çš„è¯­å¥ï¼Œæäº¤æˆ–å›æ»šè¿æ¥ï¼Œæœ€åï¼Œå½“ä¸å†éœ€è¦å®ƒçš„æ—¶å€™ï¼Œä½ å¯ä»¥å…³é—­ sessionã€‚</p><p>SqlSessionFactoryæœ‰ä¸€ä¸ªå”¯ä¸€çš„å¿…è¦å±æ€§ï¼šç”¨äº JDBC çš„ DataSourceã€‚è¿™å¯ä»¥æ˜¯ä»»æ„çš„ DataSource å¯¹è±¡ï¼Œå®ƒçš„é…ç½®æ–¹æ³•å’Œå…¶å®ƒ Spring æ•°æ®åº“è¿æ¥æ˜¯ä¸€æ ·çš„ã€‚</p><p>ä¸€ä¸ªå¸¸ç”¨çš„å±æ€§æ˜¯ configLocationï¼Œå®ƒç”¨æ¥æŒ‡å®š MyBatis çš„ XML é…ç½®æ–‡ä»¶è·¯å¾„ã€‚å®ƒåœ¨éœ€è¦ä¿®æ”¹ MyBatis çš„åŸºç¡€é…ç½®éå¸¸æœ‰ç”¨ã€‚é€šå¸¸ï¼ŒåŸºç¡€é…ç½®æŒ‡çš„æ˜¯ &lt; settings&gt; æˆ– &lt; typeAliases&gt;å…ƒç´ ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶å¹¶ä¸éœ€è¦æ˜¯ä¸€ä¸ªå®Œæ•´çš„ MyBatis é…ç½®ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œä»»ä½•ç¯å¢ƒé…ç½®ï¼ˆ<environments>ï¼‰ï¼Œæ•°æ®æºï¼ˆ<DataSource>ï¼‰å’Œ MyBatis çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆ<transactionManager>ï¼‰éƒ½ä¼šè¢«å¿½ç•¥ã€‚SqlSessionFactoryBean ä¼šåˆ›å»ºå®ƒè‡ªæœ‰çš„ MyBatis ç¯å¢ƒé…ç½®ï¼ˆEnvironmentï¼‰ï¼Œå¹¶æŒ‰è¦æ±‚è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒçš„å€¼ã€‚</transactionManager></DataSource></environments></p><p>SqlSessionTemplate æ˜¯ MyBatis-Spring çš„æ ¸å¿ƒã€‚ä½œä¸º SqlSession çš„ä¸€ä¸ªå®ç°ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨å®ƒæ— ç¼ä»£æ›¿ä½ ä»£ç ä¸­å·²ç»åœ¨ä½¿ç”¨çš„ SqlSessionã€‚</p><p>æ¨¡æ¿å¯ä»¥å‚ä¸åˆ° Spring çš„äº‹åŠ¡ç®¡ç†ä¸­ï¼Œå¹¶ä¸”ç”±äºå…¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥ä¾›å¤šä¸ªæ˜ å°„å™¨ç±»ä½¿ç”¨ï¼Œä½ åº”è¯¥æ€»æ˜¯ç”¨ SqlSessionTemplate æ¥æ›¿æ¢ MyBatis é»˜è®¤çš„ DefaultSqlSession å®ç°ã€‚åœ¨åŒä¸€åº”ç”¨ç¨‹åºä¸­çš„ä¸åŒç±»ä¹‹é—´æ··æ‚ä½¿ç”¨å¯èƒ½ä¼šå¼•èµ·æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</p><p>å¯ä»¥ä½¿ç”¨ SqlSessionFactory ä½œä¸ºæ„é€ æ–¹æ³•çš„å‚æ•°æ¥åˆ›å»º SqlSessionTemplate å¯¹è±¡ã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;bean <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-built_in">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;<br> &lt;constructor-arg index=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-keyword">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> /&gt;<br>&lt;/bean&gt;<br></code></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œè¿™ä¸ª bean å°±å¯ä»¥ç›´æ¥æ³¨å…¥åˆ°ä½ çš„ DAO bean ä¸­äº†ã€‚ä½ éœ€è¦åœ¨ä½ çš„ bean ä¸­æ·»åŠ ä¸€ä¸ª SqlSession å±æ€§ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoImpl</span> <span class="hljs-title">implements</span> <span class="hljs-title">UserDao</span> </span>&#123;<br><br> <span class="hljs-keyword">private</span> SqlSession sqlSession;<br><br> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-function"><span class="hljs-title">setSqlSession</span>(<span class="hljs-params">SqlSession sqlSession</span>)</span> &#123;<br>   <span class="hljs-built_in">this</span>.sqlSession = sqlSession;<br>&#125;<br><br> <span class="hljs-keyword">public</span> User <span class="hljs-function"><span class="hljs-title">getUser</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userId</span>)</span> &#123;<br>   <span class="hljs-keyword">return</span> sqlSession.getMapper...;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æŒ‰ä¸‹é¢è¿™æ ·ï¼Œæ³¨å…¥ SqlSessionTemplateï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;bean <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-built_in">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.sample.dao.UserDaoImpl&quot;</span>&gt;<br> &lt;<span class="hljs-keyword">property</span> <span class="hljs-built_in">name</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-keyword">ref</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> /&gt;<br>&lt;/bean&gt;<br></code></pre></td></tr></table></figure><h2 id="10-2-å¯¼å…¥èµ„æºå’ŒjaråŒ…"><a href="#10-2-å¯¼å…¥èµ„æºå’ŒjaråŒ…" class="headerlink" title="10.2 å¯¼å…¥èµ„æºå’ŒjaråŒ…"></a>10.2 å¯¼å…¥èµ„æºå’ŒjaråŒ…</h2><p>1ã€å¯¼å…¥ç›¸å…³jaråŒ…</p><p>junit</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>mybatis</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>mysql-connector-java</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>springç›¸å…³</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.10.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>aspectJ AOP ç»‡å…¥å™¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>mybatis-springæ•´åˆåŒ… ã€é‡ç‚¹ã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®Mavené™æ€èµ„æºè¿‡æ»¤é—®é¢˜ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™é…ç½®æ–‡ä»¶</p><p>3ã€ä»£ç å®ç°</p><h2 id="10-3-å›å¿†MyBatis"><a href="#10-3-å›å¿†MyBatis" class="headerlink" title="10.3 å›å¿†MyBatis"></a>10.3 å›å¿†MyBatis</h2><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227171607981.png" alt="image-20201227171607981"></p><p><strong>ç¼–å†™pojoå®ä½“ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.kuang.pojo;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;  <span class="hljs-comment">//id</span><br>   <span class="hljs-keyword">private</span> String name;   <span class="hljs-comment">//å§“å</span><br>   <span class="hljs-keyword">private</span> String pwd;   <span class="hljs-comment">//å¯†ç </span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>å®ç°mybatisçš„é…ç½®æ–‡ä»¶</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.kuang.pojo&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123456&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.kuang.dao&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>mybatiså·¥å…·ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.utils;<br><br><span class="hljs-keyword">import</span> org.apache.ibatis.io.Resources;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-comment">//ç¼–å†™æ­¤å·¥å…·ç±»ç”¨äºè·å–sqlSessionFactoryå¯¹è±¡</span><br><span class="hljs-comment">//sqlSessionFactoryå·¥å‚ç”¨äºç”Ÿäº§sqlSession</span><br><span class="hljs-comment">//sqlSessiomåŒ…å«äº†é¢å‘æ•°æ®åº“çš„æ‰€æœ‰æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisUtils</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SqlSessionFactory sqlSessionFactory;<br>    <span class="hljs-comment">//    ç”¨é™æ€ä»£ç å—ä½¿å…¶ä¸€åˆå§‹å°±åŠ è½½</span><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br><span class="hljs-comment">//            1ã€è·å–èµ„æº</span><br>            String resource = <span class="hljs-string">&quot;mybatis-config.xml&quot;</span>;<br><span class="hljs-comment">//            2ã€ç”¨resourceåŠ è½½è¿›æ¥</span><br>            InputStream inputStream = Resources.getResourceAsStream(resource);<br><span class="hljs-comment">//            3ã€ç”¨buliderå°†resourceåŠ è½½è¿›æ¥</span><br>            sqlSessionFactory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–SqlSessionè¿æ¥</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSession</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> sqlSessionFactory.openSession();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>UserDaoæ¥å£ç¼–å†™</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> </span>&#123;<br>   <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">selectUser</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ¥å£å¯¹åº”çš„Mapperæ˜ å°„æ–‡ä»¶</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.kuang.dao.UserMapper&quot;</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUser&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;User&quot;</span>&gt;</span><br>    select * from user<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><span class="hljs-keyword">import</span> com.mc.utils.MybatisUtils;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoTest</span> </span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//è·å–sqlå¯¹è±¡</span><br>        SqlSession sqlSession = MybatisUtils.getSession();<br>         UserDao userDao = sqlSession.getMapper(UserDao.class);<br>         List&lt;User&gt; userList = userDao.getUserList();<br><br>         <span class="hljs-keyword">for</span>(User user:userList)&#123;<br>             System.out.println(user);<br>         &#125;<br><br>         <span class="hljs-comment">//å…³é—­sqlsession</span><br>         sqlSession.close();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="10-4-æ•´åˆå®ç°ä¸€"><a href="#10-4-æ•´åˆå®ç°ä¸€" class="headerlink" title="10.4 æ•´åˆå®ç°ä¸€"></a>10.4 æ•´åˆå®ç°ä¸€</h2><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227170921074.png" alt="image-20201227170921074"></p><p>UseMapper</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> </span>&#123;<br>    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserList</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>UserMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--å‘½åç©ºé—´ä¸èƒ½é”™--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.mc.dao.UserMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserList&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.mc.pojo.User&quot;</span>&gt;</span><br>  select * from user<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>UserMapperImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><span class="hljs-keyword">import</span> org.mybatis.spring.SqlSessionTemplate;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserMapperImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserMapper</span></span>&#123;<br>    <span class="hljs-comment">//sqlSessionä¸ç”¨æˆ‘ä»¬è‡ªå·±åˆ›å»ºäº†ï¼ŒSpringæ¥ç®¡ç†</span><br>    <span class="hljs-keyword">private</span> SqlSessionTemplate sqlSession;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSqlSession</span><span class="hljs-params">(SqlSessionTemplate sqlSession)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.sqlSession = sqlSession;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">getUserList</span><span class="hljs-params">()</span> </span>&#123;<br>        UserMapper mapper = sqlSession.getMapper(UserMapper.class);<br>        <span class="hljs-keyword">return</span> mapper.getUserList();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>mybatis-config.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--        configurationæ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.mc.pojo&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br><span class="hljs-comment">&lt;!--    æ¯ä¸€ä¸ªMapper.xmléƒ½è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ--&gt;</span><br><span class="hljs-comment">&lt;!--    resourceã€classã€urlä¸‰ç§æ–¹å¼éƒ½å¯ä»¥--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/mc/dao/UserMapper.xml&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--        &lt;mapper class=&quot;com.mc.dao.UserDao&quot;/&gt;--&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><p>spring-dap.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--é…ç½®æ•°æ®æºï¼šæ•°æ®æºæœ‰éå¸¸å¤šï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ï¼Œä¹Ÿå¯ä½¿ä½¿ç”¨Springçš„--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;admin&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--é…ç½®SqlSessionFactory--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--å…³è”Mybatis--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;configLocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapperLocations&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:com/mc/dao/*.xml&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--æ³¨å†ŒsqlSessionTemplate , å…³è”sqlSessionFactory--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--åªèƒ½ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä¸èƒ½ç”¨set--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mc.dao.UserMapperImpl&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSession&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> org.springframework.context.ApplicationContext;<br><span class="hljs-keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoTest</span> </span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span></span>&#123;<br>        ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;spring-dao.xml&quot;</span>);<br>        UserMapper mapper = (UserMapper) context.getBean(<span class="hljs-string">&quot;userMapper&quot;</span>);<br>        List&lt;User&gt; user = mapper.getUserList();<br>        System.out.println(user);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10-5-æ•´åˆå®ç°äºŒ"><a href="#10-5-æ•´åˆå®ç°äºŒ" class="headerlink" title="10.5 æ•´åˆå®ç°äºŒ"></a>10.5 æ•´åˆå®ç°äºŒ</h2><p>mybatis-spring1.2.3ç‰ˆä»¥ä¸Šçš„æ‰æœ‰è¿™ä¸ª .</p><p>å®˜æ–¹æ–‡æ¡£æˆªå›¾ :</p><p>daoç»§æ‰¿Supportç±» , ç›´æ¥åˆ©ç”¨ getSqlSession() è·å¾— , ç„¶åç›´æ¥æ³¨å…¥SqlSessionFactory . æ¯”èµ·æ–¹å¼1 , ä¸éœ€è¦ç®¡ç†SqlSessionTemplate , è€Œä¸”å¯¹äº‹åŠ¡çš„æ”¯æŒæ›´åŠ å‹å¥½ . å¯è·Ÿè¸ªæºç æŸ¥çœ‹</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227172728104.png" alt="image-20201227172728104"></p><p>æµ‹è¯•ï¼š</p><p>1ã€å°†æˆ‘ä»¬ä¸Šé¢å†™çš„UserMapperImplä¿®æ”¹ä¸€ä¸‹UserMapperImpl2</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.mybatis.spring.support.SqlSessionDaoSupport;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserMapperImpl2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SqlSessionDaoSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserMapper</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">getUserList</span><span class="hljs-params">()</span> </span>&#123;<br><br>        UserMapper mapper = getSqlSession().getMapper(UserMapper.class);<br>        <span class="hljs-keyword">return</span> mapper.getUserList();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€ä¿®æ”¹beançš„é…ç½®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mc.dao.UserMapperImpl2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> /&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test2</span><span class="hljs-params">()</span></span>&#123;<br>   ApplicationContext context = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);<br>   UserMapper mapper = (UserMapper) context.getBean(<span class="hljs-string">&quot;userDao&quot;</span>);<br>   List&lt;User&gt; user = mapper.selectUser();<br>   System.out.println(user);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Beané…ç½®æ–‡ä»¶ç»“æ„ä¼˜åŒ–"><a href="#Beané…ç½®æ–‡ä»¶ç»“æ„ä¼˜åŒ–" class="headerlink" title="Beané…ç½®æ–‡ä»¶ç»“æ„ä¼˜åŒ–"></a><strong>Beané…ç½®æ–‡ä»¶ç»“æ„ä¼˜åŒ–</strong></h2><p>åŸæ¥çš„ spring-dao.xml</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227174022485.png" alt="image-20201227174022485"></p><p>æ”¹æˆä¸¤ä¸ª</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227174106868.png" alt="image-20201227174106868"></p><p>å°†æ³¨å…¥mapperæ”¾å…¥applicationä¸­å½“ä½œè‘—é…ç½®æ–‡ä»¶</p><p>spring-dao</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--é…ç½®æ•°æ®æºï¼šæ•°æ®æºæœ‰éå¸¸å¤šï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ï¼Œä¹Ÿå¯ä½¿ä½¿ç”¨Springçš„--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;admin&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--é…ç½®SqlSessionFactory--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--å…³è”Mybatis--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;configLocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapperLocations&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:com/mc/dao/*.xml&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--æ³¨å†ŒsqlSessionTemplate , å…³è”sqlSessionFactory--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--åªèƒ½ä½¿ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä¸èƒ½ç”¨set--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>applicationContext</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-tag"><span class="hljs-string">       http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;spring-dao.xml&quot;</span>/&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mc.dao.UserMapperImpl&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSession&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mc.dao.UserMapperImpl2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç±»ç›´æ¥è°ƒç”¨applicationContext</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Spring/image-20201227174707535.png" alt="image-20201227174707535"></p><h1 id="åä¸€ã€å£°æ˜å¼äº‹åŠ¡"><a href="#åä¸€ã€å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="åä¸€ã€å£°æ˜å¼äº‹åŠ¡"></a>åä¸€ã€å£°æ˜å¼äº‹åŠ¡</h1>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sql</title>
    <link href="/2020/12/26/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Sql/"/>
    <url>/2020/12/26/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Sql/</url>
    
    <content type="html"><![CDATA[<h1 id="MySql"><a href="#MySql" class="headerlink" title="MySql"></a>MySql</h1><h2 id="å‘½ä»¤è¡Œå¯åŠ¨"><a href="#å‘½ä»¤è¡Œå¯åŠ¨" class="headerlink" title="å‘½ä»¤è¡Œå¯åŠ¨"></a>å‘½ä»¤è¡Œå¯åŠ¨</h2><p>è¿›å…¥sqlä¸­binæ‰€åœ¨ç›®å½•cmd</p><p>è¾“å…¥mysql -u root -pï¼ˆrootæ˜¯ç”¨æˆ·åï¼‰</p><p>è¾“å…¥å¯†ç å³å¯</p><p><img src="/2020/12/26/%E5%88%86%E7%B1%BB-%E6%95%B0%E6%8D%AE%E5%BA%93/Sql/image-20201226112916622.png" alt="image-20201226112916622"></p><h2 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h2><p>ä¸»è¦ä»‹ç»å¯¹æ•°æ®åº“ä»¥åŠè¡¨çš„ä¸€äº›åŸºæœ¬æ“ä½œ</p><h3 id="1-1-å…³äºæ•°æ®åº“"><a href="#1-1-å…³äºæ•°æ®åº“" class="headerlink" title="1-1.å…³äºæ•°æ®åº“"></a>1-1.å…³äºæ•°æ®åº“</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;åˆ›å»ºæ•°æ®åº“<br>create database h_test;<br>&#x2F;&#x2F;æŸ¥çœ‹æ•°æ®åº“<br>show databases;<br>&#x2F;&#x2F;æŸ¥çœ‹æ•°æ®åº“ä¿¡æ¯<br>show create database h_test;<br>&#x2F;&#x2F;ä¿®æ”¹æ•°æ®åº“çš„ç¼–ç ï¼Œå¯ä½¿ç”¨ä¸Šä¸€æ¡è¯­å¥æŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸ<br>alter database h_test default character set gbk collate gbk_bin;<br>&#x2F;&#x2F;åˆ é™¤æ•°æ®åº“<br>drop database h_test;<br>&#x2F;&#x2F;ç»¼ä¸Šï¼Œå¯ä»¥ç›´æ¥åˆ›å»ºæ•°æ®åº“ä¸”è®¾ç½®ç¼–ç æ–¹å¼<br>CREATE DATABASE h_test DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;<br></code></pre></td></tr></table></figure><h3 id="1-2-å…³äºæ•°æ®è¡¨"><a href="#1-2-å…³äºæ•°æ®è¡¨" class="headerlink" title="1-2.å…³äºæ•°æ®è¡¨"></a>1-2.å…³äºæ•°æ®è¡¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;é¦–å…ˆé€‰å®šæ“ä½œçš„æ•°æ®åº“<br>use h_test;<br>&#x2F;&#x2F;å¦‚ï¼šUSE &#96;mybatis&#96;;<br>&#x2F;&#x2F;åˆ›å»ºè¡¨student<br>create table student(<br>  id  int(11),<br>  name  varchar(20),<br>  age int(11)<br>);<br>&#x2F;&#x2F;æŸ¥çœ‹æ•°æ®è¡¨<br>show tables;<br>&#x2F;&#x2F;æŸ¥çœ‹æ•°æ®è¡¨ä¿¡æ¯ï¼Œåé¢åŠ ä¸Šå‚æ•°&#x2F;Gå¯ä½¿ç»“æœæ›´åŠ ç¾è§‚<br>show create table student;<br>&#x2F;&#x2F;æŸ¥çœ‹è¡¨çš„çš„å­—æ®µä¿¡æ¯<br>desc student;<br>&#x2F;&#x2F;ä¿®æ”¹è¡¨å<br>alter table student rename [to] h_student;<br>&#x2F;&#x2F;ä¿®æ”¹å­—æ®µå<br>alter table h_student change name stu_name varchar(20);<br>&#x2F;&#x2F;ä¿®æ”¹å­—æ®µçš„æ•°æ®ç±»å‹<br>alter table h_student modify id int(20);<br>&#x2F;&#x2F;æ·»åŠ å­—æ®µ<br>alter table h_student add grade float;<br>&#x2F;&#x2F;åˆ é™¤å­—æ®µ<br>alter table h_student drop grade;<br>&#x2F;&#x2F;ä¿®æ”¹å­—æ®µçš„ä½ç½®<br>alter table h_student modify stu_name varchar(20) first;<br>alter table h_student modify id int(11) after age;<br>&#x2F;&#x2F;åˆ é™¤æ•°æ®è¡¨<br>drop table h_student;<br></code></pre></td></tr></table></figure><h3 id="1-3è¡¨çš„çº¦æŸ"><a href="#1-3è¡¨çš„çº¦æŸ" class="headerlink" title="1-3è¡¨çš„çº¦æŸ"></a>1-3è¡¨çš„çº¦æŸ</h3><table><thead><tr><th align="left">çº¦æŸæ¡ä»¶</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">PRIMARY KEY</td><td align="center">ä¸»é”®çº¦æŸï¼Œç”¨äºå”¯ä¸€æ ‡è¯†å¯¹åº”çš„è®°å½•</td></tr><tr><td align="left">FOREIGN KEY</td><td align="center">å¤–é”®çº¦æŸ</td></tr><tr><td align="left">NOT NULL</td><td align="center">éç©ºçº¦æŸ</td></tr><tr><td align="left">UNIQUE</td><td align="center">å”¯ä¸€æ€§çº¦æŸ</td></tr><tr><td align="left">DEFAULT</td><td align="center">é»˜è®¤å€¼çº¦æŸï¼Œç”¨äºè®¾ç½®å­—æ®µçš„é»˜è®¤å€¼</td></tr></tbody></table><h3 id="1-4ç´¢å¼•"><a href="#1-4ç´¢å¼•" class="headerlink" title="1-4ç´¢å¼•"></a>1-4ç´¢å¼•</h3><blockquote><p>â€œ</p><p>ä½œç”¨ï¼šæé«˜è¡¨ä¸­æ•°æ®çš„æŸ¥è¯¢é€Ÿåº¦ 1.æ™®é€šç´¢å¼• 2.å”¯ä¸€æ€§ç´¢å¼• 3.å…¨æ–‡ç´¢å¼• 4.å•åˆ—ç´¢å¼• 5.å¤šåˆ—ç´¢å¼• 6.ç©ºé—´ç´¢å¼•</p><p>â€</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;åˆ›å»ºç´¢å¼•<br>&#x2F;&#x2F;ä¸€.åˆ›å»ºè¡¨çš„æ—¶å€™åˆ›å»ºç´¢å¼•<br>create table è¡¨å(<br>        å­—æ®µå æ•°æ®ç±»å‹[å®Œæ•´æ€§çº¦æŸæ¡ä»¶],<br>        ...<br>        å­—æ®µå æ•°æ®ç±»å‹,<br>        [UNIQUE|FULLTEXT|SPATIAL] INDEX|KEY<br>  );<br>&#x2F;&#x2F;1-1.åˆ›å»ºæ™®é€šç´¢å¼•<br>create table test1(<br>  id  INT,<br>  name VARCHAR(20),<br>  age INT,<br>  INDEX (id)<br>);<br>&#x2F;&#x2F;å¯ä»¥æ’å…¥ä¸€æ¡æ•°æ®,æŸ¥çœ‹ç´¢å¼•æ˜¯å¦è¢«ä½¿ç”¨<br>explain select * from test1 where id&#x3D;1 \G;<br>&#x2F;&#x2F;1-2.åˆ›å»ºå”¯ä¸€æ€§ç´¢å¼•<br>create table test2(<br>  id  INT,<br>  name VARCHAR(20),<br>  age INT,<br>  UNIQUE INDEX unique_id(id asc)<br>);<br>&#x2F;&#x2F;1-3.åˆ›å»ºå…¨æ–‡ç´¢å¼•<br>create table test3(<br>  id  INT,<br>  name VARCHAR(20),<br>  age INT,<br>  FULLTEXT INDEX fulltext_name(name)<br>)ENGINE&#x3D;MyISAM;<br>&#x2F;&#x2F;1-4.åˆ›å»ºå•åˆ—ç´¢å¼•<br>create table test4(<br>  id  INT,<br>  name VARCHAR(20),<br>  age INT,<br>  INDEX single_name(name(20))<br>);<br>&#x2F;&#x2F;1-5.åˆ›å»ºå¤šåˆ—ç´¢å¼•<br>create table test5(<br>  id  INT,<br>  name VARCHAR(20),<br>  age INT,<br>  INDEX multi(id,name(20))<br>);<br>&#x2F;&#x2F;1-6.åˆ›å»ºç©ºé—´ç´¢å¼•<br>create table test6(<br>  id  INT,<br>  space GEOMETRY NOT NULL,<br>  SPATIAL INDEX sp(space)<br>)ENGINE&#x3D;MyISAM;<br>---------------------------------------------------<br>&#x2F;&#x2F;äºŒ.ä½¿ç”¨create indexè¯­å¥åœ¨å·²ç»å­˜åœ¨çš„è¡¨ä¸Šåˆ›å»ºç´¢å¼•<br>&#x2F;&#x2F;é¦–å…ˆæ–°å»ºä¸€ä¸ªè¡¨,è¿™ä¸ªè¡¨æ²¡æœ‰ç´¢å¼•<br>create table student(<br>  id int,<br>  age int,<br>  name varchar(20),<br>  intro varchar(40),<br>  g GEOMETRY NOT NULL<br>)ENGINE&#x3D;MyISAM;<br>&#x2F;&#x2F;2-1.åˆ›å»ºæ™®é€šç´¢å¼•<br>create index index_id on student(id);<br>&#x2F;&#x2F;2-2.åˆ›å»ºå”¯ä¸€æ€§ç´¢å¼•<br>create unique index uniqueidx on student(id);<br>&#x2F;&#x2F;2-3.åˆ›å»ºå•åˆ—ç´¢å¼•<br>create index singleidx on student(age);<br>&#x2F;&#x2F;2-4.åˆ›å»ºå¤šåˆ—ç´¢å¼•<br>create index mulitidx on student(name(20),intro(40));<br>&#x2F;&#x2F;2-5.åˆ›å»ºå…¨æ–‡ç´¢å¼•<br>create fulltext index fulltextidx on student(name);<br>&#x2F;&#x2F;2-6.åˆ›å»ºç©ºé—´ç´¢å¼•<br>create spatial index spatidx on student(g);<br></code></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;ä¸‰.ä½¿ç”¨alter tableè¯­å¥åœ¨å·²ç»å­˜åœ¨çš„è¡¨ä¸Šåˆ›å»ºç´¢å¼•<br>&#x2F;&#x2F;åˆ é™¤studentè¡¨ï¼Œé‡æ–°åˆ›å»º<br>drop table student;<br>create table student(<br>  id int,<br>  age int,<br>  name varchar(20),<br>  intro varchar(40),<br>  space GEOMETRY NOT NULL<br>)ENGINE&#x3D;MyISAM;<br>&#x2F;&#x2F;3-1.åˆ›å»ºæ™®é€šç´¢å¼•<br>alter table student add index index_id(id);<br>&#x2F;&#x2F;3-2.åˆ›å»ºå”¯ä¸€æ€§ç´¢å¼•<br>alter table student add unique uniqueidx(id);<br>&#x2F;&#x2F;3-3.åˆ›å»ºå•åˆ—ç´¢å¼•<br>alter table student add index singleidx (age);<br>&#x2F;&#x2F;3-4.åˆ›å»ºå¤šåˆ—ç´¢å¼•<br>alter table student add index multidx(name(20),intro(40));<br>&#x2F;&#x2F;3-5.åˆ›å»ºå…¨æ–‡ç´¢å¼•<br>alter table student add fulltext index fulltextidx(name);<br>&#x2F;&#x2F;3-6.åˆ›å»ºç©ºé—´ç´¢å¼•<br>alter table student add spatial index spatidx(space);<br>&#x2F;&#x2F;ä¸‹å›¾æ¼”ç¤ºç»“æœ<br></code></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;åˆ é™¤ç´¢å¼•ï¼Œæœ‰ä¸‹é¢ä¸¤ç§æ–¹å¼<br>&#x2F;&#x2F;1.ä½¿ç”¨alter tableåˆ é™¤ç´¢å¼•fulltextidx<br>alter table student drop index fulltextidx;<br>&#x2F;&#x2F;2.ä½¿ç”¨drop indexåˆ é™¤ç´¢å¼•spatidx<br>drop index spatidx on student;<br>&#x2F;&#x2F;ä¸‹å›¾å¯çœ‹åˆ°åˆ é™¤æˆåŠŸ<br></code></pre></td></tr></table></figure><h3 id="1-5-æ·»åŠ æ•°æ®"><a href="#1-5-æ·»åŠ æ•°æ®" class="headerlink" title="1-5.æ·»åŠ æ•°æ®"></a>1-5.æ·»åŠ æ•°æ®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;é‡æ–°å»ºç«‹è¡¨student<br>drop table student;<br>create table student(<br>  id int,<br>  name varchar(20) not null,<br>  grade float<br>);<br>&#x2F;&#x2F;æ’å…¥ä¸€æ¡æ•°æ®ï¼Œä¹Ÿå¯ä»¥å°‘æŸä¸ªå­—æ®µçš„åŒæ—¶ä¹Ÿå°‘å¯¹åº”çš„æ•°æ®<br>insert into student(id,name,grade) values(1,&#39;howie&#39;,70);<br>&#x2F;&#x2F;ä¹Ÿå¯ä»¥ä¸æŒ‡å®šå­—æ®µåï¼Œä½†è¦æ³¨æ„é¡ºåº<br>insert into student values(2,&#39;howie&#39;,80);<br>&#x2F;&#x2F;ä¹Ÿå¯ä»¥è¿™æ ·æ·»åŠ æ•°æ®<br>insert into student set id&#x3D;3,name&#x3D;&quot;howie&quot;,grade&#x3D;90;<br>&#x2F;&#x2F;åŒæ—¶æ·»åŠ å¤šæ¡æ•°æ®<br>insert into student values<br>(4,&#39;howie&#39;,80),<br>(5,&#39;howie&#39;,80),<br>(6,&#39;howie&#39;,80);<br></code></pre></td></tr></table></figure><h3 id="1-6-æ›´æ–°æ•°æ®"><a href="#1-6-æ›´æ–°æ•°æ®" class="headerlink" title="1-6.æ›´æ–°æ•°æ®"></a>1-6.æ›´æ–°æ•°æ®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;æ›´æ–°id&#x3D;1çš„æ•°æ®<br>update student set name&#x3D;&quot;howie1&quot;,grade&#x3D;60 where id&#x3D;1;<br>&#x2F;&#x2F;æ‰¹é‡æ›´æ–°,å¦‚æœæ²¡æœ‰whereå­å¥ï¼Œä¼šæ›´æ–°è¡¨ä¸­æ‰€æœ‰å¯¹åº”æ•°æ®<br>update student set grade&#x3D;100 where id&lt;4;<br></code></pre></td></tr></table></figure><h3 id="1-7-åˆ é™¤æ•°æ®"><a href="#1-7-åˆ é™¤æ•°æ®" class="headerlink" title="1-7.åˆ é™¤æ•°æ®"></a>1-7.åˆ é™¤æ•°æ®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;åˆ é™¤id&#x3D;6çš„æ•°æ®<br>delete from student where id&#x3D;6;<br>&#x2F;&#x2F;æ‰¹é‡åˆ é™¤æ•°æ®<br>delete from student where id&gt;3;<br>&#x2F;&#x2F;åˆ é™¤æ‰€æœ‰æ•°æ®,DDL(æ•°æ®å®šä¹‰è¯­è¨€)è¯­å¥ truncate table studentä¹Ÿå¯ä»¥åˆ é™¤è¡¨å†…æ‰€æœ‰æ•°æ®<br>delete from student;<br></code></pre></td></tr></table></figure><hr><h2 id="äºŒ-ã€å•è¡¨æŸ¥è¯¢å’Œå¤šè¡¨æ“ä½œ"><a href="#äºŒ-ã€å•è¡¨æŸ¥è¯¢å’Œå¤šè¡¨æ“ä½œ" class="headerlink" title="äºŒ ã€å•è¡¨æŸ¥è¯¢å’Œå¤šè¡¨æ“ä½œ"></a>äºŒ ã€å•è¡¨æŸ¥è¯¢å’Œå¤šè¡¨æ“ä½œ</h2><blockquote><p>â€œ</p><p>å•è¡¨æŸ¥è¯¢ï¼šå¦‚ä½•ä»æ•°æ®åº“ä¸­è·å–ä½ éœ€è¦çš„æ•°æ® å¤šè¡¨æŸ¥è¯¢ï¼šå®é™…å¼€å‘ä¸­ï¼Œéœ€è¦è¿›è¡Œ2å¼ è¡¨ä»¥ä¸Šè¿›è¡Œæ“ä½œ</p><p>â€</p></blockquote><h3 id="2-1-1-å•è¡¨æŸ¥è¯¢"><a href="#2-1-1-å•è¡¨æŸ¥è¯¢" class="headerlink" title="2-1-1.å•è¡¨æŸ¥è¯¢"></a>2-1-1.å•è¡¨æŸ¥è¯¢</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;å»ºç«‹è¡¨student<br>create table student(<br>  id int not null auto_increment,<br>  name varchar(20) not null,<br>  grade float,<br>  primary key(id)<br>);<br>&#x2F;&#x2F;æ’å…¥æ•°æ®<br>insert into student (name,grade) values<br>(&quot;howie1&quot;,40),<br>(&quot;howie1&quot;,50),<br>(&quot;howie2&quot;,50),<br>(&quot;howie3&quot;,60),<br>(&quot;howie4&quot;,70),<br>(&quot;howie5&quot;,80),<br>(&quot;howie6&quot;,null);<br>&#x2F;&#x2F;æŸ¥è¯¢å…¨éƒ¨<br>select * from student;<br>&#x2F;&#x2F;æŸ¥è¯¢æŸä¸ªå­—æ®µ<br>select name from student;<br>&#x2F;&#x2F;æ¡ä»¶æŸ¥è¯¢,æŸ¥è¯¢id&#x3D;2å­¦ç”Ÿçš„ä¿¡æ¯<br>select * from student where id&#x3D;2;<br>&#x2F;&#x2F;inå…³é”®å­—æŸ¥è¯¢,ä¹Ÿå¯ä»¥ä½¿ç”¨not in<br>select * from student where id IN(1,2,3);<br>&#x2F;&#x2F;between andå…³é”®å­—æŸ¥è¯¢<br>select * from student where id between 2 and 5;<br>&#x2F;&#x2F;ç©ºå€¼(NULL)æŸ¥è¯¢ï¼Œä½¿ç”¨IS NULLæ¥åˆ¤æ–­<br>select * from student where grade is null;<br>&#x2F;&#x2F;distinctå…³é”®å­—æŸ¥è¯¢<br>select distinct name from student;<br>&#x2F;&#x2F;likeå…³é”®å­—æŸ¥è¯¢,æŸ¥è¯¢ä»¥hå¼€å¤´ï¼Œeç»“å°¾çš„æ•°æ®<br>select * from student where name like &quot;h%e&quot;;<br>&#x2F;&#x2F;andå…³é”®å­—å¤šæ¡ä»¶æŸ¥è¯¢,orå…³é”®å­—çš„ä½¿ç”¨ä¹Ÿæ˜¯ç±»ä¼¼<br>select * from student where id&gt;5 and grade&gt;60;<br></code></pre></td></tr></table></figure><h3 id="2-1-2-é«˜çº§æŸ¥è¯¢"><a href="#2-1-2-é«˜çº§æŸ¥è¯¢" class="headerlink" title="2-1-2.é«˜çº§æŸ¥è¯¢"></a>2-1-2.é«˜çº§æŸ¥è¯¢</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;èšåˆå‡½æ•°<br>&#x2F;&#x2F;count()å‡½æ•°,sum()å‡½æ•°,avg()å‡½æ•°,max()å‡½æ•°,min()å‡½æ•°<br>select count(*) from student;<br>select sum(grade) from student;<br>select avg(grade) from student;<br>select max(grade) from student;<br>select min(grade) from student;<br>&#x2F;&#x2F;å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åº<br>select * from student order by grade;<br>&#x2F;&#x2F;åˆ†ç»„æŸ¥è¯¢<br>&#x2F;&#x2F;1.å•ç‹¬ä½¿ç”¨group byåˆ†ç»„<br>select * from student group by grade;<br>&#x2F;&#x2F;2.å’Œèšåˆå‡½æ•°ä¸€èµ·ä½¿ç”¨<br>select count(*),grade from student group by grade;<br>&#x2F;&#x2F;3.å’Œhavingå…³é”®å­—ä¸€èµ·ä½¿ç”¨<br>select sum(grade),name from student group by grade having sum(grade) &gt;100;<br>&#x2F;&#x2F;ä½¿ç”¨limité™åˆ¶æŸ¥è¯¢ç»“æœçš„æ•°é‡<br>select * from student limit 5;<br>select * from student limit 2,2;<br>select * from student order by grade desc limit 2,2;<br>&#x2F;&#x2F;å‡½æ•°,mysqlæä¾›äº†è®¸å¤šå‡½æ•°<br>select concat(id,&#39;:&#39;,name,&#39;:&#39;,grade) from student;<br>&#x2F;&#x2F;ä¸ºè¡¨å–åˆ«å<br>select * from student as stu where stu.name&#x3D;&quot;howie&quot;;<br>&#x2F;&#x2F;ä¸ºå­—æ®µå–åˆ«å,aså…³é”®å­—ä¹Ÿå¯ä»¥ä¸å†™<br>select name as stu_name,grade stu_grade from student;<br></code></pre></td></tr></table></figure><h3 id="2-2-å¤šè¡¨æ“ä½œ"><a href="#2-2-å¤šè¡¨æ“ä½œ" class="headerlink" title="2-2.å¤šè¡¨æ“ä½œ"></a>2-2.å¤šè¡¨æ“ä½œ</h3><p>ä»‹ç»çŸ¥è¯†ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>1.äº†è§£å¤–é”®</li><li>2.äº†è§£å…³è”å…³ç³»</li><li>3.äº†è§£å„ç§è¿æ¥æŸ¥è¯¢å¤šè¡¨çš„æ•°æ®</li><li>4.äº†è§£å­æŸ¥è¯¢ï¼Œä¼šä½¿ç”¨å„ç§å…³é”®å­—ä»¥åŠæ¯”è¾ƒè¿ç®—ç¬¦æŸ¥è¯¢å¤šè¡¨ä¸­çš„æ•°æ®</li></ul><h4 id="2-2-1-å¤–é”®"><a href="#2-2-1-å¤–é”®" class="headerlink" title="2-2-1.å¤–é”®"></a>2-2-1.å¤–é”®</h4><blockquote><p>â€œ</p><p>å¤–é”®æ˜¯æŒ‡å¼•ç”¨å¦ä¸€ä¸ªè¡¨ä¸­çš„ä¸€åˆ—æˆ–è€…å¤šåˆ—ï¼Œè¢«å¼•ç”¨çš„åˆ—åº”è¯¥å…·æœ‰ä¸»é”®çº¦æŸæˆ–è€…å”¯ä¸€æ€§çº¦æŸï¼Œç”¨äºå»ºç«‹å’ŒåŠ å¼ºä¸¤ä¸ªæ•°æ®è¡¨ä¹‹é—´çš„è¿æ¥ã€‚</p><p>â€</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&#x2F;&#x2F;åˆ›å»ºè¡¨class,student<br>create table class(<br>   id int not null primary key,<br>   classname varchar(20) not null<br>)ENGINE&#x3D;InnoDB;<br>create table student(<br>   stu_id int not null primary key,<br>   stu_name varchar(20) not null,<br>   cid int not null      -- è¡¨ç¤ºç­çº§idï¼Œå®ƒå°±æ˜¯classè¡¨çš„å¤–é”®<br>)ENGINE&#x3D;InnoDB;<br>&#x2F;&#x2F;æ·»åŠ å¤–é”®çº¦æŸ<br>alter table student add constraint FK_ID foreign key(cid) references class(id);<br>&#x2F;&#x2F;åˆ é™¤å¤–é”®çº¦æŸ<br>alter table student drop foreign key FK_ID;<br></code></pre></td></tr></table></figure><h4 id="2-2-2-æ“ä½œå…³è”è¡¨"><a href="#2-2-2-æ“ä½œå…³è”è¡¨" class="headerlink" title="2-2-2.æ“ä½œå…³è”è¡¨"></a>2-2-2.æ“ä½œå…³è”è¡¨</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs Mysql">&#x2F;&#x2F;æ•°æ®è¡¨æœ‰ä¸‰ç§å…³è”å…³ç³»ï¼Œå¤šå¯¹ä¸€ã€å¤šå¯¹å¤šã€ä¸€å¯¹ä¸€<br>&#x2F;&#x2F;å­¦ç”Ÿ(student)å’Œç­çº§(class)æ˜¯å¤šå¯¹ä¸€å…³ç³»ï¼Œæ·»åŠ æ•°æ®<br>&#x2F;&#x2F;é¦–é€‰æ·»åŠ å¤–é”®çº¦æŸ<br>alter table student add constraint FK_ID foreign key(cid) references class(id);<br>&#x2F;&#x2F;æ·»åŠ æ•°æ®,è¿™ä¸¤ä¸ªè¡¨ä¾¿æœ‰äº†å…³è”è‹¥æ’å…¥ä¸­æ–‡åœ¨ç»ˆç«¯æ˜¾ç¤ºç©ºç™½ï¼Œå¯è®¾ç½®set names &#39;gbk&#39;;<br>insert into class values(1,&quot;è½¯ä»¶ä¸€ç­&quot;),(2,&quot;è½¯ä»¶äºŒç­&quot;);<br>insert into student values(1,&quot;howie&quot;,1),(2,&quot;howie1&quot;,2),(3,&quot;howie2&quot;,1),(4,&quot;howie3&quot;,2);<br>&#x2F;&#x2F;äº¤å‰è¿æ¥<br>select * from student cross join class;<br>&#x2F;&#x2F;å†…è¿æ¥ï¼Œè¯¥åŠŸèƒ½ä¹Ÿå¯ä»¥ä½¿ç”¨whereè¯­å¥å®ç°<br>select student.stu_name,class.classname from student join class on class.id&#x3D;student.cid;<br>&#x2F;&#x2F;å¤–è¿æ¥<br>&#x2F;&#x2F;é¦–å…ˆåœ¨student,classè¡¨ä¸­æ’å…¥æ•°æ®<br>insert into class values(3,&quot;è½¯ä»¶ä¸‰ç­&quot;);<br>&#x2F;&#x2F;å·¦è¿æ¥ï¼Œå³è¿æ¥<br>select s.stu_id,s.stu_name,c.classname from student s left join class c on c.id&#x3D;s.cid;<br>select s.stu_id,s.stu_name,c.classname from student s right join class c on c.id&#x3D;s.cid;<br>&#x2F;&#x2F;å¤åˆæ¡ä»¶è¿æ¥æŸ¥è¯¢å°±æ˜¯æ·»åŠ è¿‡æ»¤æ¡ä»¶<br>&#x2F;&#x2F;å­æŸ¥è¯¢<br>&#x2F;&#x2F;inå…³é”®å­—å­æŸ¥è¯¢è·Ÿä¸Šé¢çš„inå…³é”®å­—æŸ¥è¯¢ç±»ä¼¼<br>select * from student where cid in(select id from class where id&#x3D;2);<br>&#x2F;&#x2F;existså…³é”®å­—æŸ¥è¯¢,ç›¸å½“äºæµ‹è¯•ï¼Œä¸äº§ç”Ÿæ•°æ®ï¼Œåªè¿”å›trueæˆ–è€…falseï¼Œåªæœ‰è¿”å›trueï¼Œå¤–å±‚æ‰ä¼šæ‰§è¡Œï¼Œå…·ä½“çœ‹ä¸‹å›¾<br>select * from student where exists(select id from class where id&#x3D;12);   -- å¤–å±‚ä¸ä¼šæ‰§è¡Œ<br>select * from student where exists(select id from class where id&#x3D;1);    -- å¤–å±‚ä¼šæ‰§è¡Œ<br>&#x2F;&#x2F;anyå…³é”®å­—æŸ¥è¯¢<br> select * from student where cid&gt;any(select id from class);<br>&#x2F;&#x2F;allå…³é”®å­—æŸ¥è¯¢<br> select * from student where cid&#x3D;any(select id from class);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mybatisé‡åˆ°çš„é—®é¢˜</title>
    <link href="/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <url>/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="ã€ideaé—®é¢˜-ä¾èµ–åŒ…è‡ªåŠ¨ä¸‹è½½ã€‘"><a href="#ã€ideaé—®é¢˜-ä¾èµ–åŒ…è‡ªåŠ¨ä¸‹è½½ã€‘" class="headerlink" title="ã€ideaé—®é¢˜-ä¾èµ–åŒ…è‡ªåŠ¨ä¸‹è½½ã€‘"></a>ã€ideaé—®é¢˜-ä¾èµ–åŒ…è‡ªåŠ¨ä¸‹è½½ã€‘</h2><p>åœ¨å¯¼å…¥ä¾èµ–æ—¶ç³»ç»Ÿä¸ä¼šè‡ªåŠ¨ä¸‹è½½ä¾èµ–åŒ…ï¼Œéœ€è¦æ›´æ”¹è®¾ç½®å‹¾é€‰ä¸‹é¢é€‰é¡¹</p><p><img src="/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201216225711521.png" alt="image-20201216225711521"></p><h2 id="ã€ideaé—®é¢˜-æ•°æ®åº“è¿æ¥å¤±è´¥ã€‘"><a href="#ã€ideaé—®é¢˜-æ•°æ®åº“è¿æ¥å¤±è´¥ã€‘" class="headerlink" title="ã€ideaé—®é¢˜-æ•°æ®åº“è¿æ¥å¤±è´¥ã€‘"></a>ã€ideaé—®é¢˜-æ•°æ®åº“è¿æ¥å¤±è´¥ã€‘</h2><p>åœ¨Intellij IDEAä¸­é€šè¿‡Databaseè¿æ¥MysqlæŠ¥é”™ï¼šServer returns invalid timezone. Go to â€˜Advancedâ€™ tab and set â€˜serverTimezoneâ€™ property manually.</p><p>åŸå› æ˜¯MySQLé©±åŠ¨ä¸­é»˜è®¤æ—¶åŒºæ˜¯UTCï¼Œä¸æœ¬åœ°æ—¶é—´ï¼ˆä¸­å›½ï¼‰ç›¸å·®å…«ä¸ªå°æ—¶ï¼Œæ‰€ä»¥é“¾æ¥ä¸ä¸Šï¼Œ</p><p><img src="/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201217110030848.png" alt="image-20201217110030848"></p><h2 id="ã€ä»£ç é…ç½®é—®é¢˜-ç±»åè·¯å¾„ä¸å®Œæ•´ã€‘"><a href="#ã€ä»£ç é…ç½®é—®é¢˜-ç±»åè·¯å¾„ä¸å®Œæ•´ã€‘" class="headerlink" title="ã€ä»£ç é…ç½®é—®é¢˜-ç±»åè·¯å¾„ä¸å®Œæ•´ã€‘"></a>ã€ä»£ç é…ç½®é—®é¢˜-ç±»åè·¯å¾„ä¸å®Œæ•´ã€‘</h2><p><img src="/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201224161411671.png" alt="image-20201224161411671"></p><p>ä¿®æ”¹</p><p><img src="/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201224161512007.png" alt="image-20201224161512007"></p><h2 id="ã€ä»£ç é…ç½®é—®é¢˜-mapperèµ„æºæ˜ å°„é”™è¯¯ã€‘"><a href="#ã€ä»£ç é…ç½®é—®é¢˜-mapperèµ„æºæ˜ å°„é”™è¯¯ã€‘" class="headerlink" title="ã€ä»£ç é…ç½®é—®é¢˜-mapperèµ„æºæ˜ å°„é”™è¯¯ã€‘"></a>ã€ä»£ç é…ç½®é—®é¢˜-mapperèµ„æºæ˜ å°„é”™è¯¯ã€‘</h2><p>æ³¨æ„â€œ/â€ä¸â€œ.â€çš„åŒºåˆ«</p><p>æ³¨æ„åç¼€å.xml</p><p><img src="/2020/12/24/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Mybatis%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/image-20201224161706825.png" alt="image-20201224161706825"></p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>é—®é¢˜è®°å½•</tag>
      
      <tag>SSM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Lombokæ³¨è§£æ’ä»¶</title>
    <link href="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/"/>
    <url>/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/</url>
    
    <content type="html"><![CDATA[<blockquote><p>Project Lombok is a <strong>java library</strong> that automatically <strong>plugs</strong> into your editor and <strong>build tools</strong>, spicing up your java.<br>Never write another getter or equals method again, <strong>with one annotation your class</strong> has a fully featured builder, Automate your logging variables, and much more.</p></blockquote><h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a><strong>å®‰è£…æ­¥éª¤</strong></h3><ol><li><p>åœ¨ideaä¸­å®‰è£…Lombokæ’ä»¶</p><ul><li><p>Fileâ€”â€”Settingâ€”â€”Pluginsâ€”â€”æœç´¢LomBok</p></li><li><p>å¦‚æœæœç´¢ä¸åˆ°ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®Browse repositorieså†æ¬¡æœç´¢ï¼Œè¿›è¡Œå®‰è£…</p></li></ul></li><li><p>åœ¨é¡¹ç›®ä¸­å¯¼å…¥LomBokçš„jaråŒ…</p><ul><li>å»æµè§ˆå™¨æœç´¢LomBok mavenè¿›å…¥mavenä»“åº“</li></ul></li></ol><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/image-20201223111041055.png"></p><h3 id="ä½¿ç”¨æ­¥éª¤"><a href="#ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a><strong>ä½¿ç”¨æ­¥éª¤</strong></h3><h4 id="1ã€å¤åˆ¶ä»£ç åˆ°pom-xmlä¸­"><a href="#1ã€å¤åˆ¶ä»£ç åˆ°pom-xmlä¸­" class="headerlink" title="1ã€å¤åˆ¶ä»£ç åˆ°pom.xmlä¸­"></a>1ã€å¤åˆ¶ä»£ç åˆ°pom.xmlä¸­</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.16<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‡ºç°é—®é¢˜ï¼Œå°†1.18.16æ¢æˆ1.18.10æˆåŠŸäº†</p><h4 id="2ã€åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨"><a href="#2ã€åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨" class="headerlink" title="2ã€åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨"></a>2ã€åœ¨å®ä½“ç±»ä¸­ä½¿ç”¨</h4><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/image-20201223114441377.png" alt="image-20201223114441377"></p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/image-20201223114515185.png" alt="image-20201223114515185"></p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/image-20201223114634202.png" alt="image-20201223114634202"></p><h3 id="LomBokå¸¸ç”¨æ³¨è§£"><a href="#LomBokå¸¸ç”¨æ³¨è§£" class="headerlink" title="LomBokå¸¸ç”¨æ³¨è§£"></a>LomBokå¸¸ç”¨æ³¨è§£</h3><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123505093-120706027.png" alt="img"></p><h4 id="1-Getter-Setter"><a href="#1-Getter-Setter" class="headerlink" title="1. @Getter/@Setter"></a>1. @Getter/@Setter</h4><p>è‡ªåŠ¨äº§ç”Ÿ getter/setter</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123608674-881008070.png" alt="img"></p><h4 id="2-ToString"><a href="#2-ToString" class="headerlink" title="2. @ToString"></a>2. @ToString</h4><p>è‡ªåŠ¨é‡å†™ <code>toString()</code> æ–¹æ³•ï¼Œä¼šå°å‡ºæ‰€æœ‰å˜é‡</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123622420-39641215.png" alt="img"></p><h4 id="3-EqualsAndHashCode"><a href="#3-EqualsAndHashCode" class="headerlink" title="3. @EqualsAndHashCode"></a>3. @EqualsAndHashCode</h4><p>è‡ªåŠ¨ç”Ÿæˆ <code>equals(Object other)</code> å’Œ <code>hashcode()</code> æ–¹æ³•ï¼ŒåŒ…æ‹¬æ‰€æœ‰éé™æ€å˜é‡å’Œé transient çš„å˜é‡</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123632801-1579489628.png" alt="img"></p><p> å¦‚æœæŸäº›å˜é‡ä¸æƒ³è¦åŠ è¿›åˆ¤æ–­ï¼Œå¯ä»¥é€è¿‡ exclude æ’é™¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ of æŒ‡å®šæŸäº›å­—æ®µ</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123644697-422140515.png" alt="img"></p><p>Q : ä¸ºä»€ä¹ˆåªæœ‰ä¸€ä¸ªæ•´ä½“çš„ <code>@EqualsAndHashCode</code> æ³¨è§£ï¼Œè€Œä¸æ˜¯åˆ†å¼€çš„ä¸¤ä¸ª <code>@Equals</code> å’Œ <code>@HashCode</code>ï¼Ÿ</p><p>A : åœ¨ Java ä¸­æœ‰è§„å®šï¼Œå½“ä¸¤ä¸ªå¯¹è±¡ equals æ—¶ï¼Œä»–ä»¬çš„ hashcode ä¸€å®šè¦ç›¸åŒï¼Œåä¹‹ï¼Œå½“ hashcode ç›¸åŒæ—¶ï¼Œå¯¹è±¡ä¸ä¸€å®š equalsã€‚æ‰€ä»¥ equals å’Œ hashcode è¦ä¸€èµ·å®ç°ï¼Œå…å¾—å‘ç”Ÿè¿å Java è§„å®šçš„æƒ…å½¢å‘ç”Ÿ</p><h4 id><a href="#" class="headerlink" title></a></h4><h4 id="4-NoArgsConstructor-AllArgsConstructor-RequiredArgsConstructor"><a href="#4-NoArgsConstructor-AllArgsConstructor-RequiredArgsConstructor" class="headerlink" title="4. @NoArgsConstructor, @AllArgsConstructor, @RequiredArgsConstructor"></a>4. @NoArgsConstructor, @AllArgsConstructor, @RequiredArgsConstructor</h4><p>æ— å‚æ„é€ ã€æœ‰å‚æ„é€ </p><p>è¿™ä¸‰ä¸ªå¾ˆåƒï¼Œéƒ½æ˜¯åœ¨è‡ªåŠ¨ç”Ÿæˆè¯¥ç±»çš„æ„é€ å™¨ï¼Œå·®åˆ«åªåœ¨ç”Ÿæˆçš„æ„é€ å™¨çš„å‚æ•°ä¸ä¸€æ ·è€Œå·²</p><p><strong>@NoArgsConstructor</strong> : ç”Ÿæˆä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„æ„é€ å™¨</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123705271-239133946.png" alt="img"></p><p> <strong>@AllArgsConstructor</strong> : ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å‚æ•°çš„æ„é€ å™¨</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123713466-1515539870.png" alt="img"></p><p>è¿™é‡Œæ³¨æ„ä¸€ä¸ª Java çš„å°å‘ï¼Œå½“æˆ‘ä»¬æ²¡æœ‰æŒ‡å®šæ„é€ å™¨æ—¶ï¼ŒJava ç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ²¡æœ‰ä»»ä½•å‚æ•°çš„æ„é€ å™¨ç»™è¯¥ç±»ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬è‡ªå·±å†™äº†æ„é€ å™¨ä¹‹åï¼ŒJava å°±ä¸ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¡¥ä¸Šé‚£ä¸ªæ— å‚æ•°çš„æ„é€ å™¨äº†</p><p>ç„¶è€Œå¾ˆå¤šåœ°æ–¹ï¼ˆåƒæ˜¯ Spring Data JPAï¼‰ï¼Œä¼šéœ€è¦æ¯ä¸ªç±»éƒ½ä¸€å®šè¦æœ‰ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ å™¨ï¼Œæ‰€ä»¥ä½ åœ¨åŠ ä¸Š <code>@AllArgsConstructor</code> æ—¶ï¼Œä¸€å®šè¦è¡¥ä¸Š <code>@NoArgsConstrcutor</code>ï¼Œä¸ç„¶ä¼šæœ‰å„ç§å‘ç­‰ç€ä½ </p><p><strong>@RequiredArgsConstructor</strong> : ç”Ÿæˆä¸€ä¸ªåŒ…å« â€œç‰¹å®šå‚æ•°â€ çš„æ„é€ å™¨ï¼Œç‰¹å®šå‚æ•°æŒ‡çš„æ˜¯é‚£äº›æœ‰åŠ ä¸Š final ä¿®é¥°è¯çš„å˜é‡ä»¬</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123802184-301313014.png" alt="img"></p><p>è¡¥å……ä¸€ä¸‹ï¼Œå¦‚æœæ‰€æœ‰çš„å˜é‡éƒ½æ˜¯æ­£å¸¸çš„ï¼Œéƒ½æ²¡æœ‰ç”¨ final ä¿®é¥°çš„è¯ï¼Œé‚£å°±ä¼šç”Ÿæˆä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„æ„é€ å™¨</p><h4 id="-1"><a href="#-1" class="headerlink" title></a></h4><h4 id="5-Data"><a href="#5-Data" class="headerlink" title="5. @Data"></a>5. @Data</h4><p>æ•´åˆåŒ…ï¼Œåªè¦åŠ äº† @Data è¿™ä¸ªæ³¨è§£ï¼Œç­‰äºåŒæ—¶åŠ äº†ä»¥ä¸‹æ³¨è§£</p><ul><li>@Getter/@Setter</li><li>@ToString</li><li>@EqualsAndHashCode</li><li>@RequiredArgsConstructor</li></ul><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123821803-1801908929.png" alt="img"></p><p>@Data æ˜¯ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ lombok æ³¨è§£ï¼Œé€šå¸¸ @Data ä¼šåŠ åœ¨ä¸€ä¸ªå€¼å¯ä»¥è¢«æ›´æ–°çš„å¯¹è±¡ä¸Šï¼Œåƒæ˜¯æ—¥å¸¸ä½¿ç”¨çš„ DTO ä»¬ã€æˆ–æ˜¯ JPA è£¡çš„ Entity ä»¬ï¼Œå°±å¾ˆé€‚åˆåŠ ä¸Š @Data æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯ @Data for mutable class</p><h4 id="-2"><a href="#-2" class="headerlink" title></a></h4><h4 id="6-Value"><a href="#6-Value" class="headerlink" title="6. @Value"></a>6. @Value</h4><p>ä¹Ÿæ˜¯æ•´åˆåŒ…ï¼Œä½†æ˜¯ä»–ä¼šæŠŠæ‰€æœ‰çš„å˜é‡éƒ½è®¾æˆ final çš„ï¼Œå…¶ä»–çš„å°±è·Ÿ @Data ä¸€æ ·ï¼Œç­‰äºåŒæ—¶åŠ äº†ä»¥ä¸‹æ³¨è§£</p><ul><li>@Getter (æ³¨æ„æ²¡æœ‰setter)</li><li>@ToString</li><li>@EqualsAndHashCode</li><li>@RequiredArgsConstructor</li></ul><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123848772-196755613.png" alt="img"></p><p>ä¸Šé¢é‚£ä¸ª @Data é€‚åˆç”¨åœ¨ POJO æˆ– DTO ä¸Šï¼Œè€Œè¿™ä¸ª @Value æ³¨è§£ï¼Œåˆ™æ˜¯é€‚åˆåŠ åœ¨å€¼ä¸å¸Œæœ›è¢«æ”¹å˜çš„ç±»ä¸Šï¼Œåƒæ˜¯æŸä¸ªç±»çš„å€¼å½“åˆ›å»ºåå°±ä¸å¸Œæœ›è¢«æ›´æ”¹ï¼Œåªå¸Œæœ›æˆ‘ä»¬è¯»å®ƒè€Œå·²ï¼Œå°±é€‚åˆåŠ ä¸Š @Value æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯ @Value for immutable class</p><p>å¦å¤–æ³¨æ„ä¸€ä¸‹ï¼Œæ­¤ lombok çš„æ³¨è§£ @Value å’Œå¦ä¸€ä¸ª Spring çš„æ³¨è§£ @Value æ’åï¼Œåœ¨ import æ—¶ä¸è¦ import é”™äº†</p><h4 id="-3"><a href="#-3" class="headerlink" title></a></h4><h4 id="7-Builder"><a href="#7-Builder" class="headerlink" title="7. @Builder"></a>7. @Builder</h4><p>è‡ªåŠ¨ç”Ÿæˆæµå¼ set å€¼å†™æ³•ï¼Œä»æ­¤ä¹‹åå†ä¹Ÿä¸ç”¨å†™ä¸€å † setter äº†</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309123907759-554181302.png" alt="img"></p><p>æ³¨æ„ï¼Œè™½ç„¶åªè¦åŠ ä¸Š @Builder æ³¨è§£ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿç”¨æµå¼å†™æ³•å¿«é€Ÿè®¾å®šå¯¹è±¡çš„å€¼ï¼Œä½†æ˜¯ setter è¿˜æ˜¯å¿…é¡»è¦å†™ä¸èƒ½çœç•¥çš„ï¼Œå› ä¸º Spring æˆ–æ˜¯å…¶ä»–æ¡†æ¶æœ‰å¾ˆå¤šåœ°æ–¹éƒ½ä¼šç”¨åˆ°å¯¹è±¡çš„ getter/setter å¯¹ä»–ä»¬å–å€¼/èµ‹å€¼</p><p>æ‰€ä»¥é€šå¸¸æ˜¯ @Data å’Œ @Builder ä¼šä¸€èµ·ç”¨åœ¨åŒä¸ªç±»ä¸Šï¼Œæ—¢æ–¹ä¾¿æˆ‘ä»¬æµå¼å†™ä»£ç ï¼Œä¹Ÿæ–¹ä¾¿æ¡†æ¶åšäº‹</p><h4 id="-4"><a href="#-4" class="headerlink" title></a></h4><h4 id="8-Slf4j"><a href="#8-Slf4j" class="headerlink" title="8. @Slf4j"></a>8. @Slf4j</h4><p>è‡ªåŠ¨ç”Ÿæˆè¯¥ç±»çš„ log é™æ€å¸¸é‡ï¼Œè¦æ‰“æ—¥å¿—å°±å¯ä»¥ç›´æ¥æ‰“ï¼Œä¸ç”¨å†æ‰‹åŠ¨ new log é™æ€å¸¸é‡äº†</p><p><img src="/2020/12/23/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/Lombok/1003856-20200309124029891-1112211509.png" alt="img"></p><p> é™¤äº† @Slf4j ä¹‹å¤–ï¼Œlombok ä¹Ÿæä¾›å…¶ä»–æ—¥å¿—æ¡†æ¶çš„å˜ç§æ³¨è§£å¯ä»¥ç”¨ï¼Œåƒæ˜¯ @Logã€@Log4jâ€¦ç­‰ï¼Œä»–ä»¬éƒ½æ˜¯å¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé™æ€å¸¸é‡ logï¼Œåªæ˜¯ä½¿ç”¨çš„åº“ä¸ä¸€æ ·è€Œå·²</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">@Log <span class="hljs-comment">//å¯¹åº”çš„logè¯­å¥å¦‚ä¸‹</span><br><span class="hljs-keyword">private</span> static final java.util.logging.Logger log = java.util.logging.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Logger</span>.</span></span>get<span class="hljs-constructor">Logger(LogExample.<span class="hljs-params">class</span>.<span class="hljs-params">getName</span>()</span>);<br><br>@Log4j <span class="hljs-comment">//å¯¹åº”çš„logè¯­å¥å¦‚ä¸‹</span><br><span class="hljs-keyword">private</span> static final org.apache.log4j.Logger log = org.apache.log4j.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Logger</span>.</span></span>get<span class="hljs-constructor">Logger(LogExample.<span class="hljs-params">class</span>)</span>;<br></code></pre></td></tr></table></figure><p>SpringBooté»˜è®¤æ”¯æŒçš„å°±æ˜¯ slf4j + logback çš„æ—¥å¿—æ¡†æ¶ï¼Œæ‰€ä»¥ä¹Ÿä¸ç”¨å†å¤šåšå•¥è®¾å®šï¼Œç›´æ¥å°±å¯ä»¥ç”¨åœ¨ SpringBoot projectä¸Šï¼Œlog ç³»åˆ—æ³¨è§£æœ€å¸¸ç”¨çš„å°±æ˜¯ @Slf4j</p>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åç«¯æ’ä»¶</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mybatiså­¦ä¹ ç¬”è®°</title>
    <link href="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/"/>
    <url>/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/</url>
    
    <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/mp/homepage?__biz=Mzg2NTAzMTExNg==&hid=3&sn=456dc4d66f0726730757e319ffdaa23e&scene=1&devicetype=android-28&version=27001135&lang=zh_CN&nettype=cmnet&ascene=7&session_us=gh_1dd456f1d44d&wx_header=1">Mybatisæ–‡ç« ç¬”è®°æ•´åˆã€ç‹‚ç¥è¯´ã€‘</a></p><p><a href="http://www.mybatis.org/mybatis-3/zh/index.html">Mybatiså®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://github.com/mybatis/mybatis-3">GitHub</a></p><p>[toc]</p><h1 id="ä¸€ã€æ­å»ºMybatisé¡¹ç›®"><a href="#ä¸€ã€æ­å»ºMybatisé¡¹ç›®" class="headerlink" title="ä¸€ã€æ­å»ºMybatisé¡¹ç›®"></a>ä¸€ã€æ­å»ºMybatisé¡¹ç›®</h1><p><strong>æ€è·¯æµç¨‹ï¼šæ­å»ºç¯å¢ƒâ€“&gt;å¯¼å…¥Mybatisâ€”&gt;ç¼–å†™ä»£ç â€”&gt;æµ‹è¯•</strong></p><h2 id="1-1-æ­å»ºç¯å¢ƒ"><a href="#1-1-æ­å»ºç¯å¢ƒ" class="headerlink" title="1.1 æ­å»ºç¯å¢ƒ"></a>1.1 æ­å»ºç¯å¢ƒ</h2><h3 id="æ­å»ºå®éªŒæ•°æ®åº“"><a href="#æ­å»ºå®éªŒæ•°æ®åº“" class="headerlink" title="æ­å»ºå®éªŒæ•°æ®åº“"></a>æ­å»ºå®éªŒæ•°æ®åº“</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> <span class="hljs-string">`mybatis`</span>;<br><br><span class="hljs-keyword">USE</span> <span class="hljs-string">`mybatis`</span>;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`user`</span>;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`user`</span> (<br><span class="hljs-string">`id`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<br><span class="hljs-string">`name`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<br><span class="hljs-string">`pwd`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<br>PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`id`</span>)<br>) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8;<br><br><span class="hljs-keyword">insert</span>  <span class="hljs-keyword">into</span> <span class="hljs-string">`user`</span>(<span class="hljs-string">`id`</span>,<span class="hljs-string">`name`</span>,<span class="hljs-string">`pwd`</span>) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;ç‹‚ç¥&#x27;</span>,<span class="hljs-string">&#x27;123456&#x27;</span>),(<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;å¼ ä¸‰&#x27;</span>,<span class="hljs-string">&#x27;abcdef&#x27;</span>),(<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;æå››&#x27;</span>,<span class="hljs-string">&#x27;987654&#x27;</span>);<br></code></pre></td></tr></table></figure><p><strong>ideaåˆ›å»ºé¡¹ç›®</strong></p><p>New Project â€”â€”Maven</p><p>åˆ é™¤srcç›®å½•ï¼ˆè¿™æ ·å°±å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªçˆ¶å·¥ç¨‹ï¼‰</p><h3 id="å¯¼å…¥ä¾èµ–ï¼ˆGitHubä¸Šæ‰¾ï¼‰"><a href="#å¯¼å…¥ä¾èµ–ï¼ˆGitHubä¸Šæ‰¾ï¼‰" class="headerlink" title="å¯¼å…¥ä¾èµ–ï¼ˆGitHubä¸Šæ‰¾ï¼‰"></a>å¯¼å…¥ä¾èµ–ï¼ˆGitHubä¸Šæ‰¾ï¼‰</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><span class="hljs-comment">&lt;!--çˆ¶å·¥ç¨‹--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatisstudy<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modules</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>mybatis-01<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--å¯¼å…¥ä¾èµ–--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.1.47<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure><h2 id="1-2-åˆ›å»ºä¸€ä¸ªæ¨¡å—"><a href="#1-2-åˆ›å»ºä¸€ä¸ªæ¨¡å—" class="headerlink" title="1.2 åˆ›å»ºä¸€ä¸ªæ¨¡å—"></a>1.2 åˆ›å»ºä¸€ä¸ªæ¨¡å—</h2><p>1ã€å³å‡»çˆ¶é¡¹ç›®ï¼šNewâ€”â€”Module</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201217103513549.png" alt="image-20201217103513549"></p><h3 id="ç¼–å†™MyBatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰"><a href="#ç¼–å†™MyBatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰" class="headerlink" title="ç¼–å†™MyBatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰"></a>ç¼–å†™MyBatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--configurationæ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;admin&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--    æ¯ä¸€ä¸ªMapper.xmléƒ½è¦åœ¨Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ--&gt;</span><br>    <span class="hljs-comment">&lt;!--    resourceã€classã€urlä¸‰ç§æ–¹å¼éƒ½å¯ä»¥--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/mc/dao/userMapper.xml&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201217104400478.png" alt="image-20201217104400478"></p><p>è¿æ¥mysqlæ•°æ®åº“</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201217105018724.png" alt="image-20201217105018724"></p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201217105251983.png" alt="image-20201217105251983"></p><p>lè¿æ¥æˆåŠŸåå¯»æ‰¾å·²ç»å»ºç«‹çš„æ•°æ®åº“</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201217110328828.png" alt="image-20201217110328828"></p><h3 id="ç¼–å†™MyBatiså·¥å…·ç±»ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰"><a href="#ç¼–å†™MyBatiså·¥å…·ç±»ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰" class="headerlink" title="ç¼–å†™MyBatiså·¥å…·ç±»ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰"></a>ç¼–å†™MyBatiså·¥å…·ç±»ï¼ˆæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.ibatis.io.Resources;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-comment">//ç¼–å†™æ­¤å·¥å…·ç±»ç”¨äºè·å–sqlSessionFactoryå¯¹è±¡</span><br><span class="hljs-comment">//sqlSessionFactoryå·¥å‚ç”¨äºç”Ÿäº§sqlSession</span><br><span class="hljs-comment">//sqlSessiomåŒ…å«äº†é¢å‘æ•°æ®åº“çš„æ‰€æœ‰æ–¹æ³•</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisUtils</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SqlSessionFactory sqlSessionFactory;<br><span class="hljs-comment">//    ç”¨é™æ€ä»£ç å—ä½¿å…¶ä¸€åˆå§‹å°±åŠ è½½</span><br>    <span class="hljs-keyword">static</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br><span class="hljs-comment">//            1ã€è·å–èµ„æº</span><br>            String resource = <span class="hljs-string">&quot;mybatis-config.xml&quot;</span>;<br><span class="hljs-comment">//            2ã€ç”¨resourceåŠ è½½è¿›æ¥</span><br>            InputStream inputStream = Resources.getResourceAsStream(resource);<br><span class="hljs-comment">//            3ã€ç”¨buliderå°†resourceåŠ è½½è¿›æ¥</span><br>            sqlSessionFactory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–SqlSessionè¿æ¥</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSession</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> sqlSessionFactory.openSession();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201217113302827.png" alt="image-20201217113302827"></p><h2 id="1-3-ç¼–å†™ä»£ç "><a href="#1-3-ç¼–å†™ä»£ç " class="headerlink" title="1.3 ç¼–å†™ä»£ç "></a>1.3 ç¼–å†™ä»£ç </h2><ul><li><p>å®ä½“ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String pwd;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id, String name, String pwd)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.id = id;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.pwd = pwd;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> id;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.id = id;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPwd</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> pwd;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPwd</span><span class="hljs-params">(String pwd)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.pwd = pwd;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;id=&quot;</span> + id +<br>                <span class="hljs-string">&quot;, name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, pwd=&#x27;&quot;</span> + pwd + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Dao/Mapperæ¥å£ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserDao</span> </span>&#123;<br>    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserList</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br></code></pre></td></tr></table></figure></li><li><p>ç¼–å†™Dao/Mapperé…ç½®æ–‡ä»¶</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--å‘½åç©ºé—´ä¸èƒ½é”™ å¯¹åº”ä¸Šé¢æ¥å£UserDao--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.mc.dao.UserDao&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--    è®¾ç½®æŸ¥è¯¢è¯­å¥--&gt;</span><br><span class="hljs-comment">&lt;!--    è®¾ç½®è¿”å›ç±»å‹type--&gt;</span><br><span class="hljs-comment">&lt;!--    idå¯¹åº”namespace UserDaoä¸­çš„æ¥å£æ–¹æ³•å--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserList&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.mc.pojo.User&quot;</span>&gt;</span><br>  select * from user<br> <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h2 id="1-4-æµ‹è¯•ä»£ç "><a href="#1-4-æµ‹è¯•ä»£ç " class="headerlink" title="1.4  æµ‹è¯•ä»£ç "></a>1.4  æµ‹è¯•ä»£ç </h2><ul><li><p>ç¼–å†™junitæµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.dao;<br><br><span class="hljs-keyword">import</span> com.mc.pojo.User;<br><span class="hljs-keyword">import</span> com.mc.utils.MybatisUtils;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoTest</span> </span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-comment">//è·å–sqlå¯¹è±¡</span><br>        SqlSession sqlSession = MybatisUtils.getSession();<br>         UserDao userDao = sqlSession.getMapper(UserDao.class);<br>         List&lt;User&gt; userList = userDao.getUserList();<br><br>         <span class="hljs-keyword">for</span>(User user:userList)&#123;<br>             System.out.println(user);<br>         &#125;<br>         <br>         <span class="hljs-comment">//å…³é—­sqlsession</span><br>         sqlSession.close();<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201222104857720.png" alt="image-20201222104857720"></p></li></ul><h2 id="1-5-æ€»ç»“"><a href="#1-5-æ€»ç»“" class="headerlink" title="1.5 æ€»ç»“"></a>1.5 æ€»ç»“</h2><ol><li><p>åˆ›å»ºæ•°æ®åº“</p></li><li><p>pom.xmlä¸­å¯¼å…¥MyBatisç›¸å…³jaråŒ…ï¼ˆorg.mybatisã€mysqlã€junitï¼‰ï¼ˆæ³¨æ„é…ç½®buildä¸­çš„resourceï¼‰</p></li><li><p>resources/mybatis-config.xmlä¸­ç¼–å†™mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶</p><ul><li><p>æ³¨æ„æ•°æ®åº“url</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>æ³¨æ„mapperæ³¨è§£ï¼ˆè¿æ¥ç¬¬7æ­¥ï¼Œæ³¨æ„æ˜¯/ä¸æ˜¯.ï¼‰</p></li></ul></li><li><p>åœ¨java/â€¦/utils/MyBatisUtilsç¼–å†™mybatiså·¥å…·ç±»ï¼ˆä¸‰æ­¥å›ºå®šæµç¨‹ï¼‰</p></li><li><p>åœ¨java/â€¦/pojo/Userä¸­åˆ›å»ºå®ä½“ç±»</p></li><li><p>åœ¨java/â€¦/dao/UserDaoç¼–å†™Dao/Mapperæ¥å£ç±»</p></li><li><p>åœ¨java/â€¦/dao/UserMapper.xmlä¸­ç¼–å†™é…ç½®æ–‡ä»¶ï¼ˆæ³¨æ„namespaceã€idè¿æ¥ç¬¬6æ­¥åŒ…åè¦ä¸€è‡´ï¼‰</p></li><li><p>ç¼–å†™æµ‹è¯•ç±»</p></li></ol><h1 id="äºŒã€CURDå¢åˆ æ”¹æŸ¥"><a href="#äºŒã€CURDå¢åˆ æ”¹æŸ¥" class="headerlink" title="äºŒã€CURDå¢åˆ æ”¹æŸ¥"></a>äºŒã€CURDå¢åˆ æ”¹æŸ¥</h1><p>UserMapper.xmlé…ç½®æ–‡ä»¶è¯¦è§£</p><h2 id="namespace"><a href="#namespace" class="headerlink" title="namespace"></a>namespace</h2><p>é…ç½®æ–‡ä»¶ä¸­namespaceä¸­çš„åç§°ä¸ºå¯¹åº”Mapperæ¥å£æˆ–è€…Daoæ¥å£çš„å®Œæ•´åŒ…å,å¿…é¡»ä¸€è‡´ï¼</p><h2 id="2-1-select"><a href="#2-1-select" class="headerlink" title="2.1 select"></a>2.1 select</h2><ul><li><p>selectæ ‡ç­¾æ˜¯mybatisä¸­æœ€å¸¸ç”¨çš„æ ‡ç­¾ä¹‹ä¸€</p></li><li><p>selectè¯­å¥æœ‰å¾ˆå¤šå±æ€§å¯ä»¥è¯¦ç»†é…ç½®æ¯ä¸€æ¡SQLè¯­å¥</p></li><li><ul><li>SQLè¯­å¥è¿”å›å€¼ç±»å‹ã€‚ã€å®Œæ•´çš„ç±»åæˆ–è€…åˆ«åã€‘</li><li>ä¼ å…¥SQLè¯­å¥çš„å‚æ•°ç±»å‹ ã€‚ã€ä¸‡èƒ½çš„Mapï¼Œå¯ä»¥å¤šå°è¯•ä½¿ç”¨ã€‘</li><li>å‘½åç©ºé—´ä¸­å”¯ä¸€çš„æ ‡è¯†ç¬¦</li><li>æ¥å£ä¸­çš„æ–¹æ³•åä¸æ˜ å°„æ–‡ä»¶ä¸­çš„SQLè¯­å¥ID ä¸€ä¸€å¯¹åº”</li><li>id</li><li>parameterType</li><li>resultType</li></ul></li></ul><p><strong>éœ€æ±‚ï¼šæ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</strong></p><p>1ã€åœ¨UserMapperä¸­æ·»åŠ å¯¹åº”æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> </span>&#123;<br>   <span class="hljs-comment">//æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·</span><br>   <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">selectUser</span><span class="hljs-params">()</span></span>;<br>   <span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br>   <span class="hljs-function">User <span class="hljs-title">selectUserById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨UserMapper.xmlä¸­æ·»åŠ Selectè¯­å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span><br>select * from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ç±»ä¸­æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tsetSelectUserById</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();  <span class="hljs-comment">//è·å–SqlSessionè¿æ¥</span><br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   User user = mapper.selectUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br>   session.close();<br></code></pre></td></tr></table></figure><h2 id="2-2-insert"><a href="#2-2-insert" class="headerlink" title="2.2 insert"></a>2.2 insert</h2><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨insertæ ‡ç­¾è¿›è¡Œæ’å…¥æ“ä½œï¼Œå®ƒçš„é…ç½®å’Œselectæ ‡ç­¾å·®ä¸å¤šï¼</p><p><strong>éœ€æ±‚ï¼šç»™æ•°æ®åº“å¢åŠ ä¸€ä¸ªç”¨æˆ·</strong></p><p>1ã€åœ¨UserMapperæ¥å£ä¸­æ·»åŠ å¯¹åº”çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ·»åŠ ä¸€ä¸ªç”¨æˆ·</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(User user)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨UserMapper.xmlä¸­æ·»åŠ insertè¯­å¥ï¼ˆ#{}ä¸­çš„å‚æ•°éœ€è¦ä¸å®ä¾‹ä¸­çš„å‚æ•°ä¸€ä¸€å¯¹åº”ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span><br>    insert into user (id,name,pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;)<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testAddUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   User user = <span class="hljs-keyword">new</span> User(<span class="hljs-number">5</span>,<span class="hljs-string">&quot;ç‹äº”&quot;</span>,<span class="hljs-string">&quot;zxcvbn&quot;</span>);<br>   <span class="hljs-keyword">int</span> i = mapper.addUser(user);<br>   System.out.println(i);<br>   session.commit(); <span class="hljs-comment">//æäº¤äº‹åŠ¡,é‡ç‚¹!ä¸å†™çš„è¯ä¸ä¼šæäº¤åˆ°æ•°æ®åº“</span><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ç‚¹ï¼šå¢ã€åˆ ã€æ”¹æ“ä½œéœ€è¦æäº¤äº‹åŠ¡ï¼</strong></p><h2 id="2-3-update"><a href="#2-3-update" class="headerlink" title="2.3 update"></a>2.3 update</h2><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨updateæ ‡ç­¾è¿›è¡Œæ›´æ–°æ“ä½œï¼Œå®ƒçš„é…ç½®å’Œselectæ ‡ç­¾å·®ä¸å¤šï¼</p><p><strong>éœ€æ±‚ï¼šä¿®æ”¹ç”¨æˆ·çš„ä¿¡æ¯</strong></p><p>1ã€åŒç†ï¼Œç¼–å†™æ¥å£æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¿®æ”¹ä¸€ä¸ªç”¨æˆ·</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(User user)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™å¯¹åº”çš„é…ç½®æ–‡ä»¶SQL</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span><br>  update user set name=#&#123;name&#125;,pwd=#&#123;pwd&#125; where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdateUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   User user = mapper.selectUserById(<span class="hljs-number">1</span>);<br>   user.setPwd(<span class="hljs-string">&quot;asdfgh&quot;</span>);<br>   <span class="hljs-keyword">int</span> i = mapper.updateUser(user);<br>   System.out.println(i);<br>   session.commit(); <span class="hljs-comment">//æäº¤äº‹åŠ¡,é‡ç‚¹!ä¸å†™çš„è¯ä¸ä¼šæäº¤åˆ°æ•°æ®åº“</span><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-4-delete"><a href="#2-4-delete" class="headerlink" title="2.4 delete"></a>2.4 delete</h2><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨deleteæ ‡ç­¾è¿›è¡Œåˆ é™¤æ“ä½œï¼Œå®ƒçš„é…ç½®å’Œselectæ ‡ç­¾å·®ä¸å¤šï¼</p><p><strong>éœ€æ±‚ï¼šæ ¹æ®idåˆ é™¤ä¸€ä¸ªç”¨æˆ·</strong></p><p>1ã€åŒç†ï¼Œç¼–å†™æ¥å£æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®idåˆ é™¤ç”¨æˆ·</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™å¯¹åº”çš„é…ç½®æ–‡ä»¶SQL</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span>&gt;</span><br>  delete from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeleteUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   <span class="hljs-keyword">int</span> i = mapper.deleteUser(<span class="hljs-number">5</span>);<br>   System.out.println(i);<br>   session.commit(); <span class="hljs-comment">//æäº¤äº‹åŠ¡,é‡ç‚¹!ä¸å†™çš„è¯ä¸ä¼šæäº¤åˆ°æ•°æ®åº“</span><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å¦ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨map"><a href="#å¦ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨map" class="headerlink" title="å¦ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨map"></a>å¦ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨map</h2><p>1ã€åœ¨æ¥å£æ–¹æ³•ä¸­ï¼Œå‚æ•°ç›´æ¥ä¼ é€’Mapï¼›</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livescript">User selectUserByNP2(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>,<span class="hljs-built_in">Object</span>&gt; <span class="hljs-keyword">map</span>);<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™sqlè¯­å¥çš„æ—¶å€™ï¼Œéœ€è¦ä¼ é€’å‚æ•°ç±»å‹ï¼Œå‚æ•°ç±»å‹ä¸ºmap</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserByNP2&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span>&gt;</span><br>select * from user where name = #&#123;username&#125; and pwd = #&#123;pwd&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€åœ¨ä½¿ç”¨æ–¹æ³•çš„æ—¶å€™ï¼ŒMapçš„ key ä¸º sqlä¸­å–çš„å€¼å³å¯ï¼Œæ²¡æœ‰é¡ºåºè¦æ±‚ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;();<br>map.put(<span class="hljs-string">&quot;username&quot;</span>,<span class="hljs-string">&quot;å°æ˜&quot;</span>);<br>map.put(<span class="hljs-string">&quot;pwd&quot;</span>,<span class="hljs-string">&quot;123456&quot;</span>);<br>User user = mapper.selectUserByNP2(map);<br></code></pre></td></tr></table></figure><p>æ€»ç»“ï¼šå¦‚æœå‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ç›´æ¥ä½¿ç”¨Mapå®ç°ï¼Œå¦‚æœå‚æ•°æ¯”è¾ƒå°‘ï¼Œç›´æ¥ä¼ é€’å‚æ•°å³å¯</p><h2 id="æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥"><a href="#æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥"></a>æ¨¡ç³ŠæŸ¥è¯¢likeè¯­å¥</h2><p>ç¬¬1ç§ï¼šåœ¨Javaä»£ç ä¸­æ·»åŠ sqlé€šé…ç¬¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">string wildcardname = â€œ%smi%â€;<br>list&lt;name&gt; names = mapper.selectlike(wildcardname);<br><span class="hljs-comment">//List&lt;User&gt; userList = mapper.getUserLike(&quot;%æ%&quot;)</span><br>    <br>&lt;select id=â€selectlikeâ€&gt;<br>select * from foo where bar like #&#123;value&#125;<br>&lt;/select&gt;<br>    <br><br></code></pre></td></tr></table></figure><p>ç¬¬2ç§ï¼šåœ¨sqlè¯­å¥ä¸­æ‹¼æ¥é€šé…ç¬¦ï¼Œä¼šå¼•èµ·sqlæ³¨å…¥</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">string wildcardname = â€œsmiâ€;<br>list&lt;name&gt; names = mapper.selectlike(wildcardname);<br><br>&lt;select id=â€selectlikeâ€&gt;<br>    select * from foo where bar like &quot;%&quot;#&#123;value&#125;&quot;%&quot;<br>&lt;/select&gt;<br></code></pre></td></tr></table></figure><h2 id="2-5-å°ç»“ï¼š"><a href="#2-5-å°ç»“ï¼š" class="headerlink" title="2.5 å°ç»“ï¼š"></a><strong>2.5 å°ç»“ï¼š</strong></h2><ul><li>æ‰€æœ‰çš„å¢åˆ æ”¹æ“ä½œéƒ½éœ€è¦æäº¤äº‹åŠ¡ï¼</li><li>æ¥å£æ‰€æœ‰çš„æ™®é€šå‚æ•°ï¼Œå°½é‡éƒ½å†™ä¸Š@Paramå‚æ•°ï¼Œå°¤å…¶æ˜¯å¤šä¸ªå‚æ•°æ—¶ï¼Œå¿…é¡»å†™ä¸Šï¼</li><li>æœ‰æ—¶å€™æ ¹æ®ä¸šåŠ¡çš„éœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨mapä¼ é€’å‚æ•°ï¼</li><li>ä¸ºäº†è§„èŒƒæ“ä½œï¼Œåœ¨SQLçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°½é‡å°†Parameterå‚æ•°å’ŒresultTypeéƒ½å†™ä¸Šï¼</li></ul><h1 id="ä¸‰ã€é…ç½®è§£æ"><a href="#ä¸‰ã€é…ç½®è§£æ" class="headerlink" title="ä¸‰ã€é…ç½®è§£æ"></a>ä¸‰ã€é…ç½®è§£æ</h1><ul><li>mybatis-config.xml ç³»ç»Ÿæ ¸å¿ƒé…ç½®æ–‡ä»¶</li><li>MyBatis çš„é…ç½®æ–‡ä»¶åŒ…å«äº†ä¼šæ·±æ·±å½±å“ MyBatis è¡Œä¸ºçš„è®¾ç½®å’Œå±æ€§ä¿¡æ¯ã€‚</li><li>èƒ½é…ç½®çš„å†…å®¹å¦‚ä¸‹ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml">configurationï¼ˆé…ç½®ï¼‰<br>propertiesï¼ˆå±æ€§ï¼‰<br>settingsï¼ˆè®¾ç½®ï¼‰<br>typeAliasesï¼ˆç±»å‹åˆ«åï¼‰<br>typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰<br>objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰<br>pluginsï¼ˆæ’ä»¶ï¼‰<br>environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰<br>environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰<br>transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰<br>dataSourceï¼ˆæ•°æ®æºï¼‰<br>databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰<br>mappersï¼ˆæ˜ å°„å™¨ï¼‰<br><span class="hljs-comment">&lt;!-- æ³¨æ„å…ƒç´ èŠ‚ç‚¹çš„é¡ºåºï¼é¡ºåºä¸å¯¹ä¼šæŠ¥é”™ --&gt;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é˜…è¯» mybatis-config.xml ä¸Šé¢çš„dtdçš„å¤´æ–‡ä»¶</p><h2 id="3-1-environmentså…ƒç´ "><a href="#3-1-environmentså…ƒç´ " class="headerlink" title="3.1 environmentså…ƒç´ "></a>3.1 environmentså…ƒç´ </h2><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span></span><br><span class="xml"> <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;...&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;...&quot;</span>/&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;driver&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>/&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;url&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>/&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;username&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>/&gt;</span></span><br><span class="xml">     <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;password&#125;</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>/&gt;</span></span><br><span class="xml">   <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span></span><br><span class="xml"> <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span></span><br></code></pre></td></tr></table></figure><ul><li><p>é…ç½®MyBatisçš„å¤šå¥—è¿è¡Œç¯å¢ƒï¼Œå°†SQLæ˜ å°„åˆ°å¤šä¸ªä¸åŒçš„æ•°æ®åº“ä¸Šï¼Œå¿…é¡»æŒ‡å®šå…¶ä¸­ä¸€ä¸ªä¸ºé»˜è®¤è¿è¡Œç¯å¢ƒï¼ˆé€šè¿‡defaultæŒ‡å®šï¼‰</p></li><li><p>å­å…ƒç´ èŠ‚ç‚¹ï¼š<strong>environment</strong></p></li><li><ul><li><p>dataSource å…ƒç´ ä½¿ç”¨æ ‡å‡†çš„ JDBC æ•°æ®æºæ¥å£æ¥é…ç½® JDBC è¿æ¥å¯¹è±¡çš„èµ„æºã€‚</p></li><li><p>æ•°æ®æºæ˜¯å¿…é¡»é…ç½®çš„ã€‚</p></li><li><p>æœ‰ä¸‰ç§å†…å»ºçš„æ•°æ®æºç±»å‹</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs fsharp"><span class="hljs-class"><span class="hljs-keyword">type</span></span>=<span class="hljs-string">&quot;[UNPOOLED|POOLED|JNDI]&quot;</span>ï¼‰<br></code></pre></td></tr></table></figure></li><li><p>unpooledï¼šè¿™ä¸ªæ•°æ®æºçš„å®ç°åªæ˜¯æ¯æ¬¡è¢«è¯·æ±‚æ—¶æ‰“å¼€å’Œå…³é—­è¿æ¥ã€‚</p></li><li><p><strong>pooled</strong>ï¼šè¿™ç§æ•°æ®æºçš„å®ç°åˆ©ç”¨â€œæ± â€çš„æ¦‚å¿µå°† JDBC è¿æ¥å¯¹è±¡ç»„ç»‡èµ·æ¥ , è¿™æ˜¯ä¸€ç§ä½¿å¾—å¹¶å‘ Web åº”ç”¨å¿«é€Ÿå“åº”è¯·æ±‚çš„æµè¡Œå¤„ç†æ–¹å¼ã€‚</p></li><li><p>jndiï¼šè¿™ä¸ªæ•°æ®æºçš„å®ç°æ˜¯ä¸ºäº†èƒ½åœ¨å¦‚ Spring æˆ–åº”ç”¨æœåŠ¡å™¨è¿™ç±»å®¹å™¨ä¸­ä½¿ç”¨ï¼Œå®¹å™¨å¯ä»¥é›†ä¸­æˆ–åœ¨å¤–éƒ¨é…ç½®æ•°æ®æºï¼Œç„¶åæ”¾ç½®ä¸€ä¸ª JNDI ä¸Šä¸‹æ–‡çš„å¼•ç”¨ã€‚</p></li><li><p>æ•°æ®æºä¹Ÿæœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹çš„å®ç°ï¼Œæ¯”å¦‚dbcpï¼Œc3p0ï¼Œdruidç­‰ç­‰â€¦.</p></li></ul></li></ul><ul><li><p>è¯¦æƒ…ï¼šç‚¹å‡»æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£</p></li><li><p>è¿™ä¸¤ç§äº‹åŠ¡ç®¡ç†å™¨ç±»å‹éƒ½ä¸éœ€è¦è®¾ç½®ä»»ä½•å±æ€§ã€‚</p></li><li><p>å…·ä½“çš„ä¸€å¥—ç¯å¢ƒï¼Œé€šè¿‡è®¾ç½®idè¿›è¡ŒåŒºåˆ«ï¼Œidä¿è¯å”¯ä¸€ï¼</p></li><li><p>å­å…ƒç´ èŠ‚ç‚¹ï¼štransactionManager - [ äº‹åŠ¡ç®¡ç†å™¨ ]</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- è¯­æ³• --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;[ JDBC | MANAGED ]&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure></li><li><p>å­å…ƒç´ èŠ‚ç‚¹ï¼š<strong>æ•°æ®æºï¼ˆdataSourceï¼‰</strong></p></li></ul><h2 id="3-2-mapperså…ƒç´ "><a href="#3-2-mapperså…ƒç´ " class="headerlink" title="3.2 mapperså…ƒç´ "></a>3.2 mapperså…ƒç´ </h2><p><strong>mappers</strong></p><ul><li>æ˜ å°„å™¨ : å®šä¹‰æ˜ å°„SQLè¯­å¥æ–‡ä»¶</li><li>æ—¢ç„¶ MyBatis çš„è¡Œä¸ºå…¶ä»–å…ƒç´ å·²ç»é…ç½®å®Œäº†ï¼Œæˆ‘ä»¬ç°åœ¨å°±è¦å®šä¹‰ SQL æ˜ å°„è¯­å¥äº†ã€‚ä½†æ˜¯é¦–å…ˆæˆ‘ä»¬éœ€è¦å‘Šè¯‰ MyBatis åˆ°å“ªé‡Œå»æ‰¾åˆ°è¿™äº›è¯­å¥ã€‚Java åœ¨è‡ªåŠ¨æŸ¥æ‰¾è¿™æ–¹é¢æ²¡æœ‰æä¾›ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œæ‰€ä»¥æœ€ä½³çš„æ–¹å¼æ˜¯å‘Šè¯‰ MyBatis åˆ°å“ªé‡Œå»æ‰¾æ˜ å°„æ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨ï¼Œ æˆ–å®Œå…¨é™å®šèµ„æºå®šä½ç¬¦ï¼ˆåŒ…æ‹¬ <code>file:///</code> çš„ URLï¼‰ï¼Œæˆ–ç±»åå’ŒåŒ…åç­‰ã€‚æ˜ å°„å™¨æ˜¯MyBatisä¸­æœ€æ ¸å¿ƒçš„ç»„ä»¶ä¹‹ä¸€ï¼Œåœ¨MyBatis 3ä¹‹å‰ï¼Œåªæ”¯æŒxmlæ˜ å°„å™¨ï¼Œå³ï¼šæ‰€æœ‰çš„SQLè¯­å¥éƒ½å¿…é¡»åœ¨xmlæ–‡ä»¶ä¸­é…ç½®ã€‚è€Œä»MyBatis 3å¼€å§‹ï¼Œè¿˜æ”¯æŒæ¥å£æ˜ å°„å™¨ï¼Œè¿™ç§æ˜ å°„å™¨æ–¹å¼å…è®¸ä»¥Javaä»£ç çš„æ–¹å¼æ³¨è§£å®šä¹‰SQLè¯­å¥ï¼Œéå¸¸ç®€æ´ã€‚</li></ul><p><strong>å¼•å…¥èµ„æºæ–¹å¼</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 1ã€ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;org/mybatis/builder/PostMapper.xml&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 2ã€ä½¿ç”¨å®Œå…¨é™å®šèµ„æºå®šä½ç¬¦ï¼ˆURLï¼‰ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;file:///var/mappers/AuthorMapper.xml&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">3ã€ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»å</span><br><span class="hljs-comment">éœ€è¦é…ç½®æ–‡ä»¶åç§°å’Œæ¥å£åç§°ä¸€è‡´ï¼Œå¹¶ä¸”ä½äºåŒä¸€ç›®å½•ä¸‹</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.builder.AuthorMapper&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">4ã€å°†åŒ…å†…çš„æ˜ å°„å™¨æ¥å£å®ç°å…¨éƒ¨æ³¨å†Œä¸ºæ˜ å°„å™¨</span><br><span class="hljs-comment">ä½†æ˜¯éœ€è¦é…ç½®æ–‡ä»¶åç§°å’Œæ¥å£åç§°ä¸€è‡´ï¼Œå¹¶ä¸”ä½äºåŒä¸€ç›®å½•ä¸‹</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;org.mybatis.builder&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>Mapperæ–‡ä»¶</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.kuang.mapper.UserMapper&quot;</span>&gt;</span><br>   <br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li><p>namespaceä¸­æ–‡æ„æ€ï¼šå‘½åç©ºé—´ï¼Œä½œç”¨å¦‚ä¸‹ï¼š</p></li><li><ul><li>namespaceçš„å‘½åå¿…é¡»è·ŸæŸä¸ªæ¥å£åŒå</li><li>æ¥å£ä¸­çš„æ–¹æ³•ä¸æ˜ å°„æ–‡ä»¶ä¸­sqlè¯­å¥idåº”è¯¥ä¸€ä¸€å¯¹åº”</li></ul></li><li><ol><li>namespaceå’Œå­å…ƒç´ çš„idè”åˆä¿è¯å”¯ä¸€  , åŒºåˆ«ä¸åŒçš„mapper</li><li>ç»‘å®šDAOæ¥å£</li><li>namespaceå‘½åè§„åˆ™ : åŒ…å+ç±»å</li></ol></li></ul><p>MyBatis çš„çœŸæ­£å¼ºå¤§åœ¨äºå®ƒçš„æ˜ å°„è¯­å¥ï¼Œè¿™æ˜¯å®ƒçš„é­”åŠ›æ‰€åœ¨ã€‚ç”±äºå®ƒçš„å¼‚å¸¸å¼ºå¤§ï¼Œæ˜ å°„å™¨çš„ XML æ–‡ä»¶å°±æ˜¾å¾—ç›¸å¯¹ç®€å•ã€‚å¦‚æœæ‹¿å®ƒè·Ÿå…·æœ‰ç›¸åŒåŠŸèƒ½çš„ JDBC ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œä½ ä¼šç«‹å³å‘ç°çœæ‰äº†å°†è¿‘ 95% çš„ä»£ç ã€‚MyBatis ä¸ºèšç„¦äº SQL è€Œæ„å»ºï¼Œä»¥å°½å¯èƒ½åœ°ä¸ºä½ å‡å°‘éº»çƒ¦ã€‚</p><h2 id="3-3-Propertiesä¼˜åŒ–"><a href="#3-3-Propertiesä¼˜åŒ–" class="headerlink" title="3.3 Propertiesä¼˜åŒ–"></a>3.3 Propertiesä¼˜åŒ–</h2><p>æ•°æ®åº“è¿™äº›å±æ€§éƒ½æ˜¯å¯å¤–éƒ¨é…ç½®ä¸”å¯åŠ¨æ€æ›¿æ¢çš„ï¼Œæ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®ï¼Œäº¦å¯é€šè¿‡ properties å…ƒç´ çš„å­å…ƒç´ æ¥ä¼ é€’ã€‚å…·ä½“çš„å®˜æ–¹æ–‡æ¡£</p><p>æ–¹æ³•ä¸€:ç›´æ¥åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­å¼•å…¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="hljs-symbol">&amp;amp;</span>useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;admin&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šæˆ‘ä»¬æ¥ä¼˜åŒ–æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶</p><p>ç¬¬ä¸€æ­¥ ï¼š åœ¨èµ„æºç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªdb.properties</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">driver=com.mysql.jdbc.Driver<br>url=jdbc:mysql:<span class="hljs-comment">//localhost:3306/mybatis?useSSL=true&amp;useUnicode=true&amp;characterEncoding=utf8</span><br>username=root<br>password=<span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ : å°†æ–‡ä»¶å¯¼å…¥properties é…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--å¯¼å…¥propertieså¤–éƒ¨é…ç½®æ–‡ä»¶--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;mapper/UserMapper.xml&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>å¯ä»¥ç›´æ¥å¼•å…¥å¤–éƒ¨æ–‡ä»¶</li><li>å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ ä¸€äº›é…ç½®å±æ€§</li><li>å¦‚æœä¸¤ä¸ªæ–‡ä»¶ä¸­æœ‰åŒä¸€å­—æ®µï¼Œä¼˜å…ˆä½¿ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶</li></ul><h2 id="3-4-typeAliasesä¼˜åŒ–"><a href="#3-4-typeAliasesä¼˜åŒ–" class="headerlink" title="3.4 typeAliasesä¼˜åŒ–"></a>3.4 typeAliasesä¼˜åŒ–</h2><p>ç±»å‹åˆ«åæ˜¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªçŸ­çš„åå­—ã€‚å®ƒåªå’Œ XML é…ç½®æœ‰å…³ï¼Œå­˜åœ¨çš„æ„ä¹‰ä»…åœ¨äºç”¨æ¥å‡å°‘ç±»å®Œå…¨é™å®šåçš„å†—ä½™ã€‚</p><ul><li>æ–¹æ³•ä¸€ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®åˆ«å,æ³¨æ„é¡ºåº--&gt;</span><br><span class="hljs-comment">&lt;!--å¯ä»¥ç»™å®ä½“ç±»èµ·åˆ«å--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">typeAlias</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.kuang.pojo.User&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;User&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å½“è¿™æ ·é…ç½®æ—¶ï¼Œ<code>User</code>å¯ä»¥ç”¨åœ¨ä»»ä½•ä½¿ç”¨<code>com.kuang.pojo.User</code>çš„åœ°æ–¹ã€‚</p><ul><li>æ–¹æ³•äºŒï¼š</li></ul><p>ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…åï¼ŒMyBatis ä¼šåœ¨åŒ…åä¸‹é¢æœç´¢éœ€è¦çš„ Java Beanï¼Œæ¯”å¦‚:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.kuang.pojo&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¯ä¸€ä¸ªåœ¨åŒ… <code>com.kuang.pojo</code> ä¸­çš„ Java Beanï¼Œåœ¨æ²¡æœ‰æ³¨è§£çš„æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨ Bean çš„é¦–å­—æ¯å°å†™çš„éé™å®šç±»åæ¥ä½œä¸ºå®ƒçš„åˆ«åã€‚</p><ul><li>ç¬¬ä¸€ç§å¯ä»¥diyï¼Œç¬¬äºŒç§ä¸å¯ä»¥</li></ul><p>ä½†æ˜¯å¯ä»¥ä½¿ç”¨æ³¨è§£diyåç§°</p><p>è‹¥æœ‰æ³¨è§£ï¼Œåˆ™åˆ«åä¸ºå…¶æ³¨è§£å€¼ã€‚è§ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Alias(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å®˜æ–¹é»˜è®¤åˆ«å</li></ul><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201222163823206.png" alt="image-20201222163823206"></p><h2 id="3-5-å…¶ä»–é…ç½®æµè§ˆ"><a href="#3-5-å…¶ä»–é…ç½®æµè§ˆ" class="headerlink" title="3.5 å…¶ä»–é…ç½®æµè§ˆ"></a>3.5 å…¶ä»–é…ç½®æµè§ˆ</h2><p><strong>è®¾ç½®</strong></p><ul><li><p>è®¾ç½®ï¼ˆsettingsï¼‰ç›¸å…³ =&gt; æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</p></li><li><ul><li>æ‡’åŠ è½½</li><li>æ—¥å¿—å®ç°</li><li>ç¼“å­˜å¼€å¯å…³é—­</li></ul></li><li><p>ä¸€ä¸ªé…ç½®å®Œæ•´çš„ settings å…ƒç´ çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cacheEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;lazyLoadingEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;multipleResultSetsEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;useColumnLabel&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;useGeneratedKeys&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;autoMappingBehavior&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;PARTIAL&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;autoMappingUnknownColumnBehavior&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;WARNING&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultExecutorType&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;SIMPLE&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultStatementTimeout&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;25&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultFetchSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;100&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;safeRowBoundsEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;localCacheScope&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;SESSION&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;jdbcTypeForNull&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;OTHER&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;lazyLoadTriggerMethods&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;equals,clone,hashCode,toString&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure></li></ul><p><strong>ç±»å‹å¤„ç†å™¨</strong>ï¼ˆtypeHandlersï¼‰</p><ul><li>æ— è®ºæ˜¯ MyBatis åœ¨é¢„å¤„ç†è¯­å¥ï¼ˆPreparedStatementï¼‰ä¸­è®¾ç½®ä¸€ä¸ªå‚æ•°æ—¶ï¼Œè¿˜æ˜¯ä»ç»“æœé›†ä¸­å–å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œ éƒ½ä¼šç”¨ç±»å‹å¤„ç†å™¨å°†è·å–çš„å€¼ä»¥åˆé€‚çš„æ–¹å¼è½¬æ¢æˆ Java ç±»å‹ã€‚</li><li>ä½ å¯ä»¥é‡å†™ç±»å‹å¤„ç†å™¨æˆ–åˆ›å»ºä½ è‡ªå·±çš„ç±»å‹å¤„ç†å™¨æ¥å¤„ç†ä¸æ”¯æŒçš„æˆ–éæ ‡å‡†çš„ç±»å‹ã€‚ã€äº†è§£å³å¯ã€‘</li></ul><p><strong>å¯¹è±¡å·¥å‚</strong>ï¼ˆobjectFactoryï¼‰</p><ul><li>MyBatis æ¯æ¬¡åˆ›å»ºç»“æœå¯¹è±¡çš„æ–°å®ä¾‹æ—¶ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼ˆObjectFactoryï¼‰å®ä¾‹æ¥å®Œæˆã€‚</li><li>é»˜è®¤çš„å¯¹è±¡å·¥å‚éœ€è¦åšçš„ä»…ä»…æ˜¯å®ä¾‹åŒ–ç›®æ ‡ç±»ï¼Œè¦ä¹ˆé€šè¿‡é»˜è®¤æ„é€ æ–¹æ³•ï¼Œè¦ä¹ˆåœ¨å‚æ•°æ˜ å°„å­˜åœ¨çš„æ—¶å€™é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–ã€‚</li><li>å¦‚æœæƒ³è¦†ç›–å¯¹è±¡å·¥å‚çš„é»˜è®¤è¡Œä¸ºï¼Œåˆ™å¯ä»¥é€šè¿‡åˆ›å»ºè‡ªå·±çš„å¯¹è±¡å·¥å‚æ¥å®ç°ã€‚ã€äº†è§£å³å¯ã€‘</li></ul><h2 id="ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"><a href="#ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"></a>ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ</h2><p><strong>ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ</strong></p><p>ç†è§£æˆ‘ä»¬ç›®å‰å·²ç»è®¨è®ºè¿‡çš„ä¸åŒä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸç±»æ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„<strong>å¹¶å‘é—®é¢˜</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å…ˆç”»ä¸€ä¸ªæµç¨‹å›¾ï¼Œåˆ†æä¸€ä¸‹Mybatisçš„æ‰§è¡Œè¿‡ç¨‹</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/640" alt="å›¾ç‰‡"></p><p><strong>ä½œç”¨åŸŸç†è§£</strong></p><ul><li>SqlSessionFactoryBuilder çš„ä½œç”¨åœ¨äºåˆ›å»º SqlSessionFactoryï¼Œåˆ›å»ºæˆåŠŸåï¼ŒSqlSessionFactoryBuilder å°±å¤±å»äº†ä½œç”¨ï¼Œæ‰€ä»¥å®ƒåªèƒ½å­˜åœ¨äºåˆ›å»º SqlSessionFactory çš„æ–¹æ³•ä¸­ï¼Œè€Œä¸è¦è®©å…¶é•¿æœŸå­˜åœ¨ã€‚å› æ­¤ <strong>SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸ</strong>ï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚</li><li>SqlSessionFactory å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œå®ƒçš„ä½œç”¨æ˜¯åˆ›å»º SqlSession æ¥å£å¯¹è±¡ã€‚å› ä¸º MyBatis çš„æœ¬è´¨å°±æ˜¯ Java å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œæ‰€ä»¥ SqlSessionFactory çš„ç”Ÿå‘½å‘¨æœŸå­˜åœ¨äºæ•´ä¸ª MyBatis çš„åº”ç”¨ä¹‹ä¸­ï¼Œæ‰€ä»¥ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±è¦é•¿æœŸä¿å­˜å®ƒï¼Œç›´è‡³ä¸å†ä½¿ç”¨ MyBatis åº”ç”¨ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸º SqlSessionFactory çš„ç”Ÿå‘½å‘¨æœŸå°±ç­‰åŒäº MyBatis çš„åº”ç”¨å‘¨æœŸã€‚</li><li>ç”±äº SqlSessionFactory æ˜¯ä¸€ä¸ªå¯¹æ•°æ®åº“çš„è¿æ¥æ± ï¼Œæ‰€ä»¥å®ƒå æ®ç€æ•°æ®åº“çš„è¿æ¥èµ„æºã€‚å¦‚æœåˆ›å»ºå¤šä¸ª SqlSessionFactoryï¼Œé‚£ä¹ˆå°±å­˜åœ¨å¤šä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œè¿™æ ·ä¸åˆ©äºå¯¹æ•°æ®åº“èµ„æºçš„æ§åˆ¶ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°æ®åº“è¿æ¥èµ„æºè¢«æ¶ˆè€—å…‰ï¼Œå‡ºç°ç³»ç»Ÿå®•æœºç­‰æƒ…å†µï¼Œæ‰€ä»¥å°½é‡é¿å…å‘ç”Ÿè¿™æ ·çš„æƒ…å†µã€‚</li><li>å› æ­¤åœ¨ä¸€èˆ¬çš„åº”ç”¨ä¸­æˆ‘ä»¬å¾€å¾€å¸Œæœ› SqlSessionFactory ä½œä¸ºä¸€ä¸ªå•ä¾‹ï¼Œè®©å®ƒåœ¨åº”ç”¨ä¸­è¢«å…±äº«ã€‚æ‰€ä»¥è¯´ <strong>SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚</strong></li><li>å¦‚æœè¯´ SqlSessionFactory ç›¸å½“äºæ•°æ®åº“è¿æ¥æ± ï¼Œé‚£ä¹ˆ SqlSession å°±ç›¸å½“äºä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼ˆConnection å¯¹è±¡ï¼‰ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢æ‰§è¡Œå¤šæ¡ SQLï¼Œç„¶åé€šè¿‡å®ƒçš„ commitã€rollback ç­‰æ–¹æ³•ï¼Œæäº¤æˆ–è€…å›æ»šäº‹åŠ¡ã€‚æ‰€ä»¥å®ƒåº”è¯¥å­˜æ´»åœ¨ä¸€ä¸ªä¸šåŠ¡è¯·æ±‚ä¸­ï¼Œå¤„ç†å®Œæ•´ä¸ªè¯·æ±‚åï¼Œåº”è¯¥å…³é—­è¿™æ¡è¿æ¥ï¼Œè®©å®ƒå½’è¿˜ç»™ SqlSessionFactoryï¼Œå¦åˆ™æ•°æ®åº“èµ„æºå°±å¾ˆå¿«è¢«è€—è´¹ç²¾å…‰ï¼Œç³»ç»Ÿå°±ä¼šç˜«ç—ªï¼Œæ‰€ä»¥ç”¨ tryâ€¦catchâ€¦finallyâ€¦ è¯­å¥æ¥ä¿è¯å…¶æ­£ç¡®å…³é—­ã€‚</li><li><strong>æ‰€ä»¥ SqlSession çš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚</strong></li></ul><p><img src="https://mmbiz.qpic.cn/mmbiz_png/uJDAUKrGC7JdnS939HH5TayIhQo5s0aJJq1YuJCr3e9PsTBpBgc1tbicoshHB3qLkwgn3Jp2q8qI1dY9vGhIia3w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p><h1 id="å››ã€ResultMapè§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´"><a href="#å››ã€ResultMapè§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´" class="headerlink" title="å››ã€ResultMapè§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´"></a>å››ã€ResultMapè§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´</h1><h2 id="4-1-æŸ¥è¯¢ä¸ºnullé—®é¢˜"><a href="#4-1-æŸ¥è¯¢ä¸ºnullé—®é¢˜" class="headerlink" title="4.1 æŸ¥è¯¢ä¸ºnullé—®é¢˜"></a>4.1 æŸ¥è¯¢ä¸ºnullé—®é¢˜</h2><p><strong>è¦è§£å†³çš„é—®é¢˜ï¼šå±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´</strong></p><p>ç¯å¢ƒï¼šæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå°†ä¹‹å‰çš„é¡¹ç›®æ‹·è´è¿‡æ¥</p><p>1ã€æŸ¥çœ‹ä¹‹å‰çš„æ•°æ®åº“çš„å­—æ®µå</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/640" alt="å›¾ç‰‡"></p><p>2ã€Javaä¸­çš„å®ä½“ç±»è®¾è®¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;  <span class="hljs-comment">//id</span><br>   <span class="hljs-keyword">private</span> String name;   <span class="hljs-comment">//å§“å</span><br>   <span class="hljs-keyword">private</span> String password;   <span class="hljs-comment">//å¯†ç å’Œæ•°æ®åº“ä¸ä¸€æ ·ï¼</span><br>   <br>   <span class="hljs-comment">//æ„é€ </span><br>   <span class="hljs-comment">//set/get</span><br>   <span class="hljs-comment">//toString()</span><br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br><span class="hljs-function">User <span class="hljs-title">selectUserById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>4ã€mapperæ˜ å°„æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span><br>  select * from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectUserById</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();  <span class="hljs-comment">//è·å–SqlSessionè¿æ¥</span><br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   User user = mapper.selectUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ç»“æœ:</strong></p><ul><li>User{id=1, name=â€™ç‹‚ç¥â€™, password=â€™nullâ€™}</li><li>æŸ¥è¯¢å‡ºæ¥å‘ç° password ä¸ºç©º . è¯´æ˜å‡ºç°äº†é—®é¢˜ï¼</li></ul><p><strong>åˆ†æï¼š</strong></p><ul><li><p>select * from user where id = #{id} å¯ä»¥çœ‹åš</p><p>select  id,name,pwd  from user where id = #{id}</p></li><li><p>mybatisä¼šæ ¹æ®è¿™äº›æŸ¥è¯¢çš„åˆ—å(ä¼šå°†åˆ—åè½¬åŒ–ä¸ºå°å†™,æ•°æ®åº“ä¸åŒºåˆ†å¤§å°å†™) , å»å¯¹åº”çš„å®ä½“ç±»ä¸­æŸ¥æ‰¾ç›¸åº”åˆ—åçš„setæ–¹æ³•è®¾å€¼ , ç”±äºæ‰¾ä¸åˆ°setPwd() , æ‰€ä»¥passwordè¿”å›null ; ã€è‡ªåŠ¨æ˜ å°„ã€‘</p></li></ul><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>æ–¹æ¡ˆä¸€ï¼šä¸ºåˆ—åæŒ‡å®šåˆ«å , åˆ«åå’Œjavaå®ä½“ç±»çš„å±æ€§åä¸€è‡´ .</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;User&quot;</span>&gt;</span><br>  select id , name , pwd as password from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ç»“æœé›†æ˜ å°„-&gt;ResultMap</strong> ã€æ¨èã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;UserMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;User&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- idä¸ºä¸»é”® --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>   <span class="hljs-comment">&lt;!-- columnæ˜¯æ•°æ®åº“è¡¨çš„åˆ—å , propertyæ˜¯å¯¹åº”å®ä½“ç±»çš„å±æ€§å --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;pwd&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span>&gt;</span><br>  select id , name , pwd from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="4-2-ResultMap"><a href="#4-2-ResultMap" class="headerlink" title="4.2 ResultMap"></a>4.2 ResultMap</h2><p><strong>è‡ªåŠ¨æ˜ å°„</strong></p><ul><li><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ ã€‚å®ƒå¯ä»¥è®©ä½ ä» 90% çš„ JDBC <code>ResultSets</code> æ•°æ®æå–ä»£ç ä¸­è§£æ”¾å‡ºæ¥ã€‚</li><li>å®é™…ä¸Šï¼Œåœ¨ä¸ºä¸€äº›æ¯”å¦‚è¿æ¥çš„å¤æ‚è¯­å¥ç¼–å†™æ˜ å°„ä»£ç çš„æ—¶å€™ï¼Œä¸€ä»½ <code>resultMap</code> èƒ½å¤Ÿä»£æ›¿å®ç°åŒç­‰åŠŸèƒ½çš„é•¿è¾¾æ•°åƒè¡Œçš„ä»£ç ã€‚</li><li>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹äºç®€å•çš„è¯­å¥æ ¹æœ¬ä¸éœ€è¦é…ç½®æ˜¾å¼çš„ç»“æœæ˜ å°„ï¼Œè€Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥åªéœ€è¦æè¿°å®ƒä»¬çš„å…³ç³»å°±è¡Œäº†ã€‚</li></ul><p>ä½ å·²ç»è§è¿‡ç®€å•æ˜ å°„è¯­å¥çš„ç¤ºä¾‹äº†ï¼Œä½†å¹¶æ²¡æœ‰æ˜¾å¼æŒ‡å®š <code>resultMap</code>ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><br>select id , name , pwd<br>  from user<br>  where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°è¯­å¥åªæ˜¯ç®€å•åœ°å°†æ‰€æœ‰çš„åˆ—æ˜ å°„åˆ° <code>HashMap</code> çš„é”®ä¸Šï¼Œè¿™ç”± <code>resultType</code> å±æ€§æŒ‡å®šã€‚è™½ç„¶åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½å¤Ÿç”¨ï¼Œä½†æ˜¯ HashMap ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ¨¡å‹ã€‚ä½ çš„ç¨‹åºæ›´å¯èƒ½ä¼šä½¿ç”¨ JavaBean æˆ– POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä½œä¸ºæ¨¡å‹ã€‚</p><p><code>ResultMap</code> æœ€ä¼˜ç§€çš„åœ°æ–¹åœ¨äºï¼Œè™½ç„¶ä½ å·²ç»å¯¹å®ƒç›¸å½“äº†è§£äº†ï¼Œä½†æ˜¯æ ¹æœ¬å°±ä¸éœ€è¦æ˜¾å¼åœ°ç”¨åˆ°ä»–ä»¬ã€‚</p><p><strong>æ‰‹åŠ¨æ˜ å°„</strong></p><p>1ã€è¿”å›å€¼ç±»å‹ä¸ºresultMap</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUserById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span>&gt;</span><br>  select id , name , pwd from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™resultMapï¼Œå®ç°æ‰‹åŠ¨æ˜ å°„ï¼</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;UserMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;User&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!-- idä¸ºä¸»é”® --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>   <span class="hljs-comment">&lt;!-- columnæ˜¯æ•°æ®åº“è¡¨çš„åˆ—å , propertyæ˜¯å¯¹åº”å®ä½“ç±»çš„å±æ€§å --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;pwd&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä¸–ç•Œæ€»æ˜¯è¿™ä¹ˆç®€å•å°±å¥½äº†ã€‚ä½†æ˜¯è‚¯å®šä¸æ˜¯çš„ï¼Œæ•°æ®åº“ä¸­ï¼Œå­˜åœ¨ä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¹‹åä¼šä½¿ç”¨åˆ°ä¸€äº›é«˜çº§çš„ç»“æœé›†æ˜ å°„ï¼Œassociationï¼Œcollectionè¿™äº›ï¼Œæˆ‘ä»¬å°†åœ¨ä¹‹åè®²è§£ï¼Œä»Šå¤©ä½ ä»¬éœ€è¦æŠŠè¿™äº›çŸ¥è¯†éƒ½æ¶ˆåŒ–æ‰æ‰æ˜¯æœ€é‡è¦çš„ï¼ç†è§£ç»“æœé›†æ˜ å°„çš„è¿™ä¸ªæ¦‚å¿µï¼</p><h1 id="äº”ã€-æ—¥å¿—"><a href="#äº”ã€-æ—¥å¿—" class="headerlink" title="äº”ã€ æ—¥å¿—"></a>äº”ã€ æ—¥å¿—</h1><h2 id="5-1-æ—¥å¿—å·¥å‚"><a href="#5-1-æ—¥å¿—å·¥å‚" class="headerlink" title="5.1 æ—¥å¿—å·¥å‚"></a>5.1 æ—¥å¿—å·¥å‚</h2><p>æ€è€ƒï¼šæˆ‘ä»¬åœ¨æµ‹è¯•SQLçš„æ—¶å€™ï¼Œè¦æ˜¯èƒ½å¤Ÿåœ¨æ§åˆ¶å°è¾“å‡º SQL çš„è¯ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½å¤Ÿæœ‰æ›´å¿«çš„æ’é”™æ•ˆç‡ï¼Ÿ</p><p>å¦‚æœä¸€ä¸ª æ•°æ®åº“ç›¸å…³çš„æ“ä½œå‡ºç°äº†é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¾“å‡ºçš„SQLè¯­å¥å¿«é€Ÿæ’æŸ¥é—®é¢˜ã€‚</p><p>å¯¹äºä»¥å¾€çš„å¼€å‘è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¼šç»å¸¸ä½¿ç”¨åˆ°debugæ¨¡å¼æ¥è°ƒèŠ‚ï¼Œè·Ÿè¸ªæˆ‘ä»¬çš„ä»£ç æ‰§è¡Œè¿‡ç¨‹ã€‚ä½†æ˜¯ç°åœ¨ä½¿ç”¨Mybatisæ˜¯åŸºäºæ¥å£ï¼Œé…ç½®æ–‡ä»¶çš„æºä»£ç æ‰§è¡Œè¿‡ç¨‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»é€‰æ‹©æ—¥å¿—å·¥å…·æ¥ä½œä¸ºæˆ‘ä»¬å¼€å‘ï¼Œè°ƒèŠ‚ç¨‹åºçš„å·¥å…·ã€‚</p><p>Mybatiså†…ç½®çš„æ—¥å¿—å·¥å‚æä¾›æ—¥å¿—åŠŸèƒ½ï¼Œå…·ä½“çš„æ—¥å¿—å®ç°æœ‰ä»¥ä¸‹å‡ ç§å·¥å…·ï¼š</p><ul><li>SLF4J</li><li>Apache Commons Logging</li><li>Log4j 2</li><li>Log4j</li><li>JDK logging</li></ul><p>å…·ä½“é€‰æ‹©å“ªä¸ªæ—¥å¿—å®ç°å·¥å…·ç”±MyBatisçš„å†…ç½®æ—¥å¿—å·¥å‚ç¡®å®šã€‚å®ƒä¼šä½¿ç”¨æœ€å…ˆæ‰¾åˆ°çš„ï¼ˆæŒ‰ä¸Šæ–‡åˆ—ä¸¾çš„é¡ºåºæŸ¥æ‰¾ï¼‰ã€‚å¦‚æœä¸€ä¸ªéƒ½æœªæ‰¾åˆ°ï¼Œæ—¥å¿—åŠŸèƒ½å°±ä¼šè¢«ç¦ç”¨ã€‚</p><p><strong>æ ‡å‡†æ—¥å¿—å®ç°</strong></p><p>æŒ‡å®š MyBatis åº”è¯¥ä½¿ç”¨å“ªä¸ªæ—¥å¿—è®°å½•å®ç°ã€‚å¦‚æœæ­¤è®¾ç½®ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨å‘ç°æ—¥å¿—è®°å½•å®ç°ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°æœ‰å¤§é‡çš„è¾“å‡ºï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›è¾“å‡ºæ¥åˆ¤æ–­ç¨‹åºåˆ°åº•å“ªé‡Œå‡ºäº†Bug</p><h2 id="5-2-Log4j"><a href="#5-2-Log4j" class="headerlink" title="5.2 Log4j"></a>5.2 Log4j</h2><p><strong>ç®€ä»‹ï¼š</strong></p><ul><li>Log4jæ˜¯Apacheçš„ä¸€ä¸ªå¼€æºé¡¹ç›®</li><li>é€šè¿‡ä½¿ç”¨Log4jï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°ï¼šæ§åˆ¶å°ï¼Œæ–‡æœ¬ï¼ŒGUIç»„ä»¶â€¦.</li><li>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶æ¯ä¸€æ¡æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ï¼›</li><li>é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯çš„çº§åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç»†è‡´åœ°æ§åˆ¶æ—¥å¿—çš„ç”Ÿæˆè¿‡ç¨‹ã€‚æœ€ä»¤äººæ„Ÿå…´è¶£çš„å°±æ˜¯ï¼Œè¿™äº›å¯ä»¥é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥çµæ´»åœ°è¿›è¡Œé…ç½®ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨çš„ä»£ç ã€‚</li></ul><p><strong>ä½¿ç”¨æ­¥éª¤ï¼š</strong></p><p>1ã€å¯¼å…¥log4jçš„åŒ…</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€é…ç½®æ–‡ä»¶ç¼–å†™(resources / log4j.properties)</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œconsoleå’Œfileçš„å®šä¹‰åœ¨ä¸‹é¢çš„ä»£ç </span><br><span class="hljs-meta">log4j.rootLogger</span>=<span class="hljs-string">DEBUG,console,file</span><br><br><span class="hljs-comment">#æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span><br><span class="hljs-meta">log4j.appender.console</span> = <span class="hljs-string">org.apache.log4j.ConsoleAppender</span><br><span class="hljs-meta">log4j.appender.console.Target</span> = <span class="hljs-string">System.out</span><br><span class="hljs-meta">log4j.appender.console.Threshold</span>=<span class="hljs-string">DEBUG</span><br><span class="hljs-meta">log4j.appender.console.layout</span> = <span class="hljs-string">org.apache.log4j.PatternLayout</span><br><span class="hljs-meta">log4j.appender.console.layout.ConversionPattern</span>=<span class="hljs-string">[%c]-%m%n</span><br><br><span class="hljs-comment">#æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span><br><span class="hljs-meta">log4j.appender.file</span> = <span class="hljs-string">org.apache.log4j.RollingFileAppender</span><br><span class="hljs-meta">log4j.appender.file.File</span>=<span class="hljs-string">./log/kuang.log</span><br><span class="hljs-meta">log4j.appender.file.MaxFileSize</span>=<span class="hljs-string">10mb</span><br><span class="hljs-meta">log4j.appender.file.Threshold</span>=<span class="hljs-string">DEBUG</span><br><span class="hljs-meta">log4j.appender.file.layout</span>=<span class="hljs-string">org.apache.log4j.PatternLayout</span><br><span class="hljs-meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="hljs-string">[%p][%d&#123;yy-MM-dd&#125;][%c]%m%n</span><br><br><span class="hljs-comment">#æ—¥å¿—è¾“å‡ºçº§åˆ«</span><br><span class="hljs-meta">log4j.logger.org.mybatis</span>=<span class="hljs-string">DEBUG</span><br><span class="hljs-meta">log4j.logger.java.sql</span>=<span class="hljs-string">DEBUG</span><br><span class="hljs-meta">log4j.logger.java.sql.Statement</span>=<span class="hljs-string">DEBUG</span><br><span class="hljs-meta">log4j.logger.java.sql.ResultSet</span>=<span class="hljs-string">DEBUG</span><br><span class="hljs-meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="hljs-string">DEBUG</span><br></code></pre></td></tr></table></figure><p>3ã€settingè®¾ç½®æ—¥å¿—å®ç°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;LOG4J&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€åœ¨ç¨‹åºä¸­ä½¿ç”¨Log4jè¿›è¡Œè¾“å‡ºï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ³¨æ„å¯¼åŒ…ï¼šorg.apache.log4j.Logger</span><br><span class="hljs-keyword">static</span> Logger logger = Logger.getLogger(MyTest.class);<br><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectUser</span><span class="hljs-params">()</span> </span>&#123;<br>   logger.info(<span class="hljs-string">&quot;infoï¼šè¿›å…¥selectUseræ–¹æ³•&quot;</span>);<br>   logger.debug(<span class="hljs-string">&quot;debugï¼šè¿›å…¥selectUseræ–¹æ³•&quot;</span>);<br>   logger.error(<span class="hljs-string">&quot;error: è¿›å…¥selectUseræ–¹æ³•&quot;</span>);<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   List&lt;User&gt; users = mapper.selectUser();<br>   <span class="hljs-keyword">for</span> (User user: users)&#123;<br>       System.out.println(user);<br>  &#125;<br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€æµ‹è¯•ï¼Œçœ‹æ§åˆ¶å°è¾“å‡ºï¼</p><ul><li>ä½¿ç”¨Log4j è¾“å‡ºæ—¥å¿—</li><li>å¯ä»¥çœ‹åˆ°è¿˜ç”Ÿæˆäº†ä¸€ä¸ªæ—¥å¿—çš„æ–‡ä»¶ ã€éœ€è¦ä¿®æ”¹fileçš„æ—¥å¿—çº§åˆ«ã€‘</li></ul><h1 id="å…­ã€åˆ†é¡µ"><a href="#å…­ã€åˆ†é¡µ" class="headerlink" title="å…­ã€åˆ†é¡µ"></a>å…­ã€åˆ†é¡µ</h1><h2 id="6-1-limitå®ç°åˆ†é¡µ"><a href="#6-1-limitå®ç°åˆ†é¡µ" class="headerlink" title="6.1 limitå®ç°åˆ†é¡µ"></a>6.1 limitå®ç°åˆ†é¡µ</h2><p><strong>æ€è€ƒï¼šä¸ºä»€ä¹ˆéœ€è¦åˆ†é¡µï¼Ÿ</strong></p><p>åœ¨å­¦ä¹ mybatisç­‰æŒä¹…å±‚æ¡†æ¶çš„æ—¶å€™ï¼Œä¼šç»å¸¸å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯å¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¦‚æœæŸ¥è¯¢å¤§é‡æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€ä½¿ç”¨åˆ†é¡µè¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å¤„ç†å°éƒ¨åˆ†æ•°æ®ï¼Œè¿™æ ·å¯¹æ•°æ®åº“å‹åŠ›å°±åœ¨å¯æ§èŒƒå›´å†…ã€‚</p><p><strong>ä½¿ç”¨Limitå®ç°åˆ†é¡µ</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">#è¯­æ³•</span><br>SELECT * <span class="hljs-keyword">FROM</span> table LIMIT stratIndexï¼ŒpageSize<br><br>SELECT * <span class="hljs-keyword">FROM</span> table LIMIT <span class="hljs-number">5</span>,<span class="hljs-number">10</span>; <span class="hljs-comment">// æ£€ç´¢è®°å½•è¡Œ 6-15,  ä»ç¬¬5é¡µå¼€å§‹æ£€ç´¢10æ¡</span><br><br><span class="hljs-comment">#ä¸ºäº†æ£€ç´¢ä»æŸä¸€ä¸ªåç§»é‡åˆ°è®°å½•é›†çš„ç»“æŸæ‰€æœ‰çš„è®°å½•è¡Œï¼Œå¯ä»¥æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ä¸º -1ï¼š   </span><br>SELECT * <span class="hljs-keyword">FROM</span> table LIMIT <span class="hljs-number">95</span>,<span class="hljs-number">-1</span>; <span class="hljs-comment">// æ£€ç´¢è®°å½•è¡Œ 96-last.  </span><br><br><span class="hljs-comment">#å¦‚æœåªç»™å®šä¸€ä¸ªå‚æ•°ï¼Œå®ƒè¡¨ç¤ºè¿”å›æœ€å¤§çš„è®°å½•è¡Œæ•°ç›®ï¼š   </span><br>SELECT * <span class="hljs-keyword">FROM</span> table LIMIT <span class="hljs-number">5</span>; <span class="hljs-comment">//æ£€ç´¢å‰ 5 ä¸ªè®°å½•è¡Œ  </span><br><br><span class="hljs-comment">#æ¢å¥è¯è¯´ï¼ŒLIMIT n ç­‰ä»·äº LIMIT 0,nã€‚ </span><br></code></pre></td></tr></table></figure><p><strong>æ­¥éª¤ï¼š</strong></p><p>1ã€ä¿®æ”¹Mapperæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span><br>  select * from user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€Mapperæ¥å£ï¼Œå‚æ•°ä¸ºmap</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é€‰æ‹©å…¨éƒ¨ç”¨æˆ·å®ç°åˆ†é¡µ</span><br><span class="hljs-function">List&lt;User&gt; <span class="hljs-title">selectUser</span><span class="hljs-params">(Map&lt;String,Integer&gt; map)</span></span>;<br></code></pre></td></tr></table></figure><p>3ã€åœ¨æµ‹è¯•ç±»ä¸­ä¼ å…¥å‚æ•°æµ‹è¯•</p><ul><li>æ¨æ–­ï¼šèµ·å§‹ä½ç½® =  ï¼ˆå½“å‰é¡µé¢ - 1 ï¼‰ * é¡µé¢å¤§å°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//åˆ†é¡µæŸ¥è¯¢ , ä¸¤ä¸ªå‚æ•°startIndex , pageSize</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   <span class="hljs-keyword">int</span> currentPage = <span class="hljs-number">1</span>;  <span class="hljs-comment">//ç¬¬å‡ é¡µ</span><br>   <span class="hljs-keyword">int</span> pageSize = <span class="hljs-number">2</span>;  <span class="hljs-comment">//æ¯é¡µæ˜¾ç¤ºå‡ ä¸ª</span><br>   Map&lt;String,Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String,Integer&gt;();<br>   map.put(<span class="hljs-string">&quot;startIndex&quot;</span>,(currentPage-<span class="hljs-number">1</span>)*pageSize);<br>   map.put(<span class="hljs-string">&quot;pageSize&quot;</span>,pageSize);<br><br>   List&lt;User&gt; users = mapper.selectUser(map);<br><br>   <span class="hljs-keyword">for</span> (User user: users)&#123;<br>       System.out.println(user);<br>  &#125;<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="6-2-RowBoundsåˆ†é¡µ"><a href="#6-2-RowBoundsåˆ†é¡µ" class="headerlink" title="6.2 RowBoundsåˆ†é¡µ"></a>6.2 RowBoundsåˆ†é¡µ</h2><p>æˆ‘ä»¬é™¤äº†ä½¿ç”¨Limitåœ¨SQLå±‚é¢å®ç°åˆ†é¡µï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨RowBoundsåœ¨Javaä»£ç å±‚é¢å®ç°åˆ†é¡µï¼Œå½“ç„¶æ­¤ç§æ–¹å¼ä½œä¸ºäº†è§£å³å¯ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•å®ç°çš„ï¼</p><p><strong>æ­¥éª¤ï¼š</strong></p><p>1ã€mapperæ¥å£</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//é€‰æ‹©å…¨éƒ¨ç”¨æˆ·RowBoundså®ç°åˆ†é¡µ</span><br><span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserByRowBounds</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€mapperæ–‡ä»¶</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;<span class="hljs-keyword">select</span> id=&quot;getUserByRowBounds&quot; resultType=&quot;user&quot;&gt;<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span><br>&lt;/<span class="hljs-keyword">select</span>&gt;<br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ç±»</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨RowBoundsç±»</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">@Test<br><span class="hljs-built_in">public</span> <span class="hljs-type">void</span> testUserByRowBounds() &#123;<br>   SqlSession <span class="hljs-keyword">session</span> = MybatisUtils.getSession();<br><br>   <span class="hljs-type">int</span> currentPage = <span class="hljs-number">2</span>;  //ç¬¬å‡ é¡µ<br>   <span class="hljs-type">int</span> pageSize = <span class="hljs-number">2</span>;  //æ¯é¡µæ˜¾ç¤ºå‡ ä¸ª<br>   RowBounds rowBounds = <span class="hljs-built_in">new</span> RowBounds((currentPage<span class="hljs-number">-1</span>)*pageSize,pageSize);<br><br>   //é€šè¿‡<span class="hljs-keyword">session</span>.**æ–¹æ³•è¿›è¡Œä¼ é€’rowBoundsï¼Œ[æ­¤ç§æ–¹å¼ç°åœ¨å·²ç»ä¸æ¨èä½¿ç”¨äº†]<br>   List&lt;<span class="hljs-keyword">User</span>&gt; users = <span class="hljs-keyword">session</span>.selectList(&quot;com.kuang.mapper.UserMapper.getUserByRowBounds&quot;, <span class="hljs-keyword">null</span>, rowBounds);<br><br>   <span class="hljs-keyword">for</span> (<span class="hljs-keyword">User</span> <span class="hljs-keyword">user</span>: users)&#123;<br>       <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(<span class="hljs-keyword">user</span>);<br>  &#125;<br>   <span class="hljs-keyword">session</span>.<span class="hljs-keyword">close</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="6-3-PageHelperåˆ†é¡µæ’ä»¶"><a href="#6-3-PageHelperåˆ†é¡µæ’ä»¶" class="headerlink" title="6.3 PageHelperåˆ†é¡µæ’ä»¶"></a>6.3 PageHelperåˆ†é¡µæ’ä»¶</h2><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/640" alt="å›¾ç‰‡"></p><p>äº†è§£å³å¯ï¼Œå¯ä»¥è‡ªå·±å°è¯•ä½¿ç”¨</p><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://pagehelper.github.io/">https://pagehelper.github.io/</a></p><h1 id="ä¸ƒã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#ä¸ƒã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="ä¸ƒã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>ä¸ƒã€ä½¿ç”¨æ³¨è§£å¼€å‘</h1><ul><li><p><strong>mybatisæœ€åˆé…ç½®ä¿¡æ¯æ˜¯åŸºäº XML ,æ˜ å°„è¯­å¥(SQL)ä¹Ÿæ˜¯å®šä¹‰åœ¨ XML ä¸­çš„ã€‚è€Œåˆ°MyBatis 3æä¾›äº†æ–°çš„åŸºäºæ³¨è§£çš„é…ç½®ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒJava æ³¨è§£çš„çš„è¡¨è¾¾åŠ›å’Œçµæ´»æ€§ååˆ†æœ‰é™ã€‚æœ€å¼ºå¤§çš„ MyBatis æ˜ å°„å¹¶ä¸èƒ½ç”¨æ³¨è§£æ¥æ„å»º</strong></p></li><li><p>sql ç±»å‹ä¸»è¦åˆ†æˆ :</p></li><li><ul><li>@select ()</li><li>@update ()</li><li>@Insert ()</li><li>@delete ()</li></ul></li></ul><p><strong>æ³¨æ„ï¼š</strong>åˆ©ç”¨æ³¨è§£å¼€å‘å°±ä¸éœ€è¦mapper.xmlæ˜ å°„æ–‡ä»¶äº† .</p><h2 id="7-1-æ³¨è§£ä½¿ç”¨æµç¨‹"><a href="#7-1-æ³¨è§£ä½¿ç”¨æµç¨‹" class="headerlink" title="7.1 æ³¨è§£ä½¿ç”¨æµç¨‹"></a>7.1 æ³¨è§£ä½¿ç”¨æµç¨‹</h2><p>1ã€æˆ‘ä»¬åœ¨æˆ‘ä»¬çš„æ¥å£ä¸­æ·»åŠ æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·</span><br><span class="hljs-meta">@Select(&quot;select id,name,pwd password from user&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">getAllUser</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨mybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å…¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ä½¿ç”¨classç»‘å®šæ¥å£--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.kuang.mapper.UserMapper&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æˆ‘ä»¬å»è¿›è¡Œæµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testGetAllUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   <span class="hljs-comment">//æœ¬è´¨ä¸Šåˆ©ç”¨äº†jvmçš„åŠ¨æ€ä»£ç†æœºåˆ¶</span><br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   List&lt;User&gt; users = mapper.getAllUser();<br>   <span class="hljs-keyword">for</span> (User user : users)&#123;<br>       System.out.println(user);<br>  &#125;<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€åˆ©ç”¨DebugæŸ¥çœ‹æœ¬è´¨</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/640.png" alt="å›¾ç‰‡"></p><p>5ã€æœ¬è´¨ä¸Šåˆ©ç”¨äº†jvmçš„åŠ¨æ€ä»£ç†æœºåˆ¶</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/641.png" alt="å›¾ç‰‡"></p><p>6ã€Mybatisè¯¦ç»†çš„æ‰§è¡Œæµç¨‹</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/642.png" alt="å›¾ç‰‡"></p><h2 id="7-2-æ³¨è§£å¢åˆ æ”¹"><a href="#7-2-æ³¨è§£å¢åˆ æ”¹" class="headerlink" title="7.2 æ³¨è§£å¢åˆ æ”¹"></a>7.2 æ³¨è§£å¢åˆ æ”¹</h2><p>æ”¹é€ MybatisUtilså·¥å…·ç±»çš„getSession( ) æ–¹æ³•ï¼Œé‡è½½å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–SqlSessionè¿æ¥</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSession</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">return</span> getSession(<span class="hljs-keyword">true</span>); <span class="hljs-comment">//äº‹åŠ¡è‡ªåŠ¨æäº¤ï¼Œä¸éœ€è¦å†æ‰‹åŠ¨æäº¤</span><br>&#125;<br> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSession</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> flag)</span></span>&#123;java<br>    <span class="hljs-keyword">return</span> sqlSessionFactory.openSession(flag);<br>&#125;<br></code></pre></td></tr></table></figure><p>ã€æ³¨æ„ã€‘ç¡®ä¿å®ä½“ç±»å’Œæ•°æ®åº“å­—æ®µå¯¹åº”</p><p><strong>æŸ¥è¯¢ï¼š</strong></p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br><span class="hljs-meta">@Select(&quot;select * from user where id = #&#123;id&#125;&quot;)</span><br><span class="hljs-comment">//æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œä¸€å®šè¦åœ¨å‚æ•°å‰é¢åŠ @param(&quot;id&quot;)æ³¨è§£</span><br><span class="hljs-function">User <span class="hljs-title">selectUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSelectUserById</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   User user = mapper.selectUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ–°å¢ï¼š</strong></p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ·»åŠ ä¸€ä¸ªç”¨æˆ·</span><br><span class="hljs-meta">@Insert(&quot;insert into user (id,name,pwd) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;pwd&#125;)&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(User user)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testAddUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   User user = <span class="hljs-keyword">new</span> User(<span class="hljs-number">6</span>, <span class="hljs-string">&quot;ç§¦ç–†&quot;</span>, <span class="hljs-string">&quot;123456&quot;</span>);<br>   mapper.addUser(user);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ä¿®æ”¹ï¼š</strong></p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¿®æ”¹ä¸€ä¸ªç”¨æˆ·</span><br><span class="hljs-meta">@Update(&quot;update user set name=#&#123;name&#125;,pwd=#&#123;pwd&#125; where id = #&#123;id&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(User user)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdateUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   User user = <span class="hljs-keyword">new</span> User(<span class="hljs-number">6</span>, <span class="hljs-string">&quot;ç§¦ç–†&quot;</span>, <span class="hljs-string">&quot;zxcvbn&quot;</span>);<br>   mapper.updateUser(user);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>åˆ é™¤ï¼š</strong></p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®idåˆ é™¤ç”¨</span><br><span class="hljs-meta">@Delete(&quot;delete from user where id = #&#123;id&#125;&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span><span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDeleteUser</span><span class="hljs-params">()</span> </span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   mapper.deleteUser(<span class="hljs-number">6</span>);<br>   <br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>ã€æ³¨æ„ç‚¹ï¼šå¢åˆ æ”¹ä¸€å®šè®°å¾—å¯¹äº‹åŠ¡çš„å¤„ç†ã€‘</p><h2 id="7-3-param-æ³¨è§£"><a href="#7-3-param-æ³¨è§£" class="headerlink" title="7.3 @param()æ³¨è§£"></a>7.3 @param()æ³¨è§£</h2><p>@Paramæ³¨è§£ç”¨äºç»™æ–¹æ³•å‚æ•°èµ·ä¸€ä¸ªåå­—ã€‚ä»¥ä¸‹æ˜¯æ€»ç»“çš„ä½¿ç”¨åŸåˆ™ï¼š</p><ul><li>åœ¨æ–¹æ³•åªæ¥å—ä¸€ä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸ä½¿ç”¨@Paramã€‚</li><li>åœ¨æ–¹æ³•æ¥å—å¤šä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œå»ºè®®ä¸€å®šè¦ä½¿ç”¨@Paramæ³¨è§£ç»™å‚æ•°å‘½åã€‚</li><li>å¦‚æœå‚æ•°æ˜¯ JavaBean ï¼Œ åˆ™ä¸èƒ½ä½¿ç”¨@Paramã€‚</li><li>ä¸ä½¿ç”¨@Paramæ³¨è§£æ—¶ï¼Œå‚æ•°åªèƒ½æœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”æ˜¯Javabeanã€‚</li></ul><h2 id="7-4-ä¸-çš„åŒºåˆ«"><a href="#7-4-ä¸-çš„åŒºåˆ«" class="headerlink" title="7.4 #ä¸$çš„åŒºåˆ«"></a>7.4 #ä¸$çš„åŒºåˆ«</h2><ul><li><p>#{} çš„ä½œç”¨ä¸»è¦æ˜¯æ›¿æ¢é¢„ç¼–è¯‘è¯­å¥(PrepareStatement)ä¸­çš„å ä½ç¬¦? ã€æ¨èä½¿ç”¨ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">INSERT INTO <span class="hljs-title">user</span> <span class="hljs-params">(name)</span> <span class="hljs-title">VALUES</span> <span class="hljs-params">(#&#123;name&#125;)</span></span>;<br><span class="hljs-function">INSERT INTO <span class="hljs-title">user</span> <span class="hljs-params">(name)</span> <span class="hljs-title">VALUES</span> <span class="hljs-params">(?)</span></span>;<br></code></pre></td></tr></table></figure></li><li><p>${} çš„ä½œç”¨æ˜¯ç›´æ¥è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">INSERT INTO <span class="hljs-title">user</span> <span class="hljs-params">(name)</span> <span class="hljs-title">VALUES</span> <span class="hljs-params">(<span class="hljs-string">&#x27;$&#123;name&#125;&#x27;</span>)</span></span>;<br><span class="hljs-function">INSERT INTO <span class="hljs-title">user</span> <span class="hljs-params">(name)</span> <span class="hljs-title">VALUES</span> <span class="hljs-params">(<span class="hljs-string">&#x27;kuangshen&#x27;</span>)</span></span>;<br></code></pre></td></tr></table></figure></li></ul><blockquote><p>ä½¿ç”¨æ³¨è§£å’Œé…ç½®æ–‡ä»¶ååŒå¼€å‘ï¼Œæ‰æ˜¯MyBatisçš„æœ€ä½³å®è·µï¼    </p></blockquote><ul><li>å»¶ç”³<ul><li>${}æ–¹å¼æ— æ³•é˜²æ­¢sqlæ³¨å…¥</li><li>$ä¸€èˆ¬ç”¨äºä¼ å…¥æ•°æ®åº“å¯¹è±¡æ¯”å¦‚æ•°æ®åº“è¡¨å</li><li>å°½é‡ä½¿ç”¨#{}</li></ul></li></ul><h1 id="å…«ã€å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š"><a href="#å…«ã€å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š" class="headerlink" title="å…«ã€å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š"></a>å…«ã€å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š</h1><h2 id="8-1-å¤šå¯¹ä¸€çš„å¤„ç†"><a href="#8-1-å¤šå¯¹ä¸€çš„å¤„ç†" class="headerlink" title="8.1 å¤šå¯¹ä¸€çš„å¤„ç†"></a>8.1 å¤šå¯¹ä¸€çš„å¤„ç†</h2><p>å¤šå¯¹ä¸€çš„ç†è§£ï¼š</p><ul><li>å¤šä¸ªå­¦ç”Ÿå¯¹åº”ä¸€ä¸ªè€å¸ˆ</li><li>å¦‚æœå¯¹äºå­¦ç”Ÿè¿™è¾¹ï¼Œå°±æ˜¯ä¸€ä¸ªå¤šå¯¹ä¸€çš„ç°è±¡ï¼Œå³ä»å­¦ç”Ÿè¿™è¾¹å…³è”ä¸€ä¸ªè€å¸ˆï¼</li></ul><h3 id="8-1-1-æ•°æ®åº“è®¾è®¡"><a href="#8-1-1-æ•°æ®åº“è®¾è®¡" class="headerlink" title="8.1.1 æ•°æ®åº“è®¾è®¡"></a>8.1.1 æ•°æ®åº“è®¾è®¡</h3><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/643.png" alt="å›¾ç‰‡"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">USE</span> <span class="hljs-string">`mybatis`</span>;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`teacher`</span> (<br><span class="hljs-string">`id`</span> <span class="hljs-built_in">INT</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<br><span class="hljs-string">`name`</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<br>PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`id`</span>)<br>) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">INNODB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> teacher(<span class="hljs-string">`id`</span>, <span class="hljs-string">`name`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ç§¦è€å¸ˆ&#x27;</span>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`student`</span> (<br><span class="hljs-string">`id`</span> <span class="hljs-built_in">INT</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,<br><span class="hljs-string">`name`</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<br><span class="hljs-string">`tid`</span> <span class="hljs-built_in">INT</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">NULL</span>,<br>PRIMARY <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`id`</span>),<br><span class="hljs-keyword">KEY</span> <span class="hljs-string">`fktid`</span> (<span class="hljs-string">`tid`</span>),<br><span class="hljs-keyword">CONSTRAINT</span> <span class="hljs-string">`fktid`</span> <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`tid`</span>) <span class="hljs-keyword">REFERENCES</span> <span class="hljs-string">`teacher`</span> (<span class="hljs-string">`id`</span>)<br>) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">INNODB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8<br><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`student`</span> (<span class="hljs-string">`id`</span>, <span class="hljs-string">`name`</span>, <span class="hljs-string">`tid`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;å°æ˜&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`student`</span> (<span class="hljs-string">`id`</span>, <span class="hljs-string">`name`</span>, <span class="hljs-string">`tid`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;å°çº¢&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`student`</span> (<span class="hljs-string">`id`</span>, <span class="hljs-string">`name`</span>, <span class="hljs-string">`tid`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;å°å¼ &#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`student`</span> (<span class="hljs-string">`id`</span>, <span class="hljs-string">`name`</span>, <span class="hljs-string">`tid`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;å°æ&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-string">`student`</span> (<span class="hljs-string">`id`</span>, <span class="hljs-string">`name`</span>, <span class="hljs-string">`tid`</span>) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;5&#x27;</span>, <span class="hljs-string">&#x27;å°ç‹&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>);<br></code></pre></td></tr></table></figure><h3 id="8-1-2-æ­å»ºæµ‹è¯•ç¯å¢ƒ"><a href="#8-1-2-æ­å»ºæµ‹è¯•ç¯å¢ƒ" class="headerlink" title="8.1.2 æ­å»ºæµ‹è¯•ç¯å¢ƒ"></a>8.1.2 æ­å»ºæµ‹è¯•ç¯å¢ƒ</h3><p>1ã€IDEAå®‰è£…Lombokæ’ä»¶</p><p>2ã€å¼•å…¥Mavenä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€åœ¨ä»£ç ä¸­å¢åŠ æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span> <span class="hljs-comment">//GET,SET,ToStringï¼Œæœ‰å‚ï¼Œæ— å‚æ„é€ </span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Teacher</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br>   <span class="hljs-keyword">private</span> String name;<br>&#125;<br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br>   <span class="hljs-keyword">private</span> String name;<br>   <span class="hljs-comment">//å¤šä¸ªå­¦ç”Ÿå¯ä»¥æ˜¯åŒä¸€ä¸ªè€å¸ˆï¼Œå³å¤šå¯¹ä¸€</span><br>   <span class="hljs-keyword">private</span> Teacher teacher;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€ç¼–å†™å®ä½“ç±»å¯¹åº”çš„Mapperæ¥å£ ã€ä¸¤ä¸ªã€‘</p><ul><li><strong>æ— è®ºæœ‰æ²¡æœ‰éœ€æ±‚ï¼Œéƒ½åº”è¯¥å†™ä¸Šï¼Œä»¥å¤‡åæ¥ä¹‹éœ€ï¼</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StudentMapper</span> </span>&#123;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TeacherMapper</span> </span>&#123;<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€ç¼–å†™Mapperæ¥å£å¯¹åº”çš„ mapper.xmlé…ç½®æ–‡ä»¶ ã€ä¸¤ä¸ªã€‘</p><ul><li><strong>æ— è®ºæœ‰æ²¡æœ‰éœ€æ±‚ï¼Œéƒ½åº”è¯¥å†™ä¸Šï¼Œä»¥å¤‡åæ¥ä¹‹éœ€ï¼</strong></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.kuang.mapper.StudentMapper&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">       <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="hljs-meta">       <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.kuang.mapper.TeacherMapper&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨ideaä¸­å»ºç«‹çš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201223180221943.png" alt="image-20201223180221943"></p><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        SqlSession sqlSession = MybatisUtils.getSession();<br>        TeacherMapper mapper = sqlSession.getMapper(TeacherMapper.class);<br>        Teacher teacher = mapper.getTeacher(<span class="hljs-number">1</span>);<br>        System.out.println(teacher);<br><br>        sqlSession.close();<br>    &#125; <br></code></pre></td></tr></table></figure><h3 id="8-1-3-æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#8-1-3-æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="8.1.3 æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>8.1.3 æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span><br><span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span><br><span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-comment">&lt;!--configurationæ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.mc.dao.StudentMapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getStudent&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;StudentTeacher&quot;</span>&gt;</span><br>        select * from student<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">   éœ€æ±‚ï¼šè·å–æ‰€æœ‰å­¦ç”ŸåŠå¯¹åº”è€å¸ˆçš„ä¿¡æ¯</span><br><span class="hljs-comment">   æ€è·¯ï¼š</span><br><span class="hljs-comment">       1. è·å–æ‰€æœ‰å­¦ç”Ÿçš„ä¿¡æ¯</span><br><span class="hljs-comment">       2. æ ¹æ®è·å–çš„å­¦ç”Ÿä¿¡æ¯çš„è€å¸ˆID-&gt;è·å–è¯¥è€å¸ˆçš„ä¿¡æ¯</span><br><span class="hljs-comment">       3. æ€è€ƒé—®é¢˜ï¼Œè¿™æ ·å­¦ç”Ÿçš„ç»“æœé›†ä¸­åº”è¯¥åŒ…å«è€å¸ˆï¼Œè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Œæ•°æ®åº“ä¸­æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨å…³è”æŸ¥è¯¢ï¼Ÿ</span><br><span class="hljs-comment">           1. åšä¸€ä¸ªç»“æœé›†æ˜ å°„ï¼šStudentTeacher</span><br><span class="hljs-comment">           2. StudentTeacherç»“æœé›†çš„ç±»å‹ä¸º Student</span><br><span class="hljs-comment">           3. å­¦ç”Ÿä¸­è€å¸ˆçš„å±æ€§ä¸ºteacherï¼Œå¯¹åº”æ•°æ®åº“ä¸­ä¸ºtidã€‚</span><br><span class="hljs-comment">              å¤šä¸ª [1,...ï¼‰å­¦ç”Ÿå…³è”ä¸€ä¸ªè€å¸ˆ=&gt; ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤š</span><br><span class="hljs-comment">           4. æŸ¥çœ‹å®˜ç½‘æ‰¾åˆ°ï¼šassociation â€“ ä¸€ä¸ªå¤æ‚ç±»å‹çš„å…³è”ï¼›ä½¿ç”¨å®ƒæ¥å¤„ç†å…³è”æŸ¥è¯¢</span><br><span class="hljs-comment">   --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;StudentTeacher&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.mc.pojo.Student&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--        å¤æ‚å±æ€§å•ç‹¬å¤„ç†ï¼Œå¯¹è±¡associationï¼Œé›†åˆcollection--&gt;</span><br><span class="hljs-comment">&lt;!--        property=&quot;teacher&quot;ç±»ä¸­å±æ€§å column=&quot;tid&quot;æ•°æ®åº“ä¸­å±æ€§å--&gt;</span><br><span class="hljs-comment">&lt;!--associationå…³è”å±æ€§ propertyå±æ€§å javaTypeå±æ€§ç±»å‹ columnåœ¨å¤šçš„ä¸€æ–¹çš„è¡¨ä¸­çš„åˆ—å--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teacher&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;com.mc.pojo.Teacher&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;getTeacher&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">   è¿™é‡Œä¼ é€’è¿‡æ¥çš„idï¼Œåªæœ‰ä¸€ä¸ªå±æ€§çš„æ—¶å€™ï¼Œä¸‹é¢å¯ä»¥å†™ä»»ä½•å€¼</span><br><span class="hljs-comment">   associationä¸­columnå¤šå‚æ•°é…ç½®ï¼š</span><br><span class="hljs-comment">       column=&quot;&#123;key=value,key=value&#125;&quot;</span><br><span class="hljs-comment">       å…¶å®å°±æ˜¯é”®å€¼å¯¹çš„å½¢å¼ï¼Œkeyæ˜¯ä¼ ç»™ä¸‹ä¸ªsqlçš„å–å€¼åç§°ï¼Œvalueæ˜¯ç‰‡æ®µä¸€ä¸­sqlæŸ¥è¯¢çš„å­—æ®µåã€‚</span><br><span class="hljs-comment">   --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getTeacher&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.mc.pojo.Teacher&quot;</span>&gt;</span><br>        select * from teacher where id = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testStudent</span><span class="hljs-params">()</span></span>&#123;<br>      SqlSession sqlSession = MybatisUtils.getSession();<br>      StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);<br>      List&lt;Student&gt; student = mapper.getStudent();<br>      <span class="hljs-keyword">for</span> (Student student1 : student) &#123;<br>          System.out.println(student1);<br>      &#125;<br><br>      sqlSession.close();<br>  &#125;<br><br></code></pre></td></tr></table></figure><p>8.1.4 æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- æŒ‰ç…§æŸ¥è¯¢ç»“æœå¤„ç†   --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getStudent2&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;StudentTeacher2&quot;</span>&gt;</span><br>        select s.id sid,s.name sname,t.name tname<br>        from student s, teacher t<br>        where s.tid = t.id;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;StudentTeacher2&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.mc.pojo.Student&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sid&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sname&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!--å…³è”å¯¹è±¡property å…³è”å¯¹è±¡åœ¨Studentå®ä½“ç±»ä¸­çš„å±æ€§--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teacher&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;com.mc.pojo.Teacher&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tname&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testStudent2</span><span class="hljs-params">()</span></span>&#123;<br>    SqlSession sqlSession = MybatisUtils.getSession();<br>    StudentMapper mapper = sqlSession.getMapper(StudentMapper.class);<br>    List&lt;Student&gt; student = mapper.getStudent2();<br>    <span class="hljs-keyword">for</span> (Student student1 : student) &#123;<br>        System.out.println(student1);<br>    &#125;<br><br>    sqlSession.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="8-2-ä¸€å¯¹å¤šçš„å¤„ç†"><a href="#8-2-ä¸€å¯¹å¤šçš„å¤„ç†" class="headerlink" title="8.2 ä¸€å¯¹å¤šçš„å¤„ç†"></a>8.2 ä¸€å¯¹å¤šçš„å¤„ç†</h2><p>ä¸€å¯¹å¤šçš„ç†è§£ï¼š</p><ul><li>ä¸€ä¸ªè€å¸ˆæ‹¥æœ‰å¤šä¸ªå­¦ç”Ÿ</li><li>å¦‚æœå¯¹äºè€å¸ˆè¿™è¾¹ï¼Œå°±æ˜¯ä¸€ä¸ªä¸€å¯¹å¤šçš„ç°è±¡ï¼Œå³ä»ä¸€ä¸ªè€å¸ˆä¸‹é¢æ‹¥æœ‰ä¸€ç¾¤å­¦ç”Ÿï¼ˆé›†åˆï¼‰ï¼</li></ul><blockquote><p>å®ä½“ç±»ç¼–å†™</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br>   <span class="hljs-keyword">private</span> String name;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> tid;<br>&#125;<br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Teacher</span> </span>&#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;<br>   <span class="hljs-keyword">private</span> String name;<br>   <span class="hljs-comment">//ä¸€ä¸ªè€å¸ˆå¤šä¸ªå­¦ç”Ÿ</span><br>   <span class="hljs-keyword">private</span> List&lt;Student&gt; students;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€¦.. å’Œä¹‹å‰ä¸€æ ·ï¼Œæ­å»ºæµ‹è¯•çš„ç¯å¢ƒï¼</p><h3 id="8-2-1-æŒ‰ç»“æœåµŒå¥—å¤„ç†"><a href="#8-2-1-æŒ‰ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="8.2.1 æŒ‰ç»“æœåµŒå¥—å¤„ç†"></a>8.2.1 æŒ‰ç»“æœåµŒå¥—å¤„ç†</h3><p>1ã€TeacherMapperæ¥å£ç¼–å†™æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è·å–æŒ‡å®šè€å¸ˆï¼ŒåŠè€å¸ˆä¸‹çš„æ‰€æœ‰å­¦ç”Ÿ</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Teacher <span class="hljs-title">getTeacher</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™æ¥å£å¯¹åº”çš„Mapperé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.mc.mapper.TeacherMapper&quot;</span>&gt;</span><br><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">   æ€è·¯:</span><br><span class="hljs-comment">       1. ä»å­¦ç”Ÿè¡¨å’Œè€å¸ˆè¡¨ä¸­æŸ¥å‡ºå­¦ç”Ÿidï¼Œå­¦ç”Ÿå§“åï¼Œè€å¸ˆå§“å</span><br><span class="hljs-comment">       2. å¯¹æŸ¥è¯¢å‡ºæ¥çš„æ“ä½œåšç»“æœé›†æ˜ å°„</span><br><span class="hljs-comment">           1. é›†åˆçš„è¯ï¼Œä½¿ç”¨collectionï¼</span><br><span class="hljs-comment">               JavaTypeå’ŒofTypeéƒ½æ˜¯ç”¨æ¥æŒ‡å®šå¯¹è±¡ç±»å‹çš„</span><br><span class="hljs-comment">               JavaTypeæ˜¯ç”¨æ¥æŒ‡å®špojoä¸­å±æ€§çš„ç±»å‹</span><br><span class="hljs-comment">               ofTypeæŒ‡å®šçš„æ˜¯æ˜ å°„åˆ°listé›†åˆå±æ€§ä¸­pojoçš„ç±»å‹ã€‚</span><br><span class="hljs-comment">   --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getTeacher&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;TeacherStudent&quot;</span>&gt;</span><br>      select s.id sid, s.name sname , t.name tname, t.id tid<br>      from student s,teacher t<br>      where s.tid = t.id and t.id=#&#123;id&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;TeacherStudent&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.mc.pojo.Teacher&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">result</span>  <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tname&quot;</span>/&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;students&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;com.mc.pojo.Student&quot;</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sid&quot;</span> /&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sname&quot;</span> /&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;tid&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span> /&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€å°†Mapperæ–‡ä»¶æ³¨å†Œåˆ°MyBatis-configæ–‡ä»¶ä¸­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;mapper/TeacherMapper.xml&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testGetTeacher</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   TeacherMapper mapper = session.getMapper(TeacherMapper.class);<br>   Teacher teacher = mapper.getTeacher(<span class="hljs-number">1</span>);<br>   System.out.println(teacher.getName());<br>   System.out.println(teacher.getStudents());<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="8-2-2-æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#8-2-2-æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="8.2.2 æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>8.2.2 æŒ‰æŸ¥è¯¢åµŒå¥—å¤„ç†</h3><p>1ã€TeacherMapperæ¥å£ç¼–å†™æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> Teacher <span class="hljs-title">getTeacher2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™æ¥å£å¯¹åº”çš„Mapperé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getTeacher2&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;TeacherStudent2&quot;</span>&gt;</span><br>select * from teacher where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;TeacherStudent2&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.mc.pojo.Teacher&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--columnæ˜¯ä¸€å¯¹å¤šçš„å¤–é”® , å†™çš„æ˜¯ä¸€çš„ä¸»é”®çš„åˆ—å--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;students&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;ArrayList&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;com.mc.pojo.Student&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;getStudentByTeacherId&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getStudentByTeacherId&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Student&quot;</span>&gt;</span><br>  select * from student where tid = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€å°†Mapperæ–‡ä»¶æ³¨å†Œåˆ°MyBatis-configæ–‡ä»¶ä¸­</p><p>4ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testGetTeacher2</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   TeacherMapper mapper = session.getMapper(TeacherMapper.class);<br>   Teacher teacher = mapper.getTeacher2(<span class="hljs-number">1</span>);<br>   System.out.println(teacher.getName());<br>   System.out.println(teacher.getStudents());<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="8-3-å°ç»“"><a href="#8-3-å°ç»“" class="headerlink" title="8.3 å°ç»“"></a>8.3 å°ç»“</h2><p>1ã€å…³è”-association</p><p>2ã€é›†åˆ-collection</p><p>3ã€æ‰€ä»¥associationæ˜¯ç”¨äºä¸€å¯¹ä¸€å’Œå¤šå¯¹ä¸€ï¼Œè€Œcollectionæ˜¯ç”¨äºä¸€å¯¹å¤šçš„å…³ç³»</p><p>4ã€JavaTypeå’ŒofTypeéƒ½æ˜¯ç”¨æ¥æŒ‡å®šå¯¹è±¡ç±»å‹çš„</p><ul><li>JavaTypeæ˜¯ç”¨æ¥æŒ‡å®špojoä¸­å±æ€§çš„ç±»å‹</li><li>ofTypeæŒ‡å®šçš„æ˜¯æ˜ å°„åˆ°listé›†åˆå±æ€§ä¸­pojoçš„ç±»å‹ã€‚</li></ul><p><strong>æ³¨æ„è¯´æ˜ï¼š</strong></p><p>1ã€ä¿è¯SQLçš„å¯è¯»æ€§ï¼Œå°½é‡é€šä¿—æ˜“æ‡‚</p><p>2ã€æ ¹æ®å®é™…è¦æ±‚ï¼Œå°½é‡ç¼–å†™æ€§èƒ½æ›´é«˜çš„SQLè¯­å¥</p><p>3ã€æ³¨æ„å±æ€§åå’Œå­—æ®µä¸ä¸€è‡´çš„é—®é¢˜</p><p>4ã€æ³¨æ„ä¸€å¯¹å¤šå’Œå¤šå¯¹ä¸€ ä¸­ï¼šå­—æ®µå’Œå±æ€§å¯¹åº”çš„é—®é¢˜</p><p>5ã€å°½é‡ä½¿ç”¨Log4jï¼Œé€šè¿‡æ—¥å¿—æ¥æŸ¥çœ‹è‡ªå·±çš„é”™è¯¯</p><blockquote><p>é¢è¯•é«˜é¢‘ï¼šMysqlå¼•æ“ã€InnoDBåº•å±‚åŸç†ã€ç´¢å¼•ã€ç´¢å¼•ä¼˜åŒ–</p></blockquote><h1 id="ä¹ã€åŠ¨æ€SQL"><a href="#ä¹ã€åŠ¨æ€SQL" class="headerlink" title="ä¹ã€åŠ¨æ€SQL"></a>ä¹ã€åŠ¨æ€SQL</h1><p>ä»€ä¹ˆæ˜¯åŠ¨æ€SQLï¼š<strong>åŠ¨æ€SQLæŒ‡çš„æ˜¯æ ¹æ®ä¸åŒçš„æŸ¥è¯¢æ¡ä»¶ , ç”Ÿæˆä¸åŒçš„Sqlè¯­å¥.</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">å®˜ç½‘æè¿°ï¼š<br>MyBatis çš„å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€ä¾¿æ˜¯å®ƒçš„åŠ¨æ€ <span class="hljs-keyword">SQL</span>ã€‚å¦‚æœä½ æœ‰ä½¿ç”¨ JDBC æˆ–å…¶å®ƒç±»ä¼¼æ¡†æ¶çš„ç»éªŒï¼Œä½ å°±èƒ½ä½“ä¼šåˆ°æ ¹æ®ä¸åŒæ¡ä»¶æ‹¼æ¥ <span class="hljs-keyword">SQL</span> è¯­å¥çš„ç—›è‹¦ã€‚ä¾‹å¦‚æ‹¼æ¥æ—¶è¦ç¡®ä¿ä¸èƒ½å¿˜è®°æ·»åŠ å¿…è¦çš„ç©ºæ ¼ï¼Œè¿˜è¦æ³¨æ„å»æ‰åˆ—è¡¨æœ€åä¸€ä¸ªåˆ—åçš„é€—å·ã€‚åˆ©ç”¨åŠ¨æ€ <span class="hljs-keyword">SQL</span> è¿™ä¸€ç‰¹æ€§å¯ä»¥å½»åº•æ‘†è„±è¿™ç§ç—›è‹¦ã€‚<br>è™½ç„¶åœ¨ä»¥å‰ä½¿ç”¨åŠ¨æ€ <span class="hljs-keyword">SQL</span> å¹¶éä¸€ä»¶æ˜“äº‹ï¼Œä½†æ­£æ˜¯ MyBatis æä¾›äº†å¯ä»¥è¢«ç”¨åœ¨ä»»æ„ <span class="hljs-keyword">SQL</span> æ˜ å°„è¯­å¥ä¸­çš„å¼ºå¤§çš„åŠ¨æ€ <span class="hljs-keyword">SQL</span> è¯­è¨€å¾—ä»¥æ”¹è¿›è¿™ç§æƒ…å½¢ã€‚<br>åŠ¨æ€ <span class="hljs-keyword">SQL</span> å…ƒç´ å’Œ JSTL æˆ–åŸºäºç±»ä¼¼ <span class="hljs-type">XML</span> çš„æ–‡æœ¬å¤„ç†å™¨ç›¸ä¼¼ã€‚åœ¨ MyBatis ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæœ‰å¾ˆå¤šå…ƒç´ éœ€è¦èŠ±æ—¶é—´äº†è§£ã€‚MyBatis <span class="hljs-number">3</span> å¤§å¤§ç²¾ç®€äº†å…ƒç´ ç§ç±»ï¼Œç°åœ¨åªéœ€å­¦ä¹ åŸæ¥ä¸€åŠçš„å…ƒç´ ä¾¿å¯ã€‚MyBatis é‡‡ç”¨åŠŸèƒ½å¼ºå¤§çš„åŸºäº OGNL çš„è¡¨è¾¾å¼æ¥æ·˜æ±°å…¶å®ƒå¤§éƒ¨åˆ†å…ƒç´ ã€‚<br><br>  <span class="hljs-comment">-------------------------------</span><br>  - <span class="hljs-keyword">if</span><br>  - choose (<span class="hljs-keyword">when</span>, otherwise)<br>  - trim (<span class="hljs-keyword">where</span>, <span class="hljs-keyword">set</span>)<br>  - <span class="hljs-keyword">foreach</span><br>  <span class="hljs-comment">-------------------------------</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹‹å‰å†™çš„ SQL è¯­å¥éƒ½æ¯”è¾ƒç®€å•ï¼Œå¦‚æœæœ‰æ¯”è¾ƒå¤æ‚çš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å†™å¤æ‚çš„ SQL è¯­å¥ï¼Œå¾€å¾€éœ€è¦æ‹¼æ¥ï¼Œè€Œæ‹¼æ¥ SQL ï¼Œç¨å¾®ä¸æ³¨æ„ï¼Œç”±äºå¼•å·ï¼Œç©ºæ ¼ç­‰ç¼ºå¤±å¯èƒ½éƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆå»è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿè¿™å°±è¦ä½¿ç”¨ mybatis åŠ¨æ€SQLï¼Œé€šè¿‡ if, choose, when, otherwise, trim, where, set, foreachç­‰æ ‡ç­¾ï¼Œå¯ç»„åˆæˆéå¸¸çµæ´»çš„SQLè¯­å¥ï¼Œä»è€Œåœ¨æé«˜ SQL è¯­å¥çš„å‡†ç¡®æ€§çš„åŒæ—¶ï¼Œä¹Ÿå¤§å¤§æé«˜äº†å¼€å‘äººå‘˜çš„æ•ˆç‡ã€‚</p><h2 id="9-1-æ­å»ºç¯å¢ƒ"><a href="#9-1-æ­å»ºç¯å¢ƒ" class="headerlink" title="9.1 æ­å»ºç¯å¢ƒ"></a>9.1 æ­å»ºç¯å¢ƒ</h2><p><strong>æ–°å»ºä¸€ä¸ªæ•°æ®åº“è¡¨ï¼šblog</strong></p><p>å­—æ®µï¼šidï¼Œtitleï¼Œauthorï¼Œcreate_timeï¼Œviews</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`blog`</span> (<br><span class="hljs-string">`id`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;åšå®¢id&#x27;</span>,<br><span class="hljs-string">`title`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;åšå®¢æ ‡é¢˜&#x27;</span>,<br><span class="hljs-string">`author`</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;åšå®¢ä½œè€…&#x27;</span>,<br><span class="hljs-string">`create_time`</span> datetime <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,<br><span class="hljs-string">`views`</span> <span class="hljs-built_in">int</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">COMMENT</span> <span class="hljs-string">&#x27;æµè§ˆé‡&#x27;</span><br>) <span class="hljs-keyword">ENGINE</span>=<span class="hljs-keyword">InnoDB</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">CHARSET</span>=utf8<br></code></pre></td></tr></table></figure><p>1ã€åˆ›å»ºMybatisåŸºç¡€å·¥ç¨‹</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/640" alt="å›¾ç‰‡"></p><p>2ã€IDutilå·¥å…·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IDUtil</span> </span>&#123;<br><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">genId</span><span class="hljs-params">()</span></span>&#123;<br>       <span class="hljs-keyword">return</span> UUID.randomUUID().toString().replaceAll(<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;&quot;</span>);<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>3ã€å®ä½“ç±»ç¼–å†™  ã€æ³¨æ„setæ–¹æ³•ä½œç”¨ã€‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mc.pojo;<br><br><span class="hljs-keyword">import</span> lombok.Data;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><span class="hljs-meta">@Data</span><br><span class="hljs-comment">//åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å¯ä»¥è§£å†³ä½¿ç”¨é©¼å³°å‘½åå’Œæ•°æ®åº“å­—æ®µä¸ä¸€è‡´é—®é¢˜</span><br><span class="hljs-comment">// &lt;settings&gt;</span><br><span class="hljs-comment">//     &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;</span><br><span class="hljs-comment">// &lt;/settings&gt;</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Blog</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String id;<br>    <span class="hljs-keyword">private</span> String title;<br>    <span class="hljs-keyword">private</span> String author;<br>    <span class="hljs-keyword">private</span> Date createTime;<span class="hljs-comment">//å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´create_time</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> views;<br>&#125;<br></code></pre></td></tr></table></figure><p>4ã€ç¼–å†™Mapperæ¥å£åŠxmlæ–‡ä»¶</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BlogMapper</span> </span>&#123;<br>&#125;<br>&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;<br>&lt;!DOCTYPE mapper<br>       PUBLIC <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br>       <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;<br>&lt;mapper namespace=<span class="hljs-string">&quot;com.kuang.mapper.BlogMapper&quot;</span>&gt;<br><br>&lt;/mapper&gt;<br></code></pre></td></tr></table></figure><p>5ã€mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œä¸‹åˆ’çº¿é©¼å³°è‡ªåŠ¨è½¬æ¢</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span><br><span class="hljs-comment">&lt;!--æ³¨å†ŒMapper.xml--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;mapper/BlogMapper.xml&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span><br></code></pre></td></tr></table></figure><p>6ã€æ’å…¥åˆå§‹æ•°æ®</p><p>ç¼–å†™æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ–°å¢ä¸€ä¸ªåšå®¢</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addBlog</span><span class="hljs-params">(Blog blog)</span></span>;<br></code></pre></td></tr></table></figure><p>sqlé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addBlog&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;blog&quot;</span>&gt;</span><br>  insert into blog (id, title, author, create_time, views)<br>  values (#&#123;id&#125;,#&#123;title&#125;,#&#123;author&#125;,#&#123;createTime&#125;,#&#123;views&#125;);<br><span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åˆå§‹åŒ–åšå®¢æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.mc.dao.BlogMapper;<br><span class="hljs-keyword">import</span> com.mc.pojo.Blog;<br><span class="hljs-keyword">import</span> com.mc.utils.IDutils;<br><span class="hljs-keyword">import</span> com.mc.utils.MybatisUtils;<br><span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;<br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mytast</span> </span>&#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInitBlog</span><span class="hljs-params">()</span></span>&#123;<br>        SqlSession session = MybatisUtils.getSession();<br>        BlogMapper mapper = session.getMapper(BlogMapper.class);<br><br>        Blog blog = <span class="hljs-keyword">new</span> Blog();<br>        blog.setId(IDutils.getId());<br>        blog.setTitle(<span class="hljs-string">&quot;Mybatiså¦‚æ­¤ç®€å•&quot;</span>);<br>        blog.setAuthor(<span class="hljs-string">&quot;ç‹‚ç¥è¯´&quot;</span>);<br>        blog.setCreateTime(<span class="hljs-keyword">new</span> Date());<br>        blog.setViews(<span class="hljs-number">9999</span>);<br><br>        mapper.addBlog(blog);<br><br>        blog.setId(IDutils.getId());<br>        blog.setTitle(<span class="hljs-string">&quot;Javaå¦‚æ­¤ç®€å•&quot;</span>);<br>        mapper.addBlog(blog);<br><br>        blog.setId(IDutils.getId());<br>        blog.setTitle(<span class="hljs-string">&quot;Springå¦‚æ­¤ç®€å•&quot;</span>);<br>        mapper.addBlog(blog);<br><br>        blog.setId(IDutils.getId());<br>        blog.setTitle(<span class="hljs-string">&quot;å¾®æœåŠ¡å¦‚æ­¤ç®€å•&quot;</span>);<br>        mapper.addBlog(blog);<br><br>        session.commit();<br>        session.close();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åˆå§‹åŒ–æ•°æ®å®Œæ¯•ï¼</p><h3 id="ã€è§£å†³Javaé©¼å³°å‘½åå’Œæ•°æ®åº“å­—æ®µåå†²çªã€‘"><a href="#ã€è§£å†³Javaé©¼å³°å‘½åå’Œæ•°æ®åº“å­—æ®µåå†²çªã€‘" class="headerlink" title="ã€è§£å†³Javaé©¼å³°å‘½åå’Œæ•°æ®åº“å­—æ®µåå†²çªã€‘"></a>ã€è§£å†³Javaé©¼å³°å‘½åå’Œæ•°æ®åº“å­—æ®µåå†²çªã€‘</h3><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/image-20201226122100698.png" alt="image-20201226122100698"></p><h3 id="ã€è‡ªåŠ¨ç”ŸæˆIDã€‘"><a href="#ã€è‡ªåŠ¨ç”ŸæˆIDã€‘" class="headerlink" title="ã€è‡ªåŠ¨ç”ŸæˆIDã€‘"></a>ã€è‡ªåŠ¨ç”ŸæˆIDã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//éšæœºç”Ÿäº§ID,å°†IDä¸­æ‰€æœ‰-å»æ‰</span><br>       <span class="hljs-keyword">return</span> UUID.randomUUID().toString().replaceAll(<span class="hljs-string">&quot;-&quot;</span>,<span class="hljs-string">&quot;&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="9-2-f-è¯­å¥"><a href="#9-2-f-è¯­å¥" class="headerlink" title="9.2 f è¯­å¥"></a>9.2 f è¯­å¥</h2><p><strong>éœ€æ±‚ï¼šæ ¹æ®ä½œè€…åå­—å’Œåšå®¢åå­—æ¥æŸ¥è¯¢åšå®¢ï¼å¦‚æœä½œè€…åå­—ä¸ºç©ºï¼Œé‚£ä¹ˆåªæ ¹æ®åšå®¢åå­—æŸ¥è¯¢ï¼Œåä¹‹ï¼Œåˆ™æ ¹æ®ä½œè€…åæ¥æŸ¥è¯¢</strong></p><p>1ã€ç¼–å†™æ¥å£ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//éœ€æ±‚1</span><br><span class="hljs-function">List&lt;Blog&gt; <span class="hljs-title">queryBlogIf</span><span class="hljs-params">(Map map)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™SQLè¯­å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--éœ€æ±‚1ï¼š</span><br><span class="hljs-comment">æ ¹æ®ä½œè€…åå­—å’Œåšå®¢åå­—æ¥æŸ¥è¯¢åšå®¢ï¼</span><br><span class="hljs-comment">å¦‚æœä½œè€…åå­—ä¸ºç©ºï¼Œé‚£ä¹ˆåªæ ¹æ®åšå®¢åå­—æŸ¥è¯¢ï¼Œåä¹‹ï¼Œåˆ™æ ¹æ®ä½œè€…åæ¥æŸ¥è¯¢</span><br><span class="hljs-comment">select * from blog where title = #&#123;title&#125; and author = #&#123;author&#125;</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogIf&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;blog&quot;</span>&gt;</span><br>  select * from blog where<br>   <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>      title = #&#123;title&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span><br>      and author = #&#123;author&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryBlogIf</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   BlogMapper mapper = session.getMapper(BlogMapper.class);<br><br>   HashMap&lt;String, String&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, String&gt;();<br>   map.put(<span class="hljs-string">&quot;title&quot;</span>,<span class="hljs-string">&quot;Mybatiså¦‚æ­¤ç®€å•&quot;</span>);<br>   map.put(<span class="hljs-string">&quot;author&quot;</span>,<span class="hljs-string">&quot;ç‹‚ç¥è¯´&quot;</span>);<br>   List&lt;Blog&gt; blogs = mapper.queryBlogIf(map);<br><br>   System.out.println(blogs);<br>java<br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·å†™æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœ author ç­‰äº nullï¼Œé‚£ä¹ˆæŸ¥è¯¢è¯­å¥ä¸º select * from user where title=#{title},ä½†æ˜¯å¦‚æœtitleä¸ºç©ºå‘¢ï¼Ÿé‚£ä¹ˆæŸ¥è¯¢è¯­å¥ä¸º select * from user where and author=#{author}ï¼Œè¿™æ˜¯é”™è¯¯çš„ SQL è¯­å¥ï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢çš„ where è¯­å¥ï¼</p><h2 id="9-3-Where"><a href="#9-3-Where" class="headerlink" title="9.3 Where"></a>9.3 Where</h2><p>ä¿®æ”¹ä¸Šé¢çš„SQLè¯­å¥ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogIf&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;blog&quot;</span>&gt;</span><br>  select * from blog<br>   <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>          title = #&#123;title&#125;<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span><br>          and author = #&#123;author&#125;<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªâ€œwhereâ€æ ‡ç­¾ä¼šçŸ¥é“å¦‚æœå®ƒåŒ…å«çš„æ ‡ç­¾ä¸­æœ‰è¿”å›å€¼çš„è¯ï¼Œå®ƒå°±æ’å…¥ä¸€ä¸ªâ€˜whereâ€™ã€‚æ­¤å¤–ï¼Œå¦‚æœæ ‡ç­¾è¿”å›çš„å†…å®¹æ˜¯ä»¥AND æˆ–OR å¼€å¤´çš„ï¼Œåˆ™å®ƒä¼šå‰”é™¤æ‰ã€‚</p><h2 id="9-3-Set"><a href="#9-3-Set" class="headerlink" title="9.3 Set"></a>9.3 Set</h2><p>åŒç†ï¼Œä¸Šé¢çš„å¯¹äºæŸ¥è¯¢ SQL è¯­å¥åŒ…å« where å…³é”®å­—ï¼Œå¦‚æœåœ¨è¿›è¡Œæ›´æ–°æ“ä½œçš„æ—¶å€™ï¼Œå«æœ‰ set å…³é”®è¯ï¼Œæˆ‘ä»¬æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateBlog</span><span class="hljs-params">(Map map)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€sqlé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æ³¨æ„setæ˜¯ç”¨çš„é€—å·éš”å¼€--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateBlog&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><br>  update blog<br>     <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>            title = #&#123;title&#125;,<br>         <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span><br>            author = #&#123;author&#125;<br>         <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span><br>  where id = #&#123;id&#125;;<br><span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testUpdateBlog</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   BlogMapper mapper = session.getMapper(BlogMapper.class);<br><br>   HashMap&lt;String, String&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, String&gt;();<br>   map.put(<span class="hljs-string">&quot;title&quot;</span>,<span class="hljs-string">&quot;åŠ¨æ€SQL&quot;</span>);<br>   map.put(<span class="hljs-string">&quot;author&quot;</span>,<span class="hljs-string">&quot;ç§¦ç–†&quot;</span>);<br>   map.put(<span class="hljs-string">&quot;id&quot;</span>,<span class="hljs-string">&quot;9d6a763f5e1347cebda43e2a32687a77&quot;</span>);<br><br>   mapper.updateBlog(map);<br><br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-4-chooseè¯­å¥"><a href="#9-4-chooseè¯­å¥" class="headerlink" title="9.4 chooseè¯­å¥"></a>9.4 chooseè¯­å¥</h2><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨åˆ°æ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶ï¼Œåªæƒ³é€‰æ‹©å…¶ä¸­çš„ä¸€ä¸ªï¼ŒæŸ¥è¯¢æ¡ä»¶æœ‰ä¸€ä¸ªæ»¡è¶³å³å¯ï¼Œä½¿ç”¨ choose æ ‡ç­¾å¯ä»¥è§£å†³æ­¤ç±»é—®é¢˜ï¼Œç±»ä¼¼äº Java çš„ switch è¯­å¥</p><p>1ã€ç¼–å†™æ¥å£æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">List&lt;Blog&gt; <span class="hljs-title">queryBlogChoose</span><span class="hljs-params">(Map map)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€sqlé…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogChoose&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;blog&quot;</span>&gt;</span><br>  select * from blog<br>   <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">choose</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>                title = #&#123;title&#125;<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span><br>              and author = #&#123;author&#125;<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">otherwise</span>&gt;</span><br>              and views = #&#123;views&#125;<br>           <span class="hljs-tag">&lt;/<span class="hljs-name">otherwise</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">choose</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryBlogChoose</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   BlogMapper mapper = session.getMapper(BlogMapper.class);<br><br>   HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;();<br>   map.put(<span class="hljs-string">&quot;title&quot;</span>,<span class="hljs-string">&quot;Javaå¦‚æ­¤ç®€å•&quot;</span>);<br>   map.put(<span class="hljs-string">&quot;author&quot;</span>,<span class="hljs-string">&quot;ç‹‚ç¥è¯´&quot;</span>);<br>   map.put(<span class="hljs-string">&quot;views&quot;</span>,<span class="hljs-number">9999</span>);<br>   List&lt;Blog&gt; blogs = mapper.queryBlogChoose(map);<br><br>   System.out.println(blogs);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-5-SQLç‰‡æ®µ"><a href="#9-5-SQLç‰‡æ®µ" class="headerlink" title="9.5 SQLç‰‡æ®µ"></a>9.5 SQLç‰‡æ®µ</h2><p>æœ‰æ—¶å€™å¯èƒ½æŸä¸ª sql è¯­å¥æˆ‘ä»¬ç”¨çš„ç‰¹åˆ«å¤šï¼Œä¸ºäº†å¢åŠ ä»£ç çš„é‡ç”¨æ€§ï¼Œç®€åŒ–ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›ä»£ç æŠ½å–å‡ºæ¥ï¼Œç„¶åä½¿ç”¨æ—¶ç›´æ¥è°ƒç”¨ã€‚</p><p><strong>æå–SQLç‰‡æ®µï¼š</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">sql</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;if-title-author&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span><br>      title = #&#123;title&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span><br>      and author = #&#123;author&#125;<br>   <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">sql</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>å¼•ç”¨SQLç‰‡æ®µï¼š</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogIf&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;blog&quot;</span>&gt;</span><br>  select * from blog<br>   <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- å¼•ç”¨ sql ç‰‡æ®µï¼Œå¦‚æœrefid æŒ‡å®šçš„ä¸åœ¨æœ¬æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆéœ€è¦åœ¨å‰é¢åŠ ä¸Š namespace --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">refid</span>=<span class="hljs-string">&quot;if-title-author&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span><br>       <span class="hljs-comment">&lt;!-- åœ¨è¿™é‡Œè¿˜å¯ä»¥å¼•ç”¨å…¶ä»–çš„ sql ç‰‡æ®µ --&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼š</p><p>â‘ ã€æœ€å¥½åŸºäº å•è¡¨æ¥å®šä¹‰ sql ç‰‡æ®µï¼Œæé«˜ç‰‡æ®µçš„å¯é‡ç”¨æ€§</p><p>â‘¡ã€åœ¨ sql ç‰‡æ®µä¸­ä¸è¦åŒ…æ‹¬ where</p><h2 id="9-6-Foreach"><a href="#9-6-Foreach" class="headerlink" title="9.6 Foreach"></a>9.6 Foreach</h2><p>å°†æ•°æ®åº“ä¸­å‰ä¸‰ä¸ªæ•°æ®çš„idä¿®æ”¹ä¸º1,2,3ï¼›</p><p>éœ€æ±‚ï¼šæˆ‘ä»¬éœ€è¦æŸ¥è¯¢ blog è¡¨ä¸­ id åˆ†åˆ«ä¸º1,2,3çš„åšå®¢ä¿¡æ¯</p><p>1ã€ç¼–å†™æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function">List&lt;Blog&gt; <span class="hljs-title">queryBlogForeach</span><span class="hljs-params">(Map map)</span></span>;<br></code></pre></td></tr></table></figure><p>2ã€ç¼–å†™SQLè¯­å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogForeach&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;blog&quot;</span>&gt;</span><br>  select * from blog<br>   <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span><br>       <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">       collection:æŒ‡å®šè¾“å…¥å¯¹è±¡ä¸­çš„é›†åˆå±æ€§</span><br><span class="hljs-comment">       item:æ¯æ¬¡éå†ç”Ÿæˆçš„å¯¹è±¡</span><br><span class="hljs-comment">       open:å¼€å§‹éå†æ—¶çš„æ‹¼æ¥å­—ç¬¦ä¸²</span><br><span class="hljs-comment">       close:ç»“æŸæ—¶æ‹¼æ¥çš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment">       separator:éå†å¯¹è±¡ä¹‹é—´éœ€è¦æ‹¼æ¥çš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment">       select * from blog where 1=1 and (id=1 or id=2 or id=3)</span><br><span class="hljs-comment">     --&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;ids&quot;</span>  <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;and (&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;or&quot;</span>&gt;</span><br>          id=#&#123;id&#125;<br>       <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryBlogForeach</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   BlogMapper mapper = session.getMapper(BlogMapper.class);<br><br>   HashMap map = <span class="hljs-keyword">new</span> HashMap();<br>   List&lt;Integer&gt; ids = <span class="hljs-keyword">new</span> ArrayList&lt;Integer&gt;();<br>   ids.add(<span class="hljs-number">1</span>);<br>   ids.add(<span class="hljs-number">2</span>);<br>   ids.add(<span class="hljs-number">3</span>);<br>   map.put(<span class="hljs-string">&quot;ids&quot;</span>,ids);<br><br>   List&lt;Blog&gt; blogs = mapper.queryBlogForeach(map);<br><br>   System.out.println(blogs);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>å°ç»“ï¼šå…¶å®åŠ¨æ€ sql è¯­å¥çš„ç¼–å†™å¾€å¾€å°±æ˜¯ä¸€ä¸ªæ‹¼æ¥çš„é—®é¢˜ï¼Œä¸ºäº†ä¿è¯æ‹¼æ¥å‡†ç¡®ï¼Œæˆ‘ä»¬æœ€å¥½é¦–å…ˆè¦å†™åŸç”Ÿçš„ sql è¯­å¥å‡ºæ¥ï¼Œç„¶ååœ¨é€šè¿‡ mybatis åŠ¨æ€sql å¯¹ç…§ç€æ”¹ï¼Œé˜²æ­¢å‡ºé”™ã€‚å¤šåœ¨å®è·µä¸­ä½¿ç”¨æ‰æ˜¯ç†Ÿç»ƒæŒæ¡å®ƒçš„æŠ€å·§ã€‚</p><h1 id="åã€ç¼“å­˜"><a href="#åã€ç¼“å­˜" class="headerlink" title="åã€ç¼“å­˜"></a>åã€ç¼“å­˜</h1><h2 id="10-1-ç®€ä»‹"><a href="#10-1-ç®€ä»‹" class="headerlink" title="10.1 ç®€ä»‹"></a>10.1 ç®€ä»‹</h2><p>1ã€ä»€ä¹ˆæ˜¯ç¼“å­˜ [ Cache ]ï¼Ÿ</p><ul><li>å­˜åœ¨å†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®ã€‚</li><li>å°†ç”¨æˆ·ç»å¸¸æŸ¥è¯¢çš„æ•°æ®æ”¾åœ¨ç¼“å­˜ï¼ˆå†…å­˜ï¼‰ä¸­ï¼Œç”¨æˆ·å»æŸ¥è¯¢æ•°æ®å°±ä¸ç”¨ä»ç£ç›˜ä¸Š(å…³ç³»å‹æ•°æ®åº“æ•°æ®æ–‡ä»¶)æŸ¥è¯¢ï¼Œä»ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œè§£å†³äº†é«˜å¹¶å‘ç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚</li></ul><p>2ã€ä¸ºä»€ä¹ˆä½¿ç”¨ç¼“å­˜ï¼Ÿ</p><ul><li>å‡å°‘å’Œæ•°æ®åº“çš„äº¤äº’æ¬¡æ•°ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€ï¼Œæé«˜ç³»ç»Ÿæ•ˆç‡ã€‚</li></ul><p>3ã€ä»€ä¹ˆæ ·çš„æ•°æ®èƒ½ä½¿ç”¨ç¼“å­˜ï¼Ÿ</p><ul><li>ç»å¸¸æŸ¥è¯¢å¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„æ•°æ®ã€‚</li></ul><h2 id="10-2-Mybatisç¼“å­˜"><a href="#10-2-Mybatisç¼“å­˜" class="headerlink" title="10.2 Mybatisç¼“å­˜"></a>10.2 Mybatisç¼“å­˜</h2><ul><li><p>MyBatisåŒ…å«ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æŸ¥è¯¢ç¼“å­˜ç‰¹æ€§ï¼Œå®ƒå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®šåˆ¶å’Œé…ç½®ç¼“å­˜ã€‚ç¼“å­˜å¯ä»¥æå¤§çš„æå‡æŸ¥è¯¢æ•ˆç‡ã€‚</p></li><li><p>MyBatisç³»ç»Ÿä¸­é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜ï¼š<strong>ä¸€çº§ç¼“å­˜</strong>å’Œ<strong>äºŒçº§ç¼“å­˜</strong></p></li><li><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€çº§ç¼“å­˜å¼€å¯ã€‚ï¼ˆSqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œä¹Ÿç§°ä¸ºæœ¬åœ°ç¼“å­˜ï¼‰</li><li>äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯å’Œé…ç½®ï¼Œä»–æ˜¯åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ã€‚</li><li>ä¸ºäº†æé«˜æ‰©å±•æ€§ï¼ŒMyBatiså®šä¹‰äº†ç¼“å­˜æ¥å£Cacheã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°Cacheæ¥å£æ¥è‡ªå®šä¹‰äºŒçº§ç¼“å­˜</li></ul></li></ul><h2 id="10-3-ä¸€çº§ç¼“å­˜"><a href="#10-3-ä¸€çº§ç¼“å­˜" class="headerlink" title="10.3 ä¸€çº§ç¼“å­˜"></a>10.3 ä¸€çº§ç¼“å­˜</h2><p>ä¸€çº§ç¼“å­˜ä¹Ÿå«æœ¬åœ°ç¼“å­˜ï¼š</p><ul><li>ä¸æ•°æ®åº“åŒä¸€æ¬¡ä¼šè¯æœŸé—´æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šæ”¾åœ¨æœ¬åœ°ç¼“å­˜ä¸­ã€‚</li><li>ä»¥åå¦‚æœéœ€è¦è·å–ç›¸åŒçš„æ•°æ®ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿ï¼Œæ²¡å¿…é¡»å†å»æŸ¥è¯¢æ•°æ®åº“ï¼›</li></ul><blockquote><p>æµ‹è¯•</p></blockquote><p>1ã€åœ¨mybatisä¸­åŠ å…¥æ—¥å¿—ï¼Œæ–¹ä¾¿æµ‹è¯•ç»“æœ</p><p>2ã€ç¼–å†™æ¥å£æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br><span class="hljs-function">User <span class="hljs-title">queryUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;<br></code></pre></td></tr></table></figure><p>3ã€æ¥å£å¯¹åº”çš„Mapperæ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;user&quot;</span>&gt;</span><br>  select * from user where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><p>4ã€æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryUserById</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   User user = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br>   User user2 = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user2);<br>   System.out.println(user==user2);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>5ã€ç»“æœåˆ†æ</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/640" alt="å›¾ç‰‡"></p><blockquote><p>ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å››ç§æƒ…å†µ</p></blockquote><p>ä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œæ˜¯ä¸€ç›´å¼€å¯çš„ï¼Œæˆ‘ä»¬å…³é—­ä¸äº†å®ƒï¼›</p><p>ä¸€çº§ç¼“å­˜å¤±æ•ˆæƒ…å†µï¼šæ²¡æœ‰ä½¿ç”¨åˆ°å½“å‰çš„ä¸€çº§ç¼“å­˜ï¼Œæ•ˆæœå°±æ˜¯ï¼Œè¿˜éœ€è¦å†å‘æ•°æ®åº“ä¸­å‘èµ·ä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ï¼</p><p>1ã€sqlSessionä¸åŒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryUserById</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   SqlSession session2 = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   UserMapper mapper2 = session2.getMapper(UserMapper.class);<br><br>   User user = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br>   User user2 = mapper2.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user2);<br>   System.out.println(user==user2);<br><br>   session.close();<br>   session2.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿç»“æœï¼šå‘ç°å‘é€äº†ä¸¤æ¡SQLè¯­å¥ï¼</p><p>ç»“è®ºï¼š<strong>æ¯ä¸ªsqlSessionä¸­çš„ç¼“å­˜ç›¸äº’ç‹¬ç«‹</strong></p><p>2ã€sqlSessionç›¸åŒï¼ŒæŸ¥è¯¢æ¡ä»¶ä¸åŒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryUserById</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   UserMapper mapper2 = session.getMapper(UserMapper.class);<br><br>   User user = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br>   User user2 = mapper2.queryUserById(<span class="hljs-number">2</span>);<br>   System.out.println(user2);<br>   System.out.println(user==user2);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿç»“æœï¼šå‘ç°å‘é€äº†ä¸¤æ¡SQLè¯­å¥ï¼å¾ˆæ­£å¸¸çš„ç†è§£</p><p>ç»“è®ºï¼š<strong>å½“å‰ç¼“å­˜ä¸­ï¼Œä¸å­˜åœ¨è¿™ä¸ªæ•°æ®</strong></p><p>3ã€sqlSessionç›¸åŒï¼Œä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´æ‰§è¡Œäº†å¢åˆ æ”¹æ“ä½œï¼</p><p>å¢åŠ æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¿®æ”¹ç”¨æˆ·</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(Map map)</span></span>;<br></code></pre></td></tr></table></figure><p>ç¼–å†™SQL</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span><br>  update user set name = #&#123;name&#125; where id = #&#123;id&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryUserById</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   User user = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br><br>   HashMap map = <span class="hljs-keyword">new</span> HashMap();<br>   map.put(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;kuangshen&quot;</span>);<br>   map.put(<span class="hljs-string">&quot;id&quot;</span>,<span class="hljs-number">4</span>);<br>   mapper.updateUser(map);<br><br>   User user2 = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user2);<br><br>   System.out.println(user==user2);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿç»“æœï¼šæŸ¥è¯¢åœ¨ä¸­é—´æ‰§è¡Œäº†å¢åˆ æ”¹æ“ä½œåï¼Œé‡æ–°æ‰§è¡Œäº†</p><p>ç»“è®ºï¼š<strong>å› ä¸ºå¢åˆ æ”¹æ“ä½œå¯èƒ½ä¼šå¯¹å½“å‰æ•°æ®äº§ç”Ÿå½±å“</strong></p><p>4ã€sqlSessionç›¸åŒï¼Œæ‰‹åŠ¨æ¸…é™¤ä¸€çº§ç¼“å­˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryUserById</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   UserMapper mapper = session.getMapper(UserMapper.class);<br><br>   User user = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br><br>   session.clearCache();<span class="hljs-comment">//æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜</span><br><br>   User user2 = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user2);<br><br>   System.out.println(user==user2);<br><br>   session.close();<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€çº§ç¼“å­˜å°±æ˜¯ä¸€ä¸ªmap</p><h2 id="10-4-äºŒçº§ç¼“å­˜"><a href="#10-4-äºŒçº§ç¼“å­˜" class="headerlink" title="10.4 äºŒçº§ç¼“å­˜"></a>10.4 äºŒçº§ç¼“å­˜</h2><ul><li><p>äºŒçº§ç¼“å­˜ä¹Ÿå«å…¨å±€ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜ä½œç”¨åŸŸå¤ªä½äº†ï¼Œæ‰€ä»¥è¯ç”Ÿäº†äºŒçº§ç¼“å­˜</p></li><li><p>åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ï¼Œä¸€ä¸ªåç§°ç©ºé—´ï¼Œå¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ï¼›</p></li><li><p>å·¥ä½œæœºåˆ¶</p></li><li><ul><li>ä¸€ä¸ªä¼šè¯æŸ¥è¯¢ä¸€æ¡æ•°æ®ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«æ”¾åœ¨å½“å‰ä¼šè¯çš„ä¸€çº§ç¼“å­˜ä¸­ï¼›</li><li>å¦‚æœå½“å‰ä¼šè¯å…³é—­äº†ï¼Œè¿™ä¸ªä¼šè¯å¯¹åº”çš„ä¸€çº§ç¼“å­˜å°±æ²¡äº†ï¼›ä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ˜¯ï¼Œä¼šè¯å…³é—­äº†ï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®è¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼›</li><li>æ–°çš„ä¼šè¯æŸ¥è¯¢ä¿¡æ¯ï¼Œå°±å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–å†…å®¹ï¼›</li><li>ä¸åŒçš„mapperæŸ¥å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜ï¼ˆmapï¼‰ä¸­ï¼›</li></ul></li></ul><blockquote><p>ä½¿ç”¨æ­¥éª¤</p></blockquote><p>1ã€å¼€å¯å…¨å±€ç¼“å­˜ ã€mybatis-config.xmlã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cacheEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>2ã€å»æ¯ä¸ªmapper.xmlä¸­é…ç½®ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œè¿™ä¸ªé…ç½®éå¸¸ç®€å•ï¼›ã€xxxMapper.xmlã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">cache</span>/&gt;</span><br><br>å®˜æ–¹ç¤ºä¾‹=====&gt;æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£<br><span class="hljs-tag">&lt;<span class="hljs-name">cache</span></span><br><span class="hljs-tag"> <span class="hljs-attr">eviction</span>=<span class="hljs-string">&quot;FIFO&quot;</span></span><br><span class="hljs-tag"> <span class="hljs-attr">flushInterval</span>=<span class="hljs-string">&quot;60000&quot;</span></span><br><span class="hljs-tag"> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;512&quot;</span></span><br><span class="hljs-tag"> <span class="hljs-attr">readOnly</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br>è¿™ä¸ªæ›´é«˜çº§çš„é…ç½®åˆ›å»ºäº†ä¸€ä¸ª FIFO ç¼“å­˜ï¼Œæ¯éš” 60 ç§’åˆ·æ–°ï¼Œæœ€å¤šå¯ä»¥å­˜å‚¨ç»“æœå¯¹è±¡æˆ–åˆ—è¡¨çš„ 512 ä¸ªå¼•ç”¨ï¼Œè€Œä¸”è¿”å›çš„å¯¹è±¡è¢«è®¤ä¸ºæ˜¯åªè¯»çš„ï¼Œå› æ­¤å¯¹å®ƒä»¬è¿›è¡Œä¿®æ”¹å¯èƒ½ä¼šåœ¨ä¸åŒçº¿ç¨‹ä¸­çš„è°ƒç”¨è€…äº§ç”Ÿå†²çªã€‚<br></code></pre></td></tr></table></figure><p>3ã€ä»£ç æµ‹è¯•</p><ul><li>æ‰€æœ‰çš„å®ä½“ç±»å…ˆå®ç°åºåˆ—åŒ–æ¥å£</li><li>æµ‹è¯•ä»£ç </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testQueryUserById</span><span class="hljs-params">()</span></span>&#123;<br>   SqlSession session = MybatisUtils.getSession();<br>   SqlSession session2 = MybatisUtils.getSession();<br><br>   UserMapper mapper = session.getMapper(UserMapper.class);<br>   UserMapper mapper2 = session2.getMapper(UserMapper.class);<br><br>   User user = mapper.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user);<br>   session.close();<br><br>   User user2 = mapper2.queryUserById(<span class="hljs-number">1</span>);<br>   System.out.println(user2);<br>   System.out.println(user==user2);<br><br>   session2.close();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10-5-ç»“è®º"><a href="#10-5-ç»“è®º" class="headerlink" title="10.5 ç»“è®º"></a>10.5 ç»“è®º</h2><ul><li>åªè¦å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œæˆ‘ä»¬åœ¨åŒä¸€ä¸ªMapperä¸­çš„æŸ¥è¯¢ï¼Œå¯ä»¥åœ¨äºŒçº§ç¼“å­˜ä¸­æ‹¿åˆ°æ•°æ®</li><li>æŸ¥å‡ºçš„æ•°æ®éƒ½ä¼šè¢«é»˜è®¤å…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­</li><li>åªæœ‰ä¼šè¯æäº¤æˆ–è€…å…³é—­ä»¥åï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®æ‰ä¼šè½¬åˆ°äºŒçº§ç¼“å­˜ä¸­</li></ul><blockquote><p>ç¼“å­˜åŸç†å›¾</p></blockquote><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/12.png" alt="å›¾ç‰‡"></p><p>10.6 ç¬¬ä¸‰æ–¹ç¼“å­˜EhCache</p><p><img src="/2020/12/16/%E5%88%86%E7%B1%BB-Java%E5%BC%80%E5%8F%91/mybatis/1226.png" alt="å›¾ç‰‡"></p><p>ç¬¬ä¸‰æ–¹ç¼“å­˜å®ç°â€“EhCache: æŸ¥çœ‹ç™¾åº¦ç™¾ç§‘</p><p>Ehcacheæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„javaåˆ†å¸ƒå¼ç¼“å­˜ï¼Œç”¨äºé€šç”¨ç¼“å­˜ï¼›</p><p>è¦åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨Ehcacheï¼Œéœ€è¦å¼•å…¥ä¾èµ–çš„jaråŒ…</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis.caches/mybatis-ehcache --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.caches<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-ehcache<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨mapper.xmlä¸­ä½¿ç”¨å¯¹åº”çš„ç¼“å­˜å³å¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span> = <span class="hljs-string">â€œorg.acme.FooMapperâ€</span> &gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">type</span> = <span class="hljs-string">â€œorg.mybatis.caches.ehcache.EhcacheCacheâ€</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¼–å†™ehcache.xmlæ–‡ä»¶ï¼Œå¦‚æœåœ¨åŠ è½½æ—¶æœªæ‰¾åˆ°/ehcache.xmlèµ„æºæˆ–å‡ºç°é—®é¢˜ï¼Œåˆ™å°†ä½¿ç”¨é»˜è®¤é…ç½®ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ehcache</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">xsi:noNamespaceSchemaLocation</span>=<span class="hljs-string">&quot;http://ehcache.org/ehcache.xsd&quot;</span></span><br><span class="hljs-tag">        <span class="hljs-attr">updateCheck</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      diskStoreï¼šä¸ºç¼“å­˜è·¯å¾„ï¼Œehcacheåˆ†ä¸ºå†…å­˜å’Œç£ç›˜ä¸¤çº§ï¼Œæ­¤å±æ€§å®šä¹‰ç£ç›˜çš„ç¼“å­˜ä½ç½®ã€‚å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</span><br><span class="hljs-comment">      user.home â€“ ç”¨æˆ·ä¸»ç›®å½•</span><br><span class="hljs-comment">      user.dir â€“ ç”¨æˆ·å½“å‰å·¥ä½œç›®å½•</span><br><span class="hljs-comment">      java.io.tmpdir â€“ é»˜è®¤ä¸´æ—¶æ–‡ä»¶è·¯å¾„</span><br><span class="hljs-comment">    --&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">diskStore</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;./tmpdir/Tmp_EhCache&quot;</span>/&gt;</span><br>   <br>   <span class="hljs-tag">&lt;<span class="hljs-name">defaultCache</span></span><br><span class="hljs-tag">           <span class="hljs-attr">eternal</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">maxElementsInMemory</span>=<span class="hljs-string">&quot;10000&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">overflowToDisk</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">diskPersistent</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">timeToIdleSeconds</span>=<span class="hljs-string">&quot;1800&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">timeToLiveSeconds</span>=<span class="hljs-string">&quot;259200&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">memoryStoreEvictionPolicy</span>=<span class="hljs-string">&quot;LRU&quot;</span>/&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">cache</span></span><br><span class="hljs-tag">           <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cloud_user&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">eternal</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">maxElementsInMemory</span>=<span class="hljs-string">&quot;5000&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">overflowToDisk</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">diskPersistent</span>=<span class="hljs-string">&quot;false&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">timeToIdleSeconds</span>=<span class="hljs-string">&quot;1800&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">timeToLiveSeconds</span>=<span class="hljs-string">&quot;1800&quot;</span></span><br><span class="hljs-tag">           <span class="hljs-attr">memoryStoreEvictionPolicy</span>=<span class="hljs-string">&quot;LRU&quot;</span>/&gt;</span><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">      defaultCacheï¼šé»˜è®¤ç¼“å­˜ç­–ç•¥ï¼Œå½“ehcacheæ‰¾ä¸åˆ°å®šä¹‰çš„ç¼“å­˜æ—¶ï¼Œåˆ™ä½¿ç”¨è¿™ä¸ªç¼“å­˜ç­–ç•¥ã€‚åªèƒ½å®šä¹‰ä¸€ä¸ªã€‚</span><br><span class="hljs-comment">    --&gt;</span><br>   <span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">     name:ç¼“å­˜åç§°ã€‚</span><br><span class="hljs-comment">     maxElementsInMemory:ç¼“å­˜æœ€å¤§æ•°ç›®</span><br><span class="hljs-comment">     maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚</span><br><span class="hljs-comment">     eternal:å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚</span><br><span class="hljs-comment">     overflowToDisk:æ˜¯å¦ä¿å­˜åˆ°ç£ç›˜ï¼Œå½“ç³»ç»Ÿå½“æœºæ—¶</span><br><span class="hljs-comment">     timeToIdleSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚</span><br><span class="hljs-comment">     timeToLiveSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0.ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚</span><br><span class="hljs-comment">     diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ® Whether the disk store persists between restarts of the Virtual Machine. The default value is false.</span><br><span class="hljs-comment">     diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚</span><br><span class="hljs-comment">     diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚</span><br><span class="hljs-comment">     memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚</span><br><span class="hljs-comment">     clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚</span><br><span class="hljs-comment">     memoryStoreEvictionPolicy:å¯é€‰ç­–ç•¥æœ‰ï¼šLRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼Œé»˜è®¤ç­–ç•¥ï¼‰ã€FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€LFUï¼ˆæœ€å°‘è®¿é—®æ¬¡æ•°ï¼‰ã€‚</span><br><span class="hljs-comment">     FIFOï¼Œfirst in first outï¼Œè¿™ä¸ªæ˜¯å¤§å®¶æœ€ç†Ÿçš„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚</span><br><span class="hljs-comment">     LFUï¼Œ Less Frequently Usedï¼Œå°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è®²ä¸€ç›´ä»¥æ¥æœ€å°‘è¢«ä½¿ç”¨çš„ã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªhitå±æ€§ï¼Œhitå€¼æœ€å°çš„å°†ä¼šè¢«æ¸…å‡ºç¼“å­˜ã€‚</span><br><span class="hljs-comment">     LRUï¼ŒLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå½“ç¼“å­˜å®¹é‡æ»¡äº†ï¼Œè€Œåˆéœ€è¦è…¾å‡ºåœ°æ–¹æ¥ç¼“å­˜æ–°çš„å…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆç°æœ‰ç¼“å­˜å…ƒç´ ä¸­æ—¶é—´æˆ³ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„å…ƒç´ å°†è¢«æ¸…å‡ºç¼“å­˜ã€‚</span><br><span class="hljs-comment">  --&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">ehcache</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Javaå¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SSM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Toï¼šè›è›</title>
    <link href="/2020/10/24/first/"/>
    <url>/2020/10/24/first/</url>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="é”™å•¦ï¼å†çŒœï¼ï¼ï¼" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="5b824e77bebb353e63b4b8d9072633e0122f7a2c1d45bd93b46f02c85a20894a">de435f4adca7b95dee962158abaa00c609c9229f108154a1eea90f13073acc08d48063bd86f8a0d8ff9a26bb9ab1136885b640c1b8e34af3cd9323d072142ae06db85e280bde536858e115db893c2ade3c85a1d07d42bb0f77fedb5661adf1254fd8cf604fb36c1a3e5b24c31296fa5e2eb13ab61792aa59be8d8c3e89cfbe37b37ce7fe4986b219d6789d3a314a04441c750eae22210ee97f1b4525014b5a93a462edf32b1333d8e11b5df1a26ba09528a0f6eea5fc7843767b3d3dd271f65550c3adeda957e34b64e3deeebd81c16fd61eed419967bf6228975dc700c6548fb4aa92414b16272b84403a7346459034282c636453f355a2de0347989bd5962faaf292a13e726764d30067479d579a9ad0b6ee8069c212c79667bce1938a31927513c34364a702493c2fffccb6685225eadebb8844f91c921518782f706df9088108b50db577e1759df4a659a8bd0e0c0ae3d1165bbd04986c42535412c6bf0039bb06eb97698f667710abe274a733d721561c86d3dc30c22acd9478d5784a5b0d0985685f8c43a29937315a2edebf1a9a3fba4ae558d3143fe10d101f34bcd84980fce48dc53276fdf9697b59702e9ba83b37b212fba1d376fe33643c5cb92956e73759041e5cc64ec47f3e7917749ac37b10fcaff1fad3be652cb2a8814b5fdeeb29bf54480c0260862f349cf941775bd2862cdbe6d64f6d24f77982b3e953fb95bb1d2a06dbecaa40c19d2741926e24a5777064f9ec41fec5d5f753b04fde3fddaf516d56fa5edb9270789616e03f5f0ba67df7a9b670ca80f8bce4d6443563200e8e815ea963533b12cdaa3fd698697e8f50edfb54527c0c7f5dc7124856b5c3c26e1992b7121a468837ceea6c6794ad59eafa4377ad559c4f3b3e0e0345852de68dd6404677485fc7a065ef0af62ecb90c6f713c310d88221415072b10fdbb031c91f061fdb0d4f089fc876b4386ee52de033894da698226fc45a533bf57472e259363599a3db03df234c85bd2689b31de0883b6b0e75808531b4aec4fea05aa784441d14a26feba128afd3f6876a79fed2ad54857045ceaeb53c74ecb3fa5f557dfaa76957deeb5993e8e7b7e206fc4e4592570fd21b0aeca53f6c495422986c201cd52ad6a70c4ae798fca69258848500d41fb6ca5608775b13587c16097fa3d09d908558432bff3c2e4600944f2acbedbce78a9f865caef25c7ac300feaa2135345366001134db227f3ec6d6b609c78af3a8345d798a9c7dc24c98d24bba86f1c7fae53c18173e1da88b532e5cd12f0ab444ba2ca1278b132ffb10cee3e7e15ebddd400fe5ae41be09a60f65b5ad1a393ad78c294559779b51b8d282bf74c9920fe9dd7a358e10c01397f170069a71deb6b6cd798db5e4ca60ae2f0a</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>QuQ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
